[{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\eslint.config.mjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\next.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\postcss.config.mjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\app\\api\\analyze\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\app\\api\\cultural-analysis\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":133,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":133,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5652,5655],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5652,5655],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":186,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":186,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7602,7605],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7602,7605],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":210,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":210,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8765,8768],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8765,8768],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":224,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":224,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9326,9329],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9326,9329],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":341,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":341,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[15218,15221],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[15218,15221],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":377,"column":100,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":377,"endColumn":103,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[17257,17260],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[17257,17260],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":397,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":397,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[17919,17922],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[17919,17922],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":7,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from 'next/server';\r\nimport OpenAI from 'openai';\r\n\r\nconst openai = new OpenAI({\r\n    apiKey: process.env.OPENAI_API_KEY,\r\n});\r\n\r\n// System prompt for theme extraction\r\nconst THEME_EXTRACTION_PROMPT = `You are an expert qualitative researcher analyzing policy documents and discourse to identify key themes and concepts.\r\n\r\nExtract 5-10 key themes from the provided text. Each theme should be:\r\n- A concise phrase (2-5 words)\r\n- Representing a distinct concept, practice, or understanding\r\n- Relevant to AI governance, policy, or ecosystem dynamics\r\n\r\nReturn ONLY a JSON array of objects, where each object has a 'theme' and a 'quote'.\r\nExample: [{\"theme\": \"risk-based regulation\", \"quote\": \"The regulation follows a risk-based approach...\"}, {\"theme\": \"fundamental rights\", \"quote\": \"Union values and fundamental rights must be protected...\"}]`;\r\n\r\n// System prompt for bridging concept generation\r\nconst BRIDGING_PROMPT = `You are an expert in innovation ecosystems and policy analysis.\r\n\r\nGiven two clusters of themes that represent different \"discourse communities\" or areas of understanding, suggest 3-5 bridging concepts that could connect these two areas.\r\n\r\nBridging concepts should:\r\n- Draw from both clusters\r\n- Represent potential areas for innovation or policy intervention\r\n- Be concrete and actionable\r\n\r\nFor EACH bridging concept, provide:\r\n- The concept name (2-4 words)\r\n- A brief explanation (1 sentence) of what it means and why it bridges the gap\r\n\r\nAlso provide:\r\n1. A description of the innovation opportunity this gap represents\r\n2. A policy implication for how to leverage this cultural hole\r\n\r\nReturn your response as JSON with this structure:\r\n{\r\n  \"bridgingConcepts\": [\r\n    {\"concept\": \"concept name\", \"explanation\": \"brief explanation of this bridging concept\"},\r\n    ...\r\n  ],\r\n  \"opportunity\": \"Description of innovation potential\",\r\n  \"policyImplication\": \"Actionable policy recommendation\"\r\n}`;\r\n\r\n// Lens-specific prompt additions\r\nconst LENS_PROMPTS: Record<string, string> = {\r\n    default: \"\",\r\n    institutional_logics: `\r\n    ADOPT AN INSTITUTIONAL LOGICS LENS.\r\n    Focus specifically on identifying conflicting institutional logics (e.g., market vs. state, professional vs. corporate).\r\n    Look for symbols, practices, and rules that indicate which institutional order is dominant.\r\n    Themes should reflect these underlying logics.`,\r\n    critical_data_studies: `\r\n    ADOPT A CRITICAL DATA STUDIES LENS.\r\n    Focus on power dynamics, surveillance, data justice, and how data practices reinforce or challenge existing inequalities.\r\n    Look for silence and what is NOT said.\r\n    Themes should reflect power relations and justice implications.`,\r\n    actor_network_theory: `\r\n    ADOPT AN ACTOR-NETWORK THEORY (ANT) LENS.\r\n    Treat non-human actors (algorithms, databases, standards) as having agency.\r\n    Focus on translation processes and how networks of heterogeneous materials are assembled.\r\n    Themes should reflect the agency of artifacts and the mechanics of translation.`\r\n};\r\n\r\n// Helper function to calculate cosine similarity\r\nfunction cosineSimilarity(a: number[], b: number[]): number {\r\n    const dotProduct = a.reduce((sum, val, i) => sum + val * b[i], 0);\r\n    const magnitudeA = Math.sqrt(a.reduce((sum, val) => sum + val * val, 0));\r\n    const magnitudeB = Math.sqrt(b.reduce((sum, val) => sum + val * val, 0));\r\n    return dotProduct / (magnitudeA * magnitudeB);\r\n}\r\n\r\n// Helper function to perform hierarchical clustering\r\nfunction hierarchicalClustering(\r\n    themeObjects: { theme: string; quote: string }[],\r\n    embeddings: number[][],\r\n    sourceIds: string[],\r\n    threshold: number = 0.7\r\n): Array<{ themes: { theme: string; quote: string }[]; sources: string[]; centroid: number[] }> {\r\n    // Start with each theme as its own cluster\r\n    let clusters = themeObjects.map((obj, i) => ({\r\n        themes: [obj],\r\n        sources: [sourceIds[i]],\r\n        embeddings: [embeddings[i]],\r\n        centroid: embeddings[i],\r\n    }));\r\n\r\n    // Merge clusters until no more similar pairs\r\n    let merged = true;\r\n    while (merged && clusters.length > 1) {\r\n        merged = false;\r\n        let maxSimilarity = threshold;\r\n        let mergeIndices: [number, number] | null = null;\r\n\r\n        // Find most similar pair\r\n        for (let i = 0; i < clusters.length; i++) {\r\n            for (let j = i + 1; j < clusters.length; j++) {\r\n                const similarity = cosineSimilarity(clusters[i].centroid, clusters[j].centroid);\r\n                if (similarity > maxSimilarity) {\r\n                    maxSimilarity = similarity;\r\n                    mergeIndices = [i, j];\r\n                }\r\n            }\r\n        }\r\n\r\n        // Merge if found\r\n        if (mergeIndices) {\r\n            const [i, j] = mergeIndices;\r\n            const newCluster = {\r\n                themes: [...clusters[i].themes, ...clusters[j].themes],\r\n                sources: [...new Set([...clusters[i].sources, ...clusters[j].sources])],\r\n                embeddings: [...clusters[i].embeddings, ...clusters[j].embeddings],\r\n                centroid: clusters[i].centroid.map((val, idx) =>\r\n                    (val + clusters[j].centroid[idx]) / 2\r\n                ),\r\n            };\r\n            clusters = [\r\n                ...clusters.slice(0, i),\r\n                ...clusters.slice(i + 1, j),\r\n                ...clusters.slice(j + 1),\r\n                newCluster,\r\n            ];\r\n            merged = true;\r\n        }\r\n    }\r\n\r\n    return clusters;\r\n}\r\n\r\n// Helper function to safely parse JSON from AI responses\r\nfunction safeJSONParse(text: string, fallback: any = []) {\r\n    try {\r\n        // Remove markdown code blocks if present\r\n        let cleaned = text.trim();\r\n        if (cleaned.startsWith('```json')) {\r\n            cleaned = cleaned.replace(/```json\\n?/g, '').replace(/```\\n?$/g, '');\r\n        } else if (cleaned.startsWith('```')) {\r\n            cleaned = cleaned.replace(/```\\n?/g, '');\r\n        }\r\n        cleaned = cleaned.trim();\r\n\r\n        return JSON.parse(cleaned);\r\n    } catch (error) {\r\n        console.error('JSON parse error:', error, 'Text:', text);\r\n        return fallback;\r\n    }\r\n}\r\n\r\nexport async function POST(request: NextRequest) {\r\n    try {\r\n        // Check API key\r\n        if (!process.env.OPENAI_API_KEY) {\r\n            console.error('OPENAI_API_KEY is not set');\r\n            return NextResponse.json(\r\n                { success: false, error: 'OpenAI API key is not configured' },\r\n                { status: 500 }\r\n            );\r\n        }\r\n\r\n        const body = await request.json();\r\n        const { sources, lensId = 'default' } = body;\r\n\r\n        console.log('Cultural analysis request received:', {\r\n            sourceCount: sources?.length,\r\n            hasSources: !!sources,\r\n            lensId\r\n        });\r\n\r\n        if (!sources || !Array.isArray(sources) || sources.length < 2) {\r\n            console.error('Invalid sources:', sources);\r\n            return NextResponse.json(\r\n                { success: false, error: 'At least 2 sources required for cultural analysis' },\r\n                { status: 400 }\r\n            );\r\n        }\r\n\r\n        // Construct the lens-aware prompt\r\n        const lensPrompt = LENS_PROMPTS[lensId as keyof typeof LENS_PROMPTS] || \"\";\r\n        const finalSystemPrompt = `${THEME_EXTRACTION_PROMPT}\\n\\n${lensPrompt}`;\r\n\r\n        // Step 1: Extract themes from each source\r\n        console.log('Extracting themes from sources...');\r\n        const themeExtractions = await Promise.all(\r\n            sources.map(async (source: any, index: number) => {\r\n                try {\r\n                    console.log(`Extracting themes from source ${index + 1}/${sources.length}: ${source.title}`);\r\n\r\n                    const response = await openai.chat.completions.create({\r\n                        model: 'gpt-4o-mini',\r\n                        messages: [\r\n                            { role: 'system', content: finalSystemPrompt },\r\n                            { role: 'user', content: source.text.substring(0, 4000) },\r\n                        ],\r\n                        temperature: 0.3,\r\n                    });\r\n\r\n                    const themesText = response.choices[0].message.content || '[]';\r\n                    console.log(`Raw themes response for ${source.title}:`, themesText.substring(0, 200));\r\n\r\n                    const themes = safeJSONParse(themesText, []);\r\n                    console.log(`Extracted ${themes.length} themes from ${source.title}`);\r\n\r\n                    return {\r\n                        sourceId: source.id,\r\n                        sourceTitle: source.title,\r\n                        themes,\r\n                    };\r\n                } catch (error: any) {\r\n                    console.error(`Error extracting themes from source ${source.title}:`, error.message);\r\n                    throw error;\r\n                }\r\n            })\r\n        );\r\n\r\n        // Step 2: Generate embeddings for all themes\r\n        console.log('Generating embeddings...');\r\n        const allThemesText: string[] = [];\r\n        const allThemeObjects: { theme: string; quote: string }[] = [];\r\n        const sourceIds: string[] = [];\r\n\r\n        themeExtractions.forEach((extraction) => {\r\n            extraction.themes.forEach((item: any) => {\r\n                // Handle both old (string) and new (object) formats for robustness\r\n                const themeText = typeof item === 'string' ? item : item.theme;\r\n                const quote = typeof item === 'string' ? '' : item.quote;\r\n\r\n                allThemesText.push(themeText);\r\n                allThemeObjects.push({ theme: themeText, quote });\r\n                sourceIds.push(extraction.sourceId);\r\n            });\r\n        });\r\n\r\n        const embeddingResponse = await openai.embeddings.create({\r\n            model: 'text-embedding-3-small',\r\n            input: allThemesText,\r\n        });\r\n\r\n        const embeddings = embeddingResponse.data.map((item) => item.embedding);\r\n\r\n        // Step 3: Cluster themes\r\n        console.log('Clustering themes...');\r\n        const rawClusters = hierarchicalClustering(allThemeObjects, embeddings, sourceIds, 0.7);\r\n\r\n        // Format clusters\r\n        const clusters = rawClusters.map((cluster, i) => ({\r\n            id: `cluster-${i}`,\r\n            name: cluster.themes[0].theme, // Use first theme as cluster name\r\n            themes: cluster.themes.map(t => t.theme), // Keep simple string array for compatibility if needed\r\n            quotes: cluster.themes.map(t => t.quote).filter(q => q), // Extract quotes\r\n            sources: cluster.sources,\r\n            centroid: cluster.centroid,\r\n            size: cluster.themes.length,\r\n        }));\r\n\r\n        // Generate descriptions for each cluster\r\n        console.log('Generating cluster descriptions...');\r\n        const clustersWithDescriptions = await Promise.all(\r\n            clusters.map(async (cluster) => {\r\n                try {\r\n                    const descriptionResponse = await openai.chat.completions.create({\r\n                        model: 'gpt-4o-mini',\r\n                        messages: [\r\n                            {\r\n                                role: 'system',\r\n                                content: `You are an expert in discourse analysis and policy research. Given a list of related themes, provide a single concise sentence (max 15 words) that defines what this discourse cluster represents. Examples: \"regulatory copying policies\", \"grand societal challenges\", \"diversity-coherence paradox\", \"enactment fields\". Focus on identifying the conceptual pattern or theoretical category.`\r\n                            },\r\n                            {\r\n                                role: 'user',\r\n                                content: `Themes: ${cluster.themes.join(', ')}`\r\n                            }\r\n                        ],\r\n                        temperature: 0.3,\r\n                    });\r\n\r\n                    const description = descriptionResponse.choices[0].message.content?.trim() || cluster.name;\r\n                    return { ...cluster, description };\r\n                } catch (error) {\r\n                    console.error(`Error generating description for cluster ${cluster.id}:`, error);\r\n                    return { ...cluster, description: cluster.name };\r\n                }\r\n            })\r\n        );\r\n\r\n        // Step 4: Identify cultural holes (gaps between clusters)\r\n        console.log('Identifying cultural holes...');\r\n        const potentialHoles = [];\r\n        const holeThreshold = 0.4; // Clusters with similarity < 0.4 are considered \"holes\"\r\n\r\n        for (let i = 0; i < clustersWithDescriptions.length; i++) {\r\n            for (let j = i + 1; j < clustersWithDescriptions.length; j++) {\r\n                const similarity = cosineSimilarity(clustersWithDescriptions[i].centroid, clustersWithDescriptions[j].centroid);\r\n                const distance = 1 - similarity;\r\n\r\n                if (distance > holeThreshold) {\r\n                    potentialHoles.push({\r\n                        clusterA: clustersWithDescriptions[i],\r\n                        clusterB: clustersWithDescriptions[j],\r\n                        distance: parseFloat(distance.toFixed(3)),\r\n                    });\r\n                }\r\n            }\r\n        }\r\n\r\n        // Sort by distance and only generate bridging concepts for top 3 largest gaps\r\n        potentialHoles.sort((a, b) => b.distance - a.distance);\r\n        const topHoles = potentialHoles.slice(0, 3);\r\n\r\n        console.log(`Found ${potentialHoles.length} potential holes, generating bridging concepts for top ${topHoles.length}`);\r\n\r\n        const holes = await Promise.all(\r\n            topHoles.map(async (hole) => {\r\n                try {\r\n                    const bridgingResponse = await openai.chat.completions.create({\r\n                        model: 'gpt-4o-mini',\r\n                        messages: [\r\n                            { role: 'system', content: BRIDGING_PROMPT },\r\n                            {\r\n                                role: 'user',\r\n                                content: `Cluster A themes: ${hole.clusterA.themes.join(', ')}\\n\\nCluster B themes: ${hole.clusterB.themes.join(', ')}`,\r\n                            },\r\n                        ],\r\n                        temperature: 0.5,\r\n                    });\r\n\r\n                    const bridgingData = safeJSONParse(\r\n                        bridgingResponse.choices[0].message.content || '{}',\r\n                        { bridgingConcepts: [], opportunity: '', policyImplication: '' }\r\n                    );\r\n\r\n                    return {\r\n                        id: `hole-${hole.clusterA.id}-${hole.clusterB.id}`,\r\n                        clusterA: hole.clusterA.id,\r\n                        clusterB: hole.clusterB.id,\r\n                        distance: hole.distance,\r\n                        bridgingConcepts: bridgingData.bridgingConcepts || [],\r\n                        opportunity: bridgingData.opportunity || '',\r\n                        policyImplication: bridgingData.policyImplication || '',\r\n                    };\r\n                } catch (error: any) {\r\n                    console.error(`Error generating bridging concepts:`, error.message);\r\n                    return {\r\n                        id: `hole-${hole.clusterA.id}-${hole.clusterB.id}`,\r\n                        clusterA: hole.clusterA.id,\r\n                        clusterB: hole.clusterB.id,\r\n                        distance: hole.distance,\r\n                        bridgingConcepts: [],\r\n                        opportunity: 'Error generating opportunity description',\r\n                        policyImplication: 'Error generating policy implication',\r\n                    };\r\n                }\r\n            })\r\n        );\r\n\r\n        console.log(`Cultural analysis complete. Found ${clusters.length} clusters and ${holes.length} cultural holes`);\r\n\r\n        // Step 5: Generate overall summary\r\n        console.log('Generating overall summary...');\r\n        let summary = \"\";\r\n        try {\r\n            const summaryResponse = await openai.chat.completions.create({\r\n                model: 'gpt-4o-mini',\r\n                messages: [\r\n                    {\r\n                        role: 'system',\r\n                        content: `You are an expert in cultural sociology and innovation ecosystems. \r\n                        Summarize the key findings of this cultural analysis in 2-3 sentences.\r\n                        Focus on the main discourse clusters identified and the most significant cultural hole (gap) between them.\r\n                        Highlight the potential for innovation or policy intervention.`\r\n                    },\r\n                    {\r\n                        role: 'user',\r\n                        content: `Analysis Results:\r\n                        Clusters: ${clustersWithDescriptions.map(c => c.name).join(', ')}\r\n                        Top Cultural Hole: ${holes.length > 0 ? `Between ${holes[0].clusterA} and ${holes[0].clusterB} (Distance: ${holes[0].distance})` : \"None found\"}\r\n                        Bridging Concepts: ${holes.length > 0 ? holes[0].bridgingConcepts.map((bc: any) => bc.concept).join(', ') : \"N/A\"}`\r\n                    }\r\n                ],\r\n                temperature: 0.5,\r\n            });\r\n            summary = summaryResponse.choices[0].message.content || \"\";\r\n        } catch (error) {\r\n            console.error(\"Error generating summary:\", error);\r\n            summary = \"Summary generation failed.\";\r\n        }\r\n\r\n        return NextResponse.json({\r\n            success: true,\r\n            analysis: {\r\n                summary,\r\n                clusters: clustersWithDescriptions,\r\n                holes,\r\n                timestamp: new Date().toISOString(),\r\n            },\r\n        });\r\n    } catch (error: any) {\r\n        console.error('Cultural analysis error:', error);\r\n        return NextResponse.json(\r\n            { success: false, error: error.message || 'Cultural analysis failed' },\r\n            { status: 500 }\r\n        );\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\app\\api\\ecosystem\\simulate\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\app\\api\\generate-search-terms\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'parseError' is defined but never used.","line":56,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":56,"endColumn":28}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextResponse } from 'next/server';\r\nimport OpenAI from 'openai';\r\n\r\nexport async function POST(req: Request) {\r\n    try {\r\n        const { keyInsight } = await req.json();\r\n\r\n        if (!keyInsight) {\r\n            return NextResponse.json(\r\n                { success: false, error: 'Key insight is required' },\r\n                { status: 400 }\r\n            );\r\n        }\r\n\r\n        const apiKey = process.env.OPENAI_API_KEY;\r\n        if (!apiKey) {\r\n            return NextResponse.json(\r\n                { success: false, error: 'OpenAI API key not configured' },\r\n                { status: 500 }\r\n            );\r\n        }\r\n\r\n        const openai = new OpenAI({ apiKey });\r\n\r\n        const prompt = `Given this policy insight, extract 3-5 key search terms or phrases that would be most effective for finding related discussions on Reddit. Focus on concrete topics, issues, or controversies that people would actually discuss online.\r\n\r\nInsight: \"${keyInsight}\"\r\n\r\nReturn ONLY a JSON array of search terms, without any markdown formatting or explanation. Example format:\r\n[\"algorithmic bias\", \"AI regulation\", \"facial recognition\"]`;\r\n\r\n        const response = await openai.chat.completions.create({\r\n            model: 'gpt-4o-mini',\r\n            messages: [\r\n                {\r\n                    role: 'system',\r\n                    content: 'You are a search optimization expert. Extract the most relevant search terms for finding online discussions.'\r\n                },\r\n                { role: 'user', content: prompt }\r\n            ],\r\n            temperature: 0.3,\r\n            max_tokens: 200\r\n        });\r\n\r\n        const content = response.choices[0].message.content?.trim() || '[]';\r\n\r\n        // Parse the JSON response (handle potential markdown wrapping)\r\n        let searchTerms: string[];\r\n        try {\r\n            const jsonMatch = content.match(/\\[[\\s\\S]*\\]/);\r\n            if (jsonMatch) {\r\n                searchTerms = JSON.parse(jsonMatch[0]);\r\n            } else {\r\n                searchTerms = JSON.parse(content);\r\n            }\r\n        } catch (parseError) {\r\n            console.error('Failed to parse AI response:', content);\r\n            return NextResponse.json(\r\n                { success: false, error: 'Failed to parse AI response' },\r\n                { status: 500 }\r\n            );\r\n        }\r\n\r\n        // Validate that we got an array of strings\r\n        if (!Array.isArray(searchTerms) || searchTerms.length === 0) {\r\n            return NextResponse.json(\r\n                { success: false, error: 'Invalid search terms generated' },\r\n                { status: 500 }\r\n            );\r\n        }\r\n\r\n        return NextResponse.json({ success: true, searchTerms });\r\n\r\n    } catch (error) {\r\n        console.error('Search term generation error:', error);\r\n        return NextResponse.json(\r\n            { success: false, error: 'Internal Server Error' },\r\n            { status: 500 }\r\n        );\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\app\\api\\logs\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":23,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":23,"endColumn":19},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":29,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":29,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[710,713],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[710,713],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":38,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":38,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":64,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":64,"endColumn":19}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from 'next/server';\r\nimport fs from 'fs/promises';\r\nimport path from 'path';\r\n\r\nconst LOGS_FILE = path.join(process.cwd(), 'data', 'logs.json');\r\n\r\n// Ensure data directory exists\r\nasync function ensureDataDir() {\r\n    const dataDir = path.join(process.cwd(), 'data');\r\n    try {\r\n        await fs.access(dataDir);\r\n    } catch {\r\n        await fs.mkdir(dataDir, { recursive: true });\r\n    }\r\n}\r\n\r\n// Read logs\r\nasync function getLogs() {\r\n    await ensureDataDir();\r\n    try {\r\n        const data = await fs.readFile(LOGS_FILE, 'utf-8');\r\n        return JSON.parse(data);\r\n    } catch (error) {\r\n        return [];\r\n    }\r\n}\r\n\r\n// Save logs\r\nasync function saveLogs(logs: any[]) {\r\n    await ensureDataDir();\r\n    await fs.writeFile(LOGS_FILE, JSON.stringify(logs, null, 2));\r\n}\r\n\r\nexport async function GET() {\r\n    try {\r\n        const logs = await getLogs();\r\n        return NextResponse.json(logs);\r\n    } catch (error) {\r\n        return NextResponse.json({ error: 'Failed to fetch logs' }, { status: 500 });\r\n    }\r\n}\r\n\r\nexport async function POST(request: NextRequest) {\r\n    try {\r\n        const body = await request.json();\r\n        const { action, details, timestamp } = body;\r\n\r\n        if (!action) {\r\n            return NextResponse.json({ error: 'Action is required' }, { status: 400 });\r\n        }\r\n\r\n        const newLog = {\r\n            id: crypto.randomUUID(),\r\n            action,\r\n            details: details || {},\r\n            timestamp: timestamp || new Date().toISOString(),\r\n        };\r\n\r\n        const logs = await getLogs();\r\n        logs.unshift(newLog); // Add to beginning\r\n        await saveLogs(logs);\r\n\r\n        return NextResponse.json(newLog);\r\n    } catch (error) {\r\n        return NextResponse.json({ error: 'Failed to save log' }, { status: 500 });\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\app\\api\\search-traces\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":91,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":91,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3391,3394],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3391,3394],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":133,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":133,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5096,5099],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5096,5099],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from 'next/server';\r\nimport OpenAI from 'openai';\r\n\r\nconst KEY_TERM_EXTRACTION_PROMPT = `You are an expert researcher analyzing policy documents to identify key terms for web searches.\r\n\r\nYour task is to extract 3-5 specific, searchable terms or phrases from the policy text that would help find real-world discussions about resistance, criticism, or adaptation to this policy.\r\n\r\nFocus on:\r\n- Specific mechanisms or requirements (e.g., \"facial recognition ban\", \"high-risk AI systems\")\r\n- Controversial or burdensome aspects\r\n- Terms that affected communities would use (e.g., \"gig worker surveillance\", \"algorithm transparency\")\r\n\r\nReturn ONLY a JSON array of strings, nothing else:\r\n[\"term 1\", \"term 2\", \"term 3\"]`;\r\n\r\ninterface SearchResult {\r\n    title: string;\r\n    snippet: string;\r\n    link: string;\r\n    displayLink: string;\r\n}\r\n\r\ninterface GoogleSearchResponse {\r\n    items?: SearchResult[];\r\n}\r\n\r\nexport async function POST(request: NextRequest) {\r\n    try {\r\n        const { policyText, customQuery, platforms } = await request.json();\r\n\r\n        // Check for required API keys\r\n        const googleApiKey = process.env.GOOGLE_SEARCH_API_KEY;\r\n        const searchEngineId = process.env.GOOGLE_SEARCH_ENGINE_ID;\r\n        const openaiApiKey = process.env.OPENAI_API_KEY;\r\n\r\n\r\n\r\n        if (!googleApiKey || !searchEngineId) {\r\n            return NextResponse.json(\r\n                {\r\n                    error: 'Google Search API not configured',\r\n                    details: 'Please add GOOGLE_SEARCH_API_KEY and GOOGLE_SEARCH_ENGINE_ID to .env.local'\r\n                },\r\n                { status: 500 }\r\n            );\r\n        }\r\n\r\n        let searchQueries: string[] = [];\r\n\r\n        // If custom query provided, use it directly\r\n        if (customQuery && customQuery.trim()) {\r\n            searchQueries = [customQuery.trim()];\r\n        }\r\n        // Otherwise, extract key terms from policy text\r\n        else if (policyText) {\r\n            if (!openaiApiKey) {\r\n                return NextResponse.json(\r\n                    { error: 'OpenAI API key required for automatic term extraction' },\r\n                    { status: 500 }\r\n                );\r\n            }\r\n\r\n            const openai = new OpenAI({ apiKey: openaiApiKey });\r\n\r\n            const completion = await openai.chat.completions.create({\r\n                model: 'gpt-4',\r\n                messages: [\r\n                    { role: 'system', content: KEY_TERM_EXTRACTION_PROMPT },\r\n                    { role: 'user', content: `POLICY TEXT:\\n${policyText.substring(0, 3000)}` }\r\n                ],\r\n                temperature: 0.3,\r\n                max_tokens: 200,\r\n            });\r\n\r\n            const responseText = completion.choices[0]?.message?.content || '';\r\n            try {\r\n                searchQueries = JSON.parse(responseText);\r\n            } catch {\r\n                // Fallback if parsing fails\r\n                searchQueries = ['AI policy resistance', 'algorithm criticism'];\r\n            }\r\n        } else {\r\n            return NextResponse.json(\r\n                { error: 'Either policyText or customQuery must be provided' },\r\n                { status: 400 }\r\n            );\r\n        }\r\n\r\n        // Construct platform-specific queries\r\n        const platformFilters = platforms || ['reddit', 'hackernews', 'forums'];\r\n        const allTraces: any[] = [];\r\n\r\n        for (const query of searchQueries.slice(0, 2)) { // Limit to 2 queries to save API quota\r\n            for (const platform of platformFilters) {\r\n                let siteQuery = query;\r\n\r\n                if (platform === 'reddit') {\r\n                    siteQuery = `site:reddit.com ${query}`;\r\n                } else if (platform === 'hackernews') {\r\n                    siteQuery = `site:news.ycombinator.com ${query}`;\r\n                } else if (platform === 'forums') {\r\n                    // Search general forums\r\n                    siteQuery = `${query} forum OR discussion`;\r\n                }\r\n\r\n                // Call Google Custom Search API\r\n                const searchUrl = `https://www.googleapis.com/customsearch/v1?key=${googleApiKey}&cx=${searchEngineId}&q=${encodeURIComponent(siteQuery)}&num=3`;\r\n\r\n                const response = await fetch(searchUrl);\r\n                const data: GoogleSearchResponse = await response.json();\r\n\r\n                if (data.items) {\r\n                    for (const item of data.items) {\r\n                        allTraces.push({\r\n                            title: item.title,\r\n                            description: `From ${item.displayLink}`,\r\n                            content: item.snippet,\r\n                            sourceUrl: item.link,\r\n                            platform: platform,\r\n                            query: query\r\n                        });\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return NextResponse.json({\r\n            success: true,\r\n            traces: allTraces,\r\n            queriesUsed: searchQueries.slice(0, 2)\r\n        });\r\n\r\n    } catch (error: any) {\r\n        console.error('Search error:', error);\r\n        return NextResponse.json(\r\n            {\r\n                error: 'Search failed',\r\n                details: error.message\r\n            },\r\n            { status: 500 }\r\n        );\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\app\\api\\search\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":115,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":115,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5287,5290],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5287,5290],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextResponse } from 'next/server';\r\n\r\nexport async function POST(req: Request) {\r\n    try {\r\n        const { query, policyText, maxResults = 5 } = await req.json();\r\n\r\n        // Determine the search query\r\n        let searchQuery = query;\r\n\r\n        // If policyText is provided but no query, generate search terms from the policy text\r\n        if (!searchQuery && policyText) {\r\n            const apiKey = process.env.GOOGLE_API_KEY;\r\n            if (!apiKey) {\r\n                return NextResponse.json(\r\n                    { success: false, error: 'Google API key not configured for search term generation. Please set GOOGLE_API_KEY in .env.local' },\r\n                    { status: 500 }\r\n                );\r\n            }\r\n\r\n            try {\r\n                const { GoogleGenerativeAI } = await import('@google/generative-ai');\r\n                const genAI = new GoogleGenerativeAI(apiKey);\r\n                const modelName = process.env.GOOGLE_AI_MODEL || \"gemini-1.5-flash\";\r\n                const model = genAI.getGenerativeModel({ model: modelName });\r\n\r\n                const prompt = `You are analyzing an AI governance policy document to find EMPIRICAL TRACES of real-world resistance, impacts, and micro-practices.\r\n\r\nPolicy Document Excerpt:\r\n\"${policyText.substring(0, 1000)}\"\r\n\r\nYour task: Generate 1-2 highly specific search queries to find:\r\n1. Real people discussing how this policy affects them (workers, users, communities)\r\n2. Evidence of resistance strategies (workarounds, refusals, collective action)\r\n3. Concrete examples of policy implementation challenges or failures\r\n4. Forum posts, Reddit threads, or social media discussions about lived experiences\r\n\r\nIMPORTANT RULES:\r\n- Focus on SPECIFIC stakeholders (e.g., \"gig workers\", \"content moderators\", \"AI developers\")\r\n- Include action words (e.g., \"resist\", \"workaround\", \"protest\", \"experience\")\r\n- Avoid generic terms like \"AI regulation\" or \"policy discussion\"\r\n- Target platforms where affected people actually discuss issues (Reddit, forums, social media)\r\n\r\nGOOD EXAMPLES:\r\n- \"uber drivers algorithm manipulation reddit\"\r\n- \"content moderators AI moderation burnout\"\r\n- \"facial recognition protest community resistance\"\r\n\r\nBAD EXAMPLES:\r\n- \"AI regulation\" (too broad)\r\n- \"EU AI Act\" (just the policy name)\r\n- \"artificial intelligence governance\" (academic, not empirical)\r\n\r\nReturn ONLY a JSON array of 1-2 search queries, no markdown:\r\n[\"specific query 1\", \"specific query 2\"]`;\r\n\r\n                const result = await model.generateContent(prompt);\r\n                const response = result.response;\r\n                const content = response.text().trim();\r\n\r\n                // Parse the JSON response (handle potential markdown wrapping)\r\n                const jsonMatch = content.match(/\\[[\\s\\S]*\\]/);\r\n                const searchTerms = jsonMatch ? JSON.parse(jsonMatch[0]) : JSON.parse(content);\r\n\r\n                if (Array.isArray(searchTerms) && searchTerms.length > 0) {\r\n                    searchQuery = searchTerms[0]; // Use the first search term\r\n                } else {\r\n                    return NextResponse.json(\r\n                        { success: false, error: 'Failed to generate search terms from policy text' },\r\n                        { status: 400 }\r\n                    );\r\n                }\r\n            } catch (aiError) {\r\n                console.error('AI search term generation error:', aiError);\r\n                return NextResponse.json(\r\n                    { success: false, error: 'Failed to generate search terms' },\r\n                    { status: 500 }\r\n                );\r\n            }\r\n        }\r\n\r\n        if (!searchQuery) {\r\n            return NextResponse.json(\r\n                { success: false, error: 'Either query or policyText is required' },\r\n                { status: 400 }\r\n            );\r\n        }\r\n\r\n        const googleApiKey = process.env.GOOGLE_SEARCH_API_KEY;\r\n        const cx = process.env.GOOGLE_SEARCH_CX || process.env.GOOGLE_SEARCH_ENGINE_ID;\r\n\r\n        if (!googleApiKey || !cx) {\r\n            return NextResponse.json(\r\n                { success: false, error: 'Google Search API configuration missing. Please set GOOGLE_SEARCH_API_KEY and GOOGLE_SEARCH_CX in .env.local' },\r\n                { status: 500 }\r\n            );\r\n        }\r\n\r\n        // Enhance query with site-specific operators to target empirical discussion platforms\r\n        // This helps filter out news articles and academic papers in favor of real discussions\r\n        const enhancedQuery = `${searchQuery} (site:reddit.com OR site:news.ycombinator.com OR site:*.stackexchange.com OR inurl:forum OR inurl:discussion)`;\r\n\r\n        const searchUrl = `https://www.googleapis.com/customsearch/v1?key=${googleApiKey}&cx=${cx}&q=${encodeURIComponent(enhancedQuery)}&num=${Math.min(maxResults, 10)}`;\r\n\r\n        const response = await fetch(searchUrl);\r\n        const data = await response.json();\r\n\r\n        if (!response.ok) {\r\n            console.error('Google Search API Error:', data);\r\n            return NextResponse.json(\r\n                { success: false, error: data.error?.message || 'Failed to fetch search results' },\r\n                { status: response.status }\r\n            );\r\n        }\r\n\r\n        const results = data.items?.map((item: any) => ({\r\n            title: item.title,\r\n            link: item.link,\r\n            snippet: item.snippet,\r\n        })) || [];\r\n\r\n        return NextResponse.json({\r\n            success: true,\r\n            results,\r\n            searchQuery // Return the query that was used\r\n        });\r\n\r\n    } catch (error) {\r\n        console.error('Search API Error:', error);\r\n        return NextResponse.json(\r\n            { success: false, error: 'Internal Server Error' },\r\n            { status: 500 }\r\n        );\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\app\\api\\sources\\[id]\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":18,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":18,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":36,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":36,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextResponse } from 'next/server';\r\nimport { updateSource, deleteSource } from '@/lib/store';\r\n\r\nexport async function PUT(\r\n    request: Request,\r\n    { params }: { params: Promise<{ id: string }> }\r\n) {\r\n    try {\r\n        const { id } = await params;\r\n        const body = await request.json();\r\n        const updatedSource = await updateSource(id, body);\r\n\r\n        if (!updatedSource) {\r\n            return NextResponse.json({ error: 'Source not found' }, { status: 404 });\r\n        }\r\n\r\n        return NextResponse.json(updatedSource);\r\n    } catch (error) {\r\n        return NextResponse.json({ error: 'Failed to update source' }, { status: 500 });\r\n    }\r\n}\r\n\r\nexport async function DELETE(\r\n    request: Request,\r\n    { params }: { params: Promise<{ id: string }> }\r\n) {\r\n    try {\r\n        const { id } = await params;\r\n        const success = await deleteSource(id);\r\n\r\n        if (!success) {\r\n            return NextResponse.json({ error: 'Source not found' }, { status: 404 });\r\n        }\r\n\r\n        return NextResponse.json({ success: true });\r\n    } catch (error) {\r\n        return NextResponse.json({ error: 'Failed to delete source' }, { status: 500 });\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\app\\api\\sources\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":8,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":18,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":18,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextResponse } from 'next/server';\r\nimport { getSources, addSource } from '@/lib/store';\r\n\r\nexport async function GET() {\r\n    try {\r\n        const sources = await getSources();\r\n        return NextResponse.json(sources);\r\n    } catch (error) {\r\n        return NextResponse.json({ error: 'Failed to fetch sources' }, { status: 500 });\r\n    }\r\n}\r\n\r\nexport async function POST(request: Request) {\r\n    try {\r\n        const body = await request.json();\r\n        const newSource = await addSource(body);\r\n        return NextResponse.json(newSource);\r\n    } catch (error) {\r\n        return NextResponse.json({ error: 'Failed to create source' }, { status: 500 });\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\app\\comparison\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CulturalFraming' is defined but never used.","line":12,"column":6,"nodeType":null,"messageId":"unusedVar","endLine":12,"endColumn":21},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\app\\comparison\\page.tsx:25:9\n  23 |         // Filter for policy documents (non-traces)\n  24 |         const policies = sources.filter(s => s.type !== \"Trace\");\n> 25 |         setPolicyDocs(policies);\n     |         ^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  26 |\n  27 |         // Auto-select first two docs\n  28 |         if (policies.length >= 2 && selectedDocs.length === 0) {","line":25,"column":9,"nodeType":null,"endLine":25,"endColumn":22},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":152,"column":63,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[7293,7421],"text":"\r\n                                                analysisMode: &apos;cultural_framing'\r\n                                            "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[7293,7421],"text":"\r\n                                                analysisMode: &lsquo;cultural_framing'\r\n                                            "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[7293,7421],"text":"\r\n                                                analysisMode: &#39;cultural_framing'\r\n                                            "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[7293,7421],"text":"\r\n                                                analysisMode: &rsquo;cultural_framing'\r\n                                            "},"desc":"Replace with `&rsquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":152,"column":80,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[7293,7421],"text":"\r\n                                                analysisMode: 'cultural_framing&apos;\r\n                                            "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[7293,7421],"text":"\r\n                                                analysisMode: 'cultural_framing&lsquo;\r\n                                            "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[7293,7421],"text":"\r\n                                                analysisMode: 'cultural_framing&#39;\r\n                                            "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[7293,7421],"text":"\r\n                                                analysisMode: 'cultural_framing&rsquo;\r\n                                            "},"desc":"Replace with `&rsquo;`."}]},{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Use \"@ts-expect-error\" instead of \"@ts-ignore\", as \"@ts-ignore\" will do nothing if the following line is error-free.","line":197,"column":74,"nodeType":"Block","messageId":"tsIgnoreInsteadOfExpectError","endLine":197,"endColumn":90,"suggestions":[{"messageId":"replaceTsIgnoreWithTsExpectError","fix":{"range":[11165,11181],"text":"/* @ts-expect-error */"},"desc":"Replace \"@ts-ignore\" with \"@ts-expect-error\"."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":231,"column":63,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[13279,13411],"text":"\r\n                                                analysisMode: &apos;institutional_logics'\r\n                                            "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[13279,13411],"text":"\r\n                                                analysisMode: &lsquo;institutional_logics'\r\n                                            "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[13279,13411],"text":"\r\n                                                analysisMode: &#39;institutional_logics'\r\n                                            "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[13279,13411],"text":"\r\n                                                analysisMode: &rsquo;institutional_logics'\r\n                                            "},"desc":"Replace with `&rsquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":231,"column":84,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[13279,13411],"text":"\r\n                                                analysisMode: 'institutional_logics&apos;\r\n                                            "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[13279,13411],"text":"\r\n                                                analysisMode: 'institutional_logics&lsquo;\r\n                                            "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[13279,13411],"text":"\r\n                                                analysisMode: 'institutional_logics&#39;\r\n                                            "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[13279,13411],"text":"\r\n                                                analysisMode: 'institutional_logics&rsquo;\r\n                                            "},"desc":"Replace with `&rsquo;`."}]},{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Use \"@ts-expect-error\" instead of \"@ts-ignore\", as \"@ts-ignore\" will do nothing if the following line is error-free.","line":249,"column":65,"nodeType":"Line","messageId":"tsIgnoreInsteadOfExpectError","endLine":249,"endColumn":78,"suggestions":[{"messageId":"replaceTsIgnoreWithTsExpectError","fix":{"range":[14720,14733],"text":"// @ts-expect-error"},"desc":"Replace \"@ts-ignore\" with \"@ts-expect-error\"."}]}],"suppressedMessages":[],"errorCount":7,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport { useSources } from \"@/hooks/useSources\";\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\r\nimport { ArrowLeftRight, Globe2, Scale, Users, Building, Loader2 } from \"lucide-react\";\r\nimport { Source, AnalysisResult } from \"@/types\";\r\n\r\ntype CulturalFraming = NonNullable<AnalysisResult>;\r\n\r\nexport default function ComparisonPage() {\r\n    const { sources, isLoading } = useSources();\r\n    const [policyDocs, setPolicyDocs] = useState<Source[]>([]);\r\n    const [selectedDocs, setSelectedDocs] = useState<string[]>([]);\r\n    const [activeTab, setActiveTab] = useState<\"cultural\" | \"logics\">(\"cultural\");\r\n\r\n    useEffect(() => {\r\n        if (isLoading) return;\r\n\r\n        // Filter for policy documents (non-traces)\r\n        const policies = sources.filter(s => s.type !== \"Trace\");\r\n        setPolicyDocs(policies);\r\n\r\n        // Auto-select first two docs\r\n        if (policies.length >= 2 && selectedDocs.length === 0) {\r\n            setSelectedDocs([policies[0].id, policies[1].id]);\r\n        }\r\n    }, [sources, isLoading, selectedDocs.length]);\r\n\r\n    const selectedSources = selectedDocs\r\n        .map(id => policyDocs.find(s => s.id === id))\r\n        .filter(Boolean) as Source[];\r\n\r\n    const logicIcons = {\r\n        market: Building,\r\n        state: Scale,\r\n        professional: Users,\r\n        community: Users,\r\n    };\r\n\r\n    const logicColors = {\r\n        market: \"text-purple-600 bg-purple-100\",\r\n        state: \"text-blue-600 bg-blue-100\",\r\n        professional: \"text-green-600 bg-green-100\",\r\n        community: \"text-orange-600 bg-orange-100\",\r\n    };\r\n\r\n    if (isLoading) {\r\n        return (\r\n            <div className=\"flex items-center justify-center h-64\">\r\n                <Loader2 className=\"h-8 w-8 animate-spin text-slate-400\" />\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"space-y-8\">\r\n            <div>\r\n                <h2 className=\"text-3xl font-bold tracking-tight text-slate-900\">Comparative Analysis</h2>\r\n                <p className=\"text-slate-500\">Compare cultural framing and institutional logics across jurisdictions.</p>\r\n            </div>\r\n\r\n            {/* Document Selector */}\r\n            <Card>\r\n                <CardHeader>\r\n                    <CardTitle className=\"flex items-center gap-2\">\r\n                        <ArrowLeftRight className=\"h-5 w-5\" />\r\n                        Select Documents to Compare\r\n                    </CardTitle>\r\n                    <CardDescription>Choose 2-3 policy documents for side-by-side analysis</CardDescription>\r\n                </CardHeader>\r\n                <CardContent>\r\n                    <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n                        {[0, 1, 2].map((index) => (\r\n                            <div key={index}>\r\n                                <label className=\"text-sm font-medium text-slate-700 mb-2 block\">\r\n                                    Document {index + 1} {index > 0 && \"(Optional)\"}\r\n                                </label>\r\n                                <Select\r\n                                    value={selectedDocs[index] || \"\"}\r\n                                    onValueChange={(value) => {\r\n                                        const newSelection = [...selectedDocs];\r\n                                        newSelection[index] = value;\r\n                                        setSelectedDocs(newSelection.filter(Boolean));\r\n                                    }}\r\n                                >\r\n                                    <SelectTrigger>\r\n                                        <SelectValue placeholder=\"Select document...\" />\r\n                                    </SelectTrigger>\r\n                                    <SelectContent>\r\n                                        {policyDocs.map((doc) => (\r\n                                            <SelectItem key={doc.id} value={doc.id}>\r\n                                                {doc.title}\r\n                                                {doc.jurisdiction && (\r\n                                                    <Badge variant=\"outline\" className=\"ml-2\">\r\n                                                        {doc.jurisdiction}\r\n                                                    </Badge>\r\n                                                )}\r\n                                            </SelectItem>\r\n                                        ))}\r\n                                    </SelectContent>\r\n                                </Select>\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                </CardContent>\r\n            </Card>\r\n\r\n            {/* Analysis Type Tabs */}\r\n            {selectedSources.length >= 2 && (\r\n                <>\r\n                    <div className=\"flex gap-2\">\r\n                        <Button\r\n                            variant={activeTab === \"cultural\" ? \"default\" : \"outline\"}\r\n                            onClick={() => setActiveTab(\"cultural\")}\r\n                            className=\"flex-1\"\r\n                        >\r\n                            <Globe2 className=\"mr-2 h-4 w-4\" />\r\n                            Cultural Framing\r\n                        </Button>\r\n                        <Button\r\n                            variant={activeTab === \"logics\" ? \"default\" : \"outline\"}\r\n                            onClick={() => setActiveTab(\"logics\")}\r\n                            className=\"flex-1\"\r\n                        >\r\n                            <Scale className=\"mr-2 h-4 w-4\" />\r\n                            Institutional Logics\r\n                        </Button>\r\n                    </div>\r\n\r\n                    {/* Cultural Framing Comparison */}\r\n                    {activeTab === \"cultural\" && (\r\n                        <div className=\"space-y-6\">\r\n                            <Card>\r\n                                <CardHeader>\r\n                                    <CardTitle>Cultural Framing Comparison</CardTitle>\r\n                                    <CardDescription>\r\n                                        How do these jurisdictions differ in their cultural assumptions about AI governance?\r\n                                    </CardDescription>\r\n                                </CardHeader>\r\n                                <CardContent>\r\n                                    {!selectedSources[0]?.cultural_framing && (\r\n                                        <div className=\"text-center py-8 text-slate-500\">\r\n                                            <p className=\"mb-4\">No cultural framing analysis yet.</p>\r\n                                            <p className=\"text-sm\">\r\n                                                Run cultural framing analysis on these documents first.\r\n                                            </p>\r\n                                            <code className=\"text-xs bg-slate-100 px-2 py-1 rounded mt-2 block max-w-2xl mx-auto\">\r\n                                                analysisMode: 'cultural_framing'\r\n                                            </code>\r\n                                        </div>\r\n                                    )}\r\n\r\n                                    {selectedSources[0]?.cultural_framing && (\r\n                                        <div className=\"space-y-8\">\r\n                                            {/* Cultural Distinctiveness Scores */}\r\n                                            <div>\r\n                                                <h4 className=\"font-semibold mb-4\">Cultural Distinctiveness</h4>\r\n                                                <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n                                                    {selectedSources.map((source) => (\r\n                                                        <Card key={source.id} className=\"bg-slate-50\">\r\n                                                            <CardContent className=\"pt-6\">\r\n                                                                <div className=\"text-center\">\r\n                                                                    <div className=\"text-3xl font-bold text-slate-900\">\r\n                                                                        {((source.cultural_framing?.cultural_distinctiveness_score ?? 0) * 100).toFixed(0)}%\r\n                                                                    </div>\r\n                                                                    <div className=\"text-sm text-slate-600 mt-1\">\r\n                                                                        {source.title}\r\n                                                                    </div>\r\n                                                                    <div className=\"text-xs text-slate-500 mt-2 italic\">\r\n                                                                        {source.cultural_framing?.dominant_cultural_logic}\r\n                                                                    </div>\r\n                                                                </div>\r\n                                                            </CardContent>\r\n                                                        </Card>\r\n                                                    ))}\r\n                                                </div>\r\n                                            </div>\r\n\r\n                                            {/* Dimension Comparison */}\r\n                                            {[\"state_market_society\", \"technology_role\", \"rights_conception\", \"historical_context\", \"epistemic_authority\"].map((dimension) => (\r\n                                                <div key={dimension}>\r\n                                                    <h4 className=\"font-semibold mb-3 capitalize\">\r\n                                                        {dimension.replace(/_/g, \" \")}\r\n                                                    </h4>\r\n                                                    <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n                                                        {selectedSources.map((source) => (\r\n                                                            <Card key={source.id}>\r\n                                                                <CardContent className=\"pt-4\">\r\n                                                                    <div className=\"text-xs font-semibold text-slate-500 mb-2\">\r\n                                                                        {source.title}\r\n                                                                    </div>\r\n                                                                    <div className=\"text-sm text-slate-700\">\r\n                                                                        {/* @ts-ignore */}\r\n                                                                        {source.cultural_framing?.[dimension] || \"Not analyzed\"}\r\n                                                                    </div>\r\n                                                                </CardContent>\r\n                                                            </Card>\r\n                                                        ))}\r\n                                                    </div>\r\n                                                </div>\r\n                                            ))}\r\n                                        </div>\r\n                                    )}\r\n                                </CardContent>\r\n                            </Card>\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* Institutional Logics Comparison */}\r\n                    {activeTab === \"logics\" && (\r\n                        <div className=\"space-y-6\">\r\n                            <Card>\r\n                                <CardHeader>\r\n                                    <CardTitle>Institutional Logics Comparison</CardTitle>\r\n                                    <CardDescription>\r\n                                        Which institutional logics dominate in each jurisdiction?\r\n                                    </CardDescription>\r\n                                </CardHeader>\r\n                                <CardContent>\r\n                                    {!selectedSources[0]?.institutional_logics && (\r\n                                        <div className=\"text-center py-8 text-slate-500\">\r\n                                            <p className=\"mb-4\">No institutional logics analysis yet.</p>\r\n                                            <p className=\"text-sm\">\r\n                                                Run institutional logics analysis on these documents first.\r\n                                            </p>\r\n                                            <code className=\"text-xs bg-slate-100 px-2 py-1 rounded mt-2 block max-w-2xl mx-auto\">\r\n                                                analysisMode: 'institutional_logics'\r\n                                            </code>\r\n                                        </div>\r\n                                    )}\r\n\r\n                                    {selectedSources[0]?.institutional_logics && (\r\n                                        <div className=\"space-y-8\">\r\n                                            {/* Logic Strength Comparison */}\r\n                                            {[\"market\", \"state\", \"professional\", \"community\"].map((logic) => {\r\n                                                const Icon = logicIcons[logic as keyof typeof logicIcons];\r\n                                                return (\r\n                                                    <div key={logic}>\r\n                                                        <h4 className=\"font-semibold mb-4 flex items-center gap-2 capitalize\">\r\n                                                            <Icon className=\"h-5 w-5\" />\r\n                                                            {logic} Logic\r\n                                                        </h4>\r\n                                                        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n                                                            {selectedSources.map((source) => {\r\n                                                                // @ts-ignore\r\n                                                                const logicData = source.institutional_logics?.logics[logic];\r\n                                                                return (\r\n                                                                    <Card key={source.id} className={logicColors[logic as keyof typeof logicColors]}>\r\n                                                                        <CardContent className=\"pt-6\">\r\n                                                                            <div className=\"text-xs font-semibold mb-2\">\r\n                                                                                {source.title}\r\n                                                                            </div>\r\n                                                                            <div className=\"mb-3\">\r\n                                                                                <div className=\"flex items-center justify-between mb-1\">\r\n                                                                                    <span className=\"text-xs\">Strength</span>\r\n                                                                                    <span className=\"text-sm font-bold\">\r\n                                                                                        {((logicData?.strength || 0) * 100).toFixed(0)}%\r\n                                                                                    </span>\r\n                                                                                </div>\r\n                                                                                <div className=\"w-full bg-white rounded-full h-2\">\r\n                                                                                    <div\r\n                                                                                        className=\"bg-slate-800 h-2 rounded-full\"\r\n                                                                                        style={{ width: `${(logicData?.strength || 0) * 100}%` }}\r\n                                                                                    />\r\n                                                                                </div>\r\n                                                                            </div>\r\n                                                                            <div className=\"text-xs space-y-2\">\r\n                                                                                <div>\r\n                                                                                    <span className=\"font-semibold\">Material:</span>{\" \"}\r\n                                                                                    {logicData?.material || \"N/A\"}\r\n                                                                                </div>\r\n                                                                                <div>\r\n                                                                                    <span className=\"font-semibold\">Discursive:</span>{\" \"}\r\n                                                                                    {logicData?.discursive || \"N/A\"}\r\n                                                                                </div>\r\n                                                                            </div>\r\n                                                                        </CardContent>\r\n                                                                    </Card>\r\n                                                                );\r\n                                                            })}\r\n                                                        </div>\r\n                                                    </div>\r\n                                                );\r\n                                            })}\r\n\r\n                                            {/* Dominant Logic Summary */}\r\n                                            <div>\r\n                                                <h4 className=\"font-semibold mb-4\">Dominant Logic</h4>\r\n                                                <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n                                                    {selectedSources.map((source) => (\r\n                                                        <Card key={source.id} className=\"bg-slate-50\">\r\n                                                            <CardContent className=\"pt-6\">\r\n                                                                <div className=\"text-center\">\r\n                                                                    <Badge className=\"text-lg px-4 py-2 capitalize\">\r\n                                                                        {source.institutional_logics?.dominant_logic || \"Unknown\"}\r\n                                                                    </Badge>\r\n                                                                    <div className=\"text-xs text-slate-600 mt-3\">\r\n                                                                        {source.title}\r\n                                                                    </div>\r\n                                                                    <div className=\"text-xs text-slate-700 mt-4 text-left\">\r\n                                                                        {source.institutional_logics?.overall_assessment || \"No assessment\"}\r\n                                                                    </div>\r\n                                                                </div>\r\n                                                            </CardContent>\r\n                                                        </Card>\r\n                                                    ))}\r\n                                                </div>\r\n                                            </div>\r\n\r\n                                            {/* Logic Conflicts */}\r\n                                            <div>\r\n                                                <h4 className=\"font-semibold mb-4\">Logic Conflicts</h4>\r\n                                                <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n                                                    {selectedSources.map((source) => (\r\n                                                        <Card key={source.id}>\r\n                                                            <CardContent className=\"pt-6\">\r\n                                                                <div className=\"text-xs font-semibold text-slate-500 mb-3\">\r\n                                                                    {source.title}\r\n                                                                </div>\r\n                                                                <div className=\"space-y-3\">\r\n                                                                    {source.institutional_logics?.logic_conflicts?.map((conflict, idx) => (\r\n                                                                        <div key={idx} className=\"text-xs space-y-1 p-2 bg-amber-50 rounded border border-amber-200\">\r\n                                                                            <div className=\"font-semibold text-amber-800\">\r\n                                                                                {conflict.between}\r\n                                                                            </div>\r\n                                                                            <div className=\"text-slate-700\">\r\n                                                                                <span className=\"font-semibold\">Site:</span> {conflict.site_of_conflict}\r\n                                                                            </div>\r\n                                                                            <div className=\"text-slate-700\">\r\n                                                                                <span className=\"font-semibold\">Resolution:</span> {conflict.resolution_strategy}\r\n                                                                            </div>\r\n                                                                        </div>\r\n                                                                    ))}\r\n                                                                    {(!source.institutional_logics?.logic_conflicts || source.institutional_logics.logic_conflicts.length === 0) && (\r\n                                                                        <div className=\"text-slate-500 italic\">No conflicts identified</div>\r\n                                                                    )}\r\n                                                                </div>\r\n                                                            </CardContent>\r\n                                                        </Card>\r\n                                                    ))}\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n                                    )}\r\n                                </CardContent>\r\n                            </Card>\r\n                        </div>\r\n                    )}\r\n                </>\r\n            )}\r\n\r\n            {selectedSources.length < 2 && (\r\n                <Card className=\"bg-slate-50 border-dashed\">\r\n                    <CardContent className=\"pt-6 text-center text-slate-500\">\r\n                        <Globe2 className=\"h-12 w-12 mx-auto mb-4 text-slate-400\" />\r\n                        <p>Select at least 2 documents above to begin comparing</p>\r\n                    </CardContent>\r\n                </Card>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\app\\cultural\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Source' is defined but never used.","line":5,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":16},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CulturalHoleNetwork' is defined but never used.","line":12,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":12,"endColumn":29},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":135,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":135,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7166,7169],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7166,7169],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":213,"column":58,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[10816,10868],"text":"Clusters similar themes into &quot;discourse communities\""},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[10816,10868],"text":"Clusters similar themes into &ldquo;discourse communities\""},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[10816,10868],"text":"Clusters similar themes into &#34;discourse communities\""},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[10816,10868],"text":"Clusters similar themes into &rdquo;discourse communities\""},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":213,"column":80,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[10816,10868],"text":"Clusters similar themes into \"discourse communities&quot;"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[10816,10868],"text":"Clusters similar themes into \"discourse communities&ldquo;"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[10816,10868],"text":"Clusters similar themes into \"discourse communities&#34;"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[10816,10868],"text":"Clusters similar themes into \"discourse communities&rdquo;"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":399,"column":136,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[21094,21247],"text":"Groups of related themes that use similar language and concepts. Each cluster represents a coherent &quot;discourse community\" within your analyzed documents."},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[21094,21247],"text":"Groups of related themes that use similar language and concepts. Each cluster represents a coherent &ldquo;discourse community\" within your analyzed documents."},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[21094,21247],"text":"Groups of related themes that use similar language and concepts. Each cluster represents a coherent &#34;discourse community\" within your analyzed documents."},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[21094,21247],"text":"Groups of related themes that use similar language and concepts. Each cluster represents a coherent &rdquo;discourse community\" within your analyzed documents."},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":399,"column":156,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[21094,21247],"text":"Groups of related themes that use similar language and concepts. Each cluster represents a coherent \"discourse community&quot; within your analyzed documents."},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[21094,21247],"text":"Groups of related themes that use similar language and concepts. Each cluster represents a coherent \"discourse community&ldquo; within your analyzed documents."},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[21094,21247],"text":"Groups of related themes that use similar language and concepts. Each cluster represents a coherent \"discourse community&#34; within your analyzed documents."},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[21094,21247],"text":"Groups of related themes that use similar language and concepts. Each cluster represents a coherent \"discourse community&rdquo; within your analyzed documents."},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":403,"column":86,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[21469,21643],"text":"Gaps between discourse clusters where concepts don&apos;t overlap. These represent areas where different stakeholder groups or policy frameworks aren't connecting with each other."},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[21469,21643],"text":"Gaps between discourse clusters where concepts don&lsquo;t overlap. These represent areas where different stakeholder groups or policy frameworks aren't connecting with each other."},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[21469,21643],"text":"Gaps between discourse clusters where concepts don&#39;t overlap. These represent areas where different stakeholder groups or policy frameworks aren't connecting with each other."},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[21469,21643],"text":"Gaps between discourse clusters where concepts don&rsquo;t overlap. These represent areas where different stakeholder groups or policy frameworks aren't connecting with each other."},"desc":"Replace with `&rsquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":403,"column":180,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[21469,21643],"text":"Gaps between discourse clusters where concepts don't overlap. These represent areas where different stakeholder groups or policy frameworks aren&apos;t connecting with each other."},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[21469,21643],"text":"Gaps between discourse clusters where concepts don't overlap. These represent areas where different stakeholder groups or policy frameworks aren&lsquo;t connecting with each other."},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[21469,21643],"text":"Gaps between discourse clusters where concepts don't overlap. These represent areas where different stakeholder groups or policy frameworks aren&#39;t connecting with each other."},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[21469,21643],"text":"Gaps between discourse clusters where concepts don't overlap. These represent areas where different stakeholder groups or policy frameworks aren&rsquo;t connecting with each other."},"desc":"Replace with `&rsquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":407,"column":189,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[22063,22183],"text":". The &quot;bridging concepts\" suggest ways to connect isolated conversations and create more holistic governance frameworks."},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[22063,22183],"text":". The &ldquo;bridging concepts\" suggest ways to connect isolated conversations and create more holistic governance frameworks."},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[22063,22183],"text":". The &#34;bridging concepts\" suggest ways to connect isolated conversations and create more holistic governance frameworks."},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[22063,22183],"text":". The &rdquo;bridging concepts\" suggest ways to connect isolated conversations and create more holistic governance frameworks."},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":407,"column":207,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[22063,22183],"text":". The \"bridging concepts&quot; suggest ways to connect isolated conversations and create more holistic governance frameworks."},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[22063,22183],"text":". The \"bridging concepts&ldquo; suggest ways to connect isolated conversations and create more holistic governance frameworks."},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[22063,22183],"text":". The \"bridging concepts&#34; suggest ways to connect isolated conversations and create more holistic governance frameworks."},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[22063,22183],"text":". The \"bridging concepts&rdquo; suggest ways to connect isolated conversations and create more holistic governance frameworks."},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":486,"column":69,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[27430,27501],"text":"\r\n                                                                    &quot;"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[27430,27501],"text":"\r\n                                                                    &ldquo;"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[27430,27501],"text":"\r\n                                                                    &#34;"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[27430,27501],"text":"\r\n                                                                    &rdquo;"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":486,"column":77,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[27508,27575],"text":"&quot;\r\n                                                                "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[27508,27575],"text":"&ldquo;\r\n                                                                "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[27508,27575],"text":"&#34;\r\n                                                                "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[27508,27575],"text":"&rdquo;\r\n                                                                "},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":11,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState } from \"react\";\r\nimport { useSources } from \"@/hooks/useSources\";\r\nimport { Source } from \"@/types\";\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Tooltip, TooltipContent, TooltipProvider, TooltipTrigger } from \"@/components/ui/tooltip\";\r\nimport { Lightbulb, Sparkles, Network, Loader2, BookOpen } from \"lucide-react\";\r\nimport { CulturalHoleCard } from \"@/components/CulturalHoleCard\";\r\nimport { CulturalHoleNetwork } from \"@/components/CulturalHoleNetwork\";\r\nimport { CulturalHoleMatrix } from \"@/components/CulturalHoleMatrix\";\r\nimport { CulturalAnalysisResult } from \"@/types/cultural\";\r\n\r\nexport default function CulturalAnalysisPage() {\r\n    const { sources, isLoading } = useSources();\r\n    const [selectedSources, setSelectedSources] = useState<string[]>([]);\r\n    const [isAnalyzing, setIsAnalyzing] = useState(false);\r\n    const [culturalAnalysis, setCulturalAnalysis] = useState<CulturalAnalysisResult | null>(null);\r\n    const [selectedLensId, setSelectedLensId] = useState<string>(\"default\");\r\n\r\n    const theoreticalLenses = [\r\n        {\r\n            id: \"default\",\r\n            name: \"Discursive Field Analysis\",\r\n            description: \"General analysis of cultural framing, legitimacy dynamics, and epistemic authority.\",\r\n            explanation: \"This lens views the text as a 'discursive field' (Miranda et al., 2022) where meaning is contested. It focuses on how specific terms and narratives circumscribe what is considered 'true' or 'legitimate' knowledge, often privileging Western/Global North epistemologies over local or indigenous ones.\",\r\n            apiHint: \"The AI is prompted to analyze 'cultural framing,' 'epistemic authority,' and 'legitimacy dynamics.' It looks for how the text constructs the 'state-market-society' relationship.\"\r\n        },\r\n        {\r\n            id: \"institutional_logics\",\r\n            name: \"Institutional Logics\",\r\n            description: \"Focus on conflicting institutional orders (e.g., market vs. state).\",\r\n            explanation: \"Based on the work of Thornton et al. and applied by Jennings/Faraj, this lens analyzes the conflicting 'logics' (e.g., Market vs. State vs. Community) that shape the text. It identifies how these logics compete for dominance within the algorithmic assemblage.\",\r\n            apiHint: \"The AI is prompted to identify specific 'institutional logics' (Market, State, Professional, Community) and map their 'discursive and material interconnections.'\"\r\n        },\r\n        {\r\n            id: \"critical_data_studies\",\r\n            name: \"Critical Data Studies\",\r\n            description: \"Focus on power dynamics, surveillance, and data justice.\",\r\n            explanation: \"This lens focuses on power, surveillance, and data justice. It interrogates the 'data relations' and 'extractivist' practices embedded in the policy, asking who benefits from data flows and who is marginalized.\",\r\n            apiHint: \"The AI is prompted to look for 'data extractivism,' 'surveillance capitalism,' and 'algorithmic bias.' It questions the 'neutrality' of data.\"\r\n        },\r\n        {\r\n            id: \"actor_network_theory\",\r\n            name: \"Actor-Network Theory\",\r\n            description: \"Focus on the agency of non-human actors and translation processes.\",\r\n            explanation: \"This lens views the policy as an 'assemblage' of human and non-human actors (Latour, Callon). It focuses on 'translation' processeshow goals are displaced and modified as they pass through different actors (e.g., how a 'fairness' goal becomes a 'bias metric').\",\r\n            apiHint: \"The AI is prompted to map the 'network of actors' and identify 'translation centers' and 'obligatory passage points.'\"\r\n        }\r\n    ];\r\n\r\n    // Filter sources that have text available for analysis\r\n    const analyzedSources = sources.filter(s => s.analysis || s.extractedText);\r\n\r\n    const toggleSource = (sourceId: string) => {\r\n        setSelectedSources((prev) =>\r\n            prev.includes(sourceId)\r\n                ? prev.filter((id) => id !== sourceId)\r\n                : [...prev, sourceId]\r\n        );\r\n    };\r\n\r\n    const handleAnalyze = async () => {\r\n        if (selectedSources.length < 2) {\r\n            alert(\"Please select at least 2 sources for cultural analysis.\");\r\n            return;\r\n        }\r\n\r\n        setIsAnalyzing(true);\r\n        console.log('Starting cultural analysis...');\r\n\r\n        try {\r\n            const sourcesToAnalyze = analyzedSources.filter((s) =>\r\n                selectedSources.includes(s.id)\r\n            );\r\n\r\n            console.log('Sources to analyze:', sourcesToAnalyze.map(s => ({ id: s.id, title: s.title, hasText: !!s.extractedText })));\r\n\r\n            const requestBody = {\r\n                sources: sourcesToAnalyze.map((s) => ({\r\n                    id: s.id,\r\n                    title: s.title,\r\n                    text: s.extractedText?.substring(0, 4000) || '',\r\n                })),\r\n                lensId: selectedLensId\r\n            };\r\n\r\n            console.log('Sending request to /api/cultural-analysis...');\r\n\r\n            const response = await fetch('/api/cultural-analysis', {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify(requestBody),\r\n            });\r\n\r\n            console.log('Response status:', response.status);\r\n\r\n            if (!response.ok) {\r\n                const errorText = await response.text();\r\n                console.error('Response error:', errorText);\r\n                throw new Error(`API returned ${response.status}: ${errorText}`);\r\n            }\r\n\r\n            const data = await response.json();\r\n            console.log('Response data:', data);\r\n\r\n            if (data.success && data.analysis) {\r\n                console.log('Analysis successful, setting results');\r\n                setCulturalAnalysis(data.analysis);\r\n\r\n                // Log the methodological action\r\n                try {\r\n                    await fetch('/api/logs', {\r\n                        method: 'POST',\r\n                        headers: { 'Content-Type': 'application/json' },\r\n                        body: JSON.stringify({\r\n                            action: \"Cultural Analysis\",\r\n                            details: {\r\n                                lens: selectedLensId,\r\n                                sourceCount: sourcesToAnalyze.length,\r\n                                clustersFound: data.analysis.clusters.length,\r\n                                holesFound: data.analysis.holes.length\r\n                            }\r\n                        })\r\n                    });\r\n                } catch (logError) {\r\n                    console.error(\"Failed to log action:\", logError);\r\n                }\r\n            } else {\r\n                console.error('Analysis failed:', data.error);\r\n                alert(\"Cultural analysis failed: \" + (data.error || \"Unknown error\"));\r\n            }\r\n        } catch (error: any) {\r\n            console.error(\"Cultural analysis error:\", error);\r\n            alert(`Failed to perform cultural analysis: ${error.message || error}`);\r\n        } finally {\r\n            console.log('Analysis complete, resetting button');\r\n            setIsAnalyzing(false);\r\n        }\r\n    };\r\n\r\n    if (isLoading) {\r\n        return (\r\n            <div className=\"flex items-center justify-center h-64\">\r\n                <Loader2 className=\"h-8 w-8 animate-spin text-slate-400\" />\r\n            </div>\r\n        );\r\n    }\r\n\r\n    const exportToCSV = () => {\r\n        if (!culturalAnalysis) return;\r\n\r\n        // 1. Clusters CSV\r\n        const clustersHeader = \"Type,Name,Themes,Sources\\n\";\r\n        const clustersRows = culturalAnalysis.clusters.map(c =>\r\n            `Cluster,\"${c.name}\",\"${c.themes.join(', ')}\",\"${c.sources.join(', ')}\"`\r\n        ).join(\"\\n\");\r\n\r\n        // 2. Holes CSV\r\n        const holesHeader = \"\\nType,Gap Between,Distance,Bridging Concepts,Opportunity,Policy Implication\\n\";\r\n        const holesRows = culturalAnalysis.holes.map(h =>\r\n            `Hole,\"${h.clusterA} - ${h.clusterB}\",${h.distance},\"${h.bridgingConcepts.join(', ')}\",\"${h.opportunity}\",\"${h.policyImplication}\"`\r\n        ).join(\"\\n\");\r\n\r\n        const csvContent = \"data:text/csv;charset=utf-8,\"\r\n            + \"Analysis Summary\\n\" + `\"${(culturalAnalysis.summary || '').replace(/\"/g, '\"\"')}\"\\n\\n`\r\n            + clustersHeader + clustersRows\r\n            + holesHeader + holesRows;\r\n\r\n        const encodedUri = encodeURI(csvContent);\r\n        const link = document.createElement(\"a\");\r\n        link.setAttribute(\"href\", encodedUri);\r\n        link.setAttribute(\"download\", `cultural_analysis_${new Date().toISOString().slice(0, 10)}.csv`);\r\n        document.body.appendChild(link);\r\n        link.click();\r\n        document.body.removeChild(link);\r\n    };\r\n\r\n    return (\r\n        <div className=\"space-y-8\">\r\n            {/* Header */}\r\n            <div>\r\n                <h2 className=\"text-3xl font-bold tracking-tight text-slate-900\">\r\n                    Hermeneutic Interpretation of Discursive Fields\r\n                </h2>\r\n                <p className=\"text-slate-500\">\r\n                    Identify gaps between discourse clusters within the algorithmic assemblage to discover innovation opportunities and legitimacy dynamics.\r\n                </p>\r\n            </div>\r\n\r\n            {/* Introduction Card */}\r\n            <Card className=\"bg-gradient-to-br from-amber-50 to-orange-50 border-amber-200\">\r\n                <CardHeader>\r\n                    <div className=\"flex items-center gap-2\">\r\n                        <Lightbulb className=\"h-5 w-5 text-amber-600\" />\r\n                        <CardTitle>What are Cultural Holes?</CardTitle>\r\n                    </div>\r\n                    <CardDescription>\r\n                        Understanding gaps in entrepreneurial ecosystems\r\n                    </CardDescription>\r\n                </CardHeader>\r\n                <CardContent className=\"space-y-3 text-sm text-slate-700\">\r\n                    <p>\r\n                        <strong>Cultural holes</strong> are gaps between clusters of understandings, practices, or discourse within a sociotechnical ecosystem. These gaps represent opportunities for new ideas, practices, or values to emerge.\r\n                    </p>\r\n                    <p>\r\n                        By analyzing discourse from multiple policy documents, this tool:\r\n                    </p>\r\n                    <ul className=\"list-disc list-inside space-y-1 ml-2\">\r\n                        <li>Extracts key themes from each document</li>\r\n                        <li>Clusters similar themes into \"discourse communities\"</li>\r\n                        <li>Identifies gaps between distant clusters</li>\r\n                        <li>Suggests bridging concepts for policy intervention</li>\r\n                    </ul>\r\n                </CardContent>\r\n            </Card>\r\n\r\n            {/* Theoretical Lens Selection */}\r\n            <Card>\r\n                <CardHeader>\r\n                    <CardTitle>Theoretical Lens</CardTitle>\r\n                    <CardDescription>\r\n                        Select a theoretical framework to guide the hermeneutic interpretation.\r\n                    </CardDescription>\r\n                </CardHeader>\r\n                <CardContent>\r\n                    <div className=\"grid gap-4 md:grid-cols-2\">\r\n                        {theoreticalLenses.map((lens) => (\r\n                            <div\r\n                                key={lens.id}\r\n                                className={`p-4 border-2 rounded-lg cursor-pointer transition-all ${selectedLensId === lens.id\r\n                                    ? \"border-indigo-500 bg-indigo-50\"\r\n                                    : \"border-slate-200 hover:border-slate-300\"\r\n                                    }`}\r\n                                onClick={() => setSelectedLensId(lens.id)}\r\n                            >\r\n                                <div className=\"flex items-start justify-between\">\r\n                                    <div>\r\n                                        <h4 className=\"font-semibold text-slate-900\">\r\n                                            {lens.name}\r\n                                        </h4>\r\n                                        <p className=\"text-sm text-slate-600 mt-1\">\r\n                                            {lens.description}\r\n                                        </p>\r\n                                    </div>\r\n                                    {selectedLensId === lens.id && (\r\n                                        <Badge className=\"bg-indigo-500 text-white\">\r\n                                            Active\r\n                                        </Badge>\r\n                                    )}\r\n                                </div>\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                </CardContent>\r\n            </Card>\r\n\r\n            {/* Selected Lens Details */}\r\n            <Card className=\"bg-indigo-50/50 border-indigo-100\">\r\n                <CardHeader className=\"pb-2\">\r\n                    <div className=\"flex items-center gap-2\">\r\n                        <BookOpen className=\"h-5 w-5 text-indigo-600\" />\r\n                        <CardTitle className=\"text-lg\">\r\n                            Lens Details: {theoreticalLenses.find(l => l.id === selectedLensId)?.name}\r\n                        </CardTitle>\r\n                    </div>\r\n                </CardHeader>\r\n                <CardContent className=\"space-y-4\">\r\n                    <div>\r\n                        <h4 className=\"text-sm font-semibold text-indigo-900 mb-1\">Theoretical Explanation</h4>\r\n                        <p className=\"text-sm text-slate-700 leading-relaxed\">\r\n                            {theoreticalLenses.find(l => l.id === selectedLensId)?.explanation}\r\n                        </p>\r\n                    </div>\r\n                    <div className=\"bg-white p-3 rounded-md border border-indigo-100\">\r\n                        <h4 className=\"text-xs font-semibold text-slate-500 uppercase tracking-wider mb-1 flex items-center gap-1\">\r\n                            <Sparkles className=\"h-3 w-3\" /> API Query Logic\r\n                        </h4>\r\n                        <p className=\"text-xs text-slate-600 font-mono\">\r\n                            {theoreticalLenses.find(l => l.id === selectedLensId)?.apiHint}\r\n                        </p>\r\n                    </div>\r\n                </CardContent>\r\n            </Card>\r\n\r\n            {/* Source Selection */}\r\n            <Card>\r\n                <CardHeader>\r\n                    <CardTitle>Select Sources for Analysis</CardTitle>\r\n                    <CardDescription>\r\n                        Choose at least 2 analyzed documents to detect cultural holes\r\n                    </CardDescription>\r\n                </CardHeader>\r\n                <CardContent className=\"space-y-4\">\r\n                    {analyzedSources.length === 0 ? (\r\n                        <div className=\"text-center py-8 text-slate-500\">\r\n                            <p>No analyzed sources available.</p>\r\n                            <p className=\"text-sm mt-2\">\r\n                                Please upload and analyze documents on the Data page first.\r\n                            </p>\r\n                        </div>\r\n                    ) : (\r\n                        <>\r\n                            <div className=\"grid gap-3\">\r\n                                {analyzedSources.map((source) => (\r\n                                    <div\r\n                                        key={source.id}\r\n                                        className={`p-4 border-2 rounded-lg cursor-pointer transition-all ${selectedSources.includes(source.id)\r\n                                            ? \"border-amber-500 bg-amber-50\"\r\n                                            : \"border-slate-200 hover:border-slate-300\"\r\n                                            }`}\r\n                                        onClick={() => toggleSource(source.id)}\r\n                                    >\r\n                                        <div className=\"flex items-start justify-between\">\r\n                                            <div className=\"flex-1\">\r\n                                                <h4 className=\"font-semibold text-slate-900\">\r\n                                                    {source.title}\r\n                                                </h4>\r\n                                                <p className=\"text-sm text-slate-600 mt-1\">\r\n                                                    {source.description}\r\n                                                </p>\r\n                                            </div>\r\n                                            {selectedSources.includes(source.id) && (\r\n                                                <Badge className=\"bg-amber-500 text-white\">\r\n                                                    Selected\r\n                                                </Badge>\r\n                                            )}\r\n                                        </div>\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n\r\n                            <div className=\"flex items-center justify-between pt-4 border-t\">\r\n                                <div className=\"text-sm text-slate-600\">\r\n                                    {selectedSources.length} source{selectedSources.length !== 1 ? 's' : ''} selected\r\n                                </div>\r\n                                <Button\r\n                                    className=\"bg-amber-600 text-white hover:bg-amber-700\"\r\n                                    onClick={handleAnalyze}\r\n                                    disabled={selectedSources.length < 2 || isAnalyzing}\r\n                                >\r\n                                    {isAnalyzing ? (\r\n                                        <>\r\n                                            <Sparkles className=\"mr-2 h-4 w-4 animate-spin\" />\r\n                                            Analyzing...\r\n                                        </>\r\n                                    ) : (\r\n                                        <>\r\n                                            <Lightbulb className=\"mr-2 h-4 w-4\" />\r\n                                            Detect Cultural Holes\r\n                                        </>\r\n                                    )}\r\n                                </Button>\r\n                            </div>\r\n                        </>\r\n                    )}\r\n                </CardContent>\r\n            </Card>\r\n\r\n            {/* Results */}\r\n            {culturalAnalysis && (\r\n                <div className=\"space-y-6\">\r\n                    {/* Analysis Summary */}\r\n                    {culturalAnalysis.summary && (\r\n                        <Card className=\"bg-slate-50 border-slate-200\">\r\n                            <CardHeader className=\"pb-2\">\r\n                                <div className=\"flex items-center justify-between\">\r\n                                    <div className=\"flex items-center gap-2\">\r\n                                        <Sparkles className=\"h-4 w-4 text-amber-600\" />\r\n                                        <CardTitle className=\"text-lg\">Analysis Summary</CardTitle>\r\n                                    </div>\r\n                                    <Button variant=\"outline\" size=\"sm\" onClick={exportToCSV}>\r\n                                        Export CSV\r\n                                    </Button>\r\n                                </div>\r\n                            </CardHeader>\r\n                            <CardContent>\r\n                                <p className=\"text-sm text-slate-700 leading-relaxed\">\r\n                                    {culturalAnalysis.summary}\r\n                                </p>\r\n                            </CardContent>\r\n                        </Card>\r\n                    )}\r\n\r\n\r\n                    {/* Explanation Card */}\r\n                    <Card className=\"bg-blue-50 border-blue-200\">\r\n                        <CardHeader>\r\n                            <div className=\"flex items-center gap-2\">\r\n                                <BookOpen className=\"h-5 w-5 text-blue-600\" />\r\n                                <CardTitle className=\"text-base\">Understanding Cultural Holes</CardTitle>\r\n                            </div>\r\n                        </CardHeader>\r\n                        <CardContent className=\"space-y-3 text-sm text-slate-700\">\r\n                            <div>\r\n                                <p className=\"font-semibold text-blue-900 mb-1\">What are Discourse Clusters?</p>\r\n                                <p>Groups of related themes that use similar language and concepts. Each cluster represents a coherent \"discourse community\" within your analyzed documents.</p>\r\n                            </div>\r\n                            <div>\r\n                                <p className=\"font-semibold text-blue-900 mb-1\">What are Cultural Holes?</p>\r\n                                <p>Gaps between discourse clusters where concepts don't overlap. These represent areas where different stakeholder groups or policy frameworks aren't connecting with each other.</p>\r\n                            </div>\r\n                            <div className=\"bg-white p-3 rounded border border-blue-200\">\r\n                                <p className=\"font-semibold text-blue-900 mb-1\"> Why This Matters</p>\r\n                                <p>Cultural holes reveal <span className=\"font-semibold\">innovation opportunities</span> and <span className=\"font-semibold\">policy blind spots</span>. The \"bridging concepts\" suggest ways to connect isolated conversations and create more holistic governance frameworks.</p>\r\n                            </div>\r\n                        </CardContent>\r\n                    </Card>\r\n\r\n                    {/* Network Visualization */}\r\n                    <Card>\r\n                        <CardHeader>\r\n                            <div className=\"flex items-center gap-2\">\r\n                                <Network className=\"h-5 w-5 text-blue-600\" />\r\n                                <CardTitle>Discourse Cluster Network</CardTitle>\r\n                            </div>\r\n                            <CardDescription>\r\n                                Visual representation of theme clusters and cultural holes\r\n                            </CardDescription>\r\n                        </CardHeader>\r\n                        <CardContent>\r\n                            <CulturalHoleMatrix\r\n                                clusters={culturalAnalysis.clusters}\r\n                                holes={culturalAnalysis.holes}\r\n                            />\r\n                        </CardContent>\r\n                    </Card>\r\n\r\n                    {/* Cluster Summary */}\r\n                    <Card>\r\n                        <CardHeader>\r\n                            <CardTitle>Discourse Clusters</CardTitle>\r\n                            <CardDescription>\r\n                                {culturalAnalysis.clusters.length} clusters identified from {selectedSources.length} sources (sorted by size)\r\n                            </CardDescription>\r\n                        </CardHeader>\r\n                        <CardContent>\r\n                            <div className=\"grid gap-4 md:grid-cols-2\">\r\n                                {[...culturalAnalysis.clusters]\r\n                                    .sort((a, b) => b.size - a.size)\r\n                                    .map((cluster) => (\r\n                                        <div\r\n                                            key={cluster.id}\r\n                                            className=\"p-4 bg-blue-50 border border-blue-200 rounded-lg\"\r\n                                        >\r\n                                            <TooltipProvider>\r\n                                                <Tooltip>\r\n                                                    <TooltipTrigger asChild>\r\n                                                        <h4 className=\"font-semibold text-blue-900 mb-2 cursor-help underline decoration-dotted\">\r\n                                                            {cluster.name}\r\n                                                        </h4>\r\n                                                    </TooltipTrigger>\r\n                                                    {cluster.description && (\r\n                                                        <TooltipContent className=\"max-w-xs bg-white\">\r\n                                                            <p className=\"text-xs text-slate-700\">{cluster.description}</p>\r\n                                                        </TooltipContent>\r\n                                                    )}\r\n                                                </Tooltip>\r\n                                            </TooltipProvider>\r\n                                            <div className=\"flex flex-wrap gap-1 mb-2\">\r\n                                                {cluster.themes.filter(theme => theme !== cluster.name).map((theme, i) => (\r\n                                                    <Badge\r\n                                                        key={i}\r\n                                                        variant=\"outline\"\r\n                                                        className=\"text-xs bg-white\"\r\n                                                    >\r\n                                                        {theme}\r\n                                                    </Badge>\r\n                                                ))}\r\n                                            </div>\r\n                                            <p className=\"text-xs text-slate-600\">\r\n                                                {cluster.size} theme{cluster.size !== 1 ? 's' : ''} from {cluster.sources.length} source{cluster.sources.length !== 1 ? 's' : ''}\r\n                                            </p>\r\n\r\n                                            {\r\n                                                cluster.quotes && cluster.quotes.length > 0 && (\r\n                                                    <details className=\"mt-3 pt-2 border-t border-blue-200\">\r\n                                                        <summary className=\"text-xs font-medium text-blue-700 cursor-pointer hover:text-blue-900 select-none flex items-center gap-1\">\r\n                                                            Show Evidence ({cluster.quotes.length})\r\n                                                        </summary>\r\n                                                        <ul className=\"mt-2 space-y-2\">\r\n                                                            {cluster.quotes.slice(0, 3).map((quote, i) => (\r\n                                                                <li key={i} className=\"text-xs text-slate-600 italic border-l-2 border-blue-300 pl-2\">\r\n                                                                    \"{quote}\"\r\n                                                                </li>\r\n                                                            ))}\r\n                                                            {cluster.quotes.length > 3 && (\r\n                                                                <li className=\"text-xs text-blue-500 pl-2\">\r\n                                                                    + {cluster.quotes.length - 3} more citations...\r\n                                                                </li>\r\n                                                            )}\r\n                                                        </ul>\r\n                                                    </details>\r\n                                                )\r\n                                            }\r\n                                        </div>\r\n                                    ))}\r\n                            </div>\r\n                        </CardContent>\r\n                    </Card>\r\n\r\n                    {/* Cultural Holes */}\r\n                    <div className=\"space-y-4\">\r\n                        <div className=\"flex items-center gap-2\">\r\n                            <Lightbulb className=\"h-6 w-6 text-amber-600\" />\r\n                            <h3 className=\"text-2xl font-bold text-slate-900\">\r\n                                Cultural Holes Detected\r\n                            </h3>\r\n                            <Badge className=\"bg-amber-100 text-amber-800\">\r\n                                {culturalAnalysis.holes.length} gap{culturalAnalysis.holes.length !== 1 ? 's' : ''}\r\n                            </Badge>\r\n                        </div>\r\n\r\n                        {culturalAnalysis.holes.length === 0 ? (\r\n                            <Card>\r\n                                <CardContent className=\"py-8 text-center text-slate-500\">\r\n                                    <p>No significant cultural holes detected.</p>\r\n                                    <p className=\"text-sm mt-2\">\r\n                                        The selected sources have highly similar discourse patterns.\r\n                                    </p>\r\n                                </CardContent>\r\n                            </Card>\r\n                        ) : (\r\n                            <div className=\"grid gap-4\">\r\n                                {culturalAnalysis.holes.map((hole) => (\r\n                                    <CulturalHoleCard\r\n                                        key={hole.id}\r\n                                        hole={hole}\r\n                                        clusters={culturalAnalysis.clusters}\r\n                                    />\r\n                                ))}\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n            )\r\n            }\r\n        </div >\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\app\\data\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'generateSearchTerms' is defined but never used.","line":6,"column":27,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":46}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState, useRef } from \"react\";\r\nimport { useSources } from \"@/hooks/useSources\";\r\nimport { Source } from \"@/types\";\r\nimport { analyzeDocument, generateSearchTerms, AnalysisMode } from \"@/services/analysis\";\r\nimport { extractTextFromPDF } from \"@/utils/pdfExtractor\";\r\nimport { DocumentCard } from \"@/components/policy/DocumentCard\";\r\nimport { AddDocumentDialog } from \"@/components/policy/AddDocumentDialog\";\r\nimport { ViewSourceDialog } from \"@/components/policy/ViewSourceDialog\";\r\nimport { EditSourceDialog } from \"@/components/policy/EditSourceDialog\";\r\nimport { DocumentToolbar } from \"@/components/policy/DocumentToolbar\";\r\nimport { Loader2 } from \"lucide-react\";\r\n\r\nexport default function PolicyDocumentsPage() {\r\n    const { sources, isLoading: isSourcesLoading, addSource, updateSource, deleteSource } = useSources();\r\n    const [searchQuery, setSearchQuery] = useState(\"\");\r\n    const [isAddDialogOpen, setIsAddDialogOpen] = useState(false);\r\n    const [analyzingId, setAnalyzingId] = useState<string | null>(null);\r\n    const [searchingId, setSearchingId] = useState<string | null>(null);\r\n    const [isUploading, setIsUploading] = useState(false);\r\n    const [viewingSource, setViewingSource] = useState<Source | null>(null);\r\n    const [editingSource, setEditingSource] = useState<Source | null>(null);\r\n    const fileInputRef = useRef<HTMLInputElement | null>(null);\r\n\r\n    const filteredSources = sources.filter(source =>\r\n        source.title.toLowerCase().includes(searchQuery.toLowerCase()) ||\r\n        source.description.toLowerCase().includes(searchQuery.toLowerCase())\r\n    );\r\n\r\n    const handlePDFUpload = async (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        const file = e.target.files?.[0];\r\n        if (!file) return;\r\n\r\n        setIsUploading(true);\r\n        try {\r\n            const extractionResult = await extractTextFromPDF(file);\r\n            const text = typeof extractionResult === 'string' ? extractionResult : extractionResult.text;\r\n            const newDoc: Source = {\r\n                id: Date.now().toString(),\r\n                title: file.name.replace('.pdf', ''),\r\n                description: `Uploaded ${new Date().toLocaleDateString()}`,\r\n                type: \"PDF\",\r\n                addedDate: new Date().toLocaleDateString(),\r\n                status: \"Active Case\",\r\n                colorClass: \"bg-purple-100\",\r\n                iconClass: \"text-purple-600\",\r\n                extractedText: text\r\n            };\r\n            await addSource(newDoc);\r\n            alert('PDF uploaded successfully!');\r\n        } catch (error) {\r\n            console.error('PDF upload error:', error);\r\n            alert('Failed to upload PDF. Please try again.');\r\n        } finally {\r\n            setIsUploading(false);\r\n            if (fileInputRef.current) {\r\n                fileInputRef.current.value = '';\r\n            }\r\n        }\r\n    };\r\n\r\n    const handleAddSource = async (title: string, description: string, pageCount: string, publicationDate: string, version: string) => {\r\n        const source: Source = {\r\n            id: Date.now().toString(),\r\n            title,\r\n            description,\r\n            type: \"Text\",\r\n            pageCount: pageCount ? parseInt(pageCount) : undefined,\r\n            publicationDate: publicationDate || undefined,\r\n            version: version || undefined,\r\n            addedDate: new Date().toLocaleDateString(),\r\n            status: \"Active Case\",\r\n            colorClass: \"bg-blue-100\",\r\n            iconClass: \"text-blue-600\"\r\n        };\r\n        await addSource(source);\r\n    };\r\n\r\n    const handleEditSource = async (sourceId: string, updates: Partial<Source>) => {\r\n        await updateSource(sourceId, updates);\r\n    };\r\n\r\n    const handleAnalyze = async (sourceId: string, mode: AnalysisMode) => {\r\n        const source = sources.find(s => s.id === sourceId);\r\n        if (!source || !source.extractedText) {\r\n            alert('No text available to analyze. Please upload a PDF or add text first.');\r\n            return;\r\n        }\r\n\r\n        setAnalyzingId(sourceId);\r\n        try {\r\n            const result = await analyzeDocument(\r\n                source.extractedText.substring(0, 4000),\r\n                mode,\r\n                'Policy Document'\r\n            );\r\n\r\n            const updates: Partial<Source> = {};\r\n            if (mode === 'dsf') updates.analysis = result;\r\n            if (mode === 'cultural_framing') updates.cultural_framing = result;\r\n            if (mode === 'institutional_logics') updates.institutional_logics = result;\r\n\r\n            await updateSource(sourceId, updates);\r\n\r\n            if (mode === 'dsf') {\r\n                alert('Analysis complete! Scroll down to see results.');\r\n            } else {\r\n                alert(` ${mode === 'cultural_framing' ? 'Cultural framing' : 'Institutional logics'} analysis complete! Go to Comparison page to view results.`);\r\n            }\r\n        } catch (error: unknown) {\r\n            const errorMessage = error instanceof Error ? error.message : 'Unknown error';\r\n            alert(`Analysis failed: ${errorMessage}`);\r\n        } finally {\r\n            setAnalyzingId(null);\r\n        }\r\n    };\r\n\r\n    const handleFindTraces = async (source: Source) => {\r\n        if (!source.extractedText) {\r\n            alert('Please upload a PDF or add text first before finding traces.');\r\n            return;\r\n        }\r\n\r\n        setSearchingId(source.id);\r\n        try {\r\n            // Generate search terms from the document text\r\n            const response = await fetch('/api/search', {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({\r\n                    policyText: source.extractedText.substring(0, 3000),\r\n                    maxResults: 5\r\n                })\r\n            });\r\n\r\n            const result = await response.json();\r\n\r\n            if (result.success && Array.isArray(result.results) && result.results.length > 0) {\r\n                // Create trace sources from search results\r\n                const newTraces: Source[] = result.results.map((item: { title: string; snippet: string; link: string }) => ({\r\n                    id: Date.now().toString() + Math.random().toString(36).substr(2, 9),\r\n                    title: `[Trace] ${item.title}`,\r\n                    description: item.snippet || 'No description available',\r\n                    type: \"Trace\" as const,\r\n                    extractedText: `${item.snippet}\\n\\nSource: ${item.link}\\n\\nFound via search for: \"${result.searchQuery || 'policy analysis'}\"`,\r\n                    addedDate: new Date().toLocaleDateString(\"en-US\", { month: \"short\", day: \"numeric\", year: \"numeric\" }),\r\n                    status: \"Active Case\" as const,\r\n                    colorClass: \"bg-blue-100\",\r\n                    iconClass: \"text-blue-600\"\r\n                }));\r\n\r\n                // Add all traces to the store\r\n                for (const trace of newTraces) {\r\n                    await addSource(trace);\r\n                }\r\n\r\n                alert(` Found ${newTraces.length} empirical traces!\\n\\nSearch query: \"${result.searchQuery}\"\\n\\nTraces have been added to your sources. Go to the Resistance page to analyze them.`);\r\n            } else {\r\n                alert(`No traces found. ${result.error || 'Try analyzing the document first or check your Google Search API configuration.'}`);\r\n            }\r\n        } catch (error: unknown) {\r\n            console.error('Search error:', error);\r\n            const errorMessage = error instanceof Error ? error.message : 'Unknown error';\r\n            alert(`Failed to search for traces: ${errorMessage}\\n\\nMake sure your Google Search API credentials are configured in .env.local`);\r\n        } finally {\r\n            setSearchingId(null);\r\n        }\r\n    };\r\n\r\n    const handleDelete = async (sourceId: string) => {\r\n        if (confirm('Are you sure you want to delete this source?')) {\r\n            await deleteSource(sourceId);\r\n        }\r\n    };\r\n\r\n    if (isSourcesLoading) {\r\n        return (\r\n            <div className=\"flex items-center justify-center h-64\">\r\n                <Loader2 className=\"h-8 w-8 animate-spin text-slate-400\" />\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"space-y-8\">\r\n            <DocumentToolbar\r\n                searchQuery={searchQuery}\r\n                onSearchChange={setSearchQuery}\r\n                onUpload={handlePDFUpload}\r\n                isUploading={isUploading}\r\n                fileInputRef={fileInputRef}\r\n                onAddClick={() => setIsAddDialogOpen(true)}\r\n            />\r\n\r\n            <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-3\">\r\n                {filteredSources.map((source) => (\r\n                    <DocumentCard\r\n                        key={source.id}\r\n                        source={source}\r\n                        isAnalyzing={analyzingId === source.id}\r\n                        isSearching={searchingId === source.id}\r\n                        onAnalyze={handleAnalyze}\r\n                        onDelete={handleDelete}\r\n                        onEdit={(source) => setEditingSource(source)}\r\n                        onFindTraces={handleFindTraces}\r\n                        onView={(source) => setViewingSource(source)}\r\n                    />\r\n                ))}\r\n            </div>\r\n\r\n            <AddDocumentDialog\r\n                open={isAddDialogOpen}\r\n                onOpenChange={setIsAddDialogOpen}\r\n                onAdd={handleAddSource}\r\n            />\r\n\r\n            <ViewSourceDialog\r\n                source={viewingSource}\r\n                onOpenChange={(open) => !open && setViewingSource(null)}\r\n            />\r\n\r\n            <EditSourceDialog\r\n                source={editingSource}\r\n                open={!!editingSource}\r\n                onOpenChange={(open) => !open && setEditingSource(null)}\r\n                onSave={handleEditSource}\r\n            />\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\app\\data\\page_temp.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\app\\ecosystem\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":35,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":35,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2158,2161],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2158,2161],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":157,"column":103,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[8471,8685],"text":"\r\n                                                This will remove all actors (including mock data). You&apos;ll start with an empty ecosystem. This action cannot be undone.\r\n                                            "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[8471,8685],"text":"\r\n                                                This will remove all actors (including mock data). You&lsquo;ll start with an empty ecosystem. This action cannot be undone.\r\n                                            "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[8471,8685],"text":"\r\n                                                This will remove all actors (including mock data). You&#39;ll start with an empty ecosystem. This action cannot be undone.\r\n                                            "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[8471,8685],"text":"\r\n                                                This will remove all actors (including mock data). You&rsquo;ll start with an empty ecosystem. This action cannot be undone.\r\n                                            "},"desc":"Replace with `&rsquo;`."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":400,"column":70,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":400,"endColumn":73,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[23582,23585],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[23582,23585],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":421,"column":86,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":421,"endColumn":89,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[25317,25320],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[25317,25320],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":435,"column":67,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[26214,26258],"text":"Click &quot;Analyze Holes\" to detect disconnects."},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[26214,26258],"text":"Click &ldquo;Analyze Holes\" to detect disconnects."},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[26214,26258],"text":"Click &#34;Analyze Holes\" to detect disconnects."},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[26214,26258],"text":"Click &rdquo;Analyze Holes\" to detect disconnects."},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":435,"column":81,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[26214,26258],"text":"Click \"Analyze Holes&quot; to detect disconnects."},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[26214,26258],"text":"Click \"Analyze Holes&ldquo; to detect disconnects."},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[26214,26258],"text":"Click \"Analyze Holes&#34; to detect disconnects."},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[26214,26258],"text":"Click \"Analyze Holes&rdquo; to detect disconnects."},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState } from \"react\";\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Users, Network, Zap, Plus, Search, Globe, Loader2, Trash2 } from \"lucide-react\";\r\nimport { Dialog, DialogContent, DialogDescription, DialogFooter, DialogHeader, DialogTitle, DialogTrigger } from \"@/components/ui/dialog\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport { AlertDialog, AlertDialogAction, AlertDialogCancel, AlertDialogContent, AlertDialogDescription, AlertDialogFooter, AlertDialogHeader, AlertDialogTitle, AlertDialogTrigger } from \"@/components/ui/alert-dialog\";\r\n\r\n// Placeholder types for Ecosystem Actors\r\ninterface EcosystemActor {\r\n    id: string;\r\n    name: string;\r\n    type: \"Startup\" | \"Policymaker\" | \"Civil Society\" | \"Academic\";\r\n    description: string;\r\n    influence: \"High\" | \"Medium\" | \"Low\";\r\n}\r\n\r\nconst MOCK_ACTORS: EcosystemActor[] = [\r\n    { id: \"1\", name: \"TechCorp AI\", type: \"Startup\", description: \"Leading generative AI startup focused on enterprise solutions.\", influence: \"High\" },\r\n    { id: \"2\", name: \"PolicyWatch\", type: \"Civil Society\", description: \"NGO monitoring AI regulation compliance.\", influence: \"Medium\" },\r\n    { id: \"3\", name: \"Ministry of Digital\", type: \"Policymaker\", description: \"Government body responsible for AI Act implementation.\", influence: \"High\" },\r\n    { id: \"4\", name: \"Prof. Smith\", type: \"Academic\", description: \"Key voice in AI ethics discourse.\", influence: \"Medium\" },\r\n];\r\n\r\nexport default function EcosystemPage() {\r\n    const [actors, setActors] = useState<EcosystemActor[]>(MOCK_ACTORS);\r\n    const [selectedActorId, setSelectedActorId] = useState<string | null>(null);\r\n    const [isSimulating, setIsSimulating] = useState(false);\r\n    const [simulationQuery, setSimulationQuery] = useState(\"AI startups and policy actors in Brussels\");\r\n    const [isDialogOpen, setIsDialogOpen] = useState(false);\r\n    const [culturalHoles, setCulturalHoles] = useState<any>(null);\r\n    const [isAnalyzingHoles, setIsAnalyzingHoles] = useState(false);\r\n\r\n    const handleSimulate = async () => {\r\n        setIsSimulating(true);\r\n        try {\r\n            const response = await fetch('/api/ecosystem/simulate', {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({ query: simulationQuery })\r\n            });\r\n            const data = await response.json();\r\n            if (data.success && data.actors) {\r\n                setActors(prev => [...prev, ...data.actors]);\r\n                setIsDialogOpen(false);\r\n            } else {\r\n                alert(\"Simulation failed: \" + (data.error || \"Unknown error\"));\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Simulation error:\", error);\r\n            alert(\"Failed to simulate ecosystem.\");\r\n        } finally {\r\n            setIsSimulating(false);\r\n        }\r\n    };\r\n\r\n    const handleAnalyzeHoles = async () => {\r\n        if (actors.length < 2) {\r\n            alert(\"Need at least 2 actors to analyze cultural holes.\");\r\n            return;\r\n        }\r\n        setIsAnalyzingHoles(true);\r\n        try {\r\n            const actorsText = actors.map(a => `ACTOR: ${a.name} (${a.type})\\nDESCRIPTION: ${a.description}`).join(\"\\n\\n\");\r\n\r\n            const response = await fetch('/api/analyze', {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({\r\n                    text: actorsText,\r\n                    analysisMode: 'cultural_holes'\r\n                })\r\n            });\r\n            const data = await response.json();\r\n            if (data.success && data.analysis) {\r\n                setCulturalHoles(data.analysis);\r\n            } else {\r\n                alert(\"Analysis failed: \" + (data.error || \"Unknown error\"));\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Holes analysis error:\", error);\r\n            alert(\"Failed to analyze cultural holes.\");\r\n        } finally {\r\n            setIsAnalyzingHoles(false);\r\n        }\r\n    };\r\n\r\n    const handleClearAll = () => {\r\n        setActors([]);\r\n        setSelectedActorId(null);\r\n        setCulturalHoles(null);\r\n    };\r\n\r\n    return (\r\n        <div className=\"flex h-full gap-6\">\r\n            {/* Sidebar: Actor Management */}\r\n            <div className=\"w-80 flex flex-col gap-4 shrink-0\">\r\n                <Card className=\"h-full flex flex-col\">\r\n                    <CardHeader className=\"pb-2\">\r\n                        <div className=\"flex items-center justify-between\">\r\n                            <CardTitle className=\"text-lg\">Ecosystem Actors</CardTitle>\r\n                            <div className=\"flex gap-1\">\r\n                                <Dialog open={isDialogOpen} onOpenChange={setIsDialogOpen}>\r\n                                    <DialogTrigger asChild>\r\n                                        <Button size=\"icon\" variant=\"ghost\" className=\"h-8 w-8\" title=\"Simulate Data\">\r\n                                            <Globe className=\"h-4 w-4 text-indigo-600\" />\r\n                                        </Button>\r\n                                    </DialogTrigger>\r\n                                    <DialogContent>\r\n                                        <DialogHeader>\r\n                                            <DialogTitle>Simulate Ecosystem Data</DialogTitle>\r\n                                            <DialogDescription>\r\n                                                Use web search to discover and import actors into the ecosystem.\r\n                                            </DialogDescription>\r\n                                        </DialogHeader>\r\n                                        <div className=\"grid gap-4 py-4\">\r\n                                            <div className=\"grid grid-cols-4 items-center gap-4\">\r\n                                                <Label htmlFor=\"query\" className=\"text-right\">\r\n                                                    Search Query\r\n                                                </Label>\r\n                                                <Input\r\n                                                    id=\"query\"\r\n                                                    value={simulationQuery}\r\n                                                    onChange={(e) => setSimulationQuery(e.target.value)}\r\n                                                    className=\"col-span-3\"\r\n                                                />\r\n                                            </div>\r\n                                        </div>\r\n                                        <DialogFooter>\r\n                                            <Button onClick={handleSimulate} disabled={isSimulating}>\r\n                                                {isSimulating ? (\r\n                                                    <>\r\n                                                        <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\r\n                                                        Simulating...\r\n                                                    </>\r\n                                                ) : (\r\n                                                    \"Start Simulation\"\r\n                                                )}\r\n                                            </Button>\r\n                                        </DialogFooter>\r\n                                    </DialogContent>\r\n                                </Dialog>\r\n                                <AlertDialog>\r\n                                    <AlertDialogTrigger asChild>\r\n                                        <Button size=\"icon\" variant=\"ghost\" className=\"h-8 w-8\" title=\"Clear All Actors\">\r\n                                            <Trash2 className=\"h-4 w-4 text-red-600\" />\r\n                                        </Button>\r\n                                    </AlertDialogTrigger>\r\n                                    <AlertDialogContent>\r\n                                        <AlertDialogHeader>\r\n                                            <AlertDialogTitle>Clear All Actors?</AlertDialogTitle>\r\n                                            <AlertDialogDescription>\r\n                                                This will remove all actors (including mock data). You'll start with an empty ecosystem. This action cannot be undone.\r\n                                            </AlertDialogDescription>\r\n                                        </AlertDialogHeader>\r\n                                        <AlertDialogFooter>\r\n                                            <AlertDialogCancel>Cancel</AlertDialogCancel>\r\n                                            <AlertDialogAction onClick={handleClearAll} className=\"bg-red-600 hover:bg-red-700\">\r\n                                                Clear All\r\n                                            </AlertDialogAction>\r\n                                        </AlertDialogFooter>\r\n                                    </AlertDialogContent>\r\n                                </AlertDialog>\r\n                                <Button size=\"icon\" variant=\"ghost\" className=\"h-8 w-8\">\r\n                                    <Plus className=\"h-4 w-4\" />\r\n                                </Button>\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"relative mt-2\">\r\n                            <Search className=\"absolute left-2 top-2.5 h-4 w-4 text-slate-400\" />\r\n                            <input\r\n                                placeholder=\"Search actors...\"\r\n                                className=\"w-full pl-8 pr-4 py-2 text-sm border rounded-md bg-slate-50\"\r\n                            />\r\n                        </div>\r\n                    </CardHeader>\r\n                    <CardContent className=\"flex-1 overflow-y-auto space-y-2 pt-0\">\r\n                        {actors.map(actor => (\r\n                            <div\r\n                                key={actor.id}\r\n                                className={`p-3 rounded-md border cursor-pointer transition-colors ${selectedActorId === actor.id ? 'bg-indigo-50 border-indigo-200' : 'bg-white hover:bg-slate-50'}`}\r\n                                onClick={() => setSelectedActorId(actor.id)}\r\n                            >\r\n                                <div className=\"flex items-center justify-between mb-1\">\r\n                                    <span className=\"font-medium text-sm\">{actor.name}</span>\r\n                                    <Badge variant=\"outline\" className=\"text-[10px] px-1 py-0 h-5\">\r\n                                        {actor.type}\r\n                                    </Badge>\r\n                                </div>\r\n                                <p className=\"text-xs text-slate-500 line-clamp-2\">{actor.description}</p>\r\n                            </div>\r\n                        ))}\r\n                    </CardContent>\r\n                </Card>\r\n            </div>\r\n\r\n            {/* Main Content: Visualizations */}\r\n            <div className=\"flex-1 flex flex-col gap-6 overflow-y-auto pb-10\">\r\n                <div>\r\n                    <h2 className=\"text-3xl font-bold tracking-tight text-slate-900\">Field-Level Ecosystem</h2>\r\n                    <p className=\"text-slate-500\">Mapping the social structure, network ties, and cultural holes in the AI governance field.</p>\r\n                </div>\r\n\r\n                {/* Social Graph Visualization */}\r\n                <Card className=\"min-h-[400px] flex flex-col\">\r\n                    <CardHeader>\r\n                        <div className=\"flex items-center gap-2\">\r\n                            <Network className=\"h-5 w-5 text-indigo-600\" />\r\n                            <CardTitle>Social Network Graph</CardTitle>\r\n                        </div>\r\n                        <CardDescription>\r\n                            Visualizing ties between actors based on shared discourse and direct interaction.\r\n                        </CardDescription>\r\n                    </CardHeader>\r\n                    <CardContent className=\"flex-1 bg-slate-50/50 p-6 border-t\">\r\n                        <svg width=\"100%\" height=\"400\" className=\"border border-slate-200 rounded-lg bg-white\">\r\n                            <defs>\r\n                                <marker id=\"actor-arrow\" markerWidth=\"8\" markerHeight=\"8\" refX=\"20\" refY=\"4\" orient=\"auto\">\r\n                                    <polygon points=\"0 0, 8 4, 0 8\" fill=\"#94a3b8\" />\r\n                                </marker>\r\n                                <filter id=\"actor-glow\" x=\"-50%\" y=\"-50%\" width=\"200%\" height=\"200%\">\r\n                                    <feGaussianBlur stdDeviation=\"3\" result=\"blur\" />\r\n                                    <feComposite in=\"SourceGraphic\" in2=\"blur\" operator=\"over\" />\r\n                                </filter>\r\n                            </defs>\r\n\r\n                            {/* Generate connections based on actor types */}\r\n                            {actors.map((source, i) =>\r\n                                actors.slice(i + 1).map((target, j) => {\r\n                                    // Create connections between actors of different types\r\n                                    const shouldConnect = (\r\n                                        (source.type === \"Policymaker\" && target.type === \"Civil Society\") ||\r\n                                        (source.type === \"Startup\" && target.type === \"Academic\") ||\r\n                                        (source.type === \"Policymaker\" && target.type === \"Startup\") ||\r\n                                        (source.type === \"Civil Society\" && target.type === \"Academic\")\r\n                                    );\r\n\r\n                                    if (!shouldConnect) return null;\r\n\r\n                                    // Calculate positions in a circular layout\r\n                                    const totalActors = actors.length;\r\n                                    const sourceAngle = (i / totalActors) * 2 * Math.PI;\r\n                                    const targetAngle = ((i + j + 1) / totalActors) * 2 * Math.PI;\r\n                                    const centerX = 350;\r\n                                    const centerY = 200;\r\n                                    const radius = 120;\r\n\r\n                                    const x1 = centerX + radius * Math.cos(sourceAngle);\r\n                                    const y1 = centerY + radius * Math.sin(sourceAngle);\r\n                                    const x2 = centerX + radius * Math.cos(targetAngle);\r\n                                    const y2 = centerY + radius * Math.sin(targetAngle);\r\n\r\n                                    const isHighlighted = selectedActorId === source.id || selectedActorId === target.id;\r\n                                    const opacity = selectedActorId && !isHighlighted ? 0.15 : 0.4;\r\n\r\n                                    return (\r\n                                        <line\r\n                                            key={`${source.id}-${target.id}`}\r\n                                            x1={x1}\r\n                                            y1={y1}\r\n                                            x2={x2}\r\n                                            y2={y2}\r\n                                            stroke=\"#94a3b8\"\r\n                                            strokeWidth={isHighlighted ? 2 : 1}\r\n                                            opacity={opacity}\r\n                                            markerEnd=\"url(#actor-arrow)\"\r\n                                            style={{ transition: 'all 0.3s ease' }}\r\n                                        />\r\n                                    );\r\n                                })\r\n                            )}\r\n\r\n                            {/* Actor nodes */}\r\n                            {actors.map((actor, i) => {\r\n                                const totalActors = actors.length;\r\n                                const angle = (i / totalActors) * 2 * Math.PI;\r\n                                const centerX = 350;\r\n                                const centerY = 200;\r\n                                const radius = 120;\r\n                                const x = centerX + radius * Math.cos(angle);\r\n                                const y = centerY + radius * Math.sin(angle);\r\n\r\n                                const isSelected = selectedActorId === actor.id;\r\n                                const isDimmed = selectedActorId && !isSelected;\r\n                                const opacity = isDimmed ? 0.3 : 1;\r\n                                const scale = isSelected ? 1.15 : 1;\r\n\r\n                                // Color by type\r\n                                const colorMap: Record<string, string> = {\r\n                                    \"Startup\": \"#3b82f6\",\r\n                                    \"Policymaker\": \"#dc2626\",\r\n                                    \"Civil Society\": \"#16a34a\",\r\n                                    \"Academic\": \"#9333ea\"\r\n                                };\r\n                                const color = colorMap[actor.type] || \"#64748b\";\r\n\r\n                                return (\r\n                                    <g\r\n                                        key={actor.id}\r\n                                        onClick={() => setSelectedActorId(isSelected ? null : actor.id)}\r\n                                        onMouseEnter={() => setSelectedActorId(actor.id)}\r\n                                        style={{ cursor: 'pointer', transition: 'all 0.3s ease', opacity }}\r\n                                        transform={`translate(${x}, ${y}) scale(${scale}) translate(${-x}, ${-y})`}\r\n                                    >\r\n                                        <circle\r\n                                            cx={x}\r\n                                            cy={y}\r\n                                            r=\"28\"\r\n                                            fill=\"white\"\r\n                                            stroke={color}\r\n                                            strokeWidth={isSelected ? 3 : 2}\r\n                                            filter={isSelected ? \"url(#actor-glow)\" : \"\"}\r\n                                        />\r\n                                        <circle\r\n                                            cx={x}\r\n                                            cy={y}\r\n                                            r=\"24\"\r\n                                            fill={color}\r\n                                            opacity=\"0.2\"\r\n                                        />\r\n                                        <text\r\n                                            x={x}\r\n                                            y={y}\r\n                                            textAnchor=\"middle\"\r\n                                            dominantBaseline=\"middle\"\r\n                                            fontSize=\"10\"\r\n                                            fontWeight=\"600\"\r\n                                            fill=\"#1e293b\"\r\n                                            className=\"pointer-events-none select-none\"\r\n                                        >\r\n                                            {actor.name.split(' ').slice(0, 2).map((word, wi) => (\r\n                                                <tspan key={wi} x={x} dy={wi === 0 ? (actor.name.split(' ').length > 1 ? -5 : 0) : 11}>\r\n                                                    {word.substring(0, 8)}\r\n                                                </tspan>\r\n                                            ))}\r\n                                        </text>\r\n                                    </g>\r\n                                );\r\n                            })}\r\n\r\n                            {/* Legend */}\r\n                            <g transform=\"translate(20, 20)\">\r\n                                <text x=\"0\" y=\"0\" fontSize=\"11\" fontWeight=\"600\" fill=\"#64748b\">Actor Types:</text>\r\n                                {[\r\n                                    { type: \"Startup\", color: \"#3b82f6\" },\r\n                                    { type: \"Policymaker\", color: \"#dc2626\" },\r\n                                    { type: \"Civil Society\", color: \"#16a34a\" },\r\n                                    { type: \"Academic\", color: \"#9333ea\" }\r\n                                ].map((item, i) => (\r\n                                    <g key={item.type} transform={`translate(0, ${(i + 1) * 18})`}>\r\n                                        <circle cx=\"5\" cy=\"0\" r=\"4\" fill={item.color} />\r\n                                        <text x=\"12\" y=\"0\" fontSize=\"9\" dominantBaseline=\"middle\" fill=\"#64748b\">\r\n                                            {item.type}\r\n                                        </text>\r\n                                    </g>\r\n                                ))}\r\n                            </g>\r\n                        </svg>\r\n                    </CardContent>\r\n                </Card>\r\n\r\n                {/* Cultural Holes Visualization */}\r\n                <Card className=\"min-h-[300px] flex flex-col\">\r\n                    <CardHeader>\r\n                        <div className=\"flex items-center justify-between\">\r\n                            <div className=\"flex items-center gap-2\">\r\n                                <Zap className=\"h-5 w-5 text-amber-600\" />\r\n                                <CardTitle>Cultural Holes & Disconnects</CardTitle>\r\n                            </div>\r\n                            <Button size=\"sm\" variant=\"outline\" onClick={handleAnalyzeHoles} disabled={isAnalyzingHoles}>\r\n                                {isAnalyzingHoles ? (\r\n                                    <>\r\n                                        <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\r\n                                        Analyzing...\r\n                                    </>\r\n                                ) : (\r\n                                    \"Analyze Holes\"\r\n                                )}\r\n                            </Button>\r\n                        </div>\r\n                        <CardDescription>\r\n                            Identifying semantic distance and missing links between actor communities.\r\n                        </CardDescription>\r\n                    </CardHeader>\r\n                    <CardContent className=\"flex-1 bg-slate-50/50 p-6 border-t\">\r\n                        {culturalHoles ? (\r\n                            <div className=\"space-y-6\">\r\n                                <div className=\"flex items-center justify-between\">\r\n                                    <h4 className=\"font-semibold text-sm text-slate-700\">Connectivity Score</h4>\r\n                                    <Badge variant={culturalHoles.overall_connectivity_score > 0.7 ? \"default\" : \"destructive\"}>\r\n                                        {(culturalHoles.overall_connectivity_score * 100).toFixed(0)}%\r\n                                    </Badge>\r\n                                </div>\r\n\r\n                                <div className=\"space-y-4\">\r\n                                    {culturalHoles.holes?.map((hole: any, i: number) => (\r\n                                        <div key={i} className=\"bg-white p-4 rounded-md border border-amber-200 shadow-sm\">\r\n                                            <div className=\"flex items-center justify-between mb-2\">\r\n                                                <span className=\"font-bold text-amber-700 text-sm\">{hole.concept}</span>\r\n                                                <Badge variant=\"outline\" className=\"text-xs\">{hole.significance}</Badge>\r\n                                            </div>\r\n                                            <p className=\"text-xs text-slate-600 mb-2\">{hole.description}</p>\r\n                                            <div className=\"flex items-center gap-2 text-xs text-slate-400\">\r\n                                                <span>Between:</span>\r\n                                                {hole.between?.map((g: string) => (\r\n                                                    <Badge key={g} variant=\"secondary\" className=\"text-[10px] h-5\">{g}</Badge>\r\n                                                ))}\r\n                                            </div>\r\n                                        </div>\r\n                                    ))}\r\n                                </div>\r\n\r\n                                {culturalHoles.recommendations?.length > 0 && (\r\n                                    <div className=\"pt-4 border-t border-slate-200\">\r\n                                        <h4 className=\"font-semibold text-sm text-slate-700 mb-3\">Bridging Recommendations</h4>\r\n                                        <ul className=\"space-y-2\">\r\n                                            {culturalHoles.recommendations.map((rec: any, i: number) => (\r\n                                                <li key={i} className=\"text-xs text-slate-600 flex gap-2\">\r\n                                                    <span className=\"font-bold text-indigo-600\"> {rec.role}:</span>\r\n                                                    {rec.action}\r\n                                                </li>\r\n                                            ))}\r\n                                        </ul>\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n                        ) : (\r\n                            <div className=\"text-center text-slate-400 py-8\">\r\n                                <Users className=\"h-12 w-12 mx-auto mb-2 opacity-20\" />\r\n                                <p>No analysis yet.</p>\r\n                                <p className=\"text-xs mt-1\">Click \"Analyze Holes\" to detect disconnects.</p>\r\n                            </div>\r\n                        )}\r\n                    </CardContent>\r\n                </Card>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\app\\empirical\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'FileText' is defined but never used.","line":20,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":20,"endColumn":18},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":216,"column":85,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[10438,10513],"text":"Add a new trace manually or use &quot;Find Traces\" on the Policy Documents page."},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[10438,10513],"text":"Add a new trace manually or use &ldquo;Find Traces\" on the Policy Documents page."},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[10438,10513],"text":"Add a new trace manually or use &#34;Find Traces\" on the Policy Documents page."},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[10438,10513],"text":"Add a new trace manually or use &rdquo;Find Traces\" on the Policy Documents page."},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":216,"column":97,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[10438,10513],"text":"Add a new trace manually or use \"Find Traces&quot; on the Policy Documents page."},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[10438,10513],"text":"Add a new trace manually or use \"Find Traces&ldquo; on the Policy Documents page."},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[10438,10513],"text":"Add a new trace manually or use \"Find Traces&#34; on the Policy Documents page."},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[10438,10513],"text":"Add a new trace manually or use \"Find Traces&rdquo; on the Policy Documents page."},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":286,"column":94,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[15190,15191],"text":"&quot;"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[15190,15191],"text":"&ldquo;"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[15190,15191],"text":"&#34;"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[15190,15191],"text":"&rdquo;"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":286,"column":124,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[15220,15221],"text":"&quot;"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[15220,15221],"text":"&ldquo;"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[15220,15221],"text":"&#34;"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[15220,15221],"text":"&rdquo;"},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState } from \"react\";\r\nimport { useSources } from \"@/hooks/useSources\";\r\nimport { Source } from \"@/types\";\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport {\r\n    Dialog,\r\n    DialogContent,\r\n    DialogDescription,\r\n    DialogFooter,\r\n    DialogHeader,\r\n    DialogTitle,\r\n    DialogTrigger,\r\n} from \"@/components/ui/dialog\";\r\nimport { FileText, Plus, Search, Filter, Sparkles, Loader2, Trash, Eye } from \"lucide-react\";\r\n\r\nexport default function EmpiricalPage() {\r\n    const { sources, isLoading, addSource, updateSource, deleteSource } = useSources();\r\n    const [searchQuery, setSearchQuery] = useState(\"\");\r\n    const [isAddDialogOpen, setIsAddDialogOpen] = useState(false);\r\n    const [analyzingId, setAnalyzingId] = useState<string | null>(null);\r\n    const [newSource, setNewSource] = useState({\r\n        title: \"\",\r\n        description: \"\",\r\n        type: \"Trace\",\r\n        text: \"\",\r\n    });\r\n\r\n    const [viewingSource, setViewingSource] = useState<Source | null>(null);\r\n\r\n    const filteredSources = sources.filter((source) =>\r\n        source.type === \"Trace\" &&\r\n        (source.title.toLowerCase().includes(searchQuery.toLowerCase()) ||\r\n            source.description.toLowerCase().includes(searchQuery.toLowerCase()))\r\n    );\r\n\r\n    const handleAddSource = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        const source: Source = {\r\n            id: Date.now().toString(),\r\n            title: newSource.title,\r\n            description: newSource.description,\r\n            type: \"Trace\",\r\n            addedDate: new Date().toLocaleDateString(\"en-US\", { month: \"short\", day: \"numeric\", year: \"numeric\" }),\r\n            status: \"Active Case\",\r\n            colorClass: \"bg-orange-100\",\r\n            iconClass: \"text-orange-600\",\r\n            extractedText: newSource.text,\r\n        };\r\n        await addSource(source);\r\n        setNewSource({ title: \"\", description: \"\", type: \"Trace\", text: \"\" });\r\n        setIsAddDialogOpen(false);\r\n    };\r\n\r\n    const handleAnalyze = async (sourceId: string) => {\r\n        const source = sources.find(s => s.id === sourceId);\r\n        if (!source || !source.extractedText) {\r\n            alert('No text available to analyze.');\r\n            return;\r\n        }\r\n\r\n        setAnalyzingId(sourceId);\r\n        try {\r\n            const response = await fetch('/api/analyze', {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({\r\n                    text: source.extractedText.substring(0, 4000), // Limit to first 4000 chars\r\n                    sourceType: 'Empirical Trace'\r\n                })\r\n            });\r\n\r\n            const result = await response.json();\r\n\r\n            if (result.success) {\r\n                await updateSource(sourceId, { analysis: result.analysis });\r\n                alert('Analysis complete! Scroll down to see results.');\r\n            } else {\r\n                alert(`Analysis failed: ${result.error || 'Unknown error'} `);\r\n            }\r\n        } catch (error) {\r\n            console.error('Analysis error:', error);\r\n            alert('Failed to analyze. Make sure your OpenAI API key is configured in .env.local');\r\n        } finally {\r\n            setAnalyzingId(null);\r\n        }\r\n    };\r\n\r\n    const handleDelete = async (sourceId: string) => {\r\n        if (confirm('Are you sure you want to delete this source?')) {\r\n            await deleteSource(sourceId);\r\n        }\r\n    };\r\n\r\n    const handleDeleteAll = async () => {\r\n        if (confirm('Are you sure you want to delete ALL empirical traces? This action cannot be undone.')) {\r\n            const traceIds = sources.filter(s => s.type === \"Trace\").map(s => s.id);\r\n            for (const id of traceIds) {\r\n                await deleteSource(id);\r\n            }\r\n        }\r\n    };\r\n\r\n    if (isLoading) {\r\n        return (\r\n            <div className=\"flex items-center justify-center h-64\">\r\n                <Loader2 className=\"h-8 w-8 animate-spin text-slate-400\" />\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"space-y-8\">\r\n            <div className=\"flex items-center justify-between\">\r\n                <div>\r\n                    <h2 className=\"text-3xl font-bold tracking-tight text-slate-900\">Empirical Data</h2>\r\n                    <p className=\"text-slate-500\">Manage empirical traces (public comments, forum posts, interviews).</p>\r\n                </div>\r\n                <div className=\"flex gap-2\">\r\n                    <Button\r\n                        variant=\"destructive\"\r\n                        onClick={handleDeleteAll}\r\n                        disabled={filteredSources.length === 0}\r\n                    >\r\n                        <Trash className=\"mr-2 h-4 w-4\" /> Delete All Traces\r\n                    </Button>\r\n                    <Dialog open={isAddDialogOpen} onOpenChange={setIsAddDialogOpen}>\r\n                        <DialogTrigger asChild>\r\n                            <Button className=\"bg-slate-900 text-white hover:bg-slate-800\">\r\n                                <Plus className=\"mr-2 h-4 w-4\" /> Add Trace\r\n                            </Button>\r\n                        </DialogTrigger>\r\n                        <DialogContent className=\"sm:max-w-[500px]\">\r\n                            <DialogHeader>\r\n                                <DialogTitle>Add New Empirical Trace</DialogTitle>\r\n                                <DialogDescription>\r\n                                    Add a forum post, public comment, or interview transcript.\r\n                                </DialogDescription>\r\n                            </DialogHeader>\r\n                            <form onSubmit={handleAddSource}>\r\n                                <div className=\"grid gap-4 py-4\">\r\n                                    <div className=\"grid grid-cols-4 items-center gap-4\">\r\n                                        <Label htmlFor=\"title\" className=\"text-right\">\r\n                                            Title\r\n                                        </Label>\r\n                                        <Input\r\n                                            id=\"title\"\r\n                                            value={newSource.title}\r\n                                            onChange={(e) => setNewSource({ ...newSource, title: e.target.value })}\r\n                                            className=\"col-span-3\"\r\n                                            required\r\n                                            placeholder=\"e.g., Reddit Thread on Uber\"\r\n                                        />\r\n                                    </div>\r\n                                    <div className=\"grid grid-cols-4 items-center gap-4\">\r\n                                        <Label htmlFor=\"description\" className=\"text-right\">\r\n                                            Description\r\n                                        </Label>\r\n                                        <Input\r\n                                            id=\"description\"\r\n                                            value={newSource.description}\r\n                                            onChange={(e) => setNewSource({ ...newSource, description: e.target.value })}\r\n                                            className=\"col-span-3\"\r\n                                            required\r\n                                            placeholder=\"e.g., Drivers discussing algorithm changes\"\r\n                                        />\r\n                                    </div>\r\n                                    <div className=\"grid grid-cols-4 items-start gap-4\">\r\n                                        <Label htmlFor=\"text\" className=\"text-right pt-2\">\r\n                                            Content\r\n                                        </Label>\r\n                                        <textarea\r\n                                            id=\"text\"\r\n                                            value={newSource.text}\r\n                                            onChange={(e) => setNewSource({ ...newSource, text: e.target.value })}\r\n                                            className=\"col-span-3 flex min-h-[100px] w-full rounded-md border border-slate-200 bg-white px-3 py-2 text-sm ring-offset-white placeholder:text-slate-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-950 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\"\r\n                                            placeholder=\"Paste the text content of the trace here...\"\r\n                                            required\r\n                                        />\r\n                                    </div>\r\n                                </div>\r\n                                <DialogFooter>\r\n                                    <Button type=\"submit\">Save Trace</Button>\r\n                                </DialogFooter>\r\n                            </form>\r\n                        </DialogContent>\r\n                    </Dialog>\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"flex items-center space-x-2\">\r\n                <div className=\"relative flex-1\">\r\n                    <Search className=\"absolute left-2.5 top-2.5 h-4 w-4 text-slate-500\" />\r\n                    <Input\r\n                        type=\"text\"\r\n                        placeholder=\"Search traces...\"\r\n                        className=\"w-full pl-9\"\r\n                        value={searchQuery}\r\n                        onChange={(e) => setSearchQuery(e.target.value)}\r\n                    />\r\n                </div>\r\n                <Button variant=\"outline\" className=\"border-slate-200\">\r\n                    <Filter className=\"mr-2 h-4 w-4\" /> Filter\r\n                </Button>\r\n            </div>\r\n\r\n            <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-3\">\r\n                {filteredSources.length === 0 ? (\r\n                    <div className=\"col-span-full text-center py-12 text-slate-500\">\r\n                        <p>No empirical traces found.</p>\r\n                        <p className=\"text-sm mt-2\">Add a new trace manually or use \"Find Traces\" on the Policy Documents page.</p>\r\n                    </div>\r\n                ) : (\r\n                    filteredSources.map((source) => (\r\n                        <Card key={source.id} className=\"hover:shadow-md transition-shadow\">\r\n                            <CardHeader className=\"flex flex-row items-start justify-between space-y-0 pb-2\">\r\n                                <div className=\"space-y-1 flex-1 min-w-0 pr-4\">\r\n                                    <CardTitle className=\"text-base font-semibold break-words\">{source.title}</CardTitle>\r\n                                    <CardDescription className=\"break-words\">{source.description}</CardDescription>\r\n                                </div>\r\n                                <div className=\"flex items-center gap-2 shrink-0\">\r\n                                    <Button\r\n                                        variant=\"ghost\"\r\n                                        size=\"sm\"\r\n                                        onClick={() => setViewingSource(source)}\r\n                                        className=\"h-8 w-8 p-0 hover:bg-blue-100 hover:text-blue-600\"\r\n                                        title=\"View trace content\"\r\n                                    >\r\n                                        <Eye className=\"h-4 w-4\" />\r\n                                    </Button>\r\n                                    <Button\r\n                                        variant=\"ghost\"\r\n                                        size=\"sm\"\r\n                                        onClick={() => handleDelete(source.id)}\r\n                                        className=\"h-8 w-8 p-0 hover:bg-red-100 hover:text-red-600\"\r\n                                    >\r\n                                        <Trash className=\"h-4 w-4\" />\r\n                                    </Button>\r\n                                </div>\r\n                            </CardHeader>\r\n                            <CardContent>\r\n                                <div className=\"mt-4 flex items-center space-x-2\">\r\n                                    <Badge variant=\"secondary\" className=\"bg-green-100 text-green-700 hover:bg-green-100\">\r\n                                        {source.status}\r\n                                    </Badge>\r\n                                    <span className=\"text-xs text-slate-500\">\r\n                                        {source.type}\r\n                                    </span>\r\n                                </div>\r\n                                <div className=\"mt-4 text-xs text-slate-500\">\r\n                                    Added: {source.addedDate}\r\n                                </div>\r\n                                {source.extractedText && (\r\n                                    <div className=\"mt-4\">\r\n                                        <Button\r\n                                            onClick={() => handleAnalyze(source.id)}\r\n                                            disabled={analyzingId === source.id}\r\n                                            className=\"w-full bg-purple-600 text-white hover:bg-purple-700\"\r\n                                            size=\"sm\"\r\n                                        >\r\n                                            {analyzingId === source.id ? (\r\n                                                <>\r\n                                                    <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\r\n                                                    Analyzing...\r\n                                                </>\r\n                                            ) : (\r\n                                                <>\r\n                                                    <Sparkles className=\"mr-2 h-4 w-4\" />\r\n                                                    Analyze with AI\r\n                                                </>\r\n                                            )}\r\n                                        </Button>\r\n                                    </div>\r\n                                )}\r\n                                {source.analysis && (\r\n                                    <div className=\"mt-4 pt-4 border-t border-slate-100 space-y-3\">\r\n                                        <div className=\"flex items-start gap-2\">\r\n                                            <Sparkles className=\"h-4 w-4 text-purple-600 mt-1 shrink-0\" />\r\n                                            <div>\r\n                                                <span className=\"text-xs font-bold text-purple-700 uppercase tracking-wider\">Key Insight</span>\r\n                                                <p className=\"text-sm text-slate-700 italic\">\"{source.analysis.key_insight}\"</p>\r\n                                            </div>\r\n                                        </div>\r\n\r\n                                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3 mt-2\">\r\n                                            <div className=\"bg-slate-50 p-3 rounded-md border border-slate-100\">\r\n                                                <span className=\"text-xs font-bold text-slate-600 uppercase block mb-1\">Governance & Power</span>\r\n                                                <p className=\"text-xs text-slate-700\">{source.analysis.governance_power_accountability}</p>\r\n                                            </div>\r\n                                            <div className=\"bg-slate-50 p-3 rounded-md border border-slate-100\">\r\n                                                <span className=\"text-xs font-bold text-slate-600 uppercase block mb-1\">Plurality & Inclusion</span>\r\n                                                <p className=\"text-xs text-slate-700\">{source.analysis.plurality_inclusion_embodiment}</p>\r\n                                            </div>\r\n                                            <div className=\"bg-slate-50 p-3 rounded-md border border-slate-100\">\r\n                                                <span className=\"text-xs font-bold text-slate-600 uppercase block mb-1\">Agency & Co-Design</span>\r\n                                                <p className=\"text-xs text-slate-700\">{source.analysis.agency_codesign_self_determination}</p>\r\n                                            </div>\r\n                                            <div className=\"bg-slate-50 p-3 rounded-md border border-slate-100\">\r\n                                                <span className=\"text-xs font-bold text-slate-600 uppercase block mb-1\">Reflexivity</span>\r\n                                                <p className=\"text-xs text-slate-700\">{source.analysis.reflexivity_situated_praxis}</p>\r\n                                            </div>\r\n                                        </div>\r\n\r\n                                        {source.analysis.legitimacy_claims && (\r\n                                            <div className=\"mt-3 bg-amber-50 p-3 rounded-md border border-amber-200\">\r\n                                                <span className=\"text-xs font-bold text-amber-800 uppercase block mb-2\">Legitimacy Dynamics</span>\r\n                                                <div className=\"space-y-2 text-xs\">\r\n                                                    {source.analysis.legitimacy_claims.source && (\r\n                                                        <div>\r\n                                                            <span className=\"font-semibold text-amber-700\">Source: </span>\r\n                                                            <span className=\"text-slate-700\">{source.analysis.legitimacy_claims.source}</span>\r\n                                                        </div>\r\n                                                    )}\r\n                                                    {source.analysis.legitimacy_claims.mechanisms && (\r\n                                                        <div>\r\n                                                            <span className=\"font-semibold text-amber-700\">Mechanisms: </span>\r\n                                                            <span className=\"text-slate-700\">{source.analysis.legitimacy_claims.mechanisms}</span>\r\n                                                        </div>\r\n                                                    )}\r\n                                                    {source.analysis.legitimacy_claims.tensions && (\r\n                                                        <div>\r\n                                                            <span className=\"font-semibold text-amber-700\">Tensions: </span>\r\n                                                            <span className=\"text-slate-700\">{source.analysis.legitimacy_claims.tensions}</span>\r\n                                                        </div>\r\n                                                    )}\r\n                                                </div>\r\n                                            </div>\r\n                                        )}\r\n                                    </div>\r\n                                )}\r\n                            </CardContent>\r\n                        </Card>\r\n                    ))\r\n                )}\r\n            </div>\r\n\r\n            <Dialog open={!!viewingSource} onOpenChange={(open) => !open && setViewingSource(null)}>\r\n                <DialogContent className=\"max-w-3xl max-h-[80vh] flex flex-col\">\r\n                    <DialogHeader>\r\n                        <DialogTitle>{viewingSource?.title}</DialogTitle>\r\n                        <DialogDescription>\r\n                            Extracted text content from {viewingSource?.type}\r\n                        </DialogDescription>\r\n                    </DialogHeader>\r\n                    <div className=\"flex-1 overflow-y-auto p-4 bg-slate-50 rounded-md border border-slate-200 text-sm font-mono whitespace-pre-wrap\">\r\n                        {viewingSource?.extractedText ? (\r\n                            viewingSource.extractedText.split(/(https?:\\/\\/[^\\s]+)/g).map((part, index) =>\r\n                                part.match(/https?:\\/\\/[^\\s]+/) ? (\r\n                                    <a\r\n                                        key={index}\r\n                                        href={part}\r\n                                        target=\"_blank\"\r\n                                        rel=\"noopener noreferrer\"\r\n                                        className=\"text-blue-600 hover:underline break-all\"\r\n                                    >\r\n                                        {part}\r\n                                    </a>\r\n                                ) : (\r\n                                    <span key={index}>{part}</span>\r\n                                )\r\n                            )\r\n                        ) : (\r\n                            \"No text content available.\"\r\n                        )}\r\n                    </div>\r\n                </DialogContent>\r\n            </Dialog>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\app\\glossary\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardDescription' is defined but never used.","line":3,"column":29,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":44},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'BookOpen' is defined but never used.","line":5,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":18},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":97,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":97,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5561,5564],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5561,5564],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":99,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":99,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5671,5674],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5671,5674],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { BookOpen, Quote, ExternalLink } from \"lucide-react\";\r\n\r\nconst TERMS = [\r\n    {\r\n        term: \"Algorithmic Assemblage\",\r\n        definition: \"A complex, emergently structured sociotechnical system where value creation, capture, and resource orchestration occur. It is not just a tool but a dynamic arrangement of code, data, humans, norms, and material resources.\",\r\n        scholar: \"Faraj, S., Pachidi, S., & Sayegh, K. (2018); Hannigan, T., et al. (2025)\",\r\n        category: \"Core Concept\",\r\n        url: \"https://www.callsforpapers.org/special-issues/algorithmic-assemblages\"\r\n    },\r\n    {\r\n        term: \"Discursive Field\",\r\n        definition: \"A social domain structured by language and meaning-making practices. In this context, it refers to how algorithmic technologies differentially circumscribe meaning across global fields and societies.\",\r\n        scholar: \"Miranda, S., et al. (2022)\",\r\n        category: \"Macro\",\r\n        url: \"https://doi.org/10.25300/MISQ/2022/15736\"\r\n    },\r\n    {\r\n        term: \"Legitimacy Dynamics\",\r\n        definition: \"The processes by which an algorithmic system or institution justifies its authority and right to exist. This involves navigating tensions between different forms of legitimacy (e.g., democratic, technocratic, market-based).\",\r\n        scholar: \"Jennings, P.D., et al. (2025)\",\r\n        category: \"Macro\",\r\n        url: \"https://www.callsforpapers.org/special-issues/algorithmic-assemblages\"\r\n    },\r\n    {\r\n        term: \"Sociotechnical System\",\r\n        definition: \"An approach that views technology and social structures as inextricably linked. Algorithms are not isolated technical artifacts but are embedded in and shape social relations.\",\r\n        scholar: \"Faraj, S., et al. (2018)\",\r\n        category: \"Core Concept\",\r\n        url: \"https://doi.org/10.1016/j.infoandorg.2018.02.005\"\r\n    },\r\n    {\r\n        term: \"Gambiarra\",\r\n        definition: \"A Brazilian term for 'workaround' or 'kludge'. In this context, it represents a form of micro-resistance where users creatively repurpose or subvert algorithmic systems to meet their needs.\",\r\n        scholar: \"Decolonial Theory / Local Context\",\r\n        category: \"Micro (Resistance)\"\r\n    },\r\n    {\r\n        term: \"Cultural Hole\",\r\n        definition: \"A gap or disconnect in meaning, language, or values between different groups within an ecosystem (e.g., between policymakers and developers). These holes can be sources of misunderstanding or opportunities for innovation.\",\r\n        scholar: \"Hannigan, T. (Interpretive Data Science)\",\r\n        category: \"Meso\",\r\n        url: \"https://interpretivedatascience.com/\"\r\n    },\r\n    {\r\n        term: \"Institutional Logic\",\r\n        definition: \"The socially constructed, historical patterns of material practices, assumptions, values, beliefs, and rules by which individuals produce and reproduce their material subsistence, organize time and space, and provide meaning to their social reality.\",\r\n        scholar: \"Thornton, Ocasio, & Lounsbury (2012); Applied by Jennings/Faraj\",\r\n        category: \"Meso\"\r\n    },\r\n    {\r\n        term: \"Resource Orchestration\",\r\n        definition: \"The process by which assets are structured, bundled, and leveraged to create value. In algorithmic assemblages, this orchestration often shifts from within organizations to loosely coupled platforms.\",\r\n        scholar: \"Hannigan, T., et al. (2025)\",\r\n        category: \"Macro\",\r\n        url: \"https://www.callsforpapers.org/special-issues/algorithmic-assemblages\"\r\n    }\r\n];\r\n\r\nexport default function GlossaryPage() {\r\n    return (\r\n        <div className=\"space-y-8\">\r\n            <div>\r\n                <h2 className=\"text-3xl font-bold tracking-tight text-slate-900\">\r\n                    Critical Glossary\r\n                </h2>\r\n                <p className=\"text-slate-500\">\r\n                    Key theoretical concepts for the analysis of Algorithmic Assemblages.\r\n                </p>\r\n            </div>\r\n\r\n            <div className=\"grid gap-6 md:grid-cols-2\">\r\n                {TERMS.map((item, index) => (\r\n                    <Card key={index} className=\"hover:shadow-md transition-shadow\">\r\n                        <CardHeader className=\"pb-2\">\r\n                            <div className=\"flex items-start justify-between\">\r\n                                <CardTitle className=\"text-xl font-semibold text-slate-800\">\r\n                                    {item.term}\r\n                                </CardTitle>\r\n                                <Badge variant=\"outline\" className=\"text-xs\">\r\n                                    {item.category}\r\n                                </Badge>\r\n                            </div>\r\n                        </CardHeader>\r\n                        <CardContent className=\"space-y-4\">\r\n                            <p className=\"text-slate-600 leading-relaxed\">\r\n                                {item.definition}\r\n                            </p>\r\n                            <div className=\"flex items-center gap-2 text-xs text-slate-500 bg-slate-50 p-2 rounded border border-slate-100\">\r\n                                <Quote className=\"h-3 w-3 text-indigo-400\" />\r\n                                <span className=\"font-medium\">Scholarship:</span>\r\n                                <span className=\"italic\">{item.scholar}</span>\r\n                                {(item as any).url && (\r\n                                    <a\r\n                                        href={(item as any).url}\r\n                                        target=\"_blank\"\r\n                                        rel=\"noopener noreferrer\"\r\n                                        className=\"ml-auto flex items-center gap-1 text-indigo-600 hover:text-indigo-800 hover:underline\"\r\n                                    >\r\n                                        <ExternalLink className=\"h-3 w-3\" />\r\n                                        <span className=\"hidden sm:inline\">View Source</span>\r\n                                    </a>\r\n                                )}\r\n                            </div>\r\n                        </CardContent>\r\n                    </Card>\r\n                ))}\r\n            </div>\r\n        </div >\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\app\\governance\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Source' is defined but never used.","line":5,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":16},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Scale' is defined but never used.","line":9,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":9,"endColumn":15},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":261,"column":99,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[13015,13136],"text":" page and re-run the &quot;DSF Analysis\" for these documents to generate the necessary data.\r\n                                "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[13015,13136],"text":" page and re-run the &ldquo;DSF Analysis\" for these documents to generate the necessary data.\r\n                                "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[13015,13136],"text":" page and re-run the &#34;DSF Analysis\" for these documents to generate the necessary data.\r\n                                "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[13015,13136],"text":" page and re-run the &rdquo;DSF Analysis\" for these documents to generate the necessary data.\r\n                                "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":261,"column":112,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[13015,13136],"text":" page and re-run the \"DSF Analysis&quot; for these documents to generate the necessary data.\r\n                                "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[13015,13136],"text":" page and re-run the \"DSF Analysis&ldquo; for these documents to generate the necessary data.\r\n                                "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[13015,13136],"text":" page and re-run the \"DSF Analysis&#34; for these documents to generate the necessary data.\r\n                                "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[13015,13136],"text":" page and re-run the \"DSF Analysis&rdquo; for these documents to generate the necessary data.\r\n                                "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":516,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":516,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[31506,31509],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[31506,31509],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":519,"column":57,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[31724,31783],"text":"\r\n                                                        &quot;"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[31724,31783],"text":"\r\n                                                        &ldquo;"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[31724,31783],"text":"\r\n                                                        &#34;"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[31724,31783],"text":"\r\n                                                        &rdquo;"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":519,"column":71,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":519,"endColumn":74,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[31796,31799],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[31796,31799],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":519,"column":82,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[31807,31862],"text":"&quot;\r\n                                                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[31807,31862],"text":"&ldquo;\r\n                                                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[31807,31862],"text":"&#34;\r\n                                                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[31807,31862],"text":"&rdquo;\r\n                                                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":541,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":541,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[33674,33677],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[33674,33677],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":544,"column":57,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[33892,33951],"text":"\r\n                                                        &quot;"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[33892,33951],"text":"\r\n                                                        &ldquo;"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[33892,33951],"text":"\r\n                                                        &#34;"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[33892,33951],"text":"\r\n                                                        &rdquo;"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":544,"column":71,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":544,"endColumn":74,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[33964,33967],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[33964,33967],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":544,"column":82,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[33975,34030],"text":"&quot;\r\n                                                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[33975,34030],"text":"&ldquo;\r\n                                                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[33975,34030],"text":"&#34;\r\n                                                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[33975,34030],"text":"&rdquo;\r\n                                                    "},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":10,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState } from \"react\";\r\nimport { useSources } from \"@/hooks/useSources\";\r\nimport { Source } from \"@/types\";\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Scale, Shield, Globe, AlertTriangle, Users, Sparkles, Brain, Loader2, Info } from \"lucide-react\";\r\nimport { RadarChart, PolarGrid, PolarAngleAxis, PolarRadiusAxis, Radar, Legend, ResponsiveContainer } from 'recharts';\r\nimport {\r\n    Dialog,\r\n    DialogContent,\r\n    DialogDescription,\r\n    DialogHeader,\r\n    DialogTitle,\r\n    DialogTrigger,\r\n} from \"@/components/ui/dialog\";\r\n\r\nconst COMPARISONS = [\r\n    {\r\n        id: \"risk\",\r\n        title: \"Risk Classification\",\r\n        icon: AlertTriangle,\r\n        eu: {\r\n            title: \"Pyramid of Risk\",\r\n            description: \"Four levels: Unacceptable (banned), High Risk (regulated), Limited Risk (transparency), Minimal Risk (no obligations).\",\r\n            badge: \"Prescriptive\",\r\n            color: \"bg-blue-50 text-blue-700\"\r\n        },\r\n        brazil: {\r\n            title: \"Risk Categories\",\r\n            description: \"Excessive Risk (banned) and High Risk. Assessment criteria are similar but more flexible in initial definitions.\",\r\n            badge: \"Principled\",\r\n            color: \"bg-yellow-50 text-yellow-700\"\r\n        }\r\n    },\r\n    {\r\n        id: \"enforcement\",\r\n        title: \"Enforcement Bodies\",\r\n        icon: Shield,\r\n        eu: {\r\n            title: \"AI Office & National Authorities\",\r\n            description: \"Centralized AI Office within the Commission for general purpose AI; national supervisory authorities for other systems.\",\r\n            badge: \"Centralized/Hybrid\",\r\n            color: \"bg-blue-50 text-blue-700\"\r\n        },\r\n        brazil: {\r\n            title: \"Competent Authority\",\r\n            description: \"Designation of a coordinating authority to articulate with existing sectoral regulators (an 'orchestrator' model).\",\r\n            badge: \"Networked\",\r\n            color: \"bg-yellow-50 text-yellow-700\"\r\n        }\r\n    },\r\n    {\r\n        id: \"rights\",\r\n        title: \"Rights & Redress\",\r\n        icon: Users,\r\n        eu: {\r\n            title: \"Fundamental Rights Impact\",\r\n            description: \"Requirement for deployers of high-risk systems. Right to explanation and complaints to national authorities.\",\r\n            badge: \"Procedural\",\r\n            color: \"bg-blue-50 text-blue-700\"\r\n        },\r\n        brazil: {\r\n            title: \"Rights of Affected Persons\",\r\n            description: \"Explicit catalogue of rights including explanation, contestation, and non-discrimination. Stronger focus on individual redress.\",\r\n            badge: \"Rights-Based\",\r\n            color: \"bg-yellow-50 text-yellow-700\"\r\n        }\r\n    },\r\n    {\r\n        id: \"scope\",\r\n        title: \"Territorial Scope\",\r\n        icon: Globe,\r\n        eu: {\r\n            title: \"Brussels Effect\",\r\n            description: \"Applies to any provider placing systems on the EU market or where output is used in the EU.\",\r\n            badge: \"Extraterritorial\",\r\n            color: \"bg-blue-50 text-blue-700\"\r\n        },\r\n        brazil: {\r\n            title: \"National Sovereignty\",\r\n            description: \"Applies to systems used or developed in Brazil, or processing data of individuals in Brazil.\",\r\n            badge: \"Territorial\",\r\n            color: \"bg-yellow-50 text-yellow-700\"\r\n        }\r\n    }\r\n];\r\n\r\nconst BASELINE_INSIGHTS = {\r\n    EU: {\r\n        governance_power_accountability: \"Centralized product safety framework focused on market regulation. Power resides in the AI Office and national competent authorities.\",\r\n        plurality_inclusion_embodiment: \"Limited inclusion mechanisms. Focus is on technical standards and expert bodies rather than diverse knowledge systems.\",\r\n        agency_codesign_self_determination: \"Provides rights to explanation and complaints, but limited scope for co-design or refusal by affected communities.\",\r\n        reflexivity_situated_praxis: \"Low reflexivity; assumes universal applicability of Western technical standards and risk definitions.\"\r\n    },\r\n    Brazil: {\r\n        governance_power_accountability: \"Networked 'orchestrator' model coordinating sectoral regulators. Strong emphasis on civil liability and redress.\",\r\n        plurality_inclusion_embodiment: \"Stronger focus on non-discrimination and the rights of affected groups, reflecting Brazil's social stratification context.\",\r\n        agency_codesign_self_determination: \"Explicit rights to contestation, explanation, and human review. Emphasizes the 'centrality of the human person'.\",\r\n        reflexivity_situated_praxis: \"Moderate reflexivity; adapts global models to local legal tradition but still operates within a modernization paradigm.\"\r\n    }\r\n};\r\n\r\nconst PILLAR_DEFINITIONS = {\r\n    risk: {\r\n        description: \"How the framework categorizes AI systems based on potential harm to health, safety, or fundamental rights.\",\r\n        configurations: [\r\n            { badge: \"Prescriptive\", text: \"Relies on a fixed, pre-defined list of high-risk use cases (Top-down).\" },\r\n            { badge: \"Principled\", text: \"Risk is assessed case-by-case based on abstract principles and impact (Flexible).\" }\r\n        ]\r\n    },\r\n    enforcement: {\r\n        description: \"The institutional architecture established to oversee compliance and sanction violations.\",\r\n        configurations: [\r\n            { badge: \"Centralized\", text: \"A single new authority (e.g., AI Office) holds primary power.\" },\r\n            { badge: \"Networked\", text: \"Existing sectoral regulators enforce rules, coordinated by a central body.\" },\r\n            { badge: \"Hybrid\", text: \"A mix of central oversight for general systems and sectoral enforcement for specific uses.\" }\r\n        ]\r\n    },\r\n    rights: {\r\n        description: \"The mechanisms available for individuals to understand, challenge, or seek redress for AI decisions.\",\r\n        configurations: [\r\n            { badge: \"Procedural\", text: \"Focuses on transparency, documentation, and the 'right to explanation'.\" },\r\n            { badge: \"Rights-Based\", text: \"Focuses on substantive human rights, civil liability, and compensation for harm.\" }\r\n        ]\r\n    },\r\n    scope: {\r\n        description: \"The jurisdictional reach of the regulationwho must comply and where.\",\r\n        configurations: [\r\n            { badge: \"Extraterritorial\", text: \"Applies to foreign actors if they place systems on the local market (e.g., 'Brussels Effect').\" },\r\n            { badge: \"Territorial\", text: \"Applies strictly within national borders.\" },\r\n            { badge: \"Sovereign\", text: \"Emphasizes national control over data and infrastructure (Data Sovereignty).\" }\r\n        ]\r\n    }\r\n};\r\n\r\nexport default function GovernancePage() {\r\n    const { sources, isLoading } = useSources();\r\n    const [selectedSourceA, setSelectedSourceA] = useState<string>(\"EU\");\r\n    const [selectedSourceB, setSelectedSourceB] = useState<string>(\"\");\r\n\r\n    // Filter sources that have analysis data\r\n    const analyzedSources = sources.filter(s => s.analysis);\r\n\r\n    // Helper to get governance scores or default values\r\n    const getScores = (sourceId: string) => {\r\n        if (sourceId === \"EU\") return { centralization: 85, rights_focus: 60, flexibility: 40, market_power: 95, procedurality: 85 };\r\n        if (sourceId === \"Brazil\") return { centralization: 45, rights_focus: 90, flexibility: 80, market_power: 50, procedurality: 55 };\r\n\r\n        const source = analyzedSources.find(s => s.id === sourceId);\r\n        return source?.analysis?.governance_scores || { centralization: 0, rights_focus: 0, flexibility: 0, market_power: 0, procedurality: 0 };\r\n    };\r\n\r\n    const scoresA = getScores(selectedSourceA);\r\n    const scoresB = getScores(selectedSourceB);\r\n\r\n    const dynamicRadarData = [\r\n        { dimension: 'Centralization', A: scoresA.centralization, B: scoresB.centralization },\r\n        { dimension: 'Rights Focus', A: scoresA.rights_focus, B: scoresB.rights_focus },\r\n        { dimension: 'Flexibility', A: scoresA.flexibility, B: scoresB.flexibility },\r\n        { dimension: 'Market Power', A: scoresA.market_power, B: scoresB.market_power },\r\n        { dimension: 'Procedural', A: scoresA.procedurality, B: scoresB.procedurality },\r\n    ];\r\n\r\n    const getLabel = (id: string) => {\r\n        if (id === \"EU\") return \"EU AI Act\";\r\n        if (id === \"Brazil\") return \"Brazil PL 2338\";\r\n        return analyzedSources.find(s => s.id === id)?.title || \"Unknown\";\r\n    };\r\n\r\n    const isMissingScores = (id: string) => {\r\n        if (id === \"EU\" || id === \"Brazil\") return false;\r\n        const source = analyzedSources.find(s => s.id === id);\r\n        return !source?.analysis?.governance_scores;\r\n    };\r\n\r\n    const showWarning = isMissingScores(selectedSourceA) || isMissingScores(selectedSourceB);\r\n\r\n    const getSummary = (id: string) => {\r\n        if (id === \"EU\") return {\r\n            title: \"EU AI Act\",\r\n            description: \"A product safety framework focused on market regulation and risk mitigation.\",\r\n            color: \"blue\"\r\n        };\r\n        if (id === \"Brazil\") return {\r\n            title: \"Brazil PL 2338\",\r\n            description: \"A rights-based framework emphasizing civil liability and redress for affected individuals.\",\r\n            color: \"yellow\"\r\n        };\r\n\r\n        const source = analyzedSources.find(s => s.id === id);\r\n        return {\r\n            title: source?.title || \"Unknown Policy\",\r\n            description: source?.analysis?.key_insight || \"No analysis available.\",\r\n            color: \"slate\"\r\n        };\r\n    };\r\n\r\n    const summaryA = getSummary(selectedSourceA);\r\n    const summaryB = getSummary(selectedSourceB);\r\n\r\n    const isDefaultComparison = selectedSourceA === \"EU\" && selectedSourceB === \"Brazil\";\r\n\r\n    if (isLoading) {\r\n        return (\r\n            <div className=\"flex items-center justify-center h-64\">\r\n                <Loader2 className=\"h-8 w-8 animate-spin text-slate-400\" />\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"space-y-8\">\r\n            <div>\r\n                <h2 className=\"text-3xl font-bold tracking-tight text-slate-900\">Resource Orchestration</h2>\r\n                <p className=\"text-slate-500\">Comparative analysis of governance mechanisms across AI frameworks.</p>\r\n            </div>\r\n\r\n            {/* Radar Chart Visualization */}\r\n            <Card>\r\n                <CardHeader>\r\n                    <div className=\"flex items-center justify-between\">\r\n                        <div>\r\n                            <CardTitle>Framework Comparison</CardTitle>\r\n                            <CardDescription>Visual comparison of governance characteristics</CardDescription>\r\n                        </div>\r\n                        <div className=\"flex gap-4\">\r\n                            <select\r\n                                className=\"p-2 border rounded-md text-sm bg-white\"\r\n                                value={selectedSourceA}\r\n                                onChange={(e) => setSelectedSourceA(e.target.value)}\r\n                            >\r\n                                <option value=\"EU\">EU AI Act (Baseline)</option>\r\n                                {analyzedSources.map(s => (\r\n                                    <option key={s.id} value={s.id}>{s.title}</option>\r\n                                ))}\r\n                            </select>\r\n                            <select\r\n                                className=\"p-2 border rounded-md text-sm bg-white\"\r\n                                value={selectedSourceB}\r\n                                onChange={(e) => setSelectedSourceB(e.target.value)}\r\n                            >\r\n                                <option value=\"EU\">EU AI Act (Baseline)</option>\r\n                                {analyzedSources.map(s => (\r\n                                    <option key={s.id} value={s.id}>{s.title}</option>\r\n                                ))}\r\n                            </select>\r\n                        </div>\r\n                    </div>\r\n                </CardHeader>\r\n                <CardContent className=\"flex flex-col items-center\">\r\n                    {showWarning && (\r\n                        <div className=\"w-full mb-4 p-4 bg-yellow-50 border border-yellow-200 rounded-md flex items-start gap-3\">\r\n                            <AlertTriangle className=\"h-5 w-5 text-yellow-600 mt-0.5\" />\r\n                            <div>\r\n                                <h4 className=\"text-sm font-semibold text-yellow-800\">Re-analysis Required</h4>\r\n                                <p className=\"text-sm text-yellow-700\">\r\n                                    One or more selected sources are missing governance scores. Please go to the\r\n                                    <span className=\"font-bold\"> Data </span> page and re-run the \"DSF Analysis\" for these documents to generate the necessary data.\r\n                                </p>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n                    <ResponsiveContainer width=\"100%\" height={400}>\r\n                        <RadarChart data={dynamicRadarData}>\r\n                            <PolarGrid stroke=\"#e2e8f0\" />\r\n                            <PolarAngleAxis dataKey=\"dimension\" tick={{ fill: '#64748b', fontSize: 12 }} />\r\n                            <PolarRadiusAxis angle={90} domain={[0, 100]} tick={{ fill: '#94a3b8', fontSize: 10 }} />\r\n                            <Radar name={getLabel(selectedSourceA)} dataKey=\"A\" stroke=\"#3b82f6\" fill=\"#3b82f6\" fillOpacity={0.3} />\r\n                            <Radar name={getLabel(selectedSourceB)} dataKey=\"B\" stroke=\"#eab308\" fill=\"#eab308\" fillOpacity={0.3} />\r\n                            <Legend wrapperStyle={{ paddingTop: '20px' }} />\r\n                        </RadarChart>\r\n                    </ResponsiveContainer>\r\n                </CardContent>\r\n            </Card>\r\n\r\n            {/* Dynamic Governance Insights */}\r\n            {analyzedSources.length > 0 && (\r\n                <div className=\"space-y-4\">\r\n                    <div className=\"flex items-center space-x-2\">\r\n                        <Brain className=\"h-6 w-6 text-purple-600\" />\r\n                        <h3 className=\"text-2xl font-bold text-slate-900\">Grounded Governance Insights</h3>\r\n                        <Badge className=\"bg-purple-100 text-purple-700\">\r\n                            Empirical\r\n                        </Badge>\r\n                    </div>\r\n                    <div className=\"grid gap-4 md:grid-cols-2\">\r\n                        {[selectedSourceA, selectedSourceB].map((sourceId) => {\r\n                            const isBaseline = sourceId === \"EU\" || sourceId === \"Brazil\";\r\n                            const source = analyzedSources.find(s => s.id === sourceId);\r\n                            const insights = isBaseline\r\n                                ? BASELINE_INSIGHTS[sourceId as keyof typeof BASELINE_INSIGHTS]\r\n                                : source?.analysis;\r\n\r\n                            if (!insights && !isBaseline) return null;\r\n\r\n                            const title = isBaseline\r\n                                ? (sourceId === \"EU\" ? \"EU AI Act\" : \"Brazil PL 2338\")\r\n                                : source?.title;\r\n\r\n                            return (\r\n                                <Card key={sourceId} className=\"border-purple-100 bg-purple-50/30\">\r\n                                    <CardHeader className=\"pb-2\">\r\n                                        <div className=\"flex items-center space-x-2\">\r\n                                            <Sparkles className=\"h-4 w-4 text-purple-600\" />\r\n                                            <CardTitle className=\"text-base\">{title}</CardTitle>\r\n                                        </div>\r\n                                    </CardHeader>\r\n                                    <CardContent className=\"text-sm space-y-2\">\r\n                                        {insights?.governance_power_accountability && (\r\n                                            <div>\r\n                                                <span className=\"font-semibold text-purple-900\">Governance & Power: </span>\r\n                                                <span className=\"text-slate-700\">{insights.governance_power_accountability}</span>\r\n                                            </div>\r\n                                        )}\r\n                                        {insights?.plurality_inclusion_embodiment && (\r\n                                            <div>\r\n                                                <span className=\"font-semibold text-blue-900\">Plurality & Inclusion: </span>\r\n                                                <span className=\"text-slate-700\">{insights.plurality_inclusion_embodiment}</span>\r\n                                            </div>\r\n                                        )}\r\n                                        {insights?.agency_codesign_self_determination && (\r\n                                            <div>\r\n                                                <span className=\"font-semibold text-green-900\">Agency & Co-Design: </span>\r\n                                                <span className=\"text-slate-700\">{insights.agency_codesign_self_determination}</span>\r\n                                            </div>\r\n                                        )}\r\n                                        {insights?.reflexivity_situated_praxis && (\r\n                                            <div>\r\n                                                <span className=\"font-semibold text-orange-900\">Reflexivity: </span>\r\n                                                <span className=\"text-slate-700\">{insights.reflexivity_situated_praxis}</span>\r\n                                            </div>\r\n                                        )}\r\n                                    </CardContent>\r\n                                </Card>\r\n                            );\r\n                        })}\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            <div className=\"grid gap-6\">\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4\">\r\n                    <div className={`p-4 bg-${summaryA.color}-50 rounded-lg border border-${summaryA.color}-100`}>\r\n                        <div className=\"flex items-center space-x-2 mb-2\">\r\n                            <Globe className={`h-5 w-5 text-${summaryA.color}-600`} />\r\n                            <h3 className={`font-bold text-${summaryA.color}-900`}>{summaryA.title}</h3>\r\n                        </div>\r\n                        <p className={`text-sm text-${summaryA.color}-700`}>\r\n                            {summaryA.description}\r\n                        </p>\r\n                    </div>\r\n                    <div className={`p-4 bg-${summaryB.color}-50 rounded-lg border border-${summaryB.color}-100`}>\r\n                        <div className=\"flex items-center space-x-2 mb-2\">\r\n                            <Globe className={`h-5 w-5 text-${summaryB.color}-600`} />\r\n                            <h3 className={`font-bold text-${summaryB.color}-900`}>{summaryB.title}</h3>\r\n                        </div>\r\n                        <p className={`text-sm text-${summaryB.color}-700`}>\r\n                            {summaryB.description}\r\n                        </p>\r\n                    </div>\r\n                </div>\r\n\r\n                {isDefaultComparison ? (\r\n                    COMPARISONS.map((item) => (\r\n                        <Card key={item.id} className=\"overflow-hidden\">\r\n                            <CardHeader className=\"bg-slate-50/50 border-b pb-4\">\r\n                                <div className=\"flex items-center space-x-2\">\r\n                                    <div className=\"p-2 bg-white rounded-md shadow-sm border\">\r\n                                        <item.icon className=\"h-5 w-5 text-slate-600\" />\r\n                                    </div>\r\n                                    <Dialog>\r\n                                        <DialogTrigger asChild>\r\n                                            <Button variant=\"ghost\" className=\"p-0 h-auto text-lg font-semibold text-slate-800 hover:bg-transparent flex items-center gap-2\">\r\n                                                {item.title} <Info className=\"h-4 w-4 text-slate-400\" />\r\n                                            </Button>\r\n                                        </DialogTrigger>\r\n                                        <DialogContent>\r\n                                            <DialogHeader>\r\n                                                <DialogTitle>{item.title}</DialogTitle>\r\n                                                <DialogDescription>\r\n                                                    {PILLAR_DEFINITIONS[item.id as keyof typeof PILLAR_DEFINITIONS].description}\r\n                                                </DialogDescription>\r\n                                            </DialogHeader>\r\n                                            <div className=\"space-y-4 mt-4\">\r\n                                                <h4 className=\"font-semibold text-sm text-slate-900\">Key Configurations</h4>\r\n                                                <div className=\"grid gap-3\">\r\n                                                    {PILLAR_DEFINITIONS[item.id as keyof typeof PILLAR_DEFINITIONS].configurations.map((config, idx) => (\r\n                                                        <div key={idx} className=\"bg-slate-50 p-3 rounded border border-slate-100\">\r\n                                                            <span className=\"font-bold text-xs uppercase tracking-wider text-indigo-700 block mb-1\">\r\n                                                                {config.badge}\r\n                                                            </span>\r\n                                                            <span className=\"text-sm text-slate-600\">\r\n                                                                {config.text}\r\n                                                            </span>\r\n                                                        </div>\r\n                                                    ))}\r\n                                                </div>\r\n                                            </div>\r\n                                        </DialogContent>\r\n                                    </Dialog>\r\n                                </div>\r\n                            </CardHeader>\r\n                            <CardContent className=\"p-0\">\r\n                                <div className=\"grid md:grid-cols-2 divide-y md:divide-y-0 md:divide-x\">\r\n                                    <div className=\"p-6 space-y-3\">\r\n                                        <div className=\"flex items-center justify-between\">\r\n                                            <span className=\"text-xs font-bold text-blue-600 uppercase tracking-wider\">EU Approach</span>\r\n                                            <Badge variant=\"secondary\" className=\"bg-blue-100 text-blue-700 hover:bg-blue-100\">\r\n                                                {item.eu.badge}\r\n                                            </Badge>\r\n                                        </div>\r\n                                        <h4 className=\"font-medium text-slate-900\">{item.eu.title}</h4>\r\n                                        <p className=\"text-sm text-slate-600 leading-relaxed\">\r\n                                            {item.eu.description}\r\n                                        </p>\r\n                                    </div>\r\n                                    <div className=\"p-6 space-y-3\">\r\n                                        <div className=\"flex items-center justify-between\">\r\n                                            <span className=\"text-xs font-bold text-yellow-600 uppercase tracking-wider\">Brazil Approach</span>\r\n                                            <Badge variant=\"secondary\" className=\"bg-yellow-100 text-yellow-700 hover:bg-yellow-100\">\r\n                                                {item.brazil.badge}\r\n                                            </Badge>\r\n                                        </div>\r\n                                        <h4 className=\"font-medium text-slate-900\">{item.brazil.title}</h4>\r\n                                        <p className=\"text-sm text-slate-600 leading-relaxed\">\r\n                                            {item.brazil.description}\r\n                                        </p>\r\n                                    </div>\r\n                                </div>\r\n                            </CardContent>\r\n                        </Card>\r\n                    ))\r\n                ) : (\r\n                    COMPARISONS.map((item) => {\r\n                        // Helper to get pillar data handling baselines\r\n                        const getPillarData = (sourceId: string, comparisonId: string) => {\r\n                            if (sourceId === \"EU\") {\r\n                                const comp = COMPARISONS.find(c => c.id === comparisonId);\r\n                                return comp ? { ...comp.eu, isBaseline: true } : null;\r\n                            }\r\n                            if (sourceId === \"Brazil\") {\r\n                                const comp = COMPARISONS.find(c => c.id === comparisonId);\r\n                                return comp ? { ...comp.brazil, isBaseline: true } : null;\r\n                            }\r\n                            const source = analyzedSources.find(s => s.id === sourceId);\r\n                            const pillar = source?.analysis?.structural_pillars?.[comparisonId as keyof typeof source.analysis.structural_pillars];\r\n                            return pillar ? { ...pillar, isBaseline: false } : null;\r\n                        };\r\n\r\n                        const pillarA = getPillarData(selectedSourceA, item.id);\r\n                        const pillarB = getPillarData(selectedSourceB, item.id);\r\n\r\n                        if (!pillarA && !pillarB) return null;\r\n\r\n                        return (\r\n                            <Card key={item.id} className=\"overflow-hidden\">\r\n                                <CardHeader className=\"bg-slate-50/50 border-b pb-4\">\r\n                                    <div className=\"flex items-center space-x-2\">\r\n                                        <div className=\"p-2 bg-white rounded-md shadow-sm border\">\r\n                                            <item.icon className=\"h-5 w-5 text-slate-600\" />\r\n                                        </div>\r\n                                        <Dialog>\r\n                                            <DialogTrigger asChild>\r\n                                                <Button variant=\"ghost\" className=\"p-0 h-auto text-lg font-semibold text-slate-800 hover:bg-transparent flex items-center gap-2\">\r\n                                                    {item.title} <Info className=\"h-4 w-4 text-slate-400\" />\r\n                                                </Button>\r\n                                            </DialogTrigger>\r\n                                            <DialogContent>\r\n                                                <DialogHeader>\r\n                                                    <DialogTitle>{item.title}</DialogTitle>\r\n                                                    <DialogDescription>\r\n                                                        {PILLAR_DEFINITIONS[item.id as keyof typeof PILLAR_DEFINITIONS].description}\r\n                                                    </DialogDescription>\r\n                                                </DialogHeader>\r\n                                                <div className=\"space-y-4 mt-4\">\r\n                                                    <h4 className=\"font-semibold text-sm text-slate-900\">Key Configurations</h4>\r\n                                                    <div className=\"grid gap-3\">\r\n                                                        {PILLAR_DEFINITIONS[item.id as keyof typeof PILLAR_DEFINITIONS].configurations.map((config, idx) => (\r\n                                                            <div key={idx} className=\"bg-slate-50 p-3 rounded border border-slate-100\">\r\n                                                                <span className=\"font-bold text-xs uppercase tracking-wider text-indigo-700 block mb-1\">\r\n                                                                    {config.badge}\r\n                                                                </span>\r\n                                                                <span className=\"text-sm text-slate-600\">\r\n                                                                    {config.text}\r\n                                                                </span>\r\n                                                            </div>\r\n                                                        ))}\r\n                                                    </div>\r\n                                                </div>\r\n                                            </DialogContent>\r\n                                        </Dialog>\r\n                                    </div>\r\n                                </CardHeader>\r\n                                <CardContent className=\"p-0\">\r\n                                    <div className=\"grid md:grid-cols-2 divide-y md:divide-y-0 md:divide-x\">\r\n                                        <div className=\"p-6 space-y-3\">\r\n                                            <div className=\"flex items-center justify-between\">\r\n                                                <span className=\"text-xs font-bold text-blue-600 uppercase tracking-wider\">{summaryA.title}</span>\r\n                                                {pillarA?.badge && (\r\n                                                    <Badge variant=\"secondary\" className={`\r\n                                                        ${pillarA.isBaseline && selectedSourceA === \"EU\" ? \"bg-blue-100 text-blue-700\" : \"\"}\r\n                                                        ${pillarA.isBaseline && selectedSourceA === \"Brazil\" ? \"bg-yellow-100 text-yellow-700\" : \"\"}\r\n                                                        ${!pillarA.isBaseline ? \"bg-slate-100 text-slate-700\" : \"\"}\r\n                                                    `}>\r\n                                                        {pillarA.badge}\r\n                                                    </Badge>\r\n                                                )}\r\n                                            </div>\r\n                                            <h4 className=\"font-medium text-slate-900\">{pillarA?.title || \"Not analyzed\"}</h4>\r\n                                            <p className=\"text-sm text-slate-600 leading-relaxed\">\r\n                                                {pillarA?.description || \"Structural analysis not available for this dimension.\"}\r\n                                            </p>\r\n                                            {(pillarA as any)?.quote && (\r\n                                                <div className=\"mt-3 pt-3 border-t border-slate-100\">\r\n                                                    <p className=\"text-xs text-slate-500 italic\">\r\n                                                        \"{(pillarA as any).quote}\"\r\n                                                    </p>\r\n                                                </div>\r\n                                            )}\r\n                                        </div>\r\n                                        <div className=\"p-6 space-y-3\">\r\n                                            <div className=\"flex items-center justify-between\">\r\n                                                <span className=\"text-xs font-bold text-yellow-600 uppercase tracking-wider\">{summaryB.title}</span>\r\n                                                {pillarB?.badge && (\r\n                                                    <Badge variant=\"secondary\" className={`\r\n                                                        ${pillarB.isBaseline && selectedSourceB === \"EU\" ? \"bg-blue-100 text-blue-700\" : \"\"}\r\n                                                        ${pillarB.isBaseline && selectedSourceB === \"Brazil\" ? \"bg-yellow-100 text-yellow-700\" : \"\"}\r\n                                                        ${!pillarB.isBaseline ? \"bg-slate-100 text-slate-700\" : \"\"}\r\n                                                    `}>\r\n                                                        {pillarB.badge}\r\n                                                    </Badge>\r\n                                                )}\r\n                                            </div>\r\n                                            <h4 className=\"font-medium text-slate-900\">{pillarB?.title || \"Not analyzed\"}</h4>\r\n                                            <p className=\"text-sm text-slate-600 leading-relaxed\">\r\n                                                {pillarB?.description || \"Structural analysis not available for this dimension.\"}\r\n                                            </p>\r\n                                            {(pillarB as any)?.quote && (\r\n                                                <div className=\"mt-3 pt-3 border-t border-slate-100\">\r\n                                                    <p className=\"text-xs text-slate-500 italic\">\r\n                                                        \"{(pillarB as any).quote}\"\r\n                                                    </p>\r\n                                                </div>\r\n                                            )}\r\n                                        </div>\r\n                                    </div>\r\n                                </CardContent>\r\n                            </Card>\r\n                        );\r\n                    })\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\app\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\app\\literature\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'BookOpen' is defined but never used.","line":6,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":18},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":14,"column":75,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[665,957],"text":"\r\n                    This module maps the theoretical underpinnings of the &quot;Decolonial Situatedness in Global AI Governance\" project.\r\n                    It grounds the application's methodology in key scholarship across Decolonial Studies, STS, and Critical Legal Theory.\r\n                "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[665,957],"text":"\r\n                    This module maps the theoretical underpinnings of the &ldquo;Decolonial Situatedness in Global AI Governance\" project.\r\n                    It grounds the application's methodology in key scholarship across Decolonial Studies, STS, and Critical Legal Theory.\r\n                "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[665,957],"text":"\r\n                    This module maps the theoretical underpinnings of the &#34;Decolonial Situatedness in Global AI Governance\" project.\r\n                    It grounds the application's methodology in key scholarship across Decolonial Studies, STS, and Critical Legal Theory.\r\n                "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[665,957],"text":"\r\n                    This module maps the theoretical underpinnings of the &rdquo;Decolonial Situatedness in Global AI Governance\" project.\r\n                    It grounds the application's methodology in key scholarship across Decolonial Studies, STS, and Critical Legal Theory.\r\n                "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":14,"column":123,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[665,957],"text":"\r\n                    This module maps the theoretical underpinnings of the \"Decolonial Situatedness in Global AI Governance&quot; project.\r\n                    It grounds the application's methodology in key scholarship across Decolonial Studies, STS, and Critical Legal Theory.\r\n                "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[665,957],"text":"\r\n                    This module maps the theoretical underpinnings of the \"Decolonial Situatedness in Global AI Governance&ldquo; project.\r\n                    It grounds the application's methodology in key scholarship across Decolonial Studies, STS, and Critical Legal Theory.\r\n                "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[665,957],"text":"\r\n                    This module maps the theoretical underpinnings of the \"Decolonial Situatedness in Global AI Governance&#34; project.\r\n                    It grounds the application's methodology in key scholarship across Decolonial Studies, STS, and Critical Legal Theory.\r\n                "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[665,957],"text":"\r\n                    This module maps the theoretical underpinnings of the \"Decolonial Situatedness in Global AI Governance&rdquo; project.\r\n                    It grounds the application's methodology in key scholarship across Decolonial Studies, STS, and Critical Legal Theory.\r\n                "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":15,"column":47,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[665,957],"text":"\r\n                    This module maps the theoretical underpinnings of the \"Decolonial Situatedness in Global AI Governance\" project.\r\n                    It grounds the application&apos;s methodology in key scholarship across Decolonial Studies, STS, and Critical Legal Theory.\r\n                "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[665,957],"text":"\r\n                    This module maps the theoretical underpinnings of the \"Decolonial Situatedness in Global AI Governance\" project.\r\n                    It grounds the application&lsquo;s methodology in key scholarship across Decolonial Studies, STS, and Critical Legal Theory.\r\n                "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[665,957],"text":"\r\n                    This module maps the theoretical underpinnings of the \"Decolonial Situatedness in Global AI Governance\" project.\r\n                    It grounds the application&#39;s methodology in key scholarship across Decolonial Studies, STS, and Critical Legal Theory.\r\n                "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[665,957],"text":"\r\n                    This module maps the theoretical underpinnings of the \"Decolonial Situatedness in Global AI Governance\" project.\r\n                    It grounds the application&rsquo;s methodology in key scholarship across Decolonial Studies, STS, and Critical Legal Theory.\r\n                "},"desc":"Replace with `&rsquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":74,"column":203,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[5317,5517],"text":" to map the flow from Actors &rarr; Mechanisms &rarr; Impacts, visualizing how the EU AI Act and PL 2338 function as &quot;assemblages\" of power rather than just text.\r\n                                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[5317,5517],"text":" to map the flow from Actors &rarr; Mechanisms &rarr; Impacts, visualizing how the EU AI Act and PL 2338 function as &ldquo;assemblages\" of power rather than just text.\r\n                                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[5317,5517],"text":" to map the flow from Actors &rarr; Mechanisms &rarr; Impacts, visualizing how the EU AI Act and PL 2338 function as &#34;assemblages\" of power rather than just text.\r\n                                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[5317,5517],"text":" to map the flow from Actors &rarr; Mechanisms &rarr; Impacts, visualizing how the EU AI Act and PL 2338 function as &rdquo;assemblages\" of power rather than just text.\r\n                                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":74,"column":215,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[5317,5517],"text":" to map the flow from Actors &rarr; Mechanisms &rarr; Impacts, visualizing how the EU AI Act and PL 2338 function as \"assemblages&quot; of power rather than just text.\r\n                                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[5317,5517],"text":" to map the flow from Actors &rarr; Mechanisms &rarr; Impacts, visualizing how the EU AI Act and PL 2338 function as \"assemblages&ldquo; of power rather than just text.\r\n                                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[5317,5517],"text":" to map the flow from Actors &rarr; Mechanisms &rarr; Impacts, visualizing how the EU AI Act and PL 2338 function as \"assemblages&#34; of power rather than just text.\r\n                                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[5317,5517],"text":" to map the flow from Actors &rarr; Mechanisms &rarr; Impacts, visualizing how the EU AI Act and PL 2338 function as \"assemblages&rdquo; of power rather than just text.\r\n                                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":90,"column":51,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[6192,6343],"text":"\r\n                                    Analyzing how &quot;universal\" AI governance reinforces Global North epistemologies.\r\n                                "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[6192,6343],"text":"\r\n                                    Analyzing how &ldquo;universal\" AI governance reinforces Global North epistemologies.\r\n                                "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[6192,6343],"text":"\r\n                                    Analyzing how &#34;universal\" AI governance reinforces Global North epistemologies.\r\n                                "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[6192,6343],"text":"\r\n                                    Analyzing how &rdquo;universal\" AI governance reinforces Global North epistemologies.\r\n                                "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":90,"column":61,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[6192,6343],"text":"\r\n                                    Analyzing how \"universal&quot; AI governance reinforces Global North epistemologies.\r\n                                "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[6192,6343],"text":"\r\n                                    Analyzing how \"universal&ldquo; AI governance reinforces Global North epistemologies.\r\n                                "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[6192,6343],"text":"\r\n                                    Analyzing how \"universal&#34; AI governance reinforces Global North epistemologies.\r\n                                "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[6192,6343],"text":"\r\n                                    Analyzing how \"universal&rdquo; AI governance reinforces Global North epistemologies.\r\n                                "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":116,"column":142,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[8666,8825],"text":", questioning the &quot;universal\" applicability of the EU's \"Risk-Based Approach\" when transplanted to the Brazilian context.\r\n                                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[8666,8825],"text":", questioning the &ldquo;universal\" applicability of the EU's \"Risk-Based Approach\" when transplanted to the Brazilian context.\r\n                                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[8666,8825],"text":", questioning the &#34;universal\" applicability of the EU's \"Risk-Based Approach\" when transplanted to the Brazilian context.\r\n                                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[8666,8825],"text":", questioning the &rdquo;universal\" applicability of the EU's \"Risk-Based Approach\" when transplanted to the Brazilian context.\r\n                                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":116,"column":152,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[8666,8825],"text":", questioning the \"universal&quot; applicability of the EU's \"Risk-Based Approach\" when transplanted to the Brazilian context.\r\n                                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[8666,8825],"text":", questioning the \"universal&ldquo; applicability of the EU's \"Risk-Based Approach\" when transplanted to the Brazilian context.\r\n                                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[8666,8825],"text":", questioning the \"universal&#34; applicability of the EU's \"Risk-Based Approach\" when transplanted to the Brazilian context.\r\n                                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[8666,8825],"text":", questioning the \"universal&rdquo; applicability of the EU's \"Risk-Based Approach\" when transplanted to the Brazilian context.\r\n                                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":116,"column":177,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[8666,8825],"text":", questioning the \"universal\" applicability of the EU&apos;s \"Risk-Based Approach\" when transplanted to the Brazilian context.\r\n                                    "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[8666,8825],"text":", questioning the \"universal\" applicability of the EU&lsquo;s \"Risk-Based Approach\" when transplanted to the Brazilian context.\r\n                                    "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[8666,8825],"text":", questioning the \"universal\" applicability of the EU&#39;s \"Risk-Based Approach\" when transplanted to the Brazilian context.\r\n                                    "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[8666,8825],"text":", questioning the \"universal\" applicability of the EU&rsquo;s \"Risk-Based Approach\" when transplanted to the Brazilian context.\r\n                                    "},"desc":"Replace with `&rsquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":116,"column":180,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[8666,8825],"text":", questioning the \"universal\" applicability of the EU's &quot;Risk-Based Approach\" when transplanted to the Brazilian context.\r\n                                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[8666,8825],"text":", questioning the \"universal\" applicability of the EU's &ldquo;Risk-Based Approach\" when transplanted to the Brazilian context.\r\n                                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[8666,8825],"text":", questioning the \"universal\" applicability of the EU's &#34;Risk-Based Approach\" when transplanted to the Brazilian context.\r\n                                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[8666,8825],"text":", questioning the \"universal\" applicability of the EU's &rdquo;Risk-Based Approach\" when transplanted to the Brazilian context.\r\n                                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":116,"column":200,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[8666,8825],"text":", questioning the \"universal\" applicability of the EU's \"Risk-Based Approach&quot; when transplanted to the Brazilian context.\r\n                                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[8666,8825],"text":", questioning the \"universal\" applicability of the EU's \"Risk-Based Approach&ldquo; when transplanted to the Brazilian context.\r\n                                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[8666,8825],"text":", questioning the \"universal\" applicability of the EU's \"Risk-Based Approach&#34; when transplanted to the Brazilian context.\r\n                                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[8666,8825],"text":", questioning the \"universal\" applicability of the EU's \"Risk-Based Approach&rdquo; when transplanted to the Brazilian context.\r\n                                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":158,"column":105,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[11844,11976],"text":", where we map &quot;Friction Points\" and \"Subversion Strategies\" in the implementation of AI laws.\r\n                                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[11844,11976],"text":", where we map &ldquo;Friction Points\" and \"Subversion Strategies\" in the implementation of AI laws.\r\n                                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[11844,11976],"text":", where we map &#34;Friction Points\" and \"Subversion Strategies\" in the implementation of AI laws.\r\n                                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[11844,11976],"text":", where we map &rdquo;Friction Points\" and \"Subversion Strategies\" in the implementation of AI laws.\r\n                                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":158,"column":121,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[11844,11976],"text":", where we map \"Friction Points&quot; and \"Subversion Strategies\" in the implementation of AI laws.\r\n                                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[11844,11976],"text":", where we map \"Friction Points&ldquo; and \"Subversion Strategies\" in the implementation of AI laws.\r\n                                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[11844,11976],"text":", where we map \"Friction Points&#34; and \"Subversion Strategies\" in the implementation of AI laws.\r\n                                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[11844,11976],"text":", where we map \"Friction Points&rdquo; and \"Subversion Strategies\" in the implementation of AI laws.\r\n                                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":158,"column":127,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[11844,11976],"text":", where we map \"Friction Points\" and &quot;Subversion Strategies\" in the implementation of AI laws.\r\n                                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[11844,11976],"text":", where we map \"Friction Points\" and &ldquo;Subversion Strategies\" in the implementation of AI laws.\r\n                                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[11844,11976],"text":", where we map \"Friction Points\" and &#34;Subversion Strategies\" in the implementation of AI laws.\r\n                                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[11844,11976],"text":", where we map \"Friction Points\" and &rdquo;Subversion Strategies\" in the implementation of AI laws.\r\n                                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":158,"column":149,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[11844,11976],"text":", where we map \"Friction Points\" and \"Subversion Strategies&quot; in the implementation of AI laws.\r\n                                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[11844,11976],"text":", where we map \"Friction Points\" and \"Subversion Strategies&ldquo; in the implementation of AI laws.\r\n                                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[11844,11976],"text":", where we map \"Friction Points\" and \"Subversion Strategies&#34; in the implementation of AI laws.\r\n                                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[11844,11976],"text":", where we map \"Friction Points\" and \"Subversion Strategies&rdquo; in the implementation of AI laws.\r\n                                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":184,"column":89,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[13714,13781],"text":" The EU&apos;s unilateral power to regulate global markets (Bradford) - "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[13714,13781],"text":" The EU&lsquo;s unilateral power to regulate global markets (Bradford) - "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[13714,13781],"text":" The EU&#39;s unilateral power to regulate global markets (Bradford) - "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[13714,13781],"text":" The EU&rsquo;s unilateral power to regulate global markets (Bradford) - "},"desc":"Replace with `&rsquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":200,"column":129,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[15077,15227],"text":" to analyze the &quot;Brussels Effect\" not as a neutral diffusion of standards, but as a form of \"Legal Imperialism.\"\r\n                                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[15077,15227],"text":" to analyze the &ldquo;Brussels Effect\" not as a neutral diffusion of standards, but as a form of \"Legal Imperialism.\"\r\n                                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[15077,15227],"text":" to analyze the &#34;Brussels Effect\" not as a neutral diffusion of standards, but as a form of \"Legal Imperialism.\"\r\n                                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[15077,15227],"text":" to analyze the &rdquo;Brussels Effect\" not as a neutral diffusion of standards, but as a form of \"Legal Imperialism.\"\r\n                                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":200,"column":145,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[15077,15227],"text":" to analyze the \"Brussels Effect&quot; not as a neutral diffusion of standards, but as a form of \"Legal Imperialism.\"\r\n                                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[15077,15227],"text":" to analyze the \"Brussels Effect&ldquo; not as a neutral diffusion of standards, but as a form of \"Legal Imperialism.\"\r\n                                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[15077,15227],"text":" to analyze the \"Brussels Effect&#34; not as a neutral diffusion of standards, but as a form of \"Legal Imperialism.\"\r\n                                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[15077,15227],"text":" to analyze the \"Brussels Effect&rdquo; not as a neutral diffusion of standards, but as a form of \"Legal Imperialism.\"\r\n                                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":200,"column":205,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[15077,15227],"text":" to analyze the \"Brussels Effect\" not as a neutral diffusion of standards, but as a form of &quot;Legal Imperialism.\"\r\n                                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[15077,15227],"text":" to analyze the \"Brussels Effect\" not as a neutral diffusion of standards, but as a form of &ldquo;Legal Imperialism.\"\r\n                                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[15077,15227],"text":" to analyze the \"Brussels Effect\" not as a neutral diffusion of standards, but as a form of &#34;Legal Imperialism.\"\r\n                                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[15077,15227],"text":" to analyze the \"Brussels Effect\" not as a neutral diffusion of standards, but as a form of &rdquo;Legal Imperialism.\"\r\n                                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":200,"column":224,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[15077,15227],"text":" to analyze the \"Brussels Effect\" not as a neutral diffusion of standards, but as a form of \"Legal Imperialism.&quot;\r\n                                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[15077,15227],"text":" to analyze the \"Brussels Effect\" not as a neutral diffusion of standards, but as a form of \"Legal Imperialism.&ldquo;\r\n                                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[15077,15227],"text":" to analyze the \"Brussels Effect\" not as a neutral diffusion of standards, but as a form of \"Legal Imperialism.&#34;\r\n                                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[15077,15227],"text":" to analyze the \"Brussels Effect\" not as a neutral diffusion of standards, but as a form of \"Legal Imperialism.&rdquo;\r\n                                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":216,"column":65,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[15914,16048],"text":"\r\n                                    Acknowledging the researcher&apos;s position within the assemblage.\r\n                                "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[15914,16048],"text":"\r\n                                    Acknowledging the researcher&lsquo;s position within the assemblage.\r\n                                "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[15914,16048],"text":"\r\n                                    Acknowledging the researcher&#39;s position within the assemblage.\r\n                                "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[15914,16048],"text":"\r\n                                    Acknowledging the researcher&rsquo;s position within the assemblage.\r\n                                "},"desc":"Replace with `&rsquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":240,"column":108,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[18088,18258],"text":" via the &quot;Methodological Log\" and \"Positionality Statement,\" ensuring the researcher does not claim a \"God Trick\" view from nowhere.\r\n                                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[18088,18258],"text":" via the &ldquo;Methodological Log\" and \"Positionality Statement,\" ensuring the researcher does not claim a \"God Trick\" view from nowhere.\r\n                                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[18088,18258],"text":" via the &#34;Methodological Log\" and \"Positionality Statement,\" ensuring the researcher does not claim a \"God Trick\" view from nowhere.\r\n                                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[18088,18258],"text":" via the &rdquo;Methodological Log\" and \"Positionality Statement,\" ensuring the researcher does not claim a \"God Trick\" view from nowhere.\r\n                                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":240,"column":127,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[18088,18258],"text":" via the \"Methodological Log&quot; and \"Positionality Statement,\" ensuring the researcher does not claim a \"God Trick\" view from nowhere.\r\n                                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[18088,18258],"text":" via the \"Methodological Log&ldquo; and \"Positionality Statement,\" ensuring the researcher does not claim a \"God Trick\" view from nowhere.\r\n                                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[18088,18258],"text":" via the \"Methodological Log&#34; and \"Positionality Statement,\" ensuring the researcher does not claim a \"God Trick\" view from nowhere.\r\n                                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[18088,18258],"text":" via the \"Methodological Log&rdquo; and \"Positionality Statement,\" ensuring the researcher does not claim a \"God Trick\" view from nowhere.\r\n                                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":240,"column":133,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[18088,18258],"text":" via the \"Methodological Log\" and &quot;Positionality Statement,\" ensuring the researcher does not claim a \"God Trick\" view from nowhere.\r\n                                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[18088,18258],"text":" via the \"Methodological Log\" and &ldquo;Positionality Statement,\" ensuring the researcher does not claim a \"God Trick\" view from nowhere.\r\n                                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[18088,18258],"text":" via the \"Methodological Log\" and &#34;Positionality Statement,\" ensuring the researcher does not claim a \"God Trick\" view from nowhere.\r\n                                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[18088,18258],"text":" via the \"Methodological Log\" and &rdquo;Positionality Statement,\" ensuring the researcher does not claim a \"God Trick\" view from nowhere.\r\n                                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":240,"column":158,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[18088,18258],"text":" via the \"Methodological Log\" and \"Positionality Statement,&quot; ensuring the researcher does not claim a \"God Trick\" view from nowhere.\r\n                                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[18088,18258],"text":" via the \"Methodological Log\" and \"Positionality Statement,&ldquo; ensuring the researcher does not claim a \"God Trick\" view from nowhere.\r\n                                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[18088,18258],"text":" via the \"Methodological Log\" and \"Positionality Statement,&#34; ensuring the researcher does not claim a \"God Trick\" view from nowhere.\r\n                                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[18088,18258],"text":" via the \"Methodological Log\" and \"Positionality Statement,&rdquo; ensuring the researcher does not claim a \"God Trick\" view from nowhere.\r\n                                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":240,"column":201,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[18088,18258],"text":" via the \"Methodological Log\" and \"Positionality Statement,\" ensuring the researcher does not claim a &quot;God Trick\" view from nowhere.\r\n                                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[18088,18258],"text":" via the \"Methodological Log\" and \"Positionality Statement,\" ensuring the researcher does not claim a &ldquo;God Trick\" view from nowhere.\r\n                                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[18088,18258],"text":" via the \"Methodological Log\" and \"Positionality Statement,\" ensuring the researcher does not claim a &#34;God Trick\" view from nowhere.\r\n                                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[18088,18258],"text":" via the \"Methodological Log\" and \"Positionality Statement,\" ensuring the researcher does not claim a &rdquo;God Trick\" view from nowhere.\r\n                                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":240,"column":211,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[18088,18258],"text":" via the \"Methodological Log\" and \"Positionality Statement,\" ensuring the researcher does not claim a \"God Trick&quot; view from nowhere.\r\n                                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[18088,18258],"text":" via the \"Methodological Log\" and \"Positionality Statement,\" ensuring the researcher does not claim a \"God Trick&ldquo; view from nowhere.\r\n                                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[18088,18258],"text":" via the \"Methodological Log\" and \"Positionality Statement,\" ensuring the researcher does not claim a \"God Trick&#34; view from nowhere.\r\n                                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[18088,18258],"text":" via the \"Methodological Log\" and \"Positionality Statement,\" ensuring the researcher does not claim a \"God Trick&rdquo; view from nowhere.\r\n                                    "},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":28,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\r\nimport { BookOpen, Network, Scale, Users, Lightbulb, Globe } from \"lucide-react\";\r\n\r\nexport default function LiteraturePage() {\r\n    return (\r\n        <div className=\"space-y-8 max-w-7xl mx-auto\">\r\n            <div className=\"flex flex-col gap-2\">\r\n                <h1 className=\"text-3xl font-bold text-slate-900\">Theoretical Framework & Literature Review</h1>\r\n                <p className=\"text-slate-600 max-w-3xl\">\r\n                    This module maps the theoretical underpinnings of the \"Decolonial Situatedness in Global AI Governance\" project.\r\n                    It grounds the application's methodology in key scholarship across Decolonial Studies, STS, and Critical Legal Theory.\r\n                </p>\r\n            </div>\r\n\r\n            <Tabs defaultValue=\"assemblage\" className=\"w-full\">\r\n                <TabsList className=\"grid w-full grid-cols-5 bg-slate-100 p-1 rounded-lg\">\r\n                    <TabsTrigger value=\"assemblage\" className=\"data-[state=active]:bg-white data-[state=active]:shadow-sm\">\r\n                        <Network size={16} className=\"mr-2\" /> Assemblage Theory\r\n                    </TabsTrigger>\r\n                    <TabsTrigger value=\"decolonial\" className=\"data-[state=active]:bg-white data-[state=active]:shadow-sm\">\r\n                        <Globe size={16} className=\"mr-2\" /> Decoloniality\r\n                    </TabsTrigger>\r\n                    <TabsTrigger value=\"resistance\" className=\"data-[state=active]:bg-white data-[state=active]:shadow-sm\">\r\n                        <Users size={16} className=\"mr-2\" /> Resistance\r\n                    </TabsTrigger>\r\n                    <TabsTrigger value=\"legal\" className=\"data-[state=active]:bg-white data-[state=active]:shadow-sm\">\r\n                        <Scale size={16} className=\"mr-2\" /> Critical Legal\r\n                    </TabsTrigger>\r\n                    <TabsTrigger value=\"reflexivity\" className=\"data-[state=active]:bg-white data-[state=active]:shadow-sm\">\r\n                        <Lightbulb size={16} className=\"mr-2\" /> Reflexivity\r\n                    </TabsTrigger>\r\n                </TabsList>\r\n\r\n                <div className=\"mt-6 space-y-6\">\r\n                    {/* Assemblage Theory Content */}\r\n                    <TabsContent value=\"assemblage\" className=\"space-y-6\">\r\n                        <Card>\r\n                            <CardHeader>\r\n                                <CardTitle className=\"flex items-center gap-2\">\r\n                                    <Network className=\"text-blue-600\" />\r\n                                    Algorithmic Assemblages\r\n                                </CardTitle>\r\n                                <CardDescription>\r\n                                    Understanding AI governance not as static laws, but as dynamic, socio-technical flows.\r\n                                </CardDescription>\r\n                            </CardHeader>\r\n                            <CardContent className=\"space-y-4\">\r\n                                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                                    <div className=\"space-y-3\">\r\n                                        <h3 className=\"font-semibold text-slate-900\">Key Concepts</h3>\r\n                                        <ul className=\"list-disc list-inside text-sm text-slate-600 space-y-2\">\r\n                                            <li><strong>Assemblage (Agencement):</strong> A heterogeneous composition of human and non-human actors (Deleuze & Guattari).</li>\r\n                                            <li><strong>Translation:</strong> The process by which actors modify and displace goals (Latour/Callon).</li>\r\n                                            <li><strong>Performativity:</strong> How algorithms enact the realities they purport to describe (MacKenzie).</li>\r\n                                        </ul>\r\n                                    </div>\r\n                                    <div className=\"space-y-3\">\r\n                                        <h3 className=\"font-semibold text-slate-900\">Key Scholars</h3>\r\n                                        <div className=\"flex flex-wrap gap-2\">\r\n                                            <Badge variant=\"outline\">Deleuze & Guattari</Badge>\r\n                                            <Badge variant=\"outline\">Bruno Latour</Badge>\r\n                                            <Badge variant=\"outline\">Louise Amoore</Badge>\r\n                                            <Badge variant=\"outline\">N. Katherine Hayles</Badge>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"bg-slate-50 p-4 rounded-lg border border-slate-100 mt-4\">\r\n                                    <h4 className=\"text-sm font-semibold text-slate-800 mb-2\">Application in Project:</h4>\r\n                                    <p className=\"text-sm text-slate-600\">\r\n                                        Used in the <strong>Synthesis Module</strong> to map the flow from Actors &rarr; Mechanisms &rarr; Impacts, visualizing how the EU AI Act and PL 2338 function as \"assemblages\" of power rather than just text.\r\n                                    </p>\r\n                                </div>\r\n                            </CardContent>\r\n                        </Card>\r\n                    </TabsContent>\r\n\r\n                    {/* Decoloniality Content */}\r\n                    <TabsContent value=\"decolonial\" className=\"space-y-6\">\r\n                        <Card>\r\n                            <CardHeader>\r\n                                <CardTitle className=\"flex items-center gap-2\">\r\n                                    <Globe className=\"text-emerald-600\" />\r\n                                    Decolonial Situatedness\r\n                                </CardTitle>\r\n                                <CardDescription>\r\n                                    Analyzing how \"universal\" AI governance reinforces Global North epistemologies.\r\n                                </CardDescription>\r\n                            </CardHeader>\r\n                            <CardContent className=\"space-y-4\">\r\n                                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                                    <div className=\"space-y-3\">\r\n                                        <h3 className=\"font-semibold text-slate-900\">Key Concepts</h3>\r\n                                        <ul className=\"list-disc list-inside text-sm text-slate-600 space-y-2\">\r\n                                            <li><strong>Coloniality of Power:</strong> The continuity of colonial forms of domination after the end of colonial administrations (Quijano).</li>\r\n                                            <li><strong>Border Thinking:</strong> Thinking from the exteriority of the modern/colonial world system (Mignolo).</li>\r\n                                            <li><strong>Data Colonialism:</strong> The extraction of data from the Global South for value capture in the North (Couldry & Mejias).</li>\r\n                                        </ul>\r\n                                    </div>\r\n                                    <div className=\"space-y-3\">\r\n                                        <h3 className=\"font-semibold text-slate-900\">Key Scholars</h3>\r\n                                        <div className=\"flex flex-wrap gap-2\">\r\n                                            <Badge variant=\"outline\">Anbal Quijano</Badge>\r\n                                            <Badge variant=\"outline\">Walter Mignolo</Badge>\r\n                                            <Badge variant=\"outline\">Sylvia Wynter</Badge>\r\n                                            <Badge variant=\"outline\">Paola Ricaurte</Badge>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"bg-emerald-50 p-4 rounded-lg border border-emerald-100 mt-4\">\r\n                                    <h4 className=\"text-sm font-semibold text-emerald-900 mb-2\">Application in Project:</h4>\r\n                                    <p className=\"text-sm text-emerald-800\">\r\n                                        Informs the <strong>Ontology Module</strong> and <strong>Cultural Analysis</strong>, questioning the \"universal\" applicability of the EU's \"Risk-Based Approach\" when transplanted to the Brazilian context.\r\n                                    </p>\r\n                                </div>\r\n                            </CardContent>\r\n                        </Card>\r\n                    </TabsContent>\r\n\r\n                    {/* Resistance Content */}\r\n                    <TabsContent value=\"resistance\" className=\"space-y-6\">\r\n                        <Card>\r\n                            <CardHeader>\r\n                                <CardTitle className=\"flex items-center gap-2\">\r\n                                    <Users className=\"text-amber-600\" />\r\n                                    Micro-Resistance & Friction\r\n                                </CardTitle>\r\n                                <CardDescription>\r\n                                    Identifying how local actors adapt, resist, or subvert algorithmic governance.\r\n                                </CardDescription>\r\n                            </CardHeader>\r\n                            <CardContent className=\"space-y-4\">\r\n                                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                                    <div className=\"space-y-3\">\r\n                                        <h3 className=\"font-semibold text-slate-900\">Key Concepts</h3>\r\n                                        <ul className=\"list-disc list-inside text-sm text-slate-600 space-y-2\">\r\n                                            <li><strong>Weapons of the Weak:</strong> Everyday forms of peasant resistance (Scott).</li>\r\n                                            <li><strong>Friction:</strong> The awkward, unequal, unstable, and creative qualities of interconnection (Tsing).</li>\r\n                                            <li><strong>Glitch Feminism:</strong> Using the error/glitch as a site of resistance (Russell).</li>\r\n                                        </ul>\r\n                                    </div>\r\n                                    <div className=\"space-y-3\">\r\n                                        <h3 className=\"font-semibold text-slate-900\">Key Scholars</h3>\r\n                                        <div className=\"flex flex-wrap gap-2\">\r\n                                            <Badge variant=\"outline\">James C. Scott</Badge>\r\n                                            <Badge variant=\"outline\">Anna Lowenhaupt Tsing</Badge>\r\n                                            <Badge variant=\"outline\">Legacy Russell</Badge>\r\n                                            <Badge variant=\"outline\">Saidiya Hartman</Badge>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"bg-amber-50 p-4 rounded-lg border border-amber-100 mt-4\">\r\n                                    <h4 className=\"text-sm font-semibold text-amber-900 mb-2\">Application in Project:</h4>\r\n                                    <p className=\"text-sm text-amber-800\">\r\n                                        Central to the <strong>Resistance Module</strong>, where we map \"Friction Points\" and \"Subversion Strategies\" in the implementation of AI laws.\r\n                                    </p>\r\n                                </div>\r\n                            </CardContent>\r\n                        </Card>\r\n                    </TabsContent>\r\n\r\n                    {/* Critical Legal Content */}\r\n                    <TabsContent value=\"legal\" className=\"space-y-6\">\r\n                        <Card>\r\n                            <CardHeader>\r\n                                <CardTitle className=\"flex items-center gap-2\">\r\n                                    <Scale className=\"text-indigo-600\" />\r\n                                    Critical Legal Theory & TWAIL\r\n                                </CardTitle>\r\n                                <CardDescription>\r\n                                    Examining international law as a site of struggle and hierarchy.\r\n                                </CardDescription>\r\n                            </CardHeader>\r\n                            <CardContent className=\"space-y-4\">\r\n                                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                                    <div className=\"space-y-3\">\r\n                                        <h3 className=\"font-semibold text-slate-900\">Key Concepts</h3>\r\n                                        <ul className=\"list-disc list-inside text-sm text-slate-600 space-y-2\">\r\n                                            <li><strong>Legal Transplants:</strong> The movement of laws across borders and their mutation (Watson/Frankenberg).</li>\r\n                                            <li><strong>TWAIL:</strong> Third World Approaches to International Law, critiquing the colonial origins of international norms.</li>\r\n                                            <li><strong>Brussels Effect:</strong> The EU's unilateral power to regulate global markets (Bradford) - <em>critiqued here</em>.</li>\r\n                                        </ul>\r\n                                    </div>\r\n                                    <div className=\"space-y-3\">\r\n                                        <h3 className=\"font-semibold text-slate-900\">Key Scholars</h3>\r\n                                        <div className=\"flex flex-wrap gap-2\">\r\n                                            <Badge variant=\"outline\">Antony Anghie</Badge>\r\n                                            <Badge variant=\"outline\">B.S. Chimni</Badge>\r\n                                            <Badge variant=\"outline\">Anu Bradford</Badge>\r\n                                            <Badge variant=\"outline\">Gnter Frankenberg</Badge>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"bg-indigo-50 p-4 rounded-lg border border-indigo-100 mt-4\">\r\n                                    <h4 className=\"text-sm font-semibold text-indigo-900 mb-2\">Application in Project:</h4>\r\n                                    <p className=\"text-sm text-indigo-800\">\r\n                                        Used in the <strong>Data Module</strong> and <strong>Comparison</strong> to analyze the \"Brussels Effect\" not as a neutral diffusion of standards, but as a form of \"Legal Imperialism.\"\r\n                                    </p>\r\n                                </div>\r\n                            </CardContent>\r\n                        </Card>\r\n                    </TabsContent>\r\n\r\n                    {/* Reflexivity Content */}\r\n                    <TabsContent value=\"reflexivity\" className=\"space-y-6\">\r\n                        <Card>\r\n                            <CardHeader>\r\n                                <CardTitle className=\"flex items-center gap-2\">\r\n                                    <Lightbulb className=\"text-purple-600\" />\r\n                                    Feminist Standpoint & Reflexivity\r\n                                </CardTitle>\r\n                                <CardDescription>\r\n                                    Acknowledging the researcher's position within the assemblage.\r\n                                </CardDescription>\r\n                            </CardHeader>\r\n                            <CardContent className=\"space-y-4\">\r\n                                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                                    <div className=\"space-y-3\">\r\n                                        <h3 className=\"font-semibold text-slate-900\">Key Concepts</h3>\r\n                                        <ul className=\"list-disc list-inside text-sm text-slate-600 space-y-2\">\r\n                                            <li><strong>Situated Knowledges:</strong> The view from a body, always complex, contradictory, structuring, and structured (Haraway).</li>\r\n                                            <li><strong>Strong Objectivity:</strong> Starting research from the lives of marginalized groups to produce less partial accounts (Harding).</li>\r\n                                        </ul>\r\n                                    </div>\r\n                                    <div className=\"space-y-3\">\r\n                                        <h3 className=\"font-semibold text-slate-900\">Key Scholars</h3>\r\n                                        <div className=\"flex flex-wrap gap-2\">\r\n                                            <Badge variant=\"outline\">Donna Haraway</Badge>\r\n                                            <Badge variant=\"outline\">Sandra Harding</Badge>\r\n                                            <Badge variant=\"outline\">Patricia Hill Collins</Badge>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"bg-purple-50 p-4 rounded-lg border border-purple-100 mt-4\">\r\n                                    <h4 className=\"text-sm font-semibold text-purple-900 mb-2\">Application in Project:</h4>\r\n                                    <p className=\"text-sm text-purple-800\">\r\n                                        Operationalized in the <strong>Reflexivity Module</strong> via the \"Methodological Log\" and \"Positionality Statement,\" ensuring the researcher does not claim a \"God Trick\" view from nowhere.\r\n                                    </p>\r\n                                </div>\r\n                            </CardContent>\r\n                        </Card>\r\n                    </TabsContent>\r\n                </div>\r\n            </Tabs>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\app\\ontology\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Source' is defined but never used.","line":5,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":16}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState } from \"react\";\r\nimport { useSources } from \"@/hooks/useSources\";\r\nimport { Source } from \"@/types\";\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Network, Share2, Database, Globe, Scale, Brain, Sparkles, Loader2 } from \"lucide-react\";\r\n\r\n// Types\r\ninterface OntologyNode {\r\n    id: string;\r\n    label: string;\r\n    category: string;\r\n    description?: string;\r\n    quote?: string;\r\n    x?: number;\r\n    y?: number;\r\n    color?: string;\r\n}\r\n\r\ninterface OntologyLink {\r\n    source: string;\r\n    target: string;\r\n    relation: string;\r\n}\r\n\r\ninterface OntologyData {\r\n    summary?: string;\r\n    nodes: OntologyNode[];\r\n    links: OntologyLink[];\r\n}\r\n\r\n// Static Data (Fallback)\r\nconst STATIC_CONCEPTS = [\r\n    {\r\n        title: \"Coloniality of Power\",\r\n        description: \"The living legacy of colonialism in contemporary power structures, defining who has the authority to classify and organize the world.\",\r\n        quote: \"The coloniality of power is not just a historical event, but a continuous process of ordering the world.\",\r\n        category: \"Core Concept\",\r\n        icon: Globe,\r\n        colorClass: \"bg-red-100\",\r\n        iconClass: \"text-red-600\",\r\n    },\r\n    {\r\n        title: \"Algorithmic Rationality\",\r\n        description: \"The logic by which algorithms order, sort, and prioritize information, often embedding specific cultural and epistemological values.\",\r\n        quote: \"Algorithms are not neutral tools; they are crystallized forms of rationality.\",\r\n        category: \"Mechanism\",\r\n        icon: Brain,\r\n        colorClass: \"bg-purple-100\",\r\n        iconClass: \"text-purple-600\",\r\n    },\r\n    {\r\n        title: \"Border Thinking\",\r\n        description: \"Epistemic response from the exteriority of modernity; thinking from the borders of modern/colonial world-system.\",\r\n        quote: \"To think from the border is to challenge the universality of Western epistemology.\",\r\n        category: \"Methodology\",\r\n        icon: Share2,\r\n        colorClass: \"bg-orange-100\",\r\n        iconClass: \"text-orange-600\",\r\n    },\r\n    {\r\n        title: \"Data Extractivism\",\r\n        description: \"The process of extracting data from human life and turning it into a resource for capital accumulation.\",\r\n        quote: \"Data is the new oil, but the extraction process leaves behind social pollution.\",\r\n        category: \"Process\",\r\n        icon: Database,\r\n        colorClass: \"bg-green-100\",\r\n        iconClass: \"text-green-600\",\r\n    },\r\n    {\r\n        title: \"Epistemic Violence\",\r\n        description: \"The destruction of non-Western ways of knowing and the imposition of a single, universalized epistemology.\",\r\n        quote: \"The silencing of other ways of knowing is a form of violence.\",\r\n        category: \"Impact\",\r\n        icon: Scale,\r\n        colorClass: \"bg-slate-100\",\r\n        iconClass: \"text-slate-600\",\r\n    },\r\n    {\r\n        title: \"Sociotechnical Assemblage\",\r\n        description: \"Complex arrangements of humans, machines, norms, and resources that constitute AI systems as loosely coupled, emergently structured entities.\",\r\n        quote: \"AI is not a thing, but an assemblage of social and technical relations that orchestrate value.\",\r\n        category: \"Structure\",\r\n        icon: Network,\r\n        colorClass: \"bg-blue-100\",\r\n        iconClass: \"text-blue-600\",\r\n    },\r\n];\r\n\r\nconst STATIC_NETWORK_NODES = [\r\n    { id: \"0\", label: \"Coloniality\", x: 250, y: 50, color: \"#dc2626\" },\r\n    { id: \"1\", label: \"Algorithmic\\nRationality\", x: 450, y: 150, color: \"#9333ea\" },\r\n    { id: \"2\", label: \"Border\\nThinking\", x: 50, y: 150, color: \"#ea580c\" },\r\n    { id: \"3\", label: \"Data\\nExtractivism\", x: 400, y: 300, color: \"#16a34a\" },\r\n    { id: \"4\", label: \"Epistemic\\nViolence\", x: 100, y: 300, color: \"#64748b\" },\r\n    { id: \"5\", label: \"Assemblage\", x: 250, y: 200, color: \"#3b82f6\" },\r\n];\r\n\r\nconst STATIC_NETWORK_LINKS = [\r\n    { source: \"0\", target: \"1\", relation: \"informs\" },\r\n    { source: \"0\", target: \"4\", relation: \"causes\" },\r\n    { source: \"0\", target: \"5\", relation: \"shapes\" },\r\n    { source: \"1\", target: \"3\", relation: \"enables\" },\r\n    { source: \"1\", target: \"5\", relation: \"structures\" },\r\n    { source: \"2\", target: \"0\", relation: \"resists\" },\r\n    { source: \"2\", target: \"4\", relation: \"counters\" },\r\n    { source: \"3\", target: \"5\", relation: \"feeds\" },\r\n    { source: \"4\", target: \"5\", relation: \"embedded in\" },\r\n];\r\n\r\nexport default function OntologyPage() {\r\n    const { sources, isLoading } = useSources();\r\n    const [selectedSourceId, setSelectedSourceId] = useState<string>(\"\");\r\n    const [isAnalyzing, setIsAnalyzing] = useState(false);\r\n    const [ontologyData, setOntologyData] = useState<OntologyData | null>(null);\r\n\r\n    // Interactivity State\r\n    const [hoveredNodeId, setHoveredNodeId] = useState<string | null>(null);\r\n    const [selectedNodeId, setSelectedNodeId] = useState<string | null>(null);\r\n\r\n    // Filter sources that have text available for analysis\r\n    const analyzedSources = sources.filter(s => s.extractedText);\r\n\r\n    const handleGenerateOntology = async () => {\r\n        const source = analyzedSources.find(s => s.id === selectedSourceId);\r\n        if (!source || !source.extractedText) return;\r\n\r\n        setIsAnalyzing(true);\r\n        try {\r\n            const response = await fetch('/api/analyze', {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({\r\n                    text: source.extractedText.substring(0, 3000), // Limit text length\r\n                    analysisMode: 'ontology'\r\n                })\r\n            });\r\n\r\n            const data = await response.json();\r\n            if (data.success && data.analysis) {\r\n                // Process nodes to add coordinates and colors\r\n                const processedNodes = data.analysis.nodes.map((node: OntologyNode, index: number) => ({\r\n                    ...node,\r\n                    x: 300 + 200 * Math.cos(2 * Math.PI * index / data.analysis.nodes.length),\r\n                    y: 200 + 150 * Math.sin(2 * Math.PI * index / data.analysis.nodes.length),\r\n                    color: getColorForCategory(node.category)\r\n                }));\r\n                setOntologyData({\r\n                    summary: data.analysis.summary,\r\n                    nodes: processedNodes,\r\n                    links: data.analysis.links\r\n                });\r\n            } else {\r\n                alert(\"Analysis failed: \" + (data.error || \"Unknown error\"));\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Ontology generation error:\", error);\r\n            alert(\"Failed to generate ontology.\");\r\n        } finally {\r\n            setIsAnalyzing(false);\r\n        }\r\n    };\r\n\r\n    const getColorForCategory = (category: string) => {\r\n        const lower = category.toLowerCase();\r\n        if (lower.includes('core') || lower.includes('concept')) return \"#dc2626\"; // Red\r\n        if (lower.includes('mechanism')) return \"#9333ea\"; // Purple\r\n        if (lower.includes('actor')) return \"#2563eb\"; // Blue\r\n        if (lower.includes('value')) return \"#16a34a\"; // Green\r\n        if (lower.includes('methodology')) return \"#ea580c\"; // Orange\r\n        return \"#64748b\"; // Slate\r\n    };\r\n\r\n    const getColorClassForCategory = (category: string) => {\r\n        const lower = category.toLowerCase();\r\n        if (lower.includes('core') || lower.includes('concept')) return { bg: \"bg-red-100\", text: \"text-red-600\", border: \"border-red-200\" };\r\n        if (lower.includes('mechanism')) return { bg: \"bg-purple-100\", text: \"text-purple-600\", border: \"border-purple-200\" };\r\n        if (lower.includes('actor')) return { bg: \"bg-blue-100\", text: \"text-blue-600\", border: \"border-blue-200\" };\r\n        if (lower.includes('value')) return { bg: \"bg-green-100\", text: \"text-green-600\", border: \"border-green-200\" };\r\n        if (lower.includes('methodology')) return { bg: \"bg-orange-100\", text: \"text-orange-600\", border: \"border-orange-200\" };\r\n        return { bg: \"bg-slate-100\", text: \"text-slate-600\", border: \"border-slate-200\" };\r\n    };\r\n\r\n    // Use static data if no dynamic data is generated\r\n    const displayNodes = ontologyData ? ontologyData.nodes : STATIC_NETWORK_NODES;\r\n    const displayLinks = ontologyData ? ontologyData.links : STATIC_NETWORK_LINKS;\r\n\r\n    // Filtered cards based on selection\r\n    const filteredNodes = selectedNodeId\r\n        ? displayNodes.filter(n => n.id === selectedNodeId)\r\n        : displayNodes;\r\n\r\n    // Helper to check if a node is connected to the hovered node\r\n    const isConnected = (nodeId: string) => {\r\n        if (!hoveredNodeId) return false;\r\n        return displayLinks.some(link =>\r\n            (link.source === hoveredNodeId && link.target === nodeId) ||\r\n            (link.target === hoveredNodeId && link.source === nodeId)\r\n        );\r\n    };\r\n\r\n    const handleNodeClick = (nodeId: string) => {\r\n        if (selectedNodeId === nodeId) {\r\n            setSelectedNodeId(null); // Deselect\r\n        } else {\r\n            setSelectedNodeId(nodeId); // Select\r\n            // Scroll to cards section\r\n            const cardsSection = document.getElementById('concept-cards');\r\n            if (cardsSection) {\r\n                cardsSection.scrollIntoView({ behavior: 'smooth' });\r\n            }\r\n        }\r\n    };\r\n\r\n    if (isLoading) {\r\n        return (\r\n            <div className=\"flex items-center justify-center h-64\">\r\n                <Loader2 className=\"h-8 w-8 animate-spin text-slate-400\" />\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"space-y-8\">\r\n            <div className=\"flex items-center justify-between\">\r\n                <div>\r\n                    <h2 className=\"text-3xl font-bold tracking-tight text-slate-900\">Ontological Cartography of Algorithmic Assemblages</h2>\r\n                    <p className=\"text-slate-500\">Mapping the key concepts, materialities, and relationships in the sociotechnical assemblage.</p>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Analysis Controls */}\r\n            <Card className=\"border-indigo-100 bg-indigo-50/50\">\r\n                <CardHeader>\r\n                    <div className=\"flex items-center gap-2\">\r\n                        <Brain className=\"h-5 w-5 text-indigo-600\" />\r\n                        <CardTitle>Assemblage Mapping</CardTitle>\r\n                    </div>\r\n                    <CardDescription>Select a document to extract its conceptual ontology</CardDescription>\r\n                </CardHeader>\r\n                <CardContent>\r\n                    <div className=\"flex gap-4 items-end\">\r\n                        <div className=\"flex-1 space-y-2\">\r\n                            <label className=\"text-sm font-medium text-slate-700\">Select Document</label>\r\n                            <select\r\n                                className=\"w-full p-2 border rounded-md text-sm bg-white\"\r\n                                value={selectedSourceId}\r\n                                onChange={(e) => setSelectedSourceId(e.target.value)}\r\n                            >\r\n                                <option value=\"\">Select a source...</option>\r\n                                {analyzedSources.map(s => (\r\n                                    <option key={s.id} value={s.id}>{s.title}</option>\r\n                                ))}\r\n                            </select>\r\n                        </div>\r\n                        <Button\r\n                            className=\"bg-indigo-600 text-white hover:bg-indigo-700\"\r\n                            onClick={handleGenerateOntology}\r\n                            disabled={!selectedSourceId || isAnalyzing}\r\n                        >\r\n                            {isAnalyzing ? (\r\n                                <>\r\n                                    <Sparkles className=\"mr-2 h-4 w-4 animate-spin\" />\r\n                                    Extracting...\r\n                                </>\r\n                            ) : (\r\n                                <>\r\n                                    <Network className=\"mr-2 h-4 w-4\" />\r\n                                    Generate Map\r\n                                </>\r\n                            )}\r\n                        </Button>\r\n                    </div>\r\n                </CardContent>\r\n            </Card>\r\n\r\n            {/* Ontology Summary */}\r\n            {ontologyData?.summary && (\r\n                <Card className=\"bg-slate-50 border-slate-200\">\r\n                    <CardHeader className=\"pb-2\">\r\n                        <div className=\"flex items-center gap-2\">\r\n                            <Sparkles className=\"h-4 w-4 text-indigo-600\" />\r\n                            <CardTitle className=\"text-lg\">Ontological Summary</CardTitle>\r\n                        </div>\r\n                    </CardHeader>\r\n                    <CardContent>\r\n                        <p className=\"text-sm text-slate-700 leading-relaxed\">\r\n                            {ontologyData.summary}\r\n                        </p>\r\n                    </CardContent>\r\n                </Card>\r\n            )}\r\n\r\n            {/* Network Visualization */}\r\n            <Card>\r\n                <CardHeader>\r\n                    <div className=\"flex items-center justify-between\">\r\n                        <div>\r\n                            <CardTitle>{ontologyData ? \"Extracted Concept Map\" : \"Concept Network (Example)\"}</CardTitle>\r\n                            <CardDescription>\r\n                                {ontologyData\r\n                                    ? \"Interactive map. Hover to see connections, click to filter details.\"\r\n                                    : \"Static example. Hover to see connections, click to filter details.\"}\r\n                            </CardDescription>\r\n                        </div>\r\n                        {/* Legend */}\r\n                        <div className=\"flex gap-3 text-xs\">\r\n                            <div className=\"flex items-center gap-1\">\r\n                                <div className=\"w-3 h-3 rounded-full bg-red-600\"></div>\r\n                                <span>Core Concept</span>\r\n                            </div>\r\n                            <div className=\"flex items-center gap-1\">\r\n                                <div className=\"w-3 h-3 rounded-full bg-purple-600\"></div>\r\n                                <span>Mechanism</span>\r\n                            </div>\r\n                            <div className=\"flex items-center gap-1\">\r\n                                <div className=\"w-3 h-3 rounded-full bg-blue-600\"></div>\r\n                                <span>Actor/Structure</span>\r\n                            </div>\r\n                            <div className=\"flex items-center gap-1\">\r\n                                <div className=\"w-3 h-3 rounded-full bg-green-600\"></div>\r\n                                <span>Value/Process</span>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </CardHeader>\r\n                <CardContent className=\"flex justify-center overflow-x-auto bg-slate-50/50 py-8\">\r\n                    <svg width=\"700\" height=\"500\" className=\"border border-slate-200 rounded-lg bg-white shadow-sm\">\r\n                        <defs>\r\n                            <marker id=\"arrowhead\" markerWidth=\"10\" markerHeight=\"7\" refX=\"32\" refY=\"3.5\" orient=\"auto\">\r\n                                <polygon points=\"0 0, 10 3.5, 0 7\" fill=\"#cbd5e1\" />\r\n                            </marker>\r\n                            <filter id=\"glow\" x=\"-20%\" y=\"-20%\" width=\"140%\" height=\"140%\">\r\n                                <feGaussianBlur stdDeviation=\"2\" result=\"blur\" />\r\n                                <feComposite in=\"SourceGraphic\" in2=\"blur\" operator=\"over\" />\r\n                            </filter>\r\n                        </defs>\r\n\r\n                        {/* Links */}\r\n                        {displayLinks.map((link, i) => {\r\n                            const sourceNode = displayNodes.find(n => n.id === link.source);\r\n                            const targetNode = displayNodes.find(n => n.id === link.target);\r\n\r\n                            if (!sourceNode || !targetNode || !sourceNode.x || !sourceNode.y || !targetNode.x || !targetNode.y) return null;\r\n\r\n                            // Determine opacity based on hover/selection\r\n                            const isRelated = hoveredNodeId === link.source || hoveredNodeId === link.target || selectedNodeId === link.source || selectedNodeId === link.target;\r\n                            const isDimmed = (hoveredNodeId && !isRelated) || (selectedNodeId && !isRelated);\r\n                            const opacity = isDimmed ? 0.1 : 1;\r\n                            const strokeWidth = isRelated ? 2.5 : 1.5;\r\n                            const strokeColor = isRelated ? \"#64748b\" : \"#cbd5e1\";\r\n\r\n                            return (\r\n                                <g key={i} style={{ transition: 'all 0.3s ease' }}>\r\n                                    <line\r\n                                        x1={sourceNode.x}\r\n                                        y1={sourceNode.y}\r\n                                        x2={targetNode.x}\r\n                                        y2={targetNode.y}\r\n                                        stroke={strokeColor}\r\n                                        strokeWidth={strokeWidth}\r\n                                        opacity={opacity}\r\n                                        markerEnd=\"url(#arrowhead)\"\r\n                                    />\r\n                                    {/* Link Label - Only show if related or no hover */}\r\n                                    {(!hoveredNodeId || isRelated) && (\r\n                                        <text\r\n                                            x={(sourceNode.x + targetNode.x) / 2}\r\n                                            y={(sourceNode.y + targetNode.y) / 2 - 5}\r\n                                            textAnchor=\"middle\"\r\n                                            fontSize=\"10\"\r\n                                            fill=\"#64748b\"\r\n                                            opacity={opacity}\r\n                                            className=\"pointer-events-none select-none\"\r\n                                        >\r\n                                            {link.relation}\r\n                                        </text>\r\n                                    )}\r\n                                </g>\r\n                            );\r\n                        })}\r\n\r\n                        {/* Nodes */}\r\n                        {displayNodes.map((node) => {\r\n                            const isHovered = hoveredNodeId === node.id;\r\n                            const isSelected = selectedNodeId === node.id;\r\n                            const isConnectedToHover = isConnected(node.id);\r\n                            const isDimmed = (hoveredNodeId && !isHovered && !isConnectedToHover) || (selectedNodeId && !isSelected && selectedNodeId !== null && !hoveredNodeId);\r\n\r\n                            const opacity = isDimmed ? 0.3 : 1;\r\n                            const scale = isHovered || isSelected ? 1.1 : 1;\r\n                            const strokeWidth = isSelected ? 3 : (isHovered ? 2 : 0);\r\n                            const strokeColor = isSelected ? \"#0f172a\" : node.color;\r\n\r\n                            const tx = node.x || 0;\r\n                            const ty = node.y || 0;\r\n\r\n                            return (\r\n                                <g\r\n                                    key={node.id}\r\n                                    onClick={() => handleNodeClick(node.id)}\r\n                                    onMouseEnter={() => setHoveredNodeId(node.id)}\r\n                                    onMouseLeave={() => setHoveredNodeId(null)}\r\n                                    style={{ cursor: 'pointer', transition: 'all 0.3s ease', opacity }}\r\n                                    transform={`translate(${tx}, ${ty}) scale(${scale}) translate(${-tx}, ${-ty})`}\r\n                                >\r\n                                    <circle\r\n                                        cx={node.x}\r\n                                        cy={node.y}\r\n                                        r=\"35\"\r\n                                        fill=\"white\"\r\n                                        stroke={strokeColor}\r\n                                        strokeWidth={strokeWidth}\r\n                                        filter={isHovered || isSelected ? \"url(#glow)\" : \"\"}\r\n                                    />\r\n                                    <circle\r\n                                        cx={node.x}\r\n                                        cy={node.y}\r\n                                        r=\"30\"\r\n                                        fill={node.color || \"#64748b\"}\r\n                                        opacity=\"0.15\"\r\n                                    />\r\n                                    <text\r\n                                        x={node.x}\r\n                                        y={node.y}\r\n                                        textAnchor=\"middle\"\r\n                                        dominantBaseline=\"middle\"\r\n                                        fontSize=\"11\"\r\n                                        fontWeight=\"600\"\r\n                                        fill=\"#1e293b\"\r\n                                        className=\"pointer-events-none select-none\"\r\n                                    >\r\n                                        {node.label.split(/[\\s_]+/).slice(0, 2).map((line, i) => (\r\n                                            <tspan key={i} x={node.x} dy={i === 0 ? (node.label.split(/[\\s_]+/).length > 1 ? -6 : 0) : 12}>\r\n                                                {line}\r\n                                            </tspan>\r\n                                        ))}\r\n                                    </text>\r\n                                </g>\r\n                            );\r\n                        })}\r\n                    </svg>\r\n                </CardContent>\r\n            </Card>\r\n\r\n            {/* Concept Cards */}\r\n            <div id=\"concept-cards\" className=\"space-y-4\">\r\n                <div className=\"flex items-center justify-between\">\r\n                    <h3 className=\"text-xl font-semibold text-slate-900\">\r\n                        {selectedNodeId ? \"Selected Concept Details\" : \"All Concepts\"}\r\n                    </h3>\r\n                    {selectedNodeId && (\r\n                        <Button variant=\"ghost\" size=\"sm\" onClick={() => setSelectedNodeId(null)}>\r\n                            Show All\r\n                        </Button>\r\n                    )}\r\n                </div>\r\n\r\n                <div className=\"grid gap-6 md:grid-cols-2 lg:grid-cols-3\">\r\n                    {ontologyData ? (\r\n                        filteredNodes.map((n) => {\r\n                            const node = n as OntologyNode;\r\n                            const colors = getColorClassForCategory(node.category);\r\n                            return (\r\n                                <Card key={node.id} className={`hover:shadow-md transition-all duration-300 ${selectedNodeId === node.id ? 'ring-2 ring-indigo-500 shadow-lg' : ''}`}>\r\n                                    <CardHeader className=\"flex flex-row items-start justify-between space-y-0 pb-2\">\r\n                                        <div className=\"space-y-1\">\r\n                                            <CardTitle className=\"text-lg font-semibold\">{node.label}</CardTitle>\r\n                                            <Badge variant=\"secondary\" className=\"mt-1\">\r\n                                                {node.category}\r\n                                            </Badge>\r\n                                        </div>\r\n                                        <div className={`rounded-full p-2 ${colors.bg}`}>\r\n                                            <Brain className={`h-5 w-5 ${colors.text}`} />\r\n                                        </div>\r\n                                    </CardHeader>\r\n                                    <CardContent>\r\n                                        <p className=\"mt-2 text-sm text-slate-600 leading-relaxed\">\r\n                                            {node.description || \"No description available.\"}\r\n                                        </p>\r\n                                        {node.quote && (\r\n                                            <div className=\"mt-4 p-3 bg-slate-50 border-l-4 border-indigo-200 rounded-r text-xs italic text-slate-700\">\r\n                                                &quot;{node.quote}&quot;\r\n                                            </div>\r\n                                        )}\r\n                                    </CardContent>\r\n                                </Card>\r\n                            );\r\n                        })\r\n                    ) : (\r\n                        // Static fallback logic with filtering\r\n                        (selectedNodeId\r\n                            ? STATIC_CONCEPTS.filter((_, i) => STATIC_NETWORK_NODES[i].id === selectedNodeId)\r\n                            : STATIC_CONCEPTS\r\n                        ).map((concept) => (\r\n                            <Card key={concept.title} className=\"hover:shadow-md transition-shadow\">\r\n                                <CardHeader className=\"flex flex-row items-start justify-between space-y-0 pb-2\">\r\n                                    <div className=\"space-y-1\">\r\n                                        <CardTitle className=\"text-lg font-semibold\">{concept.title}</CardTitle>\r\n                                        <Badge variant=\"secondary\" className=\"mt-1\">\r\n                                            {concept.category}\r\n                                        </Badge>\r\n                                    </div>\r\n                                    <div className={`rounded-full p-2 ${concept.colorClass}`}>\r\n                                        <concept.icon className={`h-5 w-5 ${concept.iconClass}`} />\r\n                                    </div>\r\n                                </CardHeader>\r\n                                <CardContent>\r\n                                    <p className=\"mt-2 text-sm text-slate-600 leading-relaxed\">\r\n                                        {concept.description}\r\n                                    </p>\r\n                                    {concept.quote && (\r\n                                        <div className=\"mt-4 p-3 bg-slate-50 border-l-4 border-indigo-200 rounded-r text-xs italic text-slate-700\">\r\n                                            &quot;{concept.quote}&quot;\r\n                                        </div>\r\n                                    )}\r\n                                </CardContent>\r\n                            </Card>\r\n                        ))\r\n                    )}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\app\\page.tsx","messages":[{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":202,"column":27,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[7597,7711],"text":"\n                  Use the &quot;Analyze with AI\" button to extract insights through decolonial lenses\n                "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[7597,7711],"text":"\n                  Use the &ldquo;Analyze with AI\" button to extract insights through decolonial lenses\n                "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[7597,7711],"text":"\n                  Use the &#34;Analyze with AI\" button to extract insights through decolonial lenses\n                "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[7597,7711],"text":"\n                  Use the &rdquo;Analyze with AI\" button to extract insights through decolonial lenses\n                "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":202,"column":43,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[7597,7711],"text":"\n                  Use the \"Analyze with AI&quot; button to extract insights through decolonial lenses\n                "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[7597,7711],"text":"\n                  Use the \"Analyze with AI&ldquo; button to extract insights through decolonial lenses\n                "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[7597,7711],"text":"\n                  Use the \"Analyze with AI&#34; button to extract insights through decolonial lenses\n                "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[7597,7711],"text":"\n                  Use the \"Analyze with AI&rdquo; button to extract insights through decolonial lenses\n                "},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import Link from \"next/link\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport {\n  Database,\n  BookOpen,\n  Scale,\n  Users,\n  Scan,\n  Network,\n  Lightbulb,\n  Brain,\n  Sparkles,\n  ArrowRight\n} from \"lucide-react\";\n\nconst features = [\n  {\n    name: \"Data Sources\",\n    href: \"/data\",\n    icon: Database,\n    description: \"Upload and manage policy documents with AI-powered analysis\",\n    color: \"bg-blue-50 text-blue-700 border-blue-200\",\n    iconColor: \"text-blue-600\",\n  },\n  {\n    name: \"Ontology\",\n    href: \"/ontology\",\n    icon: BookOpen,\n    description: \"Map concepts, actors, and relationships in AI governance\",\n    color: \"bg-purple-50 text-purple-700 border-purple-200\",\n    iconColor: \"text-purple-600\",\n  },\n  {\n    name: \"Governance\",\n    href: \"/governance\",\n    icon: Scale,\n    description: \"Compare governance structures and power dynamics\",\n    color: \"bg-green-50 text-green-700 border-green-200\",\n    iconColor: \"text-green-600\",\n  },\n  {\n    name: \"Resistance\",\n    href: \"/resistance\",\n    icon: Users,\n    description: \"Analyze micro-resistance strategies and counter-narratives\",\n    color: \"bg-red-50 text-red-700 border-red-200\",\n    iconColor: \"text-red-600\",\n  },\n  {\n    name: \"Reflexivity\",\n    href: \"/reflexivity\",\n    icon: Scan,\n    description: \"Document positionality and research assumptions\",\n    color: \"bg-orange-50 text-orange-700 border-orange-200\",\n    iconColor: \"text-orange-600\",\n  },\n  {\n    name: \"Synthesis\",\n    href: \"/synthesis\",\n    icon: Network,\n    description: \"Cross-case synthesis and ecosystem impact mapping\",\n    color: \"bg-teal-50 text-teal-700 border-teal-200\",\n    iconColor: \"text-teal-600\",\n  },\n  {\n    name: \"Cultural Analysis\",\n    href: \"/cultural\",\n    icon: Lightbulb,\n    description: \"Detect cultural holes and innovation opportunities\",\n    color: \"bg-amber-50 text-amber-700 border-amber-200\",\n    iconColor: \"text-amber-600\",\n    badge: \"New\",\n  },\n];\n\nexport default function Home() {\n  return (\n    <div className=\"space-y-8\">\n      {/* Header */}\n      <div>\n        <h2 className=\"text-3xl font-bold tracking-tight text-slate-900\">\n          Research Dashboard\n        </h2>\n        <p className=\"text-slate-500 mt-1\">\n          Decolonial Situatedness in Global AI Governance\n        </p>\n      </div>\n\n      {/* Hero Card */}\n      <Card className=\"bg-gradient-to-br from-slate-900 to-slate-800 border-slate-700\">\n        <CardHeader>\n          <div className=\"flex items-center gap-2\">\n            <Brain className=\"h-6 w-6 text-purple-400\" />\n            <CardTitle className=\"text-white\">AI-Powered Research Assistant</CardTitle>\n          </div>\n          <CardDescription className=\"text-slate-300\">\n            Comparative algorithmic assemblage analysis using the Decolonial Situatedness Framework\n          </CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n            <div className=\"bg-slate-800/50 p-4 rounded-lg border border-slate-700\">\n              <div className=\"flex items-center gap-2 mb-2\">\n                <Sparkles className=\"h-4 w-4 text-purple-400\" />\n                <span className=\"text-sm font-semibold text-white\">AI Analysis</span>\n              </div>\n              <p className=\"text-xs text-slate-300\">\n                GPT-4 powered analysis through 4 decolonial lenses\n              </p>\n            </div>\n            <div className=\"bg-slate-800/50 p-4 rounded-lg border border-slate-700\">\n              <div className=\"flex items-center gap-2 mb-2\">\n                <Network className=\"h-4 w-4 text-teal-400\" />\n                <span className=\"text-sm font-semibold text-white\">Ecosystem Mapping</span>\n              </div>\n              <p className=\"text-xs text-slate-300\">\n                Visualize material and discursive interconnections\n              </p>\n            </div>\n            <div className=\"bg-slate-800/50 p-4 rounded-lg border border-slate-700\">\n              <div className=\"flex items-center gap-2 mb-2\">\n                <Lightbulb className=\"h-4 w-4 text-amber-400\" />\n                <span className=\"text-sm font-semibold text-white\">Cultural Holes</span>\n              </div>\n              <p className=\"text-xs text-slate-300\">\n                Identify discourse gaps and innovation opportunities\n              </p>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Features Grid */}\n      <div>\n        <h3 className=\"text-xl font-semibold text-slate-900 mb-4\">Research Tools</h3>\n        <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-3\">\n          {features.map((feature) => {\n            const Icon = feature.icon;\n            return (\n              <Link key={feature.name} href={feature.href}>\n                <Card className={`${feature.color} border-2 hover:shadow-lg transition-all cursor-pointer group`}>\n                  <CardHeader>\n                    <div className=\"flex items-start justify-between\">\n                      <div className=\"flex items-center gap-3\">\n                        <div className=\"p-2 bg-white rounded-lg\">\n                          <Icon className={`h-5 w-5 ${feature.iconColor}`} />\n                        </div>\n                        <CardTitle className=\"text-base\">{feature.name}</CardTitle>\n                      </div>\n                      {feature.badge && (\n                        <Badge className=\"bg-amber-500 text-white text-xs\">\n                          {feature.badge}\n                        </Badge>\n                      )}\n                    </div>\n                    <CardDescription className=\"text-sm mt-2\">\n                      {feature.description}\n                    </CardDescription>\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"flex items-center text-sm font-medium group-hover:translate-x-1 transition-transform\">\n                      Open tool\n                      <ArrowRight className=\"ml-2 h-4 w-4\" />\n                    </div>\n                  </CardContent>\n                </Card>\n              </Link>\n            );\n          })}\n        </div>\n      </div>\n\n      {/* Getting Started */}\n      <Card>\n        <CardHeader>\n          <CardTitle>Getting Started</CardTitle>\n          <CardDescription>\n            Follow these steps to begin your research\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <div className=\"space-y-3\">\n            <div className=\"flex items-start gap-3\">\n              <div className=\"flex h-6 w-6 shrink-0 items-center justify-center rounded-full bg-blue-100 text-blue-700 text-sm font-semibold\">\n                1\n              </div>\n              <div>\n                <p className=\"font-medium text-slate-900\">Upload Policy Documents</p>\n                <p className=\"text-sm text-slate-600\">\n                  Go to <Link href=\"/data\" className=\"text-blue-600 hover:underline\">Data Sources</Link> and upload PDF documents for analysis\n                </p>\n              </div>\n            </div>\n            <div className=\"flex items-start gap-3\">\n              <div className=\"flex h-6 w-6 shrink-0 items-center justify-center rounded-full bg-purple-100 text-purple-700 text-sm font-semibold\">\n                2\n              </div>\n              <div>\n                <p className=\"font-medium text-slate-900\">Analyze with AI</p>\n                <p className=\"text-sm text-slate-600\">\n                  Use the \"Analyze with AI\" button to extract insights through decolonial lenses\n                </p>\n              </div>\n            </div>\n            <div className=\"flex items-start gap-3\">\n              <div className=\"flex h-6 w-6 shrink-0 items-center justify-center rounded-full bg-teal-100 text-teal-700 text-sm font-semibold\">\n                3\n              </div>\n              <div>\n                <p className=\"font-medium text-slate-900\">Compare and Synthesize</p>\n                <p className=\"text-sm text-slate-600\">\n                  Use <Link href=\"/synthesis\" className=\"text-teal-600 hover:underline\">Synthesis</Link> to compare frameworks and map ecosystem impacts\n                </p>\n              </div>\n            </div>\n            <div className=\"flex items-start gap-3\">\n              <div className=\"flex h-6 w-6 shrink-0 items-center justify-center rounded-full bg-amber-100 text-amber-700 text-sm font-semibold\">\n                4\n              </div>\n              <div>\n                <p className=\"font-medium text-slate-900\">Detect Cultural Holes</p>\n                <p className=\"text-sm text-slate-600\">\n                  Use <Link href=\"/cultural\" className=\"text-amber-600 hover:underline\">Cultural Analysis</Link> to identify discourse gaps and innovation opportunities\n                </p>\n              </div>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\app\\reflexivity\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":21,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":21,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[871,874],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[871,874],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`fetchLogs` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\nC:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\app\\reflexivity\\page.tsx:31:9\n  29 |\n  30 |     useEffect(() => {\n> 31 |         fetchLogs();\n     |         ^^^^^^^^^ `fetchLogs` accessed before it is declared\n  32 |     }, []);\n  33 |\n  34 |     const fetchLogs = async () => {\n\nC:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\app\\reflexivity\\page.tsx:34:5\n  32 |     }, []);\n  33 |\n> 34 |     const fetchLogs = async () => {\n     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 35 |         try {\n     | ^^^^^^^^^^^^^\n> 36 |             const res = await fetch('/api/logs');\n     \n     | ^^^^^^^^^^^^^\n> 43 |         }\n     | ^^^^^^^^^^^^^\n> 44 |     };\n     | ^^^^^^^ `fetchLogs` is declared here\n  45 |\n  46 |     const handleSave = () => {\n  47 |         setSaveStatus(\"saving\");","line":31,"column":9,"nodeType":null,"endLine":31,"endColumn":18},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":129,"column":25,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[6346,6556],"text":"\r\n                        &quot;To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical' but 'decolonial'.\"  Walter Mignolo\r\n                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[6346,6556],"text":"\r\n                        &ldquo;To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical' but 'decolonial'.\"  Walter Mignolo\r\n                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[6346,6556],"text":"\r\n                        &#34;To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical' but 'decolonial'.\"  Walter Mignolo\r\n                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[6346,6556],"text":"\r\n                        &rdquo;To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical' but 'decolonial'.\"  Walter Mignolo\r\n                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":129,"column":141,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[6346,6556],"text":"\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just &apos;critical' but 'decolonial'.\"  Walter Mignolo\r\n                    "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[6346,6556],"text":"\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just &lsquo;critical' but 'decolonial'.\"  Walter Mignolo\r\n                    "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[6346,6556],"text":"\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just &#39;critical' but 'decolonial'.\"  Walter Mignolo\r\n                    "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[6346,6556],"text":"\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just &rsquo;critical' but 'decolonial'.\"  Walter Mignolo\r\n                    "},"desc":"Replace with `&rsquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":129,"column":150,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[6346,6556],"text":"\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical&apos; but 'decolonial'.\"  Walter Mignolo\r\n                    "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[6346,6556],"text":"\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical&lsquo; but 'decolonial'.\"  Walter Mignolo\r\n                    "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[6346,6556],"text":"\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical&#39; but 'decolonial'.\"  Walter Mignolo\r\n                    "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[6346,6556],"text":"\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical&rsquo; but 'decolonial'.\"  Walter Mignolo\r\n                    "},"desc":"Replace with `&rsquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":129,"column":156,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[6346,6556],"text":"\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical' but &apos;decolonial'.\"  Walter Mignolo\r\n                    "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[6346,6556],"text":"\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical' but &lsquo;decolonial'.\"  Walter Mignolo\r\n                    "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[6346,6556],"text":"\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical' but &#39;decolonial'.\"  Walter Mignolo\r\n                    "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[6346,6556],"text":"\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical' but &rsquo;decolonial'.\"  Walter Mignolo\r\n                    "},"desc":"Replace with `&rsquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":129,"column":167,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[6346,6556],"text":"\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical' but 'decolonial&apos;.\"  Walter Mignolo\r\n                    "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[6346,6556],"text":"\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical' but 'decolonial&lsquo;.\"  Walter Mignolo\r\n                    "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[6346,6556],"text":"\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical' but 'decolonial&#39;.\"  Walter Mignolo\r\n                    "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[6346,6556],"text":"\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical' but 'decolonial&rsquo;.\"  Walter Mignolo\r\n                    "},"desc":"Replace with `&rsquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":129,"column":169,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[6346,6556],"text":"\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical' but 'decolonial'.&quot;  Walter Mignolo\r\n                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[6346,6556],"text":"\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical' but 'decolonial'.&ldquo;  Walter Mignolo\r\n                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[6346,6556],"text":"\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical' but 'decolonial'.&#34;  Walter Mignolo\r\n                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[6346,6556],"text":"\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical' but 'decolonial'.&rdquo;  Walter Mignolo\r\n                    "},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":8,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport { useLocalStorage } from \"@/hooks/useLocalStorage\";\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Textarea } from \"@/components/ui/textarea\";\r\nimport { BookOpen, Save, UserCircle, History } from \"lucide-react\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\n\r\nconst GUIDING_QUESTIONS = [\r\n    \"How does my location in the Global North/South affect my reading of these texts?\",\r\n    \"What assumptions am I making about 'universal' AI ethics?\",\r\n    \"Whose voices are missing from the documents I am analyzing?\",\r\n    \"How does my own disciplinary background shape my interpretation of 'risk' and 'harm'?\",\r\n];\r\n\r\ninterface MethodLog {\r\n    id: string;\r\n    action: string;\r\n    details: any;\r\n    timestamp: string;\r\n}\r\n\r\nexport default function ReflexivityPage() {\r\n    const [journalEntry, setJournalEntry] = useLocalStorage(\"research-journal\", \"\");\r\n    const [saveStatus, setSaveStatus] = useState<\"saved\" | \"saving\" | null>(null);\r\n    const [logs, setLogs] = useState<MethodLog[]>([]);\r\n\r\n    useEffect(() => {\r\n        fetchLogs();\r\n    }, []);\r\n\r\n    const fetchLogs = async () => {\r\n        try {\r\n            const res = await fetch('/api/logs');\r\n            if (res.ok) {\r\n                const data = await res.json();\r\n                setLogs(data);\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Failed to fetch logs\", error);\r\n        }\r\n    };\r\n\r\n    const handleSave = () => {\r\n        setSaveStatus(\"saving\");\r\n        // The data is already saved via useLocalStorage, just show feedback\r\n        setTimeout(() => {\r\n            setSaveStatus(\"saved\");\r\n            setTimeout(() => setSaveStatus(null), 2000);\r\n        }, 300);\r\n    };\r\n\r\n    return (\r\n        <div className=\"space-y-8\">\r\n            <div>\r\n                <h2 className=\"text-3xl font-bold tracking-tight text-slate-900\">Reflexive Analysis</h2>\r\n                <p className=\"text-slate-500\">Documenting epistemic location and engaging with positionality.</p>\r\n            </div>\r\n\r\n            <div className=\"grid gap-6 md:grid-cols-2\">\r\n                <div className=\"space-y-6\">\r\n                    <Card>\r\n                        <CardHeader>\r\n                            <div className=\"flex items-center space-x-2\">\r\n                                <UserCircle className=\"h-5 w-5 text-slate-600\" />\r\n                                <CardTitle className=\"text-lg\">Guiding Questions</CardTitle>\r\n                            </div>\r\n                            <CardDescription>\r\n                                Prompts to consider during your analysis.\r\n                            </CardDescription>\r\n                        </CardHeader>\r\n                        <CardContent>\r\n                            <ul className=\"space-y-4\">\r\n                                {GUIDING_QUESTIONS.map((question, index) => (\r\n                                    <li key={index} className=\"flex items-start space-x-3 text-sm text-slate-700\">\r\n                                        <span className=\"flex h-6 w-6 shrink-0 items-center justify-center rounded-full bg-slate-100 text-xs font-medium text-slate-600\">\r\n                                            {index + 1}\r\n                                        </span>\r\n                                        <span className=\"pt-0.5\">{question}</span>\r\n                                    </li>\r\n                                ))}\r\n                            </ul>\r\n                        </CardContent>\r\n                    </Card>\r\n\r\n                    <Card>\r\n                        <CardHeader>\r\n                            <div className=\"flex items-center space-x-2\">\r\n                                <History className=\"h-5 w-5 text-slate-600\" />\r\n                                <CardTitle className=\"text-lg\">Methodological Log</CardTitle>\r\n                            </div>\r\n                            <CardDescription>\r\n                                Automated log of analysis actions and lenses applied.\r\n                            </CardDescription>\r\n                        </CardHeader>\r\n                        <CardContent>\r\n                            <div className=\"space-y-4 max-h-[400px] overflow-y-auto pr-2\">\r\n                                {logs.length === 0 ? (\r\n                                    <p className=\"text-sm text-slate-500 italic\">No actions logged yet.</p>\r\n                                ) : (\r\n                                    logs.map((log) => (\r\n                                        <div key={log.id} className=\"border-l-2 border-slate-200 pl-4 py-1\">\r\n                                            <div className=\"flex items-center justify-between mb-1\">\r\n                                                <span className=\"text-xs font-semibold text-slate-500\">\r\n                                                    {new Date(log.timestamp).toLocaleString()}\r\n                                                </span>\r\n                                                <Badge variant=\"outline\" className=\"text-xs\">\r\n                                                    {log.action}\r\n                                                </Badge>\r\n                                            </div>\r\n                                            <p className=\"text-sm text-slate-800 font-medium\">\r\n                                                {log.details.lens ? `Lens: ${log.details.lens}` : ''}\r\n                                            </p>\r\n                                            {log.details.sourceCount && (\r\n                                                <p className=\"text-xs text-slate-600\">\r\n                                                    Analyzed {log.details.sourceCount} sources\r\n                                                </p>\r\n                                            )}\r\n                                        </div>\r\n                                    ))\r\n                                )}\r\n                            </div>\r\n                        </CardContent>\r\n                    </Card>\r\n\r\n                    <div className=\"bg-slate-50 p-4 rounded-lg border border-slate-200 text-sm text-slate-600 italic\">\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical' but 'decolonial'.\"  Walter Mignolo\r\n                    </div>\r\n                </div>\r\n\r\n                <Card className=\"flex flex-col h-full\">\r\n                    <CardHeader>\r\n                        <div className=\"flex items-center space-x-2\">\r\n                            <BookOpen className=\"h-5 w-5 text-slate-600\" />\r\n                            <CardTitle className=\"text-lg\">Research Journal</CardTitle>\r\n                        </div>\r\n                        <CardDescription>\r\n                            Record your thoughts, biases, and shifts in perspective.\r\n                        </CardDescription>\r\n                    </CardHeader>\r\n                    <CardContent className=\"flex-1 flex flex-col space-y-4\">\r\n                        <Textarea\r\n                            placeholder=\"Start writing your reflections here...\"\r\n                            className=\"flex-1 min-h-[300px] resize-none p-4 leading-relaxed\"\r\n                            value={journalEntry}\r\n                            onChange={(e) => setJournalEntry(e.target.value)}\r\n                        />\r\n                        <div className=\"flex justify-end\">\r\n                            <Button\r\n                                onClick={handleSave}\r\n                                className=\"bg-slate-900 text-white hover:bg-slate-800\"\r\n                                disabled={saveStatus === \"saving\"}\r\n                            >\r\n                                <Save className=\"mr-2 h-4 w-4\" />\r\n                                {saveStatus === \"saving\" ? \"Saving...\" : saveStatus === \"saved\" ? \"Saved!\" : \"Save Entry\"}\r\n                            </Button>\r\n                        </div>\r\n                    </CardContent>\r\n                </Card>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\app\\resistance\\page.tsx","messages":[{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":263,"column":77,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[13124,13289],"text":"\r\n                                    No traces found. Go to Data page to add &quot;Empirical Trace\" sources or use \"Search for Traces\".\r\n                                "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[13124,13289],"text":"\r\n                                    No traces found. Go to Data page to add &ldquo;Empirical Trace\" sources or use \"Search for Traces\".\r\n                                "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[13124,13289],"text":"\r\n                                    No traces found. Go to Data page to add &#34;Empirical Trace\" sources or use \"Search for Traces\".\r\n                                "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[13124,13289],"text":"\r\n                                    No traces found. Go to Data page to add &rdquo;Empirical Trace\" sources or use \"Search for Traces\".\r\n                                "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":263,"column":93,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[13124,13289],"text":"\r\n                                    No traces found. Go to Data page to add \"Empirical Trace&quot; sources or use \"Search for Traces\".\r\n                                "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[13124,13289],"text":"\r\n                                    No traces found. Go to Data page to add \"Empirical Trace&ldquo; sources or use \"Search for Traces\".\r\n                                "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[13124,13289],"text":"\r\n                                    No traces found. Go to Data page to add \"Empirical Trace&#34; sources or use \"Search for Traces\".\r\n                                "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[13124,13289],"text":"\r\n                                    No traces found. Go to Data page to add \"Empirical Trace&rdquo; sources or use \"Search for Traces\".\r\n                                "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":263,"column":110,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[13124,13289],"text":"\r\n                                    No traces found. Go to Data page to add \"Empirical Trace\" sources or use &quot;Search for Traces\".\r\n                                "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[13124,13289],"text":"\r\n                                    No traces found. Go to Data page to add \"Empirical Trace\" sources or use &ldquo;Search for Traces\".\r\n                                "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[13124,13289],"text":"\r\n                                    No traces found. Go to Data page to add \"Empirical Trace\" sources or use &#34;Search for Traces\".\r\n                                "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[13124,13289],"text":"\r\n                                    No traces found. Go to Data page to add \"Empirical Trace\" sources or use &rdquo;Search for Traces\".\r\n                                "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":263,"column":128,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[13124,13289],"text":"\r\n                                    No traces found. Go to Data page to add \"Empirical Trace\" sources or use \"Search for Traces&quot;.\r\n                                "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[13124,13289],"text":"\r\n                                    No traces found. Go to Data page to add \"Empirical Trace\" sources or use \"Search for Traces&ldquo;.\r\n                                "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[13124,13289],"text":"\r\n                                    No traces found. Go to Data page to add \"Empirical Trace\" sources or use \"Search for Traces&#34;.\r\n                                "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[13124,13289],"text":"\r\n                                    No traces found. Go to Data page to add \"Empirical Trace\" sources or use \"Search for Traces&rdquo;.\r\n                                "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":343,"column":53,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[18671,18726],"text":"\r\n                                                    &quot;"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[18671,18726],"text":"\r\n                                                    &ldquo;"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[18671,18726],"text":"\r\n                                                    &#34;"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[18671,18726],"text":"\r\n                                                    &rdquo;"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":343,"column":86,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[18758,18809],"text":"&quot;\r\n                                                "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[18758,18809],"text":"&ldquo;\r\n                                                "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[18758,18809],"text":"&#34;\r\n                                                "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[18758,18809],"text":"&rdquo;\r\n                                                "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":356,"column":55,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[19557,19628],"text":"Select &quot;Analyze Trace\" to identify resistance strategies using the LLM."},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[19557,19628],"text":"Select &ldquo;Analyze Trace\" to identify resistance strategies using the LLM."},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[19557,19628],"text":"Select &#34;Analyze Trace\" to identify resistance strategies using the LLM."},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[19557,19628],"text":"Select &rdquo;Analyze Trace\" to identify resistance strategies using the LLM."},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":356,"column":69,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[19557,19628],"text":"Select \"Analyze Trace&quot; to identify resistance strategies using the LLM."},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[19557,19628],"text":"Select \"Analyze Trace&ldquo; to identify resistance strategies using the LLM."},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[19557,19628],"text":"Select \"Analyze Trace&#34; to identify resistance strategies using the LLM."},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[19557,19628],"text":"Select \"Analyze Trace&rdquo; to identify resistance strategies using the LLM."},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":8,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState } from \"react\";\r\nimport { useSources } from \"@/hooks/useSources\";\r\nimport { Source } from \"@/types\";\r\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Zap, EyeOff, Activity, Wrench, Users, Play, Loader2, Quote, Search, Trash } from \"lucide-react\";\r\nimport {\r\n    Dialog,\r\n    DialogContent,\r\n    DialogDescription,\r\n    DialogFooter,\r\n    DialogHeader,\r\n    DialogTitle,\r\n    DialogTrigger,\r\n} from \"@/components/ui/dialog\";\r\n\r\nconst STRATEGY_DEFINITIONS = [\r\n    { title: \"Gambiarra\", icon: Wrench, color: \"text-orange-600\", bg: \"bg-orange-100\" },\r\n    { title: \"Obfuscation\", icon: EyeOff, color: \"text-slate-600\", bg: \"bg-slate-100\" },\r\n    { title: \"Solidarity\", icon: Users, color: \"text-green-600\", bg: \"bg-green-100\" },\r\n    { title: \"Refusal\", icon: Zap, color: \"text-red-600\", bg: \"bg-red-100\" },\r\n];\r\n\r\nexport default function ResistancePage() {\r\n    const { sources, addSource, updateSource, deleteSource, isLoading } = useSources();\r\n    const [selectedTraceId, setSelectedTraceId] = useState<string | null>(null);\r\n    const [isAnalyzing, setIsAnalyzing] = useState(false);\r\n\r\n    // Filter for sources that are explicitly marked as 'Trace' or have text content\r\n    const traces = sources.filter(s => s.type === 'Trace' || (s.type === 'Text' && s.extractedText));\r\n\r\n    const handleAnalyzeTrace = async (trace: Source) => {\r\n        if (!trace.extractedText) return;\r\n\r\n        setIsAnalyzing(true);\r\n        try {\r\n            const response = await fetch('/api/analyze', {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({\r\n                    text: trace.extractedText.substring(0, 3000),\r\n                    sourceType: 'Empirical Trace',\r\n                    analysisMode: 'resistance'\r\n                })\r\n            });\r\n\r\n            const result = await response.json();\r\n            if (result.success) {\r\n                await updateSource(trace.id, { resistance_analysis: result.analysis });\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Analysis failed\", error);\r\n            alert(\"Failed to analyze trace.\");\r\n        } finally {\r\n            setIsAnalyzing(false);\r\n        }\r\n    };\r\n\r\n    const selectedTrace = traces.find(t => t.id === selectedTraceId);\r\n    const currentAnalysis = selectedTrace?.resistance_analysis;\r\n\r\n    const [isSearching, setIsSearching] = useState(false);\r\n    const [isSearchDialogOpen, setIsSearchDialogOpen] = useState(false);\r\n    const [searchSource, setSearchSource] = useState<Source | null>(null);\r\n    const [customQuery, setCustomQuery] = useState(\"\");\r\n    const [selectedPlatforms, setSelectedPlatforms] = useState<string[]>([\"reddit\", \"hackernews\", \"forums\"]);\r\n\r\n    const handleSearchTraces = async () => {\r\n        // Need either a policy source or custom query\r\n        if (!searchSource?.extractedText && !customQuery.trim()) {\r\n            alert(\"Please select a policy or enter a custom search query.\");\r\n            return;\r\n        }\r\n\r\n        setIsSearching(true);\r\n        try {\r\n            const response = await fetch('/api/search-traces', {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({\r\n                    policyText: searchSource?.extractedText?.substring(0, 3000),\r\n                    customQuery: customQuery.trim() || undefined,\r\n                    platforms: selectedPlatforms\r\n                })\r\n            });\r\n\r\n            const result = await response.json();\r\n            if (result.success && Array.isArray(result.traces)) {\r\n                const newTraces = result.traces.map((trace: { title: string; description: string; query: string; content: string; sourceUrl: string }) => ({\r\n                    id: Math.random().toString(36).substr(2, 9),\r\n                    title: `[Web] ${trace.title}`,\r\n                    description: `${trace.description}  Query: \"${trace.query}\"`,\r\n                    type: \"Trace\",\r\n                    extractedText: `${trace.content}\\n\\nSource: ${trace.sourceUrl}`,\r\n                    addedDate: new Date().toLocaleDateString(\"en-US\", { month: \"short\", day: \"numeric\", year: \"numeric\" }),\r\n                    status: \"Active Case\",\r\n                    colorClass: \"bg-blue-100\",\r\n                    iconClass: \"text-blue-600\"\r\n                }));\r\n\r\n                // Add each new trace to the store\r\n                for (const trace of newTraces) {\r\n                    await addSource(trace);\r\n                }\r\n\r\n                alert(`Found ${newTraces.length} resistance traces from the web!`);\r\n                setCustomQuery(\"\"); // Reset query\r\n            } else {\r\n                alert(\"Search failed: \" + (result.error || \"Unknown error\"));\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Search error:\", error);\r\n            alert(\"Failed to search for traces. Make sure your Google Search API is configured.\");\r\n        } finally {\r\n            setIsSearching(false);\r\n            setIsSearchDialogOpen(false);\r\n        }\r\n    };\r\n\r\n    const handleDeleteTrace = async (traceId: string) => {\r\n        if (confirm(`Are you sure you want to delete this trace?`)) {\r\n            await deleteSource(traceId);\r\n            if (selectedTraceId === traceId) {\r\n                setSelectedTraceId(null);\r\n            }\r\n        }\r\n    };\r\n\r\n    if (isLoading) {\r\n        return (\r\n            <div className=\"flex items-center justify-center h-64\">\r\n                <Loader2 className=\"h-8 w-8 animate-spin text-slate-400\" />\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"space-y-8\">\r\n            <div className=\"flex items-center justify-between\">\r\n                <div>\r\n                    <h2 className=\"text-3xl font-bold tracking-tight text-slate-900\">Micro-Resistance Grounding</h2>\r\n                    <p className=\"text-slate-500\">Analyze empirical traces (forum posts, comments) to identify real-world resistance strategies.</p>\r\n                </div>\r\n                <Dialog open={isSearchDialogOpen} onOpenChange={setIsSearchDialogOpen}>\r\n                    <DialogTrigger asChild>\r\n                        <Button className=\"bg-blue-600 text-white hover:bg-blue-700\">\r\n                            <Search className=\"mr-2 h-4 w-4\" /> Search for Traces\r\n                        </Button>\r\n                    </DialogTrigger>\r\n                    <DialogContent className=\"sm:max-w-[600px]\">\r\n                        <DialogHeader>\r\n                            <DialogTitle>Search Web for Resistance Traces</DialogTitle>\r\n                            <DialogDescription>\r\n                                Find real forum posts, Reddit threads, and discussions about resistance to AI policies.\r\n                            </DialogDescription>\r\n                        </DialogHeader>\r\n                        <div className=\"space-y-4 py-4\">\r\n                            <div>\r\n                                <label className=\"text-sm font-medium text-slate-700 mb-2 block\">\r\n                                    Auto-extract from Policy (Optional)\r\n                                </label>\r\n                                <select\r\n                                    className=\"w-full p-2 border rounded-md text-sm\"\r\n                                    onChange={(e) => {\r\n                                        const source = sources.find(s => s.id === e.target.value);\r\n                                        setSearchSource(source || null);\r\n                                    }}\r\n                                >\r\n                                    <option value=\"\">Select Policy...</option>\r\n                                    {sources.filter(s => s.type === 'PDF').map(s => (\r\n                                        <option key={s.id} value={s.id}>{s.title}</option>\r\n                                    ))}\r\n                                </select>\r\n                                <p className=\"text-xs text-slate-500 mt-1\">AI will extract key terms to search for</p>\r\n                            </div>\r\n\r\n                            <div className=\"relative\">\r\n                                <div className=\"absolute inset-0 flex items-center\">\r\n                                    <span className=\"w-full border-t\" />\r\n                                </div>\r\n                                <div className=\"relative flex justify-center text-xs uppercase\">\r\n                                    <span className=\"bg-white px-2 text-slate-500\">Or</span>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div>\r\n                                <label className=\"text-sm font-medium text-slate-700 mb-2 block\">\r\n                                    Custom Search Query\r\n                                </label>\r\n                                <Input\r\n                                    placeholder='e.g., \"uber drivers algorithm resistance\"'\r\n                                    value={customQuery}\r\n                                    onChange={(e) => setCustomQuery(e.target.value)}\r\n                                />\r\n                            </div>\r\n\r\n                            <div>\r\n                                <label className=\"text-sm font-medium text-slate-700 mb-2 block\">\r\n                                    Search Platforms\r\n                                </label>\r\n                                <div className=\"flex gap-2\">\r\n                                    {[\r\n                                        { id: 'reddit', label: 'Reddit' },\r\n                                        { id: 'hackernews', label: 'Hacker News' },\r\n                                        { id: 'forums', label: 'Forums' }\r\n                                    ].map(platform => (\r\n                                        <label key={platform.id} className=\"flex items-center gap-2 cursor-pointer\">\r\n                                            <input\r\n                                                type=\"checkbox\"\r\n                                                checked={selectedPlatforms.includes(platform.id)}\r\n                                                onChange={(e) => {\r\n                                                    if (e.target.checked) {\r\n                                                        setSelectedPlatforms([...selectedPlatforms, platform.id]);\r\n                                                    } else {\r\n                                                        setSelectedPlatforms(selectedPlatforms.filter(p => p !== platform.id));\r\n                                                    }\r\n                                                }}\r\n                                                className=\"rounded\"\r\n                                            />\r\n                                            <span className=\"text-sm\">{platform.label}</span>\r\n                                        </label>\r\n                                    ))}\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <DialogFooter>\r\n                            <Button\r\n                                onClick={handleSearchTraces}\r\n                                disabled={(!searchSource && !customQuery.trim()) || isSearching}\r\n                                className=\"bg-blue-600 hover:bg-blue-700\"\r\n                            >\r\n                                {isSearching ? (\r\n                                    <>\r\n                                        <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\r\n                                        Searching Web...\r\n                                    </>\r\n                                ) : (\r\n                                    <>\r\n                                        <Search className=\"mr-2 h-4 w-4\" />\r\n                                        Search\r\n                                    </>\r\n                                )}\r\n                            </Button>\r\n                        </DialogFooter>\r\n                    </DialogContent>\r\n                </Dialog>\r\n            </div>\r\n\r\n            <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\r\n                {/* Left Column: Trace Selector */}\r\n                <div className=\"space-y-4\">\r\n                    <h3 className=\"font-semibold text-slate-900 flex items-center\">\r\n                        <Activity className=\"mr-2 h-4 w-4\" /> Available Traces\r\n                    </h3>\r\n                    <div className=\"space-y-2\">\r\n                        {traces.length === 0 && (\r\n                            <Card className=\"bg-slate-50 border-dashed\">\r\n                                <CardContent className=\"p-4 text-center text-sm text-slate-500\">\r\n                                    No traces found. Go to Data page to add \"Empirical Trace\" sources or use \"Search for Traces\".\r\n                                </CardContent>\r\n                            </Card>\r\n                        )}\r\n                        {traces.map(trace => (\r\n                            <Card\r\n                                key={trace.id}\r\n                                className={`transition-all hover:border-purple-400 ${selectedTraceId === trace.id ? 'border-purple-600 ring-1 ring-purple-600' : ''}`}\r\n                            >\r\n                                <CardContent className=\"p-4\">\r\n                                    <div className=\"flex items-start justify-between gap-2\">\r\n                                        <div\r\n                                            className=\"flex-1 min-w-0 pr-2 cursor-pointer\"\r\n                                            onClick={() => setSelectedTraceId(trace.id)}\r\n                                        >\r\n                                            <div className=\"font-medium text-slate-900 break-words\">{trace.title}</div>\r\n                                            <div className=\"text-xs text-slate-500 mt-1 break-words\">{trace.description}</div>\r\n                                            {trace.resistance_analysis && (\r\n                                                <Badge variant=\"secondary\" className=\"mt-2 bg-green-100 text-green-700\">\r\n                                                    Analyzed\r\n                                                </Badge>\r\n                                            )}\r\n                                        </div>\r\n                                        <Button\r\n                                            variant=\"ghost\"\r\n                                            size=\"sm\"\r\n                                            className=\"shrink-0 h-8 w-8 p-0 hover:bg-red-100 hover:text-red-600\"\r\n                                            onClick={(e) => {\r\n                                                e.stopPropagation();\r\n                                                handleDeleteTrace(trace.id);\r\n                                            }}\r\n                                        >\r\n                                            <Trash className=\"h-4 w-4\" />\r\n                                        </Button>\r\n                                    </div>\r\n                                </CardContent>\r\n                            </Card>\r\n                        ))}\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Middle Column: Analysis Area */}\r\n                <div className=\"lg:col-span-2 space-y-6\">\r\n                    {selectedTrace ? (\r\n                        <div className=\"space-y-6\">\r\n                            <Card>\r\n                                <CardHeader>\r\n                                    <CardTitle className=\"flex justify-between items-center\">\r\n                                        <span>Analysis: {selectedTrace.title}</span>\r\n                                        {!currentAnalysis && (\r\n                                            <Button\r\n                                                onClick={() => handleAnalyzeTrace(selectedTrace)}\r\n                                                disabled={isAnalyzing}\r\n                                                className=\"bg-purple-600 hover:bg-purple-700\"\r\n                                            >\r\n                                                {isAnalyzing ? <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" /> : <Play className=\"mr-2 h-4 w-4\" />}\r\n                                                Analyze Trace\r\n                                            </Button>\r\n                                        )}\r\n                                    </CardTitle>\r\n                                </CardHeader>\r\n                                <CardContent>\r\n                                    {currentAnalysis ? (\r\n                                        <div className=\"space-y-6\">\r\n                                            <div className=\"flex items-center space-x-4\">\r\n                                                <div className=\"p-3 bg-purple-100 rounded-full\">\r\n                                                    <Zap className=\"h-6 w-6 text-purple-600\" />\r\n                                                </div>\r\n                                                <div>\r\n                                                    <div className=\"text-sm text-slate-500 uppercase tracking-wider font-bold\">Strategy Detected</div>\r\n                                                    <div className=\"text-2xl font-bold text-slate-900\">{currentAnalysis.strategy_detected}</div>\r\n                                                </div>\r\n                                                <Badge className={currentAnalysis.confidence === 'High' ? 'bg-green-100 text-green-800' : 'bg-yellow-100 text-yellow-800'}>\r\n                                                    {currentAnalysis.confidence} Confidence\r\n                                                </Badge>\r\n                                            </div>\r\n\r\n                                            <div className=\"bg-slate-50 p-4 rounded-lg border border-slate-200 relative\">\r\n                                                <Quote className=\"absolute top-2 left-2 h-8 w-8 text-slate-200 -z-0\" />\r\n                                                <p className=\"text-slate-700 italic relative z-10 pl-6\">\r\n                                                    \"{currentAnalysis.evidence_quote}\"\r\n                                                </p>\r\n                                            </div>\r\n\r\n                                            <div>\r\n                                                <h4 className=\"font-semibold text-slate-900 mb-2\">Interpretation</h4>\r\n                                                <p className=\"text-slate-600 leading-relaxed\">\r\n                                                    {currentAnalysis.interpretation}\r\n                                                </p>\r\n                                            </div>\r\n                                        </div>\r\n                                    ) : (\r\n                                        <div className=\"text-center py-12 text-slate-500\">\r\n                                            <p>Select \"Analyze Trace\" to identify resistance strategies using the LLM.</p>\r\n                                        </div>\r\n                                    )}\r\n                                </CardContent>\r\n                            </Card>\r\n\r\n                            {/* Reference Definitions */}\r\n                            <div className=\"grid grid-cols-2 gap-4\">\r\n                                {STRATEGY_DEFINITIONS.map(def => (\r\n                                    <div key={def.title} className=\"flex items-center space-x-3 p-3 bg-white rounded-lg border border-slate-100 shadow-sm\">\r\n                                        <div className={`p-2 rounded-full ${def.bg}`}>\r\n                                            <def.icon className={`h-4 w-4 ${def.color}`} />\r\n                                        </div>\r\n                                        <span className=\"font-medium text-slate-700\">{def.title}</span>\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n                    ) : (\r\n                        <div className=\"flex flex-col items-center justify-center h-64 bg-slate-50 rounded-lg border-2 border-dashed border-slate-200\">\r\n                            <Activity className=\"h-10 w-10 text-slate-300 mb-4\" />\r\n                            <p className=\"text-slate-500\">Select a trace from the left to begin analysis</p>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\app\\synthesis\\page.tsx","messages":[{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":497,"column":103,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[29042,29197],"text":" To see AI-generated synthesis results, use the &quot;AI-Powered Framework Comparison\" tool above to compare two policy documents.\r\n                            "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[29042,29197],"text":" To see AI-generated synthesis results, use the &ldquo;AI-Powered Framework Comparison\" tool above to compare two policy documents.\r\n                            "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[29042,29197],"text":" To see AI-generated synthesis results, use the &#34;AI-Powered Framework Comparison\" tool above to compare two policy documents.\r\n                            "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[29042,29197],"text":" To see AI-generated synthesis results, use the &rdquo;AI-Powered Framework Comparison\" tool above to compare two policy documents.\r\n                            "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":497,"column":135,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[29042,29197],"text":" To see AI-generated synthesis results, use the \"AI-Powered Framework Comparison&quot; tool above to compare two policy documents.\r\n                            "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[29042,29197],"text":" To see AI-generated synthesis results, use the \"AI-Powered Framework Comparison&ldquo; tool above to compare two policy documents.\r\n                            "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[29042,29197],"text":" To see AI-generated synthesis results, use the \"AI-Powered Framework Comparison&#34; tool above to compare two policy documents.\r\n                            "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[29042,29197],"text":" To see AI-generated synthesis results, use the \"AI-Powered Framework Comparison&rdquo; tool above to compare two policy documents.\r\n                            "},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState } from \"react\";\r\nimport { useSources } from \"@/hooks/useSources\";\r\nimport { Source } from \"@/types\";\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { GitMerge, GitPullRequest, AlertCircle, FileDown, CheckCircle2, Sparkles, Brain, Network, Loader2 } from \"lucide-react\";\r\nimport { generateSynthesisPDF } from \"@/utils/generateSynthesisPDF\";\r\nimport { AssemblageSankey } from \"@/components/AssemblageSankey\";\r\n\r\ninterface ComparisonResult {\r\n    risk: { convergence: string; divergence: string; coloniality: string; resistance: string };\r\n    governance: { convergence: string; divergence: string; coloniality: string; resistance: string };\r\n    rights: { convergence: string; divergence: string; coloniality: string; resistance: string };\r\n    scope: { convergence: string; divergence: string; coloniality: string; resistance: string };\r\n}\r\n\r\nimport { EcosystemImpact } from \"@/types\";\r\n\r\nconst SYNTHESIS_FINDINGS = [\r\n    {\r\n        key: \"risk\",\r\n        dimension: \"Risk Classification\",\r\n        convergence: \"Comparison of risk definitions and tiered obligations across frameworks.\",\r\n        divergence: \"Analysis of how risk categories are adapted to local social and political contexts.\",\r\n        coloniality: \"Examination of whether risk models reflect Global North assumptions or local realities.\",\r\n        resistance: \"Identification of mechanisms that allow for local adaptation of risk frameworks.\",\r\n        icon: AlertCircle,\r\n    },\r\n    {\r\n        key: \"governance\",\r\n        dimension: \"Governance Structure\",\r\n        convergence: \"Comparison of institutional designs (e.g., centralized vs. networked authorities).\",\r\n        divergence: \"Analysis of enforcement powers and coordination mechanisms.\",\r\n        coloniality: \"Assessment of whether governance models assume state capacities that may not exist.\",\r\n        resistance: \"Highlighting of innovative governance structures that leverage local expertise.\",\r\n        icon: GitMerge,\r\n    },\r\n    {\r\n        key: \"rights\",\r\n        dimension: \"Rights Framework\",\r\n        convergence: \"Comparison of individual rights (e.g., explanation, redress) and collective protections.\",\r\n        divergence: \"Analysis of the balance between procedural compliance and substantive rights.\",\r\n        coloniality: \"Examination of whether rights frameworks obscure underlying power asymmetries.\",\r\n        resistance: \"Identification of rights-based approaches that empower affected communities.\",\r\n        icon: CheckCircle2,\r\n    },\r\n    {\r\n        key: \"scope\",\r\n        dimension: \"Territorial Scope\",\r\n        convergence: \"Comparison of jurisdictional reach and extraterritorial application.\",\r\n        divergence: \"Analysis of data sovereignty claims and market power dynamics.\",\r\n        coloniality: \"Assessment of the 'Brussels Effect' and the imposition of external legal norms.\",\r\n        resistance: \"Highlighting of assertions of epistemic and legal autonomy.\",\r\n        icon: GitPullRequest,\r\n    },\r\n];\r\n\r\nexport default function SynthesisPage() {\r\n    const { sources, isLoading } = useSources();\r\n    const [isExporting, setIsExporting] = useState(false);\r\n\r\n    // Comparison State\r\n    const [sourceA, setSourceA] = useState<Source | null>(null);\r\n    const [sourceB, setSourceB] = useState<Source | null>(null);\r\n    const [isComparing, setIsComparing] = useState(false);\r\n    const [comparisonResult, setComparisonResult] = useState<ComparisonResult | null>(null);\r\n\r\n    // Ecosystem State\r\n    const [ecosystemSource, setEcosystemSource] = useState<Source | null>(null);\r\n    const [isMapping, setIsMapping] = useState(false);\r\n    const [ecosystemImpacts, setEcosystemImpacts] = useState<EcosystemImpact[]>([]);\r\n    const [interconnectionFilter, setInterconnectionFilter] = useState<\"All\" | \"Material\" | \"Discursive\" | \"Hybrid\">(\"All\");\r\n    const [viewMode, setViewMode] = useState<\"list\" | \"graph\">(\"list\");\r\n\r\n    // Filter sources that have text available for analysis\r\n    const analyzedSources = sources.filter(s => s.analysis || s.extractedText);\r\n\r\n    const handleExport = () => {\r\n        setIsExporting(true);\r\n        try {\r\n            generateSynthesisPDF(SYNTHESIS_FINDINGS);\r\n        } catch (error) {\r\n            console.error(\"Error generating PDF:\", error);\r\n            alert(\"Failed to generate PDF. Please try again.\");\r\n        } finally {\r\n            setTimeout(() => setIsExporting(false), 1000);\r\n        }\r\n    };\r\n\r\n    const handleCompare = async () => {\r\n        if (!sourceA || !sourceB) return;\r\n\r\n        setIsComparing(true);\r\n        try {\r\n            const response = await fetch('/api/analyze', {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({\r\n                    analysisMode: 'comparison',\r\n                    sourceA: { title: sourceA.title, text: sourceA.extractedText?.substring(0, 3000) || '' },\r\n                    sourceB: { title: sourceB.title, text: sourceB.extractedText?.substring(0, 3000) || '' }\r\n                })\r\n            });\r\n\r\n            const data = await response.json();\r\n            if (data.success && data.analysis) {\r\n                setComparisonResult(data.analysis);\r\n            } else {\r\n                alert(\"Comparison failed: \" + (data.error || \"Unknown error\"));\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Comparison error:\", error);\r\n            alert(\"Failed to generate comparison.\");\r\n        } finally {\r\n            setIsComparing(false);\r\n        }\r\n    };\r\n\r\n    const handleEcosystemMap = async () => {\r\n        if (!ecosystemSource) return;\r\n\r\n        setIsMapping(true);\r\n        try {\r\n            const response = await fetch('/api/analyze', {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({\r\n                    text: ecosystemSource.extractedText?.substring(0, 3000) || '',\r\n                    sourceType: 'Policy Document',\r\n                    analysisMode: 'ecosystem'\r\n                })\r\n            });\r\n\r\n            const data = await response.json();\r\n            if (data.success && Array.isArray(data.analysis)) {\r\n                setEcosystemImpacts(data.analysis);\r\n            } else {\r\n                alert(\"Mapping failed: \" + (data.error || \"Unknown error\"));\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Mapping error:\", error);\r\n            alert(\"Failed to generate ecosystem map.\");\r\n        } finally {\r\n            setIsMapping(false);\r\n        }\r\n    };\r\n\r\n    if (isLoading) {\r\n        return (\r\n            <div className=\"flex items-center justify-center h-64\">\r\n                <Loader2 className=\"h-8 w-8 animate-spin text-slate-400\" />\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"space-y-8\">\r\n            <div className=\"flex items-center justify-between\">\r\n                <div>\r\n                    <h2 className=\"text-3xl font-bold tracking-tight text-slate-900\">Cross-Case Synthesis</h2>\r\n                    <p className=\"text-slate-500\">Comparative analysis of AI governance frameworks using the Decolonial Situatedness Framework.</p>\r\n                </div>\r\n                <Button\r\n                    onClick={handleExport}\r\n                    className=\"bg-slate-900 text-white hover:bg-slate-800\"\r\n                    disabled={isExporting}\r\n                >\r\n                    <FileDown className=\"mr-2 h-4 w-4\" />\r\n                    {isExporting ? \"Generating PDF...\" : \"Export Report\"}\r\n                </Button>\r\n            </div>\r\n\r\n            <Card className=\"bg-gradient-to-br from-slate-50 to-blue-50 border-slate-200\">\r\n                <CardHeader>\r\n                    <CardTitle>Executive Summary</CardTitle>\r\n                    <CardDescription>Key insights from the comparative analysis</CardDescription>\r\n                </CardHeader>\r\n                <CardContent className=\"space-y-3 text-sm text-slate-700 leading-relaxed\">\r\n                    <p>\r\n                        This synthesis compares AI governance frameworks to identify patterns of convergence, divergence, and coloniality. By applying the Decolonial Situatedness Framework, we analyze how different jurisdictions approach risk, governance, rights, and territorial scope.\r\n                    </p>\r\n                    <p>\r\n                        <strong>Convergence:</strong> Identification of shared regulatory mechanisms, definitions, and risk classifications across frameworks.\r\n                    </p>\r\n                    <p>\r\n                        <strong>Divergence:</strong> Analysis of distinct approaches to enforcement, rights protections, and institutional design that reflect local contexts.\r\n                    </p>\r\n                    <p>\r\n                        <strong>Colonial Patterns:</strong> Examination of potential legal transplants, extraterritorial effects, and the imposition of Global North epistemologies.\r\n                    </p>\r\n                    <p>\r\n                        <strong>Decolonial Potential:</strong> Highlighting opportunities for epistemic autonomy, local adaptation, and resistance to hegemonic norms.\r\n                    </p>\r\n                </CardContent>\r\n            </Card>\r\n\r\n            {/* AI-Powered Comparison */}\r\n            {analyzedSources.length >= 2 && (\r\n                <Card className=\"border-purple-200\">\r\n                    <CardHeader>\r\n                        <div className=\"flex items-center gap-2\">\r\n                            <Brain className=\"h-5 w-5 text-purple-600\" />\r\n                            <CardTitle>AI-Powered Framework Comparison</CardTitle>\r\n                        </div>\r\n                        <CardDescription>\r\n                            Compare two policy documents to identify convergence, divergence, and colonial patterns\r\n                        </CardDescription>\r\n                    </CardHeader>\r\n                    <CardContent className=\"space-y-4\">\r\n                        <div className=\"grid grid-cols-2 gap-4\">\r\n                            <div className=\"space-y-2\">\r\n                                <label className=\"text-sm font-medium text-slate-700\">Source A</label>\r\n                                <select\r\n                                    className=\"w-full p-2 border rounded-md text-sm\"\r\n                                    onChange={(e) => {\r\n                                        const source = analyzedSources.find(s => s.id === e.target.value);\r\n                                        setSourceA(source || null);\r\n                                    }}\r\n                                >\r\n                                    <option value=\"\">Select first document...</option>\r\n                                    {analyzedSources.map(s => (\r\n                                        <option key={s.id} value={s.id}>{s.title}</option>\r\n                                    ))}\r\n                                </select>\r\n                            </div>\r\n                            <div className=\"space-y-2\">\r\n                                <label className=\"text-sm font-medium text-slate-700\">Source B</label>\r\n                                <select\r\n                                    className=\"w-full p-2 border rounded-md text-sm\"\r\n                                    onChange={(e) => {\r\n                                        const source = analyzedSources.find(s => s.id === e.target.value);\r\n                                        setSourceB(source || null);\r\n                                    }}\r\n                                >\r\n                                    <option value=\"\">Select second document...</option>\r\n                                    {analyzedSources.map(s => (\r\n                                        <option key={s.id} value={s.id}>{s.title}</option>\r\n                                    ))}\r\n                                </select>\r\n                            </div>\r\n                        </div>\r\n                        <Button\r\n                            className=\"w-full bg-purple-600 text-white hover:bg-purple-700\"\r\n                            onClick={handleCompare}\r\n                            disabled={!sourceA || !sourceB || isComparing}\r\n                        >\r\n                            {isComparing ? (\r\n                                <>\r\n                                    <Sparkles className=\"mr-2 h-4 w-4 animate-spin\" />\r\n                                    Comparing...\r\n                                </>\r\n                            ) : (\r\n                                <>\r\n                                    <GitMerge className=\"mr-2 h-4 w-4\" />\r\n                                    Compare Frameworks\r\n                                </>\r\n                            )}\r\n                        </Button>\r\n\r\n                        {comparisonResult && (\r\n                            <div className=\"mt-4 space-y-3 pt-4 border-t\">\r\n                                <h4 className=\"font-semibold text-slate-900\">Comparison Results</h4>\r\n                                {Object.entries(comparisonResult).map(([key, value]) => (\r\n                                    <div key={key} className=\"space-y-2\">\r\n                                        <p className=\"text-sm font-medium text-slate-700 capitalize\">{key}</p>\r\n                                        <div className=\"grid grid-cols-2 gap-2 text-xs\">\r\n                                            <div className=\"p-2 bg-green-50 rounded border border-green-200\">\r\n                                                <span className=\"font-semibold text-green-700\">Convergence:</span>\r\n                                                <p className=\"text-slate-600 mt-1\">{value.convergence}</p>\r\n                                            </div>\r\n                                            <div className=\"p-2 bg-blue-50 rounded border border-blue-200\">\r\n                                                <span className=\"font-semibold text-blue-700\">Divergence:</span>\r\n                                                <p className=\"text-slate-600 mt-1\">{value.divergence}</p>\r\n                                            </div>\r\n                                            <div className=\"p-2 bg-red-50 rounded border border-red-200\">\r\n                                                <span className=\"font-semibold text-red-700\">Coloniality:</span>\r\n                                                <p className=\"text-slate-600 mt-1\">{value.coloniality}</p>\r\n                                            </div>\r\n                                            <div className=\"p-2 bg-purple-50 rounded border border-purple-200\">\r\n                                                <span className=\"font-semibold text-purple-700\">Resistance:</span>\r\n                                                <p className=\"text-slate-600 mt-1\">{value.resistance}</p>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n                        )}\r\n                    </CardContent>\r\n                </Card>\r\n            )}\r\n\r\n            {/* Ecosystem Impact Mapping */}\r\n            {analyzedSources.length > 0 && (\r\n                <Card className=\"border-teal-200\">\r\n                    <CardHeader>\r\n                        <div className=\"flex items-center gap-2\">\r\n                            <Network className=\"h-5 w-5 text-teal-600\" />\r\n                            <CardTitle>Ecosystem Impact Mapping</CardTitle>\r\n                        </div>\r\n                        <CardDescription>\r\n                            Map how policy mechanisms constrain or afford possibilities for ecosystem actors\r\n                        </CardDescription>\r\n                    </CardHeader>\r\n                    <CardContent className=\"space-y-4\">\r\n                        <div className=\"flex gap-4 items-end\">\r\n                            <div className=\"flex-1 space-y-2\">\r\n                                <label className=\"text-sm font-medium text-slate-700\">Select Policy Document</label>\r\n                                <select\r\n                                    className=\"w-full p-2 border rounded-md text-sm\"\r\n                                    onChange={(e) => {\r\n                                        const source = analyzedSources.find(s => s.id === e.target.value);\r\n                                        setEcosystemSource(source || null);\r\n                                    }}\r\n                                >\r\n                                    <option value=\"\">Select document...</option>\r\n                                    {analyzedSources.map(s => (\r\n                                        <option key={s.id} value={s.id}>{s.title}</option>\r\n                                    ))}\r\n                                </select>\r\n                            </div>\r\n                            <Button\r\n                                className=\"bg-teal-600 text-white hover:bg-teal-700\"\r\n                                onClick={handleEcosystemMap}\r\n                                disabled={!ecosystemSource || isMapping}\r\n                            >\r\n                                {isMapping ? (\r\n                                    <>\r\n                                        <Sparkles className=\"mr-2 h-4 w-4 animate-spin\" />\r\n                                        Mapping...\r\n                                    </>\r\n                                ) : (\r\n                                    <>\r\n                                        <Network className=\"mr-2 h-4 w-4\" />\r\n                                        Generate Map\r\n                                    </>\r\n                                )}\r\n                            </Button>\r\n                        </div>\r\n\r\n                        {ecosystemImpacts.length > 0 && (\r\n                            <div className=\"mt-4 space-y-3 pt-4 border-t\">\r\n                                <div className=\"flex items-center justify-between\">\r\n                                    <h4 className=\"font-semibold text-slate-900\">Ecosystem Impacts</h4>\r\n                                    <div className=\"flex gap-2\">\r\n                                        <div className=\"flex bg-slate-100 rounded-lg p-1 mr-4\">\r\n                                            <button\r\n                                                onClick={() => setViewMode(\"list\")}\r\n                                                className={`px-3 py-1 text-xs font-medium rounded-md transition-colors ${viewMode === \"list\"\r\n                                                    ? \"bg-white text-slate-900 shadow-sm\"\r\n                                                    : \"text-slate-500 hover:text-slate-900\"\r\n                                                    }`}\r\n                                            >\r\n                                                List View\r\n                                            </button>\r\n                                            <button\r\n                                                onClick={() => setViewMode(\"graph\")}\r\n                                                className={`px-3 py-1 text-xs font-medium rounded-md transition-colors ${viewMode === \"graph\"\r\n                                                    ? \"bg-white text-slate-900 shadow-sm\"\r\n                                                    : \"text-slate-500 hover:text-slate-900\"\r\n                                                    }`}\r\n                                            >\r\n                                                Graph View\r\n                                            </button>\r\n                                        </div>\r\n\r\n                                        <Button\r\n                                            variant={interconnectionFilter === \"All\" ? \"default\" : \"outline\"}\r\n                                            size=\"sm\"\r\n                                            onClick={() => setInterconnectionFilter(\"All\")}\r\n                                        >\r\n                                            All\r\n                                        </Button>\r\n                                        <Button\r\n                                            variant={interconnectionFilter === \"Material\" ? \"default\" : \"outline\"}\r\n                                            size=\"sm\"\r\n                                            onClick={() => setInterconnectionFilter(\"Material\")}\r\n                                        >\r\n                                            Material\r\n                                        </Button>\r\n                                        <Button\r\n                                            variant={interconnectionFilter === \"Discursive\" ? \"default\" : \"outline\"}\r\n                                            size=\"sm\"\r\n                                            onClick={() => setInterconnectionFilter(\"Discursive\")}\r\n                                        >\r\n                                            Discursive\r\n                                        </Button>\r\n                                        <Button\r\n                                            variant={interconnectionFilter === \"Hybrid\" ? \"default\" : \"outline\"}\r\n                                            size=\"sm\"\r\n                                            onClick={() => setInterconnectionFilter(\"Hybrid\")}\r\n                                        >\r\n                                            Hybrid\r\n                                        </Button>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {viewMode === \"graph\" ? (\r\n                                    <div className=\"border rounded-lg p-4 bg-white min-h-[500px]\">\r\n                                        <AssemblageSankey\r\n                                            data={ecosystemImpacts.filter(impact =>\r\n                                                interconnectionFilter === \"All\" ||\r\n                                                impact.interconnection_type === interconnectionFilter\r\n                                            )}\r\n                                        />\r\n                                        <p className=\"text-center text-xs text-slate-500 mt-4\">\r\n                                            Visualizing the flow from <strong>Actors</strong>  <strong>Mechanisms</strong>  <strong>Impacts</strong>\r\n                                        </p>\r\n                                    </div>\r\n                                ) : (\r\n                                    <div className=\"grid gap-3\">\r\n                                        {ecosystemImpacts\r\n                                            .filter(impact =>\r\n                                                interconnectionFilter === \"All\" ||\r\n                                                impact.interconnection_type === interconnectionFilter\r\n                                            )\r\n                                            .map((impact, i) => (\r\n                                                <div key={i} className={`p-3 rounded-lg border ${impact.type === \"Constraint\"\r\n                                                    ? \"bg-red-50 border-red-200\"\r\n                                                    : \"bg-green-50 border-green-200\"\r\n                                                    }`}>\r\n                                                    <div className=\"flex items-start justify-between mb-2\">\r\n                                                        <span className={`text-xs font-bold uppercase ${impact.type === \"Constraint\" ? \"text-red-700\" : \"text-green-700\"\r\n                                                            }`}>\r\n                                                            {impact.type}\r\n                                                        </span>\r\n                                                        {impact.interconnection_type && (\r\n                                                            <Badge variant=\"outline\" className=\"text-xs\">\r\n                                                                {impact.interconnection_type}\r\n                                                            </Badge>\r\n                                                        )}\r\n                                                    </div>\r\n                                                    <p className=\"text-sm font-semibold text-slate-900 mb-1\">{impact.actor}</p>\r\n                                                    <p className=\"text-xs text-slate-600 mb-1\">\r\n                                                        <span className=\"font-medium\">Mechanism:</span> {impact.mechanism}\r\n                                                    </p>\r\n                                                    <p className=\"text-xs text-slate-600\">\r\n                                                        <span className=\"font-medium\">Impact:</span> {impact.impact}\r\n                                                    </p>\r\n                                                </div>\r\n                                            ))}\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n                        )}\r\n                    </CardContent>\r\n                </Card>\r\n            )}\r\n\r\n            {/* Synthesis Matrix */}\r\n            <div>\r\n                <h3 className=\"text-xl font-semibold text-slate-900 mb-4\">Synthesis Framework</h3>\r\n\r\n                {comparisonResult ? (\r\n                    // Show AI-generated comparison results\r\n                    <div className=\"grid gap-4\">\r\n                        {Object.entries(comparisonResult).map(([key, value]) => {\r\n                            const finding = SYNTHESIS_FINDINGS.find(f => f.key === key);\r\n                            const Icon = finding?.icon || AlertCircle;\r\n                            return (\r\n                                <Card key={key}>\r\n                                    <CardHeader>\r\n                                        <div className=\"flex items-center gap-2\">\r\n                                            <Icon className=\"h-5 w-5 text-slate-600\" />\r\n                                            <CardTitle>{finding?.dimension || key}</CardTitle>\r\n                                        </div>\r\n                                    </CardHeader>\r\n                                    <CardContent className=\"space-y-3\">\r\n                                        <div className=\"p-3 bg-green-50 rounded-lg border border-green-200\">\r\n                                            <p className=\"text-xs font-bold text-green-700 uppercase mb-1\">Convergence</p>\r\n                                            <p className=\"text-sm text-slate-700\">{value.convergence}</p>\r\n                                        </div>\r\n                                        <div className=\"p-3 bg-blue-50 rounded-lg border border-blue-200\">\r\n                                            <p className=\"text-xs font-bold text-blue-700 uppercase mb-1\">Divergence</p>\r\n                                            <p className=\"text-sm text-slate-700\">{value.divergence}</p>\r\n                                        </div>\r\n                                        <div className=\"p-3 bg-red-50 rounded-lg border border-red-200\">\r\n                                            <p className=\"text-xs font-bold text-red-700 uppercase mb-1\">Coloniality</p>\r\n                                            <p className=\"text-sm text-slate-700\">{value.coloniality}</p>\r\n                                        </div>\r\n                                        <div className=\"p-3 bg-purple-50 rounded-lg border border-purple-200\">\r\n                                            <p className=\"text-xs font-bold text-purple-700 uppercase mb-1\">Resistance</p>\r\n                                            <p className=\"text-sm text-slate-700\">{value.resistance}</p>\r\n                                        </div>\r\n                                    </CardContent>\r\n                                </Card>\r\n                            );\r\n                        })}\r\n                    </div>\r\n                ) : (\r\n                    // Show placeholder framework when no comparison is active\r\n                    <>\r\n                        <div className=\"mb-4 p-4 bg-blue-50 border border-blue-200 rounded-lg\">\r\n                            <p className=\"text-sm text-blue-900\">\r\n                                <strong>Note:</strong> To see AI-generated synthesis results, use the \"AI-Powered Framework Comparison\" tool above to compare two policy documents.\r\n                            </p>\r\n                        </div>\r\n                        <div className=\"grid gap-4\">\r\n                            {SYNTHESIS_FINDINGS.map((finding) => {\r\n                                const Icon = finding.icon;\r\n                                return (\r\n                                    <Card key={finding.key} className=\"opacity-60\">\r\n                                        <CardHeader>\r\n                                            <div className=\"flex items-center gap-2\">\r\n                                                <Icon className=\"h-5 w-5 text-slate-600\" />\r\n                                                <CardTitle>{finding.dimension}</CardTitle>\r\n                                            </div>\r\n                                        </CardHeader>\r\n                                        <CardContent className=\"space-y-3\">\r\n                                            <div className=\"p-3 bg-green-50 rounded-lg border border-green-200\">\r\n                                                <p className=\"text-xs font-bold text-green-700 uppercase mb-1\">Convergence</p>\r\n                                                <p className=\"text-sm text-slate-700\">{finding.convergence}</p>\r\n                                            </div>\r\n                                            <div className=\"p-3 bg-blue-50 rounded-lg border border-blue-200\">\r\n                                                <p className=\"text-xs font-bold text-blue-700 uppercase mb-1\">Divergence</p>\r\n                                                <p className=\"text-sm text-slate-700\">{finding.divergence}</p>\r\n                                            </div>\r\n                                            <div className=\"p-3 bg-red-50 rounded-lg border border-red-200\">\r\n                                                <p className=\"text-xs font-bold text-red-700 uppercase mb-1\">Coloniality</p>\r\n                                                <p className=\"text-sm text-slate-700\">{finding.coloniality}</p>\r\n                                            </div>\r\n                                            <div className=\"p-3 bg-purple-50 rounded-lg border border-purple-200\">\r\n                                                <p className=\"text-xs font-bold text-purple-700 uppercase mb-1\">Resistance</p>\r\n                                                <p className=\"text-sm text-slate-700\">{finding.resistance}</p>\r\n                                            </div>\r\n                                        </CardContent>\r\n                                    </Card>\r\n                                );\r\n                            })}\r\n                        </div>\r\n                    </>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\app\\timeline\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'FileText' is defined but never used.","line":6,"column":27,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":35},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'index' is defined but never used.","line":241,"column":57,"nodeType":null,"messageId":"unusedVar","endLine":241,"endColumn":62}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useSources } from \"@/hooks/useSources\";\r\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Calendar, Clock, FileText, TrendingUp } from \"lucide-react\";\r\nimport { Source } from \"@/types\";\r\n\r\nexport default function TimelinePage() {\r\n    const { sources, isLoading } = useSources();\r\n\r\n    // Filter sources with dates and sort them\r\n    const timelineEvents = sources\r\n        .filter(s => s.publicationDate)\r\n        .sort((a, b) => new Date(a.publicationDate!).getTime() - new Date(b.publicationDate!).getTime());\r\n\r\n    // Analytics: Publications by year\r\n    const publicationsByYear: Record<number, Source[]> = {};\r\n    timelineEvents.forEach(source => {\r\n        const year = new Date(source.publicationDate!).getFullYear();\r\n        if (!publicationsByYear[year]) publicationsByYear[year] = [];\r\n        publicationsByYear[year].push(source);\r\n    });\r\n\r\n    // Analytics: Publications by jurisdiction\r\n    const publicationsByJurisdiction: Record<string, Source[]> = {};\r\n    timelineEvents.forEach(source => {\r\n        const jurisdiction = source.jurisdiction || 'Other';\r\n        if (!publicationsByJurisdiction[jurisdiction]) publicationsByJurisdiction[jurisdiction] = [];\r\n        publicationsByJurisdiction[jurisdiction].push(source);\r\n    });\r\n\r\n    // Analytics: Active Discourse Metric\r\n    const now = new Date();\r\n    const oneYearAgo = new Date(now.getFullYear() - 1, now.getMonth(), now.getDate());\r\n    const twoYearsAgo = new Date(now.getFullYear() - 2, now.getMonth(), now.getDate());\r\n\r\n    const recentDocs = timelineEvents.filter(s => new Date(s.publicationDate!) >= oneYearAgo).length;\r\n    const previousDocs = timelineEvents.filter(s => {\r\n        const date = new Date(s.publicationDate!);\r\n        return date >= twoYearsAgo && date < oneYearAgo;\r\n    }).length;\r\n\r\n    const activityTrend = previousDocs === 0 ? 'High' :\r\n        recentDocs > previousDocs * 1.5 ? 'Growing' :\r\n            recentDocs < previousDocs * 0.5 ? 'Declining' : 'Stable';\r\n\r\n    // Analytics: Peak activity period\r\n    const peakYear = Object.entries(publicationsByYear)\r\n        .sort(([, a], [, b]) => b.length - a.length)[0];\r\n\r\n    // Analytics: Jurisdiction leadership\r\n    const jurisdictionLeader = Object.entries(publicationsByJurisdiction)\r\n        .sort(([, a], [, b]) => b.length - a.length)[0];\r\n\r\n    if (isLoading) {\r\n        return <div className=\"p-8 text-center\">Loading timeline...</div>;\r\n    }\r\n\r\n    return (\r\n        <div className=\"space-y-8\">\r\n            <div className=\"flex items-center justify-between\">\r\n                <div>\r\n                    <h1 className=\"text-3xl font-bold tracking-tight\">Temporal Dynamics</h1>\r\n                    <p className=\"text-muted-foreground mt-2\">\r\n                        Track the evolution of AI governance discourse and policy adoption over time.\r\n                    </p>\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"grid gap-6 md:grid-cols-3\">\r\n                <Card>\r\n                    <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n                        <CardTitle className=\"text-sm font-medium\">Total Timeline Events</CardTitle>\r\n                        <Calendar className=\"h-4 w-4 text-muted-foreground\" />\r\n                    </CardHeader>\r\n                    <CardContent>\r\n                        <div className=\"text-2xl font-bold\">{timelineEvents.length}</div>\r\n                        <p className=\"text-xs text-muted-foreground\">Documents with publication dates</p>\r\n                    </CardContent>\r\n                </Card>\r\n                <Card>\r\n                    <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n                        <CardTitle className=\"text-sm font-medium\">Date Range</CardTitle>\r\n                        <Clock className=\"h-4 w-4 text-muted-foreground\" />\r\n                    </CardHeader>\r\n                    <CardContent>\r\n                        <div className=\"text-2xl font-bold\">\r\n                            {timelineEvents.length > 0\r\n                                ? `${new Date(timelineEvents[0].publicationDate!).getFullYear()} - ${new Date(timelineEvents[timelineEvents.length - 1].publicationDate!).getFullYear()}`\r\n                                : \"N/A\"}\r\n                        </div>\r\n                        <p className=\"text-xs text-muted-foreground\">Earliest to latest document</p>\r\n                    </CardContent>\r\n                </Card>\r\n                <Card>\r\n                    <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n                        <CardTitle className=\"text-sm font-medium\">Active Discourse</CardTitle>\r\n                        <TrendingUp className=\"h-4 w-4 text-muted-foreground\" />\r\n                    </CardHeader>\r\n                    <CardContent>\r\n                        <div className=\"text-2xl font-bold\">{activityTrend}</div>\r\n                        <p className=\"text-xs text-muted-foreground\">\r\n                            {recentDocs} docs last year vs. {previousDocs} prior year\r\n                        </p>\r\n                    </CardContent>\r\n                </Card>\r\n            </div>\r\n\r\n            {/* New Analytics Cards */}\r\n            {timelineEvents.length > 0 && (\r\n                <div className=\"grid gap-6 md:grid-cols-2\">\r\n                    <Card>\r\n                        <CardHeader>\r\n                            <CardTitle className=\"text-base\">Peak Activity Period</CardTitle>\r\n                            <CardDescription>Year with most publications</CardDescription>\r\n                        </CardHeader>\r\n                        <CardContent>\r\n                            {peakYear && (\r\n                                <div>\r\n                                    <div className=\"text-3xl font-bold text-indigo-700 mb-2\">{peakYear[0]}</div>\r\n                                    <p className=\"text-sm text-slate-600\">\r\n                                        {peakYear[1].length} publication{peakYear[1].length !== 1 ? 's' : ''}\r\n                                    </p>\r\n                                    <div className=\"mt-3 flex flex-wrap gap-1\">\r\n                                        {Object.entries(\r\n                                            peakYear[1].reduce((acc: Record<string, number>, s: Source) => {\r\n                                                const j = s.jurisdiction || 'Other';\r\n                                                acc[j] = (acc[j] || 0) + 1;\r\n                                                return acc;\r\n                                            }, {})\r\n                                        ).map(([jurisdiction, count]) => (\r\n                                            <Badge key={jurisdiction} variant=\"outline\" className=\"text-xs\">\r\n                                                {jurisdiction}: {count}\r\n                                            </Badge>\r\n                                        ))}\r\n                                    </div>\r\n                                </div>\r\n                            )}\r\n                        </CardContent>\r\n                    </Card>\r\n\r\n                    <Card>\r\n                        <CardHeader>\r\n                            <CardTitle className=\"text-base\">Most Active Jurisdiction</CardTitle>\r\n                            <CardDescription>Publication leadership</CardDescription>\r\n                        </CardHeader>\r\n                        <CardContent>\r\n                            {jurisdictionLeader && (\r\n                                <div>\r\n                                    <div className=\"text-3xl font-bold text-indigo-700 mb-2\">{jurisdictionLeader[0]}</div>\r\n                                    <p className=\"text-sm text-slate-600\">\r\n                                        {jurisdictionLeader[1].length} publication{jurisdictionLeader[1].length !== 1 ? 's' : ''} total\r\n                                    </p>\r\n                                    <div className=\"mt-3 space-y-1\">\r\n                                        {jurisdictionLeader[1][0] && (\r\n                                            <p className=\"text-xs text-slate-500\">\r\n                                                First: {new Date(jurisdictionLeader[1][0].publicationDate!).getFullYear()}\r\n                                            </p>\r\n                                        )}\r\n                                        {jurisdictionLeader[1][jurisdictionLeader[1].length - 1] && (\r\n                                            <p className=\"text-xs text-slate-500\">\r\n                                                Latest: {new Date(jurisdictionLeader[1][jurisdictionLeader[1].length - 1].publicationDate!).getFullYear()}\r\n                                            </p>\r\n                                        )}\r\n                                    </div>\r\n                                </div>\r\n                            )}\r\n                        </CardContent>\r\n                    </Card>\r\n                </div>\r\n            )}\r\n\r\n            {/* Publication Frequency Chart */}\r\n            {timelineEvents.length > 0 && Object.keys(publicationsByYear).length > 0 && (\r\n                <Card>\r\n                    <CardHeader>\r\n                        <CardTitle>Publication Frequency Over Time</CardTitle>\r\n                        <CardDescription>Number of documents published each year</CardDescription>\r\n                    </CardHeader>\r\n                    <CardContent>\r\n                        <div className=\"space-y-4\">\r\n                            {Object.entries(publicationsByYear)\r\n                                .sort(([a], [b]) => Number(a) - Number(b))\r\n                                .map(([year, docs]) => {\r\n                                    const maxCount = Math.max(...Object.values(publicationsByYear).map(d => d.length));\r\n                                    const percentage = (docs.length / maxCount) * 100;\r\n\r\n                                    return (\r\n                                        <div key={year}>\r\n                                            <div className=\"flex items-center justify-between mb-1\">\r\n                                                <span className=\"text-sm font-medium\">{year}</span>\r\n                                                <span className=\"text-sm text-slate-600\">{docs.length} doc{docs.length !== 1 ? 's' : ''}</span>\r\n                                            </div>\r\n                                            <div className=\"w-full bg-slate-100 rounded-full h-6 relative overflow-hidden\">\r\n                                                <div\r\n                                                    className=\"bg-gradient-to-r from-indigo-500 to-indigo-600 h-6 rounded-full flex items-center px-2 transition-all\"\r\n                                                    style={{ width: `${Math.max(percentage, 5)}%` }}\r\n                                                >\r\n                                                    <div className=\"flex gap-1\">\r\n                                                        {Object.entries(\r\n                                                            docs.reduce((acc: Record<string, number>, s: Source) => {\r\n                                                                const j = s.jurisdiction || 'Other';\r\n                                                                acc[j] = (acc[j] || 0) + 1;\r\n                                                                return acc;\r\n                                                            }, {})\r\n                                                        ).map(([jurisdiction]) => (\r\n                                                            <div\r\n                                                                key={jurisdiction}\r\n                                                                className={`w-2 h-2 rounded-full ${jurisdiction === 'EU' ? 'bg-blue-300' :\r\n                                                                    jurisdiction === 'Brazil' ? 'bg-green-300' :\r\n                                                                        jurisdiction === 'US' ? 'bg-red-300' : 'bg-slate-300'\r\n                                                                    }`}\r\n                                                                title={jurisdiction}\r\n                                                            />\r\n                                                        ))}\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n                                    );\r\n                                })}\r\n                        </div>\r\n                    </CardContent>\r\n                </Card>\r\n            )}\r\n\r\n            {/* Timeline */}\r\n            <Card>\r\n                <CardHeader>\r\n                    <CardTitle>Policy Timeline</CardTitle>\r\n                    <CardDescription>Chronological evolution of AI governance documents</CardDescription>\r\n                </CardHeader>\r\n                <CardContent>\r\n                    <div className=\"relative border-l-2 border-slate-200 ml-4 md:ml-8 space-y-12 py-4\">\r\n                        {timelineEvents.length === 0 ? (\r\n                            <div className=\"pl-8 text-muted-foreground\">\r\n                                No documents with publication dates found. Edit your documents to add dates.\r\n                            </div>\r\n                        ) : (\r\n                            timelineEvents.map((source, index) => (\r\n                                <div key={source.id} className=\"relative pl-8 md:pl-12\">\r\n                                    {/* Timeline Dot */}\r\n                                    <div className={`absolute -left-[9px] top-0 h-4 w-4 rounded-full border-2 border-white ${source.jurisdiction === 'EU' ? 'bg-blue-500' :\r\n                                        source.jurisdiction === 'Brazil' ? 'bg-green-500' :\r\n                                            source.jurisdiction === 'US' ? 'bg-red-500' : 'bg-slate-500'\r\n                                        }`} />\r\n\r\n                                    {/* Date Label */}\r\n                                    <div className=\"mb-1 text-sm font-semibold text-slate-500\">\r\n                                        {new Date(source.publicationDate!).toLocaleDateString(undefined, {\r\n                                            year: 'numeric',\r\n                                            month: 'long',\r\n                                            day: 'numeric'\r\n                                        })}\r\n                                    </div>\r\n\r\n                                    {/* Content Card */}\r\n                                    <Card className=\"w-full max-w-3xl hover:shadow-md transition-shadow\">\r\n                                        <CardHeader>\r\n                                            <div className=\"flex items-start justify-between\">\r\n                                                <div>\r\n                                                    <div className=\"flex items-center gap-2 mb-1\">\r\n                                                        <CardTitle className=\"text-lg text-indigo-700\">\r\n                                                            {source.title}\r\n                                                        </CardTitle>\r\n                                                        {source.version && (\r\n                                                            <Badge variant=\"outline\">v{source.version}</Badge>\r\n                                                        )}\r\n                                                        {source.jurisdiction && (\r\n                                                            <Badge className={\r\n                                                                source.jurisdiction === 'EU' ? 'bg-blue-100 text-blue-800 hover:bg-blue-100' :\r\n                                                                    source.jurisdiction === 'Brazil' ? 'bg-green-100 text-green-800 hover:bg-green-100' :\r\n                                                                        'bg-red-100 text-red-800 hover:bg-red-100'\r\n                                                            }>\r\n                                                                {source.jurisdiction}\r\n                                                            </Badge>\r\n                                                        )}\r\n                                                    </div>\r\n                                                    <CardDescription>{source.description}</CardDescription>\r\n                                                </div>\r\n                                                <div className=\"flex gap-2\">\r\n                                                    {/* Placeholder for future actions */}\r\n                                                </div>\r\n                                            </div>\r\n                                        </CardHeader>\r\n                                        <CardContent>\r\n                                            {source.extractedText && (\r\n                                                <p className=\"text-sm text-slate-600 line-clamp-3\">\r\n                                                    {source.extractedText.substring(0, 300)}...\r\n                                                </p>\r\n                                            )}\r\n                                            {source.analysis && (\r\n                                                <div className=\"mt-4 pt-4 border-t\">\r\n                                                    <h4 className=\"text-xs font-semibold uppercase text-slate-500 mb-2\">Key Insight</h4>\r\n                                                    <p className=\"text-sm\">{source.analysis.key_insight || \"No insight available.\"}</p>\r\n                                                </div>\r\n                                            )}\r\n                                        </CardContent>\r\n                                    </Card>\r\n                                </div>\r\n                            ))\r\n                        )}\r\n                    </div>\r\n                </CardContent>\r\n            </Card>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\components\\AnalysisResults.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\components\\AssemblageSankey.tsx","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Use \"@ts-expect-error\" instead of \"@ts-ignore\", as \"@ts-ignore\" will do nothing if the following line is error-free.","line":56,"column":17,"nodeType":"Line","messageId":"tsIgnoreInsteadOfExpectError","endLine":56,"endColumn":30,"suggestions":[{"messageId":"replaceTsIgnoreWithTsExpectError","fix":{"range":[1896,1909],"text":"// @ts-expect-error"},"desc":"Replace \"@ts-ignore\" with \"@ts-expect-error\"."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":151,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":151,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5380,5383],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5380,5383],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":183,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":183,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7063,7066],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7063,7066],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useMemo, useRef } from \"react\";\r\nimport { ResponsiveContainer, Sankey, Tooltip, Layer, Rectangle } from \"recharts\";\r\nimport { EcosystemImpact } from \"@/types\";\r\n\r\ninterface AssemblageSankeyProps {\r\n    data: EcosystemImpact[];\r\n    height?: number;\r\n}\r\n\r\nexport function AssemblageSankey({ data, height = 500 }: AssemblageSankeyProps) {\r\n    const chartData = useMemo(() => {\r\n        const nodes: { name: string }[] = [];\r\n        const links: { source: number; target: number; value: number; type?: string }[] = [];\r\n\r\n        const nodeMap = new Map<string, number>();\r\n\r\n        const getNodeIndex = (name: string) => {\r\n            if (!nodeMap.has(name)) {\r\n                nodeMap.set(name, nodes.length);\r\n                nodes.push({ name });\r\n            }\r\n            return nodeMap.get(name)!;\r\n        };\r\n\r\n        data.forEach(item => {\r\n            const actorIdx = getNodeIndex(item.actor);\r\n            const mechanismIdx = getNodeIndex(item.mechanism);\r\n            const impactIdx = getNodeIndex(item.impact);\r\n\r\n            // Link: Actor -> Mechanism\r\n            links.push({\r\n                source: actorIdx,\r\n                target: mechanismIdx,\r\n                value: 1,\r\n                type: item.type\r\n            });\r\n\r\n            // Link: Mechanism -> Impact\r\n            links.push({\r\n                source: mechanismIdx,\r\n                target: impactIdx,\r\n                value: 1,\r\n                type: item.type\r\n            });\r\n        });\r\n\r\n        // Aggregate identical links\r\n        const uniqueLinksMap = new Map<string, { source: number; target: number; value: number; type: string }>();\r\n        links.forEach(link => {\r\n            const key = `${link.source}-${link.target}`;\r\n            if (uniqueLinksMap.has(key)) {\r\n                uniqueLinksMap.get(key)!.value += 1;\r\n            } else {\r\n                // @ts-ignore\r\n                uniqueLinksMap.set(key, { ...link });\r\n            }\r\n        });\r\n\r\n        return {\r\n            nodes,\r\n            links: Array.from(uniqueLinksMap.values())\r\n        };\r\n    }, [data]);\r\n\r\n    const containerRef = useRef<HTMLDivElement>(null);\r\n\r\n    const handleDownload = () => {\r\n        if (!containerRef.current) return;\r\n\r\n        const svgElement = containerRef.current.querySelector('svg');\r\n        if (!svgElement) {\r\n            console.error(\"SVG element not found\");\r\n            return;\r\n        }\r\n\r\n        // Get SVG data\r\n        const serializer = new XMLSerializer();\r\n        const svgString = serializer.serializeToString(svgElement);\r\n        const svgBlob = new Blob([svgString], { type: 'image/svg+xml;charset=utf-8' });\r\n        const url = URL.createObjectURL(svgBlob);\r\n\r\n        // Create image and draw to canvas\r\n        const img = new Image();\r\n        img.onload = () => {\r\n            const canvas = document.createElement('canvas');\r\n            // Use the actual SVG dimensions or the container dimensions\r\n            const width = svgElement.clientWidth || 800;\r\n            const height = svgElement.clientHeight || 500;\r\n\r\n            // Scale up for better resolution\r\n            const scale = 2;\r\n            canvas.width = width * scale;\r\n            canvas.height = height * scale;\r\n\r\n            const ctx = canvas.getContext('2d');\r\n            if (!ctx) return;\r\n\r\n            // Fill white background\r\n            ctx.fillStyle = '#ffffff';\r\n            ctx.fillRect(0, 0, canvas.width, canvas.height);\r\n\r\n            ctx.scale(scale, scale);\r\n            ctx.drawImage(img, 0, 0);\r\n\r\n            // Trigger download\r\n            const pngUrl = canvas.toDataURL('image/png');\r\n            const downloadLink = document.createElement('a');\r\n            downloadLink.href = pngUrl;\r\n            downloadLink.download = 'assemblage-sankey.png';\r\n            document.body.appendChild(downloadLink);\r\n            downloadLink.click();\r\n            document.body.removeChild(downloadLink);\r\n\r\n            URL.revokeObjectURL(url);\r\n        };\r\n        img.src = url;\r\n    };\r\n\r\n    if (data.length === 0) {\r\n        return (\r\n            <div className=\"flex items-center justify-center h-full text-slate-400 text-sm\">\r\n                No data available for visualization\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div style={{ width: '100%', height }} className=\"relative\" ref={containerRef}>\r\n            <div className=\"absolute top-0 right-0 z-10\">\r\n                <button\r\n                    onClick={handleDownload}\r\n                    className=\"bg-white/80 hover:bg-white border border-slate-200 text-slate-600 text-xs font-medium px-2 py-1 rounded shadow-sm backdrop-blur-sm transition-colors\"\r\n                    title=\"Download as PNG\"\r\n                >\r\n                    Download PNG\r\n                </button>\r\n            </div>\r\n\r\n            {/* Column Headers */}\r\n            <div className=\"flex justify-between px-4 mb-2 text-sm font-bold text-slate-700 uppercase tracking-wider border-b pb-2\">\r\n                <div className=\"w-1/3 text-left\">Actors</div>\r\n                <div className=\"w-1/3 text-center\">Mechanisms</div>\r\n                <div className=\"w-1/3 text-right pr-40\">Impacts</div>\r\n            </div>\r\n\r\n            <ResponsiveContainer>\r\n                <Sankey\r\n                    data={chartData}\r\n                    node={(props: any) => {\r\n                        const { x, y, width, height, index, payload, containerWidth } = props;\r\n                        const isOut = x + width + 6 > (containerWidth || 500) / 2;\r\n\r\n                        // Determine color based on node type or connection\r\n                        const fill = \"#3b82f6\";\r\n\r\n                        // Truncate text if it's too long\r\n                        const truncateText = (text: string, maxLength: number) => {\r\n                            if (text.length <= maxLength) return text;\r\n                            return text.slice(0, maxLength) + '...';\r\n                        };\r\n\r\n                        return (\r\n                            <Layer key={`CustomNode${index}`}>\r\n                                <Rectangle x={x} y={y} width={width} height={height} fill={fill} fillOpacity=\"1\" />\r\n                                <text\r\n                                    textAnchor={isOut ? 'end' : 'start'}\r\n                                    x={isOut ? x - 6 : x + width + 6}\r\n                                    y={y + height / 2}\r\n                                    fontSize=\"11\"\r\n                                    stroke=\"none\"\r\n                                    fill=\"#1e293b\"\r\n                                    dy=\"0.355em\"\r\n                                    fontWeight=\"500\"\r\n                                >\r\n                                    {truncateText(payload.name, 35)}\r\n                                </text>\r\n                                <title>{payload.name}</title>\r\n                            </Layer>\r\n                        );\r\n                    }}\r\n                    link={(props: any) => {\r\n                        const { sourceX, sourceY, targetX, targetY, linkWidth, payload } = props;\r\n                        // Color links based on the \"type\" of the impact\r\n                        const isConstraint = payload.type === \"Constraint\";\r\n                        const color = isConstraint ? \"#fca5a5\" : \"#86efac\"; // Red-300 for constraint, Green-300 for affordance\r\n                        const opacity = 0.6;\r\n\r\n                        return (\r\n                            <path\r\n                                d={`\r\n                                     M${sourceX},${sourceY + linkWidth / 2}\r\n                                     C${sourceX + 100},${sourceY + linkWidth / 2}\r\n                                     ${targetX - 100},${targetY + linkWidth / 2}\r\n                                     ${targetX},${targetY + linkWidth / 2}\r\n                                     L${targetX},${targetY - linkWidth / 2}\r\n                                     C${targetX - 100},${targetY - linkWidth / 2}\r\n                                     ${sourceX + 100},${sourceY - linkWidth / 2}\r\n                                     ${sourceX},${sourceY - linkWidth / 2}\r\n                                     Z\r\n                                 `}\r\n                                fill={color}\r\n                                fillOpacity={opacity}\r\n                                stroke={isConstraint ? \"#ef4444\" : \"#22c55e\"}\r\n                                strokeWidth={1}\r\n                                strokeOpacity={0.2}\r\n                            />\r\n                        );\r\n                    }}\r\n                    nodePadding={50}\r\n                    margin={{\r\n                        left: 20,\r\n                        right: 160,\r\n                        top: 20,\r\n                        bottom: 20,\r\n                    }}\r\n                >\r\n                    <Tooltip />\r\n                </Sankey>\r\n            </ResponsiveContainer>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\components\\CulturalHoleCard.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":119,"column":61,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":119,"endColumn":64,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5996,5999],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5996,5999],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Tooltip, TooltipContent, TooltipProvider, TooltipTrigger } from \"@/components/ui/tooltip\";\r\nimport { CulturalHole } from \"@/types/cultural\";\r\nimport { Lightbulb, ArrowRight, FileText } from \"lucide-react\";\r\n\r\ninterface CulturalHoleCardProps {\r\n    hole: CulturalHole;\r\n    clusters: Array<{ id: string; name: string; themes: string[]; description?: string }>;\r\n}\r\n\r\nexport function CulturalHoleCard({ hole, clusters }: CulturalHoleCardProps) {\r\n    const clusterA = clusters.find((c) => c.id === hole.clusterA);\r\n    const clusterB = clusters.find((c) => c.id === hole.clusterB);\r\n\r\n    if (!clusterA || !clusterB) return null;\r\n\r\n    // Color code by distance (gap size)\r\n    const gapColor =\r\n        hole.distance > 0.7\r\n            ? \"bg-red-50 border-red-200\"\r\n            : hole.distance > 0.5\r\n                ? \"bg-orange-50 border-orange-200\"\r\n                : \"bg-yellow-50 border-yellow-200\";\r\n\r\n    const badgeColor =\r\n        hole.distance > 0.7\r\n            ? \"bg-red-100 text-red-700\"\r\n            : hole.distance > 0.5\r\n                ? \"bg-orange-100 text-orange-700\"\r\n                : \"bg-yellow-100 text-yellow-700\";\r\n\r\n    return (\r\n        <Card className={`${gapColor} border-2`}>\r\n            <CardHeader className=\"pb-3\">\r\n                <div className=\"flex items-center justify-between\">\r\n                    <CardTitle className=\"text-base font-semibold text-slate-900\">\r\n                        Cultural Hole Detected\r\n                    </CardTitle>\r\n                    <Badge className={badgeColor}>\r\n                        Gap: {(hole.distance * 100).toFixed(0)}%\r\n                    </Badge>\r\n                </div>\r\n            </CardHeader>\r\n            <CardContent className=\"space-y-4\">\r\n                {/* Cluster Comparison */}\r\n                <div className=\"grid grid-cols-1 md:grid-cols-3 gap-3 items-center\">\r\n                    <div className=\"bg-white p-3 rounded-md border border-slate-200\">\r\n                        <span className=\"text-xs font-bold text-slate-600 uppercase block mb-1\">\r\n                            Cluster A\r\n                        </span>\r\n                        <TooltipProvider>\r\n                            <Tooltip>\r\n                                <TooltipTrigger asChild>\r\n                                    <p className=\"text-sm font-semibold text-slate-900 mb-2 cursor-help underline decoration-dotted\">\r\n                                        {clusterA.name}\r\n                                    </p>\r\n                                </TooltipTrigger>\r\n                                {clusterA.description && (\r\n                                    <TooltipContent className=\"max-w-xs bg-white\">\r\n                                        <p className=\"text-xs text-slate-700\">{clusterA.description}</p>\r\n                                    </TooltipContent>\r\n                                )}\r\n                            </Tooltip>\r\n                        </TooltipProvider>\r\n                        <div className=\"flex flex-wrap gap-1\">\r\n                            {clusterA.themes.filter(theme => theme !== clusterA.name).slice(0, 3).map((theme, i) => (\r\n                                <Badge key={i} variant=\"outline\" className=\"text-xs\">\r\n                                    {theme}\r\n                                </Badge>\r\n                            ))}\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"flex justify-center\">\r\n                        <ArrowRight className=\"h-6 w-6 text-slate-400\" />\r\n                    </div>\r\n\r\n                    <div className=\"bg-white p-3 rounded-md border border-slate-200\">\r\n                        <span className=\"text-xs font-bold text-slate-600 uppercase block mb-1\">\r\n                            Cluster B\r\n                        </span>\r\n                        <TooltipProvider>\r\n                            <Tooltip>\r\n                                <TooltipTrigger asChild>\r\n                                    <p className=\"text-sm font-semibold text-slate-900 mb-2 cursor-help underline decoration-dotted\">\r\n                                        {clusterB.name}\r\n                                    </p>\r\n                                </TooltipTrigger>\r\n                                {clusterB.description && (\r\n                                    <TooltipContent className=\"max-w-xs bg-white\">\r\n                                        <p className=\"text-xs text-slate-700\">{clusterB.description}</p>\r\n                                    </TooltipContent>\r\n                                )}\r\n                            </Tooltip>\r\n                        </TooltipProvider>\r\n                        <div className=\"flex flex-wrap gap-1\">\r\n                            {clusterB.themes.filter(theme => theme !== clusterB.name).slice(0, 3).map((theme, i) => (\r\n                                <Badge key={i} variant=\"outline\" className=\"text-xs\">\r\n                                    {theme}\r\n                                </Badge>\r\n                            ))}\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Bridging Concepts */}\r\n                {hole.bridgingConcepts.length > 0 && (\r\n                    <div className=\"bg-white p-3 rounded-md border border-slate-200\">\r\n                        <div className=\"flex items-center gap-2 mb-2\">\r\n                            <Lightbulb className=\"h-4 w-4 text-amber-600\" />\r\n                            <span className=\"text-xs font-bold text-amber-700 uppercase\">\r\n                                Bridging Concepts\r\n                            </span>\r\n                        </div>\r\n                        <div className=\"flex flex-wrap gap-2\">\r\n                            {hole.bridgingConcepts.map((bc: any, i: number) => (\r\n                                <TooltipProvider key={i}>\r\n                                    <Tooltip>\r\n                                        <TooltipTrigger asChild>\r\n                                            <Badge\r\n                                                className=\"bg-amber-100 text-amber-800 border-amber-300 cursor-help\"\r\n                                            >\r\n                                                {bc.concept}\r\n                                            </Badge>\r\n                                        </TooltipTrigger>\r\n                                        <TooltipContent className=\"max-w-xs bg-white\">\r\n                                            <p className=\"text-xs text-slate-700\">{bc.explanation}</p>\r\n                                        </TooltipContent>\r\n                                    </Tooltip>\r\n                                </TooltipProvider>\r\n                            ))}\r\n                        </div>\r\n                    </div>\r\n                )}\r\n\r\n                {/* Opportunity */}\r\n                {hole.opportunity && (\r\n                    <div className=\"bg-blue-50 p-3 rounded-md border border-blue-200\">\r\n                        <span className=\"text-xs font-bold text-blue-700 uppercase block mb-1\">\r\n                            Innovation Opportunity\r\n                        </span>\r\n                        <p className=\"text-sm text-slate-700\">{hole.opportunity}</p>\r\n                    </div>\r\n                )}\r\n\r\n                {/* Policy Implication */}\r\n                {hole.policyImplication && (\r\n                    <div className=\"bg-purple-50 p-3 rounded-md border border-purple-200\">\r\n                        <div className=\"flex items-center gap-2 mb-1\">\r\n                            <FileText className=\"h-4 w-4 text-purple-600\" />\r\n                            <span className=\"text-xs font-bold text-purple-700 uppercase\">\r\n                                Policy Implication\r\n                            </span>\r\n                        </div>\r\n                        <p className=\"text-sm text-slate-700\">{hole.policyImplication}</p>\r\n                    </div>\r\n                )}\r\n            </CardContent>\r\n        </Card>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\components\\CulturalHoleMatrix.tsx","messages":[{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":102,"column":89,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[5383,5599],"text":"\r\n                                                            These discourse clusters don&apos;t \"speak to each other\"  they use different language and concepts.\r\n                                                        "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[5383,5599],"text":"\r\n                                                            These discourse clusters don&lsquo;t \"speak to each other\"  they use different language and concepts.\r\n                                                        "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[5383,5599],"text":"\r\n                                                            These discourse clusters don&#39;t \"speak to each other\"  they use different language and concepts.\r\n                                                        "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[5383,5599],"text":"\r\n                                                            These discourse clusters don&rsquo;t \"speak to each other\"  they use different language and concepts.\r\n                                                        "},"desc":"Replace with `&rsquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":102,"column":92,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[5383,5599],"text":"\r\n                                                            These discourse clusters don't &quot;speak to each other\"  they use different language and concepts.\r\n                                                        "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[5383,5599],"text":"\r\n                                                            These discourse clusters don't &ldquo;speak to each other\"  they use different language and concepts.\r\n                                                        "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[5383,5599],"text":"\r\n                                                            These discourse clusters don't &#34;speak to each other\"  they use different language and concepts.\r\n                                                        "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[5383,5599],"text":"\r\n                                                            These discourse clusters don't &rdquo;speak to each other\"  they use different language and concepts.\r\n                                                        "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":102,"column":112,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[5383,5599],"text":"\r\n                                                            These discourse clusters don't \"speak to each other&quot;  they use different language and concepts.\r\n                                                        "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[5383,5599],"text":"\r\n                                                            These discourse clusters don't \"speak to each other&ldquo;  they use different language and concepts.\r\n                                                        "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[5383,5599],"text":"\r\n                                                            These discourse clusters don't \"speak to each other&#34;  they use different language and concepts.\r\n                                                        "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[5383,5599],"text":"\r\n                                                            These discourse clusters don't \"speak to each other&rdquo;  they use different language and concepts.\r\n                                                        "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":145,"column":97,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":145,"endColumn":100,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9350,9353],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9350,9353],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport React from \"react\";\r\nimport { DiscourseCluster, CulturalHole } from \"@/types/cultural\";\r\nimport { Tooltip, TooltipContent, TooltipProvider, TooltipTrigger } from \"@/components/ui/tooltip\";\r\n\r\ninterface CulturalHoleMatrixProps {\r\n    clusters: DiscourseCluster[];\r\n    holes: CulturalHole[];\r\n}\r\n\r\nexport function CulturalHoleMatrix({ clusters, holes }: CulturalHoleMatrixProps) {\r\n    if (clusters.length === 0) {\r\n        return (\r\n            <div className=\"flex items-center justify-center h-96 bg-slate-50 rounded-lg border-2 border-dashed border-slate-300\">\r\n                <p className=\"text-slate-500\">No cultural analysis data available</p>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    // Helper to get hole between two clusters\r\n    const getHole = (idA: string, idB: string) => {\r\n        return holes.find(h =>\r\n            (h.clusterA === idA && h.clusterB === idB) ||\r\n            (h.clusterA === idB && h.clusterB === idA)\r\n        );\r\n    };\r\n\r\n    // Helper to get color based on distance\r\n    const getCellColor = (distance: number) => {\r\n        if (distance < 0.2) return \"bg-slate-50\";\r\n        if (distance < 0.4) return \"bg-red-50\";\r\n        if (distance < 0.6) return \"bg-red-100\";\r\n        if (distance < 0.8) return \"bg-red-200\";\r\n        return \"bg-red-300\";\r\n    };\r\n\r\n    return (\r\n        <div className=\"overflow-x-auto\">\r\n            <div className=\"min-w-[600px] p-2\">\r\n                <div className=\"grid\" style={{\r\n                    gridTemplateColumns: `auto repeat(${clusters.length}, minmax(60px, 1fr))`\r\n                }}>\r\n                    {/* Header Row */}\r\n                    <div className=\"h-16\"></div>\r\n                    {clusters.map((cluster) => (\r\n                        <div key={cluster.id} className=\"relative h-16 border-b border-slate-200\">\r\n                            <div className=\"absolute bottom-2 left-1/2 -translate-x-1/2 w-full text-center transform -rotate-45 origin-bottom text-xs font-medium text-slate-700 px-1 whitespace-nowrap\">\r\n                                {cluster.name}\r\n                            </div>\r\n                        </div>\r\n                    ))}\r\n\r\n                    {/* Matrix Rows */}\r\n                    {clusters.map((rowCluster) => (\r\n                        <React.Fragment key={rowCluster.id}>\r\n                            {/* Row Header */}\r\n                            <div className=\"flex items-center justify-end pr-2 py-1 border-r border-slate-200\">\r\n                                <span className=\"text-xs font-medium text-slate-700 text-right truncate w-24\">\r\n                                    {rowCluster.name}\r\n                                </span>\r\n                            </div>\r\n\r\n                            {/* Cells */}\r\n                            {clusters.map((colCluster) => {\r\n                                const isDiagonal = rowCluster.id === colCluster.id;\r\n                                const hole = getHole(rowCluster.id, colCluster.id);\r\n\r\n                                if (isDiagonal) {\r\n                                    return (\r\n                                        <div key={`${rowCluster.id}-${colCluster.id}`} className=\"bg-slate-100 border border-white flex items-center justify-center h-12\">\r\n                                            <span className=\"text-xs font-bold text-slate-400\">\r\n                                                {rowCluster.size}\r\n                                            </span>\r\n                                        </div>\r\n                                    );\r\n                                }\r\n\r\n                                if (!hole) {\r\n                                    return (\r\n                                        <div key={`${rowCluster.id}-${colCluster.id}`} className=\"bg-slate-50 border border-white h-12\" />\r\n                                    );\r\n                                }\r\n\r\n                                return (\r\n                                    <TooltipProvider key={`${rowCluster.id}-${colCluster.id}`}>\r\n                                        <Tooltip>\r\n                                            <TooltipTrigger asChild>\r\n                                                <div\r\n                                                    className={`${getCellColor(hole.distance)} border border-white h-12 flex items-center justify-center cursor-help transition-colors hover:opacity-80`}\r\n                                                >\r\n                                                    <span className=\"text-xs font-medium text-red-900 opacity-50\">\r\n                                                        {(hole.distance * 100).toFixed(0)}%\r\n                                                    </span>\r\n                                                </div>\r\n                                            </TooltipTrigger>\r\n                                            <TooltipContent className=\"max-w-md bg-white border-slate-200 shadow-lg\">\r\n                                                <div className=\"space-y-3\">\r\n                                                    <div>\r\n                                                        <p className=\"font-bold text-sm text-amber-700\"> Cultural Gap Detected</p>\r\n                                                        <p className=\"text-xs text-slate-600 mt-1\">\r\n                                                            These discourse clusters don't \"speak to each other\"  they use different language and concepts.\r\n                                                        </p>\r\n                                                    </div>\r\n\r\n                                                    {/* Cluster Definitions */}\r\n                                                    <div className=\"text-xs space-y-2 bg-slate-50 p-2 rounded border border-slate-100\">\r\n                                                        <div>\r\n                                                            <span className=\"font-semibold text-indigo-700\">Cluster A:</span>{\" \"}\r\n                                                            <span className=\"text-slate-700\">\r\n                                                                {clusters.find(c => c.id === hole.clusterA)?.name}\r\n                                                            </span>\r\n                                                            {clusters.find(c => c.id === hole.clusterA)?.description && (\r\n                                                                <p className=\"text-slate-600 italic mt-0.5 pl-2\">\r\n                                                                    {clusters.find(c => c.id === hole.clusterA)?.description}\r\n                                                                </p>\r\n                                                            )}\r\n                                                        </div>\r\n                                                        <div>\r\n                                                            <span className=\"font-semibold text-indigo-700\">Cluster B:</span>{\" \"}\r\n                                                            <span className=\"text-slate-700\">\r\n                                                                {clusters.find(c => c.id === hole.clusterB)?.name}\r\n                                                            </span>\r\n                                                            {clusters.find(c => c.id === hole.clusterB)?.description && (\r\n                                                                <p className=\"text-slate-600 italic mt-0.5 pl-2\">\r\n                                                                    {clusters.find(c => c.id === hole.clusterB)?.description}\r\n                                                                </p>\r\n                                                            )}\r\n                                                        </div>\r\n                                                    </div>\r\n\r\n                                                    <div className=\"text-xs space-y-2 border-t border-slate-100 pt-2\">\r\n                                                        <p>\r\n                                                            <span className=\"font-semibold text-slate-700\">Gap Size:</span>{\" \"}\r\n                                                            <span className=\"text-slate-900\">{(hole.distance * 100).toFixed(0)}%</span>\r\n                                                            <span className=\"text-slate-500 ml-1\">\r\n                                                                ({hole.distance > 0.7 ? \"Very Large\" : hole.distance > 0.4 ? \"Moderate\" : \"Small\"})\r\n                                                            </span>\r\n                                                        </p>\r\n\r\n                                                        {/* Bridging Concepts with individual tooltips */}\r\n                                                        <div>\r\n                                                            <p className=\"font-semibold text-slate-700 mb-1\">Bridging Ideas:</p>\r\n                                                            <div className=\"flex flex-wrap gap-1\">\r\n                                                                {hole.bridgingConcepts.map((bc: any, idx: number) => (\r\n                                                                    <TooltipProvider key={idx}>\r\n                                                                        <Tooltip>\r\n                                                                            <TooltipTrigger asChild>\r\n                                                                                <span className=\"px-2 py-0.5 bg-blue-50 text-blue-700 rounded border border-blue-100 cursor-help text-xs hover:bg-blue-100 transition-colors\">\r\n                                                                                    {bc.concept}\r\n                                                                                </span>\r\n                                                                            </TooltipTrigger>\r\n                                                                            <TooltipContent className=\"max-w-xs bg-white\">\r\n                                                                                <p className=\"text-xs text-slate-700\">{bc.explanation}</p>\r\n                                                                            </TooltipContent>\r\n                                                                        </Tooltip>\r\n                                                                    </TooltipProvider>\r\n                                                                ))}\r\n                                                            </div>\r\n                                                        </div>\r\n\r\n                                                        <div className=\"bg-amber-50 p-2 rounded border border-amber-100 mt-2\">\r\n                                                            <p className=\"font-semibold text-amber-900 mb-1\"> Opportunity for Innovation:</p>\r\n                                                            <p className=\"text-slate-700\">{hole.opportunity}</p>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                </div>\r\n                                            </TooltipContent>\r\n                                        </Tooltip>\r\n                                    </TooltipProvider>\r\n                                );\r\n                            })}\r\n                        </React.Fragment>\r\n                    ))}\r\n                </div>\r\n\r\n                {/* Legend */}\r\n                <div className=\"mt-4 flex items-center justify-end gap-4 text-xs text-slate-600\">\r\n                    <div className=\"flex items-center gap-2\">\r\n                        <div className=\"w-4 h-4 bg-slate-100 border border-slate-200\"></div>\r\n                        <span>Cluster Size</span>\r\n                    </div>\r\n                    <div className=\"flex items-center gap-2\">\r\n                        <div className=\"flex\">\r\n                            <div className=\"w-4 h-4 bg-slate-50\"></div>\r\n                            <div className=\"w-4 h-4 bg-red-50\"></div>\r\n                            <div className=\"w-4 h-4 bg-red-100\"></div>\r\n                            <div className=\"w-4 h-4 bg-red-200\"></div>\r\n                            <div className=\"w-4 h-4 bg-red-300\"></div>\r\n                        </div>\r\n                        <span>Gap Distance (Low  High)</span>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\components\\CulturalHoleNetwork.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\components\\ResearchWorkflowGuide.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useEffect' is defined but never used.","line":3,"column":20,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":29},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ChevronRight' is defined but never used.","line":4,"column":23,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":35},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":72,"column":35,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[2755,2842],"text":"\r\n                        Guide for &quot;Algorithmic Assemblages\" CFP\r\n                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[2755,2842],"text":"\r\n                        Guide for &ldquo;Algorithmic Assemblages\" CFP\r\n                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[2755,2842],"text":"\r\n                        Guide for &#34;Algorithmic Assemblages\" CFP\r\n                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[2755,2842],"text":"\r\n                        Guide for &rdquo;Algorithmic Assemblages\" CFP\r\n                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":72,"column":59,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[2755,2842],"text":"\r\n                        Guide for \"Algorithmic Assemblages&quot; CFP\r\n                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[2755,2842],"text":"\r\n                        Guide for \"Algorithmic Assemblages&ldquo; CFP\r\n                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[2755,2842],"text":"\r\n                        Guide for \"Algorithmic Assemblages&#34; CFP\r\n                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[2755,2842],"text":"\r\n                        Guide for \"Algorithmic Assemblages&rdquo; CFP\r\n                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":115,"column":119,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[5164,5275],"text":" in the Synthesis tab to visualize the &quot;Decolonial Situatedness\" argument for your paper.\r\n                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[5164,5275],"text":" in the Synthesis tab to visualize the &ldquo;Decolonial Situatedness\" argument for your paper.\r\n                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[5164,5275],"text":" in the Synthesis tab to visualize the &#34;Decolonial Situatedness\" argument for your paper.\r\n                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[5164,5275],"text":" in the Synthesis tab to visualize the &rdquo;Decolonial Situatedness\" argument for your paper.\r\n                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":115,"column":143,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[5164,5275],"text":" in the Synthesis tab to visualize the \"Decolonial Situatedness&quot; argument for your paper.\r\n                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[5164,5275],"text":" in the Synthesis tab to visualize the \"Decolonial Situatedness&ldquo; argument for your paper.\r\n                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[5164,5275],"text":" in the Synthesis tab to visualize the \"Decolonial Situatedness&#34; argument for your paper.\r\n                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[5164,5275],"text":" in the Synthesis tab to visualize the \"Decolonial Situatedness&rdquo; argument for your paper.\r\n                    "},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport { BookOpen, X, ChevronRight, Database, GitGraph, FileText, Share2 } from \"lucide-react\";\r\nimport Link from \"next/link\";\r\nimport { usePathname } from \"next/navigation\";\r\n\r\nexport function ResearchWorkflowGuide() {\r\n    const [isOpen, setIsOpen] = useState(true);\r\n    const pathname = usePathname();\r\n\r\n    // Auto-minimize on specific pages if needed, or keep persistent\r\n    // For now, we'll just let the user control it.\r\n\r\n    if (!isOpen) {\r\n        return (\r\n            <button\r\n                onClick={() => setIsOpen(true)}\r\n                className=\"fixed bottom-6 right-6 bg-blue-600 text-white p-3 rounded-full shadow-lg hover:bg-blue-700 transition-all z-50 flex items-center gap-2\"\r\n                title=\"Open Research Guide\"\r\n            >\r\n                <BookOpen size={20} />\r\n                <span className=\"font-medium text-sm pr-1\">CFP Guide</span>\r\n            </button>\r\n        );\r\n    }\r\n\r\n    const steps = [\r\n        {\r\n            id: 1,\r\n            title: \"Data Collection\",\r\n            icon: <Database size={16} />,\r\n            desc: \"Import and tag your primary policy texts (EU AI Act, PL 2338).\",\r\n            link: \"/data\",\r\n            active: pathname === \"/data\"\r\n        },\r\n        {\r\n            id: 2,\r\n            title: \"Trace Resistance\",\r\n            icon: <GitGraph size={16} />,\r\n            desc: \"Identify and map micro-resistances and friction points.\",\r\n            link: \"/resistance\",\r\n            active: pathname === \"/resistance\"\r\n        },\r\n        {\r\n            id: 3,\r\n            title: \"Synthesize Assemblages\",\r\n            icon: <Share2 size={16} />,\r\n            desc: \"Visualize the actor-mechanism-impact flows.\",\r\n            link: \"/synthesis\",\r\n            active: pathname === \"/synthesis\"\r\n        },\r\n        {\r\n            id: 4,\r\n            title: \"Reflexive Journaling\",\r\n            icon: <FileText size={16} />,\r\n            desc: \"Document your situated positionality and method.\",\r\n            link: \"/reflexivity\",\r\n            active: pathname === \"/reflexivity\"\r\n        }\r\n    ];\r\n\r\n    return (\r\n        <div className=\"fixed bottom-6 right-6 w-80 bg-white rounded-xl shadow-2xl border border-slate-200 z-50 overflow-hidden flex flex-col animate-in slide-in-from-bottom-5 duration-300\">\r\n            <div className=\"bg-slate-900 text-white p-4 flex justify-between items-start\">\r\n                <div>\r\n                    <h3 className=\"font-bold text-sm flex items-center gap-2\">\r\n                        <BookOpen size={16} className=\"text-blue-400\" />\r\n                        Research Workflow\r\n                    </h3>\r\n                    <p className=\"text-xs text-slate-400 mt-1\">\r\n                        Guide for \"Algorithmic Assemblages\" CFP\r\n                    </p>\r\n                </div>\r\n                <button\r\n                    onClick={() => setIsOpen(false)}\r\n                    className=\"text-slate-400 hover:text-white transition-colors\"\r\n                >\r\n                    <X size={16} />\r\n                </button>\r\n            </div>\r\n\r\n            <div className=\"p-4 space-y-4 max-h-[60vh] overflow-y-auto\">\r\n                <div className=\"space-y-3\">\r\n                    {steps.map((step) => (\r\n                        <Link\r\n                            key={step.id}\r\n                            href={step.link}\r\n                            className={`block group border rounded-lg p-3 transition-all ${step.active\r\n                                    ? \"bg-blue-50 border-blue-200 ring-1 ring-blue-200\"\r\n                                    : \"bg-white border-slate-100 hover:border-blue-200 hover:shadow-sm\"\r\n                                }`}\r\n                        >\r\n                            <div className=\"flex items-center justify-between mb-1\">\r\n                                <div className={`flex items-center gap-2 font-semibold text-sm ${step.active ? \"text-blue-700\" : \"text-slate-700\"\r\n                                    }`}>\r\n                                    <span className={`p-1 rounded ${step.active ? \"bg-blue-100\" : \"bg-slate-100 group-hover:bg-blue-50\"\r\n                                        }`}>\r\n                                        {step.icon}\r\n                                    </span>\r\n                                    {step.title}\r\n                                </div>\r\n                                {step.active && <div className=\"w-2 h-2 rounded-full bg-blue-500\"></div>}\r\n                            </div>\r\n                            <p className=\"text-xs text-slate-500 leading-relaxed pl-8\">\r\n                                {step.desc}\r\n                            </p>\r\n                        </Link>\r\n                    ))}\r\n                </div>\r\n\r\n                <div className=\"bg-slate-50 p-3 rounded-lg border border-slate-100\">\r\n                    <h4 className=\"text-xs font-semibold text-slate-700 mb-2\">Current Goal:</h4>\r\n                    <p className=\"text-xs text-slate-600 leading-relaxed\">\r\n                        Generate the <strong>Assemblage Sankey Diagram</strong> in the Synthesis tab to visualize the \"Decolonial Situatedness\" argument for your paper.\r\n                    </p>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\components\\Sidebar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\components\\policy\\AddDocumentDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\components\\policy\\AnalysisResults.tsx","messages":[{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":15,"column":66,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[654,655],"text":"&quot;"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[654,655],"text":"&ldquo;"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[654,655],"text":"&#34;"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[654,655],"text":"&rdquo;"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":15,"column":89,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[677,678],"text":"&quot;"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[677,678],"text":"&ldquo;"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[677,678],"text":"&#34;"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[677,678],"text":"&rdquo;"},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { AnalysisResult } from \"@/types\";\r\nimport { Sparkles } from \"lucide-react\";\r\n\r\ninterface AnalysisResultsProps {\r\n    analysis: AnalysisResult;\r\n}\r\n\r\nexport function AnalysisResults({ analysis }: AnalysisResultsProps) {\r\n    return (\r\n        <div className=\"mt-4 pt-4 border-t border-slate-100 space-y-3\">\r\n            <div className=\"flex items-start gap-2\">\r\n                <Sparkles className=\"h-4 w-4 text-purple-600 mt-1 shrink-0\" />\r\n                <div>\r\n                    <span className=\"text-xs font-bold text-purple-700 uppercase tracking-wider\">Key Insight</span>\r\n                    <p className=\"text-sm text-slate-700 italic\">\"{analysis.key_insight}\"</p>\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3 mt-2\">\r\n                <div className=\"bg-slate-50 p-3 rounded-md border border-slate-100\">\r\n                    <span className=\"text-xs font-bold text-slate-600 uppercase block mb-1\">Governance & Power</span>\r\n                    <p className=\"text-xs text-slate-700\">{analysis.governance_power_accountability}</p>\r\n                </div>\r\n                <div className=\"bg-slate-50 p-3 rounded-md border border-slate-100\">\r\n                    <span className=\"text-xs font-bold text-slate-600 uppercase block mb-1\">Plurality & Inclusion</span>\r\n                    <p className=\"text-xs text-slate-700\">{analysis.plurality_inclusion_embodiment}</p>\r\n                </div>\r\n                <div className=\"bg-slate-50 p-3 rounded-md border border-slate-100\">\r\n                    <span className=\"text-xs font-bold text-slate-600 uppercase block mb-1\">Agency & Co-Design</span>\r\n                    <p className=\"text-xs text-slate-700\">{analysis.agency_codesign_self_determination}</p>\r\n                </div>\r\n                <div className=\"bg-slate-50 p-3 rounded-md border border-slate-100\">\r\n                    <span className=\"text-xs font-bold text-slate-600 uppercase block mb-1\">Reflexivity</span>\r\n                    <p className=\"text-xs text-slate-700\">{analysis.reflexivity_situated_praxis}</p>\r\n                </div>\r\n            </div>\r\n\r\n            {analysis.legitimacy_claims && (\r\n                <div className=\"mt-3 bg-amber-50 p-3 rounded-md border border-amber-200\">\r\n                    <span className=\"text-xs font-bold text-amber-800 uppercase block mb-2\">Legitimacy Dynamics</span>\r\n                    <div className=\"space-y-2 text-xs\">\r\n                        {analysis.legitimacy_claims.source && (\r\n                            <div>\r\n                                <span className=\"font-semibold text-amber-700\">Source: </span>\r\n                                <span className=\"text-slate-700\">{analysis.legitimacy_claims.source}</span>\r\n                            </div>\r\n                        )}\r\n                        {analysis.legitimacy_claims.mechanisms && (\r\n                            <div>\r\n                                <span className=\"font-semibold text-amber-700\">Mechanisms: </span>\r\n                                <span className=\"text-slate-700\">{analysis.legitimacy_claims.mechanisms}</span>\r\n                            </div>\r\n                        )}\r\n                        {analysis.legitimacy_claims.tensions && (\r\n                            <div>\r\n                                <span className=\"font-semibold text-amber-700\">Tensions: </span>\r\n                                <span className=\"text-slate-700\">{analysis.legitimacy_claims.tensions}</span>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\components\\policy\\DocumentCard.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AnalysisResult' is defined but never used.","line":1,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":32}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Source, AnalysisResult } from \"@/types\";\r\nimport { AnalysisMode } from \"@/services/analysis\";\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { FileText, Globe, Loader2, Sparkles, Trash, Globe2, Scale, Pencil } from \"lucide-react\";\r\nimport { AnalysisResults } from \"./AnalysisResults\";\r\n\r\ninterface DocumentCardProps {\r\n    source: Source;\r\n    isAnalyzing: boolean;\r\n    isSearching: boolean;\r\n    onAnalyze: (id: string, mode: AnalysisMode) => void;\r\n    onDelete: (id: string) => void;\r\n    onEdit: (source: Source) => void;\r\n    onFindTraces: (source: Source) => void;\r\n    onView: (source: Source) => void;\r\n}\r\n\r\nexport function DocumentCard({\r\n    source,\r\n    isAnalyzing,\r\n    isSearching,\r\n    onAnalyze,\r\n    onDelete,\r\n    onEdit,\r\n    onFindTraces,\r\n    onView\r\n}: DocumentCardProps) {\r\n    return (\r\n        <Card className=\"hover:shadow-md transition-shadow\">\r\n            <CardHeader className=\"flex flex-row items-start justify-between space-y-0 pb-2\">\r\n                <div className=\"space-y-1 flex-1 min-w-0 pr-4\">\r\n                    <CardTitle className=\"text-base font-semibold break-words\">{source.title}</CardTitle>\r\n                    <CardDescription className=\"break-words\">{source.description}</CardDescription>\r\n                </div>\r\n                <div className=\"flex items-center gap-2 shrink-0\">\r\n                    <div\r\n                        className={`rounded-full p-2 ${source.colorClass} cursor-pointer hover:opacity-80 transition-opacity`}\r\n                        onClick={() => onView(source)}\r\n                        title=\"Click to view extracted text\"\r\n                    >\r\n                        <FileText className={`h-4 w-4 ${source.iconClass}`} />\r\n                    </div>\r\n                    <Button\r\n                        variant=\"ghost\"\r\n                        size=\"sm\"\r\n                        onClick={() => onFindTraces(source)}\r\n                        disabled={isSearching || !source.extractedText}\r\n                        className=\"h-8 w-8 p-0 hover:bg-blue-100 hover:text-blue-600 disabled:opacity-30\"\r\n                        title={source.extractedText ? \"Find empirical traces using Google Search\" : \"Upload a PDF or add text first to enable trace search\"}\r\n                    >\r\n                        {isSearching ? (\r\n                            <Loader2 className=\"h-4 w-4 animate-spin\" />\r\n                        ) : (\r\n                            <Globe className=\"h-4 w-4\" />\r\n                        )}\r\n                    </Button>\r\n                    <Button\r\n                        variant=\"ghost\"\r\n                        size=\"sm\"\r\n                        onClick={() => onDelete(source.id)}\r\n                        className=\"h-8 w-8 p-0 hover:bg-red-100 hover:text-red-600\"\r\n                    >\r\n                        <Trash className=\"h-4 w-4\" />\r\n                    </Button>\r\n                </div>\r\n            </CardHeader>\r\n            <CardContent>\r\n                <div className=\"mt-4 flex items-center space-x-2\">\r\n                    <Badge variant=\"secondary\" className=\"bg-green-100 text-green-700 hover:bg-green-100\">\r\n                        {source.status}\r\n                    </Badge>\r\n                    <span className=\"text-xs text-slate-500\">\r\n                        {source.type} {source.pageCount ? ` ${source.pageCount} pages` : ''}\r\n                    </span>\r\n                </div>\r\n                <div className=\"mt-4 flex flex-wrap gap-2 text-xs text-slate-500\">\r\n                    <div>Added: {source.addedDate}</div>\r\n                    {source.publicationDate && (\r\n                        <>\r\n                            <div></div>\r\n                            <div>Published: {source.publicationDate}</div>\r\n                        </>\r\n                    )}\r\n                    {source.version && (\r\n                        <>\r\n                            <div></div>\r\n                            <div>v{source.version}</div>\r\n                        </>\r\n                    )}\r\n                    {source.jurisdiction && (\r\n                        <>\r\n                            <div></div>\r\n                            <Badge variant=\"outline\" className=\"text-[10px] h-4 px-1\">\r\n                                {source.jurisdiction}\r\n                            </Badge>\r\n                        </>\r\n                    )}\r\n                </div>\r\n                <div className=\"mt-4 flex gap-2\">\r\n                    <Button\r\n                        variant=\"outline\"\r\n                        size=\"sm\"\r\n                        onClick={() => onEdit(source)}\r\n                        className=\"hover:bg-blue-50 hover:text-blue-600\"\r\n                    >\r\n                        <Pencil className=\"h-4 w-4 mr-2\" />\r\n                        Edit\r\n                    </Button>\r\n                </div>\r\n                {source.extractedText && (\r\n                    <div className=\"mt-4 space-y-2\">\r\n                        <Button\r\n                            onClick={() => onAnalyze(source.id, 'dsf')}\r\n                            disabled={isAnalyzing}\r\n                            className=\"w-full bg-purple-600 text-white hover:bg-purple-700\"\r\n                            size=\"sm\"\r\n                        >\r\n                            {isAnalyzing ? (\r\n                                <>\r\n                                    <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\r\n                                    Analyzing...\r\n                                </>\r\n                            ) : (\r\n                                <>\r\n                                    <Sparkles className=\"mr-2 h-4 w-4\" />\r\n                                    Analyze with AI\r\n                                </>\r\n                            )}\r\n                        </Button>\r\n                        <div className=\"grid grid-cols-2 gap-2\">\r\n                            <Button\r\n                                onClick={() => onAnalyze(source.id, 'cultural_framing')}\r\n                                disabled={isAnalyzing}\r\n                                variant=\"outline\"\r\n                                size=\"sm\"\r\n                                className=\"text-xs border-purple-200 hover:bg-purple-50\"\r\n                                title=\"Analyze cultural framing for CFP\"\r\n                            >\r\n                                <Globe2 className=\"mr-1 h-3 w-3\" />\r\n                                Cultural\r\n                            </Button>\r\n                            <Button\r\n                                onClick={() => onAnalyze(source.id, 'institutional_logics')}\r\n                                disabled={isAnalyzing}\r\n                                variant=\"outline\"\r\n                                size=\"sm\"\r\n                                className=\"text-xs border-purple-200 hover:bg-purple-50\"\r\n                                title=\"Analyze institutional logics for CFP\"\r\n                            >\r\n                                <Scale className=\"mr-1 h-3 w-3\" />\r\n                                Logics\r\n                            </Button>\r\n                        </div>\r\n                    </div>\r\n                )}\r\n                {source.analysis && <AnalysisResults analysis={source.analysis} />}\r\n            </CardContent>\r\n        </Card>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\components\\policy\\DocumentToolbar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\components\\policy\\EditSourceDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\components\\policy\\ViewSourceDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\components\\ui\\alert-dialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\components\\ui\\badge.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\components\\ui\\button.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\components\\ui\\card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\components\\ui\\dialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\components\\ui\\input.tsx","messages":[{"ruleId":"@typescript-eslint/no-empty-object-type","severity":2,"message":"An interface declaring no members is equivalent to its supertype.","line":5,"column":18,"nodeType":"Identifier","messageId":"noEmptyInterfaceWithSuper","endLine":5,"endColumn":28,"suggestions":[{"messageId":"replaceEmptyInterfaceWithSuper","fix":{"range":[77,158],"text":"type InputProps = React.InputHTMLAttributes<HTMLInputElement>"},"desc":"Replace empty interface with a type alias."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nexport interface InputProps\r\n    extends React.InputHTMLAttributes<HTMLInputElement> { }\r\n\r\nconst Input = React.forwardRef<HTMLInputElement, InputProps>(\r\n    ({ className, type, ...props }, ref) => {\r\n        return (\r\n            <input\r\n                type={type}\r\n                className={cn(\r\n                    \"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\r\n                    className\r\n                )}\r\n                ref={ref}\r\n                {...props}\r\n            />\r\n        )\r\n    }\r\n)\r\nInput.displayName = \"Input\"\r\n\r\nexport { Input }\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\components\\ui\\label.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\components\\ui\\select.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\components\\ui\\tabs.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\components\\ui\\textarea.tsx","messages":[{"ruleId":"@typescript-eslint/no-empty-object-type","severity":2,"message":"An interface declaring no members is equivalent to its supertype.","line":5,"column":18,"nodeType":"Identifier","messageId":"noEmptyInterfaceWithSuper","endLine":5,"endColumn":31,"suggestions":[{"messageId":"replaceEmptyInterfaceWithSuper","fix":{"range":[77,167],"text":"type TextareaProps = React.TextareaHTMLAttributes<HTMLTextAreaElement>"},"desc":"Replace empty interface with a type alias."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nexport interface TextareaProps\r\n    extends React.TextareaHTMLAttributes<HTMLTextAreaElement> { }\r\n\r\nconst Textarea = React.forwardRef<HTMLTextAreaElement, TextareaProps>(\r\n    ({ className, ...props }, ref) => {\r\n        return (\r\n            <textarea\r\n                className={cn(\r\n                    \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\r\n                    className\r\n                )}\r\n                ref={ref}\r\n                {...props}\r\n            />\r\n        )\r\n    }\r\n)\r\nTextarea.displayName = \"Textarea\"\r\n\r\nexport { Textarea }\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\components\\ui\\tooltip.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\hooks\\useLocalStorage.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'isInitialized' is assigned a value but never used.","line":6,"column":12,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":25},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\hooks\\useLocalStorage.ts:13:17\n  11 |             const item = window.localStorage.getItem(key);\n  12 |             if (item) {\n> 13 |                 setStoredValue(JSON.parse(item));\n     |                 ^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  14 |             }\n  15 |             setIsInitialized(true);\n  16 |         } catch (error) {","line":13,"column":17,"nodeType":null,"endLine":13,"endColumn":31}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\n\r\nexport function useLocalStorage<T>(key: string, initialValue: T) {\r\n    // State to store our value\r\n    const [storedValue, setStoredValue] = useState<T>(initialValue);\r\n    const [isInitialized, setIsInitialized] = useState(false);\r\n\r\n    // Load from localStorage after component mounts (client-side only)\r\n    useEffect(() => {\r\n        try {\r\n            const item = window.localStorage.getItem(key);\r\n            if (item) {\r\n                setStoredValue(JSON.parse(item));\r\n            }\r\n            setIsInitialized(true);\r\n        } catch (error) {\r\n            console.log(error);\r\n            setIsInitialized(true);\r\n        }\r\n    }, [key]);\r\n\r\n    // Return a wrapped version of useState's setter function that ...\r\n    // ... persists the new value to localStorage.\r\n    const setValue = (value: T | ((val: T) => T)) => {\r\n        try {\r\n            // Allow value to be a function so we have same API as useState\r\n            const valueToStore =\r\n                value instanceof Function ? value(storedValue) : value;\r\n            // Save state\r\n            setStoredValue(valueToStore);\r\n            // Save to local storage\r\n            if (typeof window !== 'undefined') {\r\n                window.localStorage.setItem(key, JSON.stringify(valueToStore));\r\n            }\r\n        } catch (error) {\r\n            // A more advanced implementation would handle the error case\r\n            console.log(error);\r\n        }\r\n    };\r\n\r\n    return [storedValue, setValue] as const;\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\hooks\\useSources.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\lib\\store.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":23,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":23,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import fs from 'fs/promises';\r\nimport path from 'path';\r\nimport { Source } from '@/types';\r\n\r\nconst DATA_DIR = path.join(process.cwd(), 'data');\r\nconst DATA_FILE = path.join(DATA_DIR, 'sources.json');\r\n\r\n// Ensure data directory exists\r\nconst ensureDataDir = async () => {\r\n    try {\r\n        await fs.access(DATA_DIR);\r\n    } catch {\r\n        await fs.mkdir(DATA_DIR, { recursive: true });\r\n    }\r\n};\r\n\r\n// Read sources from file\r\nexport const getSources = async (): Promise<Source[]> => {\r\n    await ensureDataDir();\r\n    try {\r\n        const data = await fs.readFile(DATA_FILE, 'utf-8');\r\n        return JSON.parse(data);\r\n    } catch (error) {\r\n        // If file doesn't exist or is empty, return empty array\r\n        return [];\r\n    }\r\n};\r\n\r\n// Save sources to file\r\nexport const saveSources = async (sources: Source[]): Promise<void> => {\r\n    await ensureDataDir();\r\n    await fs.writeFile(DATA_FILE, JSON.stringify(sources, null, 2), 'utf-8');\r\n};\r\n\r\n// Add a new source\r\nexport const addSource = async (source: Source): Promise<Source> => {\r\n    const sources = await getSources();\r\n    const newSources = [...sources, source];\r\n    await saveSources(newSources);\r\n    return source;\r\n};\r\n\r\n// Update a source\r\nexport const updateSource = async (id: string, updates: Partial<Source>): Promise<Source | null> => {\r\n    const sources = await getSources();\r\n    const index = sources.findIndex(s => s.id === id);\r\n\r\n    if (index === -1) return null;\r\n\r\n    const updatedSource = { ...sources[index], ...updates };\r\n    sources[index] = updatedSource;\r\n    await saveSources(sources);\r\n\r\n    return updatedSource;\r\n};\r\n\r\n// Delete a source\r\nexport const deleteSource = async (id: string): Promise<boolean> => {\r\n    const sources = await getSources();\r\n    const filteredSources = sources.filter(s => s.id !== id);\r\n\r\n    if (filteredSources.length === sources.length) return false;\r\n\r\n    await saveSources(filteredSources);\r\n    return true;\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\lib\\utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\services\\analysis.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AnalyzeRequest' is defined but never used.","line":5,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":25},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":9,"column":15,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":9,"endColumn":18,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[329,332],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[329,332],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":10,"column":15,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":10,"endColumn":18,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[349,352],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[349,352],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { AnalysisResult } from \"@/types\";\r\n\r\nexport type AnalysisMode = 'dsf' | 'cultural_framing' | 'institutional_logics' | 'resistance' | 'ecosystem' | 'ontology' | 'comparison' | 'generate_resistance';\r\n\r\ninterface AnalyzeRequest {\r\n    text: string;\r\n    sourceType: string;\r\n    analysisMode?: AnalysisMode;\r\n    sourceA?: any;\r\n    sourceB?: any;\r\n}\r\n\r\ninterface AnalyzeResponse {\r\n    success: boolean;\r\n    analysis: AnalysisResult;\r\n    error?: string;\r\n    details?: string;\r\n}\r\n\r\nexport const analyzeDocument = async (\r\n    text: string,\r\n    mode: AnalysisMode = 'dsf',\r\n    sourceType: string = 'Policy Document'\r\n): Promise<AnalysisResult> => {\r\n    try {\r\n        const response = await fetch('/api/analyze', {\r\n            method: 'POST',\r\n            headers: { 'Content-Type': 'application/json' },\r\n            body: JSON.stringify({\r\n                text,\r\n                sourceType,\r\n                analysisMode: mode\r\n            })\r\n        });\r\n\r\n        const result: AnalyzeResponse = await response.json();\r\n\r\n        if (!result.success) {\r\n            throw new Error(result.error || 'Analysis failed');\r\n        }\r\n\r\n        return result.analysis;\r\n    } catch (error) {\r\n        console.error(`Analysis error (${mode}):`, error);\r\n        throw error;\r\n    }\r\n};\r\n\r\nexport const generateSearchTerms = async (insight: string): Promise<string[]> => {\r\n    try {\r\n        const response = await fetch('/api/generate-search-terms', {\r\n            method: 'POST',\r\n            headers: { 'Content-Type': 'application/json' },\r\n            body: JSON.stringify({ insight })\r\n        });\r\n\r\n        const result = await response.json();\r\n        return result.searchTerms || [];\r\n    } catch (error) {\r\n        console.error('Search terms generation error:', error);\r\n        return [];\r\n    }\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\types\\cultural.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\types\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\utils\\generateSynthesisPDF.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\backups\\pre_redis_migration\\src\\utils\\pdfExtractor.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":4,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":4,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[98,101],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[98,101],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":34,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":34,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1138,1141],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1138,1141],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"export interface PDFExtractionResult {\r\n    text: string;\r\n    pageCount: number;\r\n    metadata?: any;\r\n}\r\n\r\nexport async function extractTextFromPDF(file: File): Promise<PDFExtractionResult> {\r\n    try {\r\n        // Dynamic import to avoid SSR issues with DOMMatrix\r\n        const pdfjsLib = await import('pdfjs-dist');\r\n\r\n        // Configure worker\r\n        pdfjsLib.GlobalWorkerOptions.workerSrc = new URL(\r\n            'pdfjs-dist/build/pdf.worker.min.mjs',\r\n            import.meta.url\r\n        ).toString();\r\n\r\n        // Read file as array buffer\r\n        const arrayBuffer = await file.arrayBuffer();\r\n\r\n        // Load PDF document\r\n        const loadingTask = pdfjsLib.getDocument({ data: arrayBuffer });\r\n        const pdf = await loadingTask.promise;\r\n\r\n        const pageCount = pdf.numPages;\r\n        let fullText = '';\r\n\r\n        // Extract text from each page\r\n        for (let pageNum = 1; pageNum <= pageCount; pageNum++) {\r\n            const page = await pdf.getPage(pageNum);\r\n            const textContent = await page.getTextContent();\r\n\r\n            const pageText = textContent.items\r\n                .map((item: any) => item.str)\r\n                .join(' ');\r\n\r\n            fullText += `\\n\\n--- Page ${pageNum} ---\\n\\n${pageText}`;\r\n        }\r\n\r\n        // Get metadata\r\n        const metadata = await pdf.getMetadata();\r\n\r\n        return {\r\n            text: fullText.trim(),\r\n            pageCount,\r\n            metadata: metadata.info\r\n        };\r\n    } catch (error) {\r\n        console.error('PDF extraction error:', error);\r\n        throw new Error('Failed to extract text from PDF');\r\n    }\r\n}\r\n\r\nexport function segmentText(text: string, chunkSize: number = 2000): string[] {\r\n    const segments: string[] = [];\r\n    const words = text.split(/\\s+/);\r\n\r\n    let currentSegment: string[] = [];\r\n    let currentLength = 0;\r\n\r\n    for (const word of words) {\r\n        if (currentLength + word.length > chunkSize && currentSegment.length > 0) {\r\n            segments.push(currentSegment.join(' '));\r\n            currentSegment = [word];\r\n            currentLength = word.length;\r\n        } else {\r\n            currentSegment.push(word);\r\n            currentLength += word.length + 1;\r\n        }\r\n    }\r\n\r\n    if (currentSegment.length > 0) {\r\n        segments.push(currentSegment.join(' '));\r\n    }\r\n\r\n    return segments;\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\eslint.config.mjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\next.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\postcss.config.mjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\scripts\\clear-db.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\scripts\\test-search-config.js","messages":[{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":1,"column":15,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":1,"endColumn":31},{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":2,"column":12,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":2,"endColumn":25},{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":3,"column":14,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":3,"endColumn":29}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"const https = require('https');\r\nconst fs = require('fs');\r\nconst path = require('path');\r\n\r\n// Load .env.local manually since we're running a standalone script\r\nconst envPath = path.join(process.cwd(), '.env.local');\r\nlet env = {};\r\nif (fs.existsSync(envPath)) {\r\n    const content = fs.readFileSync(envPath, 'utf8');\r\n    content.split('\\n').forEach(line => {\r\n        const match = line.match(/^([^=]+)=(.*)$/);\r\n        if (match) {\r\n            env[match[1].trim()] = match[2].trim().replace(/^[\"']|[\"']$/g, '');\r\n        }\r\n    });\r\n}\r\n\r\nconst API_KEY = env.GOOGLE_SEARCH_API_KEY;\r\nconst CX = env.GOOGLE_SEARCH_CX || env.GOOGLE_SEARCH_ENGINE_ID;\r\n\r\nif (!API_KEY || !CX) {\r\n    console.log(\"Missing API keys in .env.local\");\r\n    process.exit(1);\r\n}\r\n\r\nfunction search(query) {\r\n    return new Promise((resolve, reject) => {\r\n        const url = `https://www.googleapis.com/customsearch/v1?key=${API_KEY}&cx=${CX}&q=${encodeURIComponent(query)}`;\r\n        https.get(url, (res) => {\r\n            let data = '';\r\n            res.on('data', chunk => data += chunk);\r\n            res.on('end', () => {\r\n                try {\r\n                    const json = JSON.parse(data);\r\n                    resolve(json);\r\n                } catch (e) {\r\n                    reject(e);\r\n                }\r\n            });\r\n        }).on('error', reject);\r\n    });\r\n}\r\n\r\nasync function runTest() {\r\n    console.log(\"Testing Search Engine Configuration...\");\r\n\r\n    try {\r\n        // Test 1: Wikipedia (Should work if engine is \"Search the entire web\")\r\n        console.log(\"Attempting search: 'AI site:wikipedia.org'...\");\r\n        const wikiResults = await search('AI site:wikipedia.org');\r\n        const wikiCount = wikiResults.items ? wikiResults.items.length : 0;\r\n        console.log(`Wikipedia Results: ${wikiCount}`);\r\n\r\n        // Test 2: Reddit (Should work if engine is valid)\r\n        console.log(\"Attempting search: 'AI site:reddit.com'...\");\r\n        const redditResults = await search('AI site:reddit.com');\r\n        const redditCount = redditResults.items ? redditResults.items.length : 0;\r\n        console.log(`Reddit Results: ${redditCount}`);\r\n\r\n        console.log(\"\\n--- DIAGNOSIS ---\");\r\n        if (redditCount > 0 && wikiCount === 0) {\r\n            console.log(\"RESTRICTED: The search engine is configured to ONLY search specific sites (likely just Reddit).\");\r\n            console.log(\"You need to enable 'Search the entire web' in your Google Programmable Search Engine settings.\");\r\n        } else if (redditCount > 0 && wikiCount > 0) {\r\n            console.log(\"OPEN: The search engine is correctly searching the web.\");\r\n            console.log(\"If you are still seeing only Reddit results, it might be a relevance/ranking issue.\");\r\n        } else {\r\n            console.log(\"BROKEN: Neither search returned results. Check your API Key and Quota.\");\r\n        }\r\n\r\n    } catch (error) {\r\n        console.error(\"Test failed:\", error.message);\r\n    }\r\n}\r\n\r\nrunTest();\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\admin\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\api\\admin\\ratelimit\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'_request' is defined but never used.","line":22,"column":27,"nodeType":null,"messageId":"unusedVar","endLine":22,"endColumn":35}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from 'next/server';\r\nimport { auth } from '@clerk/nextjs/server';\r\nimport { setRateLimitOverride, setHardCapOverride, getUserRateLimitConfig, resetUserUsage } from '@/lib/ratelimit';\r\nimport { redis } from '@/lib/redis';\r\nimport { createClerkClient } from '@clerk/nextjs/server';\r\n\r\n// Helper to check if user is admin\r\nasync function isAdmin(userId: string) {\r\n    const adminIds = process.env.ADMIN_USER_IDS?.split(',') || [];\r\n    const isAuthorized = adminIds.includes(userId);\r\n\r\n    if (!isAuthorized) {\r\n        console.log(`[Admin Access Attempt] Blocked user: ${userId}. To authorize, add this ID to ADMIN_USER_IDS in .env.local`);\r\n    }\r\n\r\n    return isAuthorized;\r\n}\r\n\r\n// Initialize Clerk Client\r\nconst clerkClient = createClerkClient({ secretKey: process.env.CLERK_SECRET_KEY });\r\n\r\nexport async function GET(_request: NextRequest) {\r\n    const { userId } = await auth();\r\n    if (!userId || !await isAdmin(userId)) {\r\n        return new NextResponse(\"Unauthorized\", { status: 401 });\r\n    }\r\n\r\n    try {\r\n        // 1. Fetch all users from Clerk\r\n        const clerkUsers = await clerkClient.users.getUserList({ limit: 100 });\r\n\r\n        // 2. Fetch active usage from Redis\r\n        const usageKeys = await redis.keys('ratelimit:user:*');\r\n        const usageMap = new Map<string, { usage: number, ttl: number }>();\r\n\r\n        for (const key of usageKeys) {\r\n            const uid = key.replace('ratelimit:user:', '');\r\n            const usage = await redis.get(key);\r\n            const ttl = await redis.ttl(key);\r\n            usageMap.set(uid, { usage: parseInt(usage || '0', 10), ttl });\r\n        }\r\n\r\n        // 3. Fetch total usage from Redis\r\n        const totalUsageKeys = await redis.keys('usage:user:*:total');\r\n        const totalUsageMap = new Map<string, number>();\r\n        for (const key of totalUsageKeys) {\r\n            // key format: usage:user:<userId>:total\r\n            const uid = key.split(':')[2];\r\n            const total = await redis.get(key);\r\n            totalUsageMap.set(uid, parseInt(total || '0', 10));\r\n        }\r\n\r\n        // 4. Merge data\r\n        const users = await Promise.all(clerkUsers.data.map(async (user) => {\r\n            const usageData = usageMap.get(user.id) || { usage: 0, ttl: -1 };\r\n            const totalUsage = totalUsageMap.get(user.id) || 0;\r\n            const config = await getUserRateLimitConfig(user.id);\r\n\r\n            return {\r\n                userId: user.id,\r\n                email: user.emailAddresses[0]?.emailAddress || 'No Email',\r\n                name: `${user.firstName || ''} ${user.lastName || ''}`.trim() || 'No Name',\r\n                usage: usageData.usage,\r\n                totalUsage,\r\n                limitOverride: config.limit,\r\n                capOverride: config.cap,\r\n                ttl: usageData.ttl\r\n            };\r\n        }));\r\n\r\n        return NextResponse.json({ users });\r\n    } catch (error) {\r\n        console.error('Failed to fetch admin data:', error);\r\n        return NextResponse.json({ error: 'Failed to fetch data' }, { status: 500 });\r\n    }\r\n}\r\n\r\nexport async function POST(request: NextRequest) {\r\n    const { userId } = await auth();\r\n    if (!userId || !await isAdmin(userId)) {\r\n        return new NextResponse(\"Unauthorized\", { status: 401 });\r\n    }\r\n\r\n    try {\r\n        const { targetUserId, action, limit, cap } = await request.json();\r\n\r\n        if (action === 'set_limit') {\r\n            await setRateLimitOverride(targetUserId, limit);\r\n        } else if (action === 'set_cap') {\r\n            await setHardCapOverride(targetUserId, cap);\r\n        } else if (action === 'reset_usage') {\r\n            await resetUserUsage(targetUserId);\r\n        } else {\r\n            return NextResponse.json({ error: 'Invalid action' }, { status: 400 });\r\n        }\r\n\r\n        return NextResponse.json({ success: true });\r\n    } catch (error) {\r\n        console.error('Failed to perform admin action:', error);\r\n        return NextResponse.json({ error: 'Action failed' }, { status: 500 });\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\api\\analyze\\route.ts","messages":[],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":537,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":537,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[21948,21951],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[21948,21951],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":568,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":568,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[23379,23382],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[23379,23382],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\api\\cultural-analysis\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Cluster' is defined but never used.","line":32,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":32,"endColumn":18}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from 'next/server';\r\nimport OpenAI from 'openai';\r\nimport { redis } from '@/lib/redis';\r\nimport { checkRateLimit } from '@/lib/ratelimit';\r\nimport { detectSilences } from '@/lib/ontology';\r\n\r\nconst openai = new OpenAI({\r\n    apiKey: process.env.OPENAI_API_KEY,\r\n});\r\n\r\n// System prompt for theme extraction\r\nconst THEME_EXTRACTION_PROMPT = `You are an expert qualitative researcher conducting a \"grounded theory\" analysis of policy documents.\r\n\r\nYour goal is to identify \"emic\" themesconcepts and categories used by the actors themselvesrather than imposing generic \"etic\" categories.\r\n\r\nExtract 5-10 key themes from the provided text. Each theme should be:\r\n- A specific, theoretically rich concept (e.g., \"anticipatory compliance\" instead of just \"compliance\").\r\n- Grounded in the specific language of the text.\r\n- Relevant to the construction of legitimacy, authority, or social order.\r\n\r\nReturn ONLY a JSON array of objects, where each object has a 'theme' and a 'quote'.\r\nExample: [{\"theme\": \"technological inevitability\", \"quote\": \"AI adoption is not a choice but a necessity...\"}, {\"theme\": \"sovereign data control\", \"quote\": \"We must regain control over our digital borders...\"}]`;\r\n\r\ninterface ThemeObject {\r\n    theme: string;\r\n    quote: string;\r\n}\r\n\r\n// interface ThemeExtraction removed\r\n\r\n\r\ninterface Cluster {\r\n    id: string;\r\n    name: string;\r\n    themes: string[];\r\n    quotes: { text: string; source: string }[];\r\n    sources: string[];\r\n    centroid: number[];\r\n    size: number;\r\n    description?: string;\r\n}\r\n\r\ninterface BridgingConcept {\r\n    concept: string;\r\n    explanation: string;\r\n}\r\n\r\ninterface BridgingData {\r\n    bridgingConcepts: BridgingConcept[];\r\n    opportunity: string;\r\n    policyImplication: string;\r\n}\r\n\r\n// interface Hole removed\r\n\r\n\r\n// System prompt for bridging concept generation\r\nconst BRIDGING_PROMPT = `You are a sophisticated social theorist and policy architect.\r\n\r\nYou are analyzing a \"structural hole\" between two distinct discourse communities (Cluster A and Cluster B). Your task is to propose \"bridging concepts\" that could theoretically and practically connect these disconnected worlds.\r\n\r\nAvoid generic management speak (e.g., \"stakeholder collaboration\"). Instead, propose novel, high-level theoretical or strategic concepts that resolve the tension between the two clusters.\r\n\r\nBridging concepts should:\r\n- Synthesize the conflicting logics of Cluster A and Cluster B.\r\n- Be \"boundary objects\"flexible enough to be accepted by both sides but robust enough to maintain identity.\r\n- Represent a genuine intellectual or policy innovation.\r\n\r\nFor EACH bridging concept, provide:\r\n- The concept name (2-4 words, e.g., \"Algorithmic Due Process\", \"Data Sovereignty Trusts\").\r\n- A brief explanation (1 sentence) of how it theoretically bridges the specific gap.\r\n\r\nAlso provide:\r\n1. A description of the \"Innovation Opportunity\": What new form of governance or value creation is possible here?\r\n2. A \"Policy Implication\": How should this bridge be institutionalized?\r\n\r\nReturn your response as JSON with this structure:\r\n{\r\n  \"bridgingConcepts\": [\r\n    {\"concept\": \"concept name\", \"explanation\": \"brief explanation of this bridging concept\"},\r\n    ...\r\n  ],\r\n  \"opportunity\": \"Description of innovation potential\",\r\n  \"policyImplication\": \"Actionable policy recommendation\"\r\n}`;\r\n\r\n// Lens-specific prompt additions\r\nconst LENS_PROMPTS: Record<string, string> = {\r\n    default: \"\",\r\n    institutional_logics: `\r\n    ADOPT AN INSTITUTIONAL LOGICS LENS.\r\n    Focus specifically on identifying conflicting institutional logics (e.g., market vs. state, professional vs. corporate).\r\n    Identify the \"material practices\" and \"symbolic systems\" that constitute these logics.\r\n    Themes should reflect these underlying logics and their contradictions.`,\r\n    critical_data_studies: `\r\n    ADOPT A CRITICAL DATA STUDIES LENS.\r\n    Focus on power dynamics, surveillance, data justice, and how data practices reinforce or challenge existing inequalities.\r\n    Interrogate the \"political economy of data\" and \"epistemic violence\".\r\n    Themes should reflect power relations, marginalization, and justice implications.`,\r\n    actor_network_theory: `\r\n    ADOPT AN ACTOR-NETWORK THEORY (ANT) LENS.\r\n    Treat non-human actors (algorithms, databases, standards) as having agency.\r\n    Focus on \"translation\" processes, \"obligatory passage points\", and how networks are stabilized or destabilized.\r\n    Themes should reflect the agency of artifacts and the mechanics of association.`\r\n};\r\n\r\n// Helper function to calculate cosine similarity\r\nfunction cosineSimilarity(a: number[], b: number[]): number {\r\n    const dotProduct = a.reduce((sum, val, i) => sum + val * b[i], 0);\r\n    const magnitudeA = Math.sqrt(a.reduce((sum, val) => sum + val * val, 0));\r\n    const magnitudeB = Math.sqrt(b.reduce((sum, val) => sum + val * val, 0));\r\n    return dotProduct / (magnitudeA * magnitudeB);\r\n}\r\n\r\n// Helper function to perform hierarchical clustering\r\nfunction hierarchicalClustering(\r\n    themeObjects: { theme: string; quote: string; source: string }[],\r\n    embeddings: number[][],\r\n    sourceIds: string[],\r\n    threshold: number = 0.7\r\n): Array<{ themes: { theme: string; quote: string; source: string }[]; sources: string[]; centroid: number[] }> {\r\n    // Start with each theme as its own cluster\r\n    let clusters = themeObjects.map((obj, i) => ({\r\n        themes: [obj],\r\n        sources: [sourceIds[i]],\r\n        embeddings: [embeddings[i]],\r\n        centroid: embeddings[i],\r\n    }));\r\n\r\n    // Merge clusters until no more similar pairs\r\n    let merged = true;\r\n    while (merged && clusters.length > 1) {\r\n        merged = false;\r\n        let maxSimilarity = threshold;\r\n        let mergeIndices: [number, number] | null = null;\r\n\r\n        // Find most similar pair\r\n        for (let i = 0; i < clusters.length; i++) {\r\n            for (let j = i + 1; j < clusters.length; j++) {\r\n                const similarity = cosineSimilarity(clusters[i].centroid, clusters[j].centroid);\r\n                if (similarity > maxSimilarity) {\r\n                    maxSimilarity = similarity;\r\n                    mergeIndices = [i, j];\r\n                }\r\n            }\r\n        }\r\n\r\n        // Merge if found\r\n        if (mergeIndices) {\r\n            const [i, j] = mergeIndices;\r\n            const newCluster = {\r\n                themes: [...clusters[i].themes, ...clusters[j].themes],\r\n                sources: [...new Set([...clusters[i].sources, ...clusters[j].sources])],\r\n                embeddings: [...clusters[i].embeddings, ...clusters[j].embeddings],\r\n                centroid: clusters[i].centroid.map((val, idx) =>\r\n                    (val + clusters[j].centroid[idx]) / 2\r\n                ),\r\n            };\r\n            clusters = [\r\n                ...clusters.slice(0, i),\r\n                ...clusters.slice(i + 1, j),\r\n                ...clusters.slice(j + 1),\r\n                newCluster,\r\n            ];\r\n            merged = true;\r\n        }\r\n    }\r\n\r\n    return clusters;\r\n}\r\n\r\n// Helper function to safely parse JSON from AI responses\r\nfunction safeJSONParse<T>(text: string, fallback: T): T {\r\n    try {\r\n        // Remove markdown code blocks if present\r\n        let cleaned = text.trim();\r\n        if (cleaned.startsWith('```json')) {\r\n            cleaned = cleaned.replace(/```json\\n?/g, '').replace(/```\\n?$/g, '');\r\n        } else if (cleaned.startsWith('```')) {\r\n            cleaned = cleaned.replace(/```\\n?/g, '');\r\n        }\r\n        cleaned = cleaned.trim();\r\n\r\n        return JSON.parse(cleaned);\r\n    } catch (error) {\r\n        console.error('JSON parse error:', error, 'Text:', text);\r\n        return fallback;\r\n    }\r\n}\r\n\r\nimport { auth } from '@clerk/nextjs/server';\r\n\r\nexport async function POST(request: NextRequest) {\r\n    let { userId } = await auth();\r\n\r\n    // Check for demo user if not authenticated\r\n    if (!userId && process.env.NEXT_PUBLIC_ENABLE_DEMO_MODE === 'true') {\r\n        const demoUserId = request.headers.get('x-demo-user-id');\r\n        console.log('Demo auth check - Header:', demoUserId, 'Expected:', process.env.NEXT_PUBLIC_DEMO_USER_ID);\r\n        if (demoUserId === process.env.NEXT_PUBLIC_DEMO_USER_ID) {\r\n            userId = demoUserId;\r\n        }\r\n    }\r\n\r\n    if (!userId) {\r\n        console.log('Unauthorized request. Headers:', Object.fromEntries(request.headers));\r\n        return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 });\r\n    }\r\n\r\n    // Rate Limiting\r\n    const rateLimit = await checkRateLimit(userId); // Uses default 25 requests per minute\r\n    if (!rateLimit.success) {\r\n        return NextResponse.json(\r\n            { error: rateLimit.error || \"Too Many Requests\" },\r\n            {\r\n                status: 429,\r\n                headers: {\r\n                    'X-RateLimit-Limit': rateLimit.limit.toString(),\r\n                    'X-RateLimit-Remaining': rateLimit.remaining.toString(),\r\n                    'X-RateLimit-Reset': rateLimit.reset.toString()\r\n                }\r\n            }\r\n        );\r\n    }\r\n\r\n    try {\r\n        // Check API key\r\n        if (!process.env.OPENAI_API_KEY) {\r\n            console.error('OPENAI_API_KEY is not set');\r\n            return NextResponse.json(\r\n                { success: false, error: 'OpenAI API key is not configured' },\r\n                { status: 500 }\r\n            );\r\n        }\r\n\r\n        const body = await request.json();\r\n        const { sources, lensId = 'default', forceRefresh = false } = body;\r\n\r\n        console.log('Cultural analysis request received:', {\r\n            sourceCount: sources?.length,\r\n            hasSources: !!sources,\r\n            lensId\r\n        });\r\n\r\n        if (!sources || !Array.isArray(sources) || sources.length < 2) {\r\n            console.error('Invalid sources:', sources);\r\n            return NextResponse.json(\r\n                { success: false, error: 'At least 2 sources required for cultural analysis' },\r\n                { status: 400 }\r\n            );\r\n        }\r\n\r\n        // Generate a unique key for this analysis request based on source IDs and lens\r\n        const sortedSourceIds = sources.map((s: { id: string }) => s.id).sort().join(',');\r\n        const cacheKey = `user:${userId}:analysis:${sortedSourceIds}:${lensId}:v5`;\r\n\r\n        // Check cache first\r\n        try {\r\n            const cachedAnalysis = await redis.get(cacheKey);\r\n            if (cachedAnalysis && !forceRefresh) {\r\n                console.log('Returning cached analysis for key:', cacheKey);\r\n                return NextResponse.json({\r\n                    success: true,\r\n                    analysis: JSON.parse(cachedAnalysis)\r\n                });\r\n            }\r\n        } catch (error) {\r\n            console.error('Redis cache check failed:', error);\r\n            // Continue without cache if Redis fails\r\n        }\r\n\r\n        // Construct the lens-aware prompt\r\n        const lensPrompt = LENS_PROMPTS[lensId as keyof typeof LENS_PROMPTS] || \"\";\r\n        const finalSystemPrompt = `${THEME_EXTRACTION_PROMPT}\\n\\n${lensPrompt}`;\r\n\r\n        // Step 1: Extract themes from each source\r\n        console.log('Extracting themes from sources...');\r\n        const themeExtractions = await Promise.all(\r\n            sources.map(async (source: { id: string; title: string; text: string }, index: number) => {\r\n                try {\r\n                    console.log(`Extracting themes from source ${index + 1}/${sources.length}: ${source.title}`);\r\n\r\n                    const response = await openai.chat.completions.create({\r\n                        model: 'gpt-4o-mini',\r\n                        messages: [\r\n                            { role: 'system', content: finalSystemPrompt },\r\n                            { role: 'user', content: source.text.substring(0, 4000) },\r\n                        ],\r\n                        temperature: 0.3,\r\n                    });\r\n\r\n                    const themesText = response.choices[0].message.content || '[]';\r\n                    console.log(`Raw themes response for ${source.title}:`, themesText.substring(0, 200));\r\n\r\n                    const themes = safeJSONParse<ThemeObject[]>(themesText, []);\r\n                    console.log(`Extracted ${themes.length} themes from ${source.title}`);\r\n\r\n                    return {\r\n                        sourceId: source.id,\r\n                        sourceTitle: source.title,\r\n                        themes,\r\n                    };\r\n                } catch (error: unknown) {\r\n                    console.error(`Error extracting themes from source ${source.title}:`, (error as Error).message);\r\n                    throw error;\r\n                }\r\n            })\r\n        );\r\n\r\n        // Step 2: Generate embeddings for all themes\r\n        console.log('Generating embeddings...');\r\n        const allThemesText: string[] = [];\r\n        const allThemeObjects: { theme: string; quote: string; source: string }[] = [];\r\n        const sourceIds: string[] = [];\r\n\r\n        themeExtractions.forEach((extraction) => {\r\n            extraction.themes.forEach((item: ThemeObject | string) => {\r\n                // Handle both old (string) and new (object) formats for robustness\r\n                const themeText = typeof item === 'string' ? item : item.theme;\r\n                const quote = typeof item === 'string' ? '' : item.quote;\r\n\r\n                allThemesText.push(themeText);\r\n                allThemeObjects.push({ theme: themeText, quote, source: extraction.sourceTitle });\r\n                sourceIds.push(extraction.sourceId);\r\n            });\r\n        });\r\n\r\n        // Filter out empty themes\r\n        const validThemes = allThemesText.filter(t => t && t.trim().length > 0);\r\n\r\n        if (validThemes.length === 0) {\r\n            console.log('No valid themes found in sources.');\r\n            return NextResponse.json({\r\n                success: true,\r\n                analysis: {\r\n                    summary: \"No themes could be extracted from the provided sources. Please ensure the documents contain sufficient text content.\",\r\n                    clusters: [],\r\n                    holes: [],\r\n                    silences: [],\r\n                    overall_connectivity_score: 0,\r\n                    timestamp: new Date().toISOString(),\r\n                }\r\n            });\r\n        }\r\n\r\n        const embeddingResponse = await openai.embeddings.create({\r\n            model: 'text-embedding-3-small',\r\n            input: validThemes,\r\n        });\r\n\r\n        const embeddings = embeddingResponse.data.map((item) => item.embedding);\r\n\r\n        // Step 3: Cluster themes\r\n        console.log('Clustering themes...');\r\n        const rawClusters = hierarchicalClustering(allThemeObjects, embeddings, sourceIds, 0.7);\r\n\r\n        // Format clusters\r\n        const clusters = rawClusters.map((cluster, i) => ({\r\n            id: `cluster-${i}`,\r\n            name: cluster.themes[0].theme, // Use first theme as cluster name\r\n            themes: cluster.themes.map(t => t.theme), // Keep simple string array for compatibility if needed\r\n            quotes: cluster.themes.map(t => ({ text: t.quote, source: t.source })).filter(q => q.text), // Extract quotes with source\r\n            sources: cluster.sources,\r\n            centroid: cluster.centroid,\r\n            size: cluster.themes.length,\r\n        }));\r\n\r\n        // Generate descriptions for each cluster\r\n        console.log('Generating cluster descriptions...');\r\n        const clustersWithDescriptions = await Promise.all(\r\n            clusters.map(async (cluster) => {\r\n                try {\r\n                    const descriptionResponse = await openai.chat.completions.create({\r\n                        model: 'gpt-4o-mini',\r\n                        messages: [\r\n                            {\r\n                                role: 'system',\r\n                                content: `You are an expert in discourse analysis and policy research. Given a list of related themes, provide a single concise sentence (max 15 words) that defines what this discourse cluster represents. Examples: \"regulatory copying policies\", \"grand societal challenges\", \"diversity-coherence paradox\", \"enactment fields\". Focus on identifying the conceptual pattern or theoretical category.`\r\n                            },\r\n                            {\r\n                                role: 'user',\r\n                                content: `Themes: ${cluster.themes.join(', ')}`\r\n                            }\r\n                        ],\r\n                        temperature: 0.3,\r\n                    });\r\n\r\n                    const description = descriptionResponse.choices[0].message.content?.trim() || cluster.name;\r\n                    return { ...cluster, description };\r\n                } catch (error) {\r\n                    console.error(`Error generating description for cluster ${cluster.id}:`, error);\r\n                    return { ...cluster, description: cluster.name };\r\n                }\r\n            })\r\n        );\r\n\r\n        // Step 4: Identify cultural holes (gaps between clusters)\r\n        console.log('Identifying cultural holes...');\r\n        const potentialHoles = [];\r\n        const holeThreshold = 0.4; // Clusters with similarity < 0.4 are considered \"holes\"\r\n\r\n        for (let i = 0; i < clustersWithDescriptions.length; i++) {\r\n            for (let j = i + 1; j < clustersWithDescriptions.length; j++) {\r\n                const similarity = cosineSimilarity(clustersWithDescriptions[i].centroid, clustersWithDescriptions[j].centroid);\r\n                const distance = 1 - similarity;\r\n\r\n                if (distance > holeThreshold) {\r\n                    potentialHoles.push({\r\n                        clusterA: clustersWithDescriptions[i],\r\n                        clusterB: clustersWithDescriptions[j],\r\n                        distance: parseFloat(distance.toFixed(3)),\r\n                    });\r\n                }\r\n            }\r\n        }\r\n\r\n        // Sort by distance and only generate bridging concepts for top 3 largest gaps\r\n        potentialHoles.sort((a, b) => b.distance - a.distance);\r\n        const topHoles = potentialHoles.slice(0, 3);\r\n\r\n        console.log(`Found ${potentialHoles.length} potential holes, generating bridging concepts for top ${topHoles.length}`);\r\n\r\n        const holes = await Promise.all(\r\n            topHoles.map(async (hole) => {\r\n                try {\r\n                    const bridgingResponse = await openai.chat.completions.create({\r\n                        model: 'gpt-4o',\r\n                        messages: [\r\n                            { role: 'system', content: BRIDGING_PROMPT },\r\n                            {\r\n                                role: 'user',\r\n                                content: `Cluster A themes: ${hole.clusterA.themes.join(', ')}\\n\\nCluster B themes: ${hole.clusterB.themes.join(', ')}`,\r\n                            },\r\n                        ],\r\n                        temperature: 0.5,\r\n                    });\r\n\r\n                    const bridgingData = safeJSONParse<BridgingData>(\r\n                        bridgingResponse.choices[0].message.content || '{}',\r\n                        { bridgingConcepts: [], opportunity: '', policyImplication: '' }\r\n                    );\r\n\r\n                    return {\r\n                        id: `hole-${hole.clusterA.id}-${hole.clusterB.id}`,\r\n                        clusterA: hole.clusterA.name,\r\n                        clusterB: hole.clusterB.name,\r\n                        distance: hole.distance,\r\n                        bridgingConcepts: bridgingData.bridgingConcepts || [],\r\n                        opportunity: bridgingData.opportunity || '',\r\n                        policyImplication: bridgingData.policyImplication || '',\r\n                    };\r\n                } catch (error: unknown) {\r\n                    console.error(`Error generating bridging concepts:`, (error as Error).message);\r\n                    return {\r\n                        id: `hole-${hole.clusterA.id}-${hole.clusterB.id}`,\r\n                        clusterA: hole.clusterA.name,\r\n                        clusterB: hole.clusterB.name,\r\n                        distance: hole.distance,\r\n                        bridgingConcepts: [],\r\n                        opportunity: 'Error generating opportunity description',\r\n                        policyImplication: 'Error generating policy implication',\r\n                    };\r\n                }\r\n            })\r\n        );\r\n\r\n        console.log(`Cultural analysis complete. Found ${clusters.length} clusters and ${holes.length} cultural holes`);\r\n\r\n        // Step 4b: Detect Silences (Cultural-Hole Detector)\r\n        console.log('Detecting silences (missing stakeholders)...');\r\n        // Combine all source text for silence detection\r\n        const combinedText = sources.map((s: { text: string }) => s.text).join(' ');\r\n        const silences = detectSilences(combinedText);\r\n        console.log(`Found ${silences.length} silences.`);\r\n\r\n        // Step 5: Generate overall summary\r\n        console.log('Generating overall summary...');\r\n        let summary = \"\";\r\n        try {\r\n            const summaryResponse = await openai.chat.completions.create({\r\n                model: 'gpt-4o-mini',\r\n                messages: [\r\n                    {\r\n                        role: 'system',\r\n                        content: `You are an expert in cultural sociology and innovation ecosystems. \r\n                        Summarize the key findings of this cultural analysis in 2-3 sentences.\r\n                        Focus on the main discourse clusters identified and the most significant cultural hole (gap) between them.\r\n                        Highlight the potential for innovation or policy intervention.`\r\n                    },\r\n                    {\r\n                        role: 'user',\r\n                        content: `Analysis Results:\r\n                        Clusters: ${clustersWithDescriptions.map(c => c.name).join(', ')}\r\n                        Top Cultural Hole: ${holes.length > 0 ? `Between ${holes[0].clusterA} and ${holes[0].clusterB} (Distance: ${holes[0].distance})` : \"None found\"}\r\n                        Bridging Concepts: ${holes.length > 0 && holes[0].bridgingConcepts ? holes[0].bridgingConcepts.map((bc: BridgingConcept) => bc.concept).join(', ') : \"N/A\"}`\r\n                    }\r\n                ],\r\n                temperature: 0.5,\r\n            });\r\n            summary = summaryResponse.choices[0].message.content || \"\";\r\n        } catch (error) {\r\n            console.error(\"Error generating summary:\", error);\r\n            summary = \"Summary generation failed.\";\r\n        }\r\n\r\n        // Calculate Overall Connectivity Score\r\n        let overall_connectivity_score = 1.0;\r\n        if (clustersWithDescriptions.length > 1) {\r\n            let totalSimilarity = 0;\r\n            let pairCount = 0;\r\n            for (let i = 0; i < clustersWithDescriptions.length; i++) {\r\n                for (let j = i + 1; j < clustersWithDescriptions.length; j++) {\r\n                    const similarity = cosineSimilarity(clustersWithDescriptions[i].centroid, clustersWithDescriptions[j].centroid);\r\n                    totalSimilarity += similarity;\r\n                    pairCount++;\r\n                }\r\n            }\r\n            if (pairCount > 0) {\r\n                overall_connectivity_score = totalSimilarity / pairCount;\r\n            }\r\n        }\r\n\r\n        const analysisResult = {\r\n            summary,\r\n            clusters: clustersWithDescriptions,\r\n            holes,\r\n            silences,\r\n            overall_connectivity_score,\r\n            timestamp: new Date().toISOString(),\r\n        };\r\n\r\n        // Cache the result\r\n        try {\r\n            await redis.set(cacheKey, JSON.stringify(analysisResult));\r\n        } catch (error) {\r\n            console.error('Failed to cache analysis result:', error);\r\n        }\r\n\r\n        return NextResponse.json({\r\n            success: true,\r\n            analysis: analysisResult,\r\n        });\r\n\r\n    } catch (error: unknown) {\r\n        console.error('Cultural analysis error:', error);\r\n        return NextResponse.json(\r\n            { success: false, error: (error as Error).message || 'Cultural analysis failed' },\r\n            { status: 500 }\r\n        );\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\api\\ecosystem\\clear-cache\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\api\\ecosystem\\simulate\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\api\\fetch-url\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\api\\generate-image\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\api\\generate-search-terms\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'_parseError' is defined but never used.","line":80,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":80,"endColumn":29}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextResponse } from 'next/server';\r\nimport OpenAI from 'openai';\r\nimport { checkRateLimit } from '@/lib/ratelimit';\r\n\r\nimport { auth } from '@clerk/nextjs/server';\r\n\r\nexport async function POST(req: Request) {\r\n    const { userId } = await auth();\r\n    if (!userId) {\r\n        return new NextResponse(\"Unauthorized\", { status: 401 });\r\n    }\r\n\r\n    // Rate Limiting\r\n    const rateLimit = await checkRateLimit(userId); // Uses default 25 requests per minute\r\n    if (!rateLimit.success) {\r\n        return NextResponse.json(\r\n            { error: rateLimit.error || \"Too Many Requests\" },\r\n            {\r\n                status: 429,\r\n                headers: {\r\n                    'X-RateLimit-Limit': rateLimit.limit.toString(),\r\n                    'X-RateLimit-Remaining': rateLimit.remaining.toString(),\r\n                    'X-RateLimit-Reset': rateLimit.reset.toString()\r\n                }\r\n            }\r\n        );\r\n    }\r\n\r\n    try {\r\n        const { keyInsight } = await req.json();\r\n\r\n        if (!keyInsight) {\r\n            return NextResponse.json(\r\n                { success: false, error: 'Key insight is required' },\r\n                { status: 400 }\r\n            );\r\n        }\r\n\r\n        const apiKey = process.env.OPENAI_API_KEY;\r\n        if (!apiKey) {\r\n            return NextResponse.json(\r\n                { success: false, error: 'OpenAI API key not configured' },\r\n                { status: 500 }\r\n            );\r\n        }\r\n\r\n        const openai = new OpenAI({ apiKey });\r\n\r\n        const prompt = `Given this policy insight, extract 3-5 key search terms or phrases that would be most effective for finding related discussions on Reddit. Focus on concrete topics, issues, or controversies that people would actually discuss online.\r\n\r\nInsight: \"${keyInsight}\"\r\n\r\nReturn ONLY a JSON array of search terms, without any markdown formatting or explanation. Example format:\r\n[\"algorithmic bias\", \"AI regulation\", \"facial recognition\"]`;\r\n\r\n        const response = await openai.chat.completions.create({\r\n            model: 'gpt-4o-mini',\r\n            messages: [\r\n                {\r\n                    role: 'system',\r\n                    content: 'You are a search optimization expert. Extract the most relevant search terms for finding online discussions.'\r\n                },\r\n                { role: 'user', content: prompt }\r\n            ],\r\n            temperature: 0.3,\r\n            max_tokens: 200\r\n        });\r\n\r\n        const content = response.choices[0].message.content?.trim() || '[]';\r\n\r\n        // Parse the JSON response (handle potential markdown wrapping)\r\n        let searchTerms: string[];\r\n        try {\r\n            const jsonMatch = content.match(/\\[[\\s\\S]*\\]/);\r\n            if (jsonMatch) {\r\n                searchTerms = JSON.parse(jsonMatch[0]);\r\n            } else {\r\n                searchTerms = JSON.parse(content);\r\n            }\r\n        } catch (_parseError) {\r\n            console.error('Failed to parse AI response:', content);\r\n            return NextResponse.json(\r\n                { success: false, error: 'Failed to parse AI response' },\r\n                { status: 500 }\r\n            );\r\n        }\r\n\r\n        // Validate that we got an array of strings\r\n        if (!Array.isArray(searchTerms) || searchTerms.length === 0) {\r\n            return NextResponse.json(\r\n                { success: false, error: 'Invalid search terms generated' },\r\n                { status: 500 }\r\n            );\r\n        }\r\n\r\n        return NextResponse.json({ success: true, searchTerms });\r\n\r\n    } catch (error) {\r\n        console.error('Search term generation error:', error);\r\n        return NextResponse.json(\r\n            { success: false, error: 'Internal Server Error' },\r\n            { status: 500 }\r\n        );\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\api\\governance\\compass\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\api\\logs\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":9,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":9,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[259,262],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[259,262],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'_error' is defined but never used.","line":42,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":42,"endColumn":20},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'_error' is defined but never used.","line":83,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":83,"endColumn":20}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from 'next/server';\r\nimport { redis } from '@/lib/redis';\r\nimport { auth } from '@clerk/nextjs/server';\r\n\r\n// Define a type for the log entry\r\ntype LogEntry = {\r\n    id: string;\r\n    timestamp: string;\r\n    [key: string]: any; // Allow other properties\r\n};\r\n\r\n// Helper function to get logs\r\nasync function getLogs(userId: string): Promise<LogEntry[]> {\r\n    const logsKey = `user:${userId}:logs`;\r\n    const data = await redis.get(logsKey);\r\n    return data ? JSON.parse(data) : [];\r\n}\r\n\r\n// Helper function to save logs\r\nasync function saveLogs(userId: string, logs: LogEntry[]) {\r\n    const logsKey = `user:${userId}:logs`;\r\n    await redis.set(logsKey, JSON.stringify(logs));\r\n}\r\n\r\nexport async function GET(request: NextRequest) {\r\n    let { userId } = await auth();\r\n\r\n    // Check for demo user if not authenticated\r\n    if (!userId && process.env.NEXT_PUBLIC_ENABLE_DEMO_MODE === 'true') {\r\n        const demoUserId = request.headers.get('x-demo-user-id');\r\n        if (demoUserId === process.env.NEXT_PUBLIC_DEMO_USER_ID) {\r\n            userId = demoUserId;\r\n        }\r\n    }\r\n\r\n    if (!userId) {\r\n        return new NextResponse(\"Unauthorized\", { status: 401 });\r\n    }\r\n    try {\r\n        const logs: LogEntry[] = await getLogs(userId);\r\n        return NextResponse.json(logs);\r\n    } catch (_error) {\r\n        return NextResponse.json({ error: 'Failed to fetch logs' }, { status: 500 });\r\n    }\r\n}\r\n\r\nexport async function POST(request: NextRequest) {\r\n    let { userId } = await auth();\r\n\r\n    // Check for demo user if not authenticated\r\n    if (!userId && process.env.NEXT_PUBLIC_ENABLE_DEMO_MODE === 'true') {\r\n        const demoUserId = request.headers.get('x-demo-user-id');\r\n        if (demoUserId === process.env.NEXT_PUBLIC_DEMO_USER_ID) {\r\n            userId = demoUserId;\r\n        }\r\n    }\r\n\r\n    if (!userId) {\r\n        return new NextResponse(\"Unauthorized\", { status: 401 });\r\n    }\r\n    try {\r\n        const body = await request.json();\r\n\r\n        // Fetch existing logs\r\n        const logs: LogEntry[] = await getLogs(userId);\r\n\r\n        // Add new log\r\n        const newLog: LogEntry = {\r\n            id: crypto.randomUUID(),\r\n            timestamp: new Date().toISOString(),\r\n            ...body\r\n        };\r\n        logs.unshift(newLog); // Add to beginning\r\n\r\n        // Keep only last 1000 logs\r\n        if (logs.length > 1000) {\r\n            logs.length = 1000;\r\n        }\r\n\r\n        await saveLogs(userId, logs);\r\n\r\n        return NextResponse.json(newLog);\r\n    } catch (_error) {\r\n        return NextResponse.json({ error: 'Failed to save log' }, { status: 500 });\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\api\\search-traces\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\api\\search\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\api\\sources\\[id]\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'_error' is defined but never used.","line":66,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":66,"endColumn":20}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from 'next/server';\r\nimport { updateSource, deleteSource } from '@/lib/store';\r\n\r\nimport { auth } from '@clerk/nextjs/server';\r\n\r\nexport async function PUT(\r\n    request: NextRequest,\r\n    { params }: { params: Promise<{ id: string }> }\r\n) {\r\n    let { userId } = await auth();\r\n\r\n    // Check for demo user if not authenticated\r\n    if (!userId && process.env.NEXT_PUBLIC_ENABLE_DEMO_MODE === 'true') {\r\n        const demoUserId = request.headers.get('x-demo-user-id');\r\n        if (demoUserId === process.env.NEXT_PUBLIC_DEMO_USER_ID) {\r\n            userId = demoUserId;\r\n        }\r\n    }\r\n\r\n    if (!userId) {\r\n        return new NextResponse(\"Unauthorized\", { status: 401 });\r\n    }\r\n    try {\r\n        const { id } = await params;\r\n        const body = await request.json();\r\n        const updatedSource = await updateSource(userId, id, body);\r\n\r\n        if (!updatedSource) {\r\n            return NextResponse.json({ error: 'Source not found' }, { status: 404 });\r\n        }\r\n\r\n        return NextResponse.json(updatedSource);\r\n    } catch (error: unknown) {\r\n        console.error('Update source error:', error);\r\n        const errorMessage = error instanceof Error ? error.message : 'Unknown error';\r\n        return NextResponse.json({ error: `Failed to update source: ${errorMessage}` }, { status: 500 });\r\n    }\r\n}\r\n\r\nexport async function DELETE(\r\n    request: NextRequest,\r\n    { params }: { params: Promise<{ id: string }> }\r\n) {\r\n    let { userId } = await auth();\r\n\r\n    // Check for demo user if not authenticated\r\n    if (!userId && process.env.NEXT_PUBLIC_ENABLE_DEMO_MODE === 'true') {\r\n        const demoUserId = request.headers.get('x-demo-user-id');\r\n        if (demoUserId === process.env.NEXT_PUBLIC_DEMO_USER_ID) {\r\n            userId = demoUserId;\r\n        }\r\n    }\r\n\r\n    if (!userId) {\r\n        return new NextResponse(\"Unauthorized\", { status: 401 });\r\n    }\r\n    try {\r\n        const { id } = await params;\r\n        const success = await deleteSource(userId, id);\r\n\r\n        if (!success) {\r\n            return NextResponse.json({ error: 'Source not found' }, { status: 404 });\r\n        }\r\n\r\n        return NextResponse.json({ success: true });\r\n    } catch (_error) {\r\n        return NextResponse.json({ error: 'Failed to delete source' }, { status: 500 });\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\api\\sources\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'_error' is defined but never used.","line":23,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":23,"endColumn":20},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'_error' is defined but never used.","line":46,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":46,"endColumn":20}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from 'next/server';\r\nimport { getSources, addSource } from '@/lib/store';\r\n\r\nimport { auth } from '@clerk/nextjs/server';\r\n\r\nexport async function GET(request: NextRequest) {\r\n    let { userId } = await auth();\r\n\r\n    // Check for demo user if not authenticated\r\n    if (!userId && process.env.NEXT_PUBLIC_ENABLE_DEMO_MODE === 'true') {\r\n        const demoUserId = request.headers.get('x-demo-user-id');\r\n        if (demoUserId === process.env.NEXT_PUBLIC_DEMO_USER_ID) {\r\n            userId = demoUserId;\r\n        }\r\n    }\r\n\r\n    if (!userId) {\r\n        return new NextResponse(\"Unauthorized\", { status: 401 });\r\n    }\r\n    try {\r\n        const sources = await getSources(userId);\r\n        return NextResponse.json(sources);\r\n    } catch (_error) {\r\n        return NextResponse.json({ error: 'Failed to fetch sources' }, { status: 500 });\r\n    }\r\n}\r\n\r\nexport async function POST(request: NextRequest) {\r\n    let { userId } = await auth();\r\n\r\n    // Check for demo user if not authenticated\r\n    if (!userId && process.env.NEXT_PUBLIC_ENABLE_DEMO_MODE === 'true') {\r\n        const demoUserId = request.headers.get('x-demo-user-id');\r\n        if (demoUserId === process.env.NEXT_PUBLIC_DEMO_USER_ID) {\r\n            userId = demoUserId;\r\n        }\r\n    }\r\n\r\n    if (!userId) {\r\n        return new NextResponse(\"Unauthorized\", { status: 401 });\r\n    }\r\n    try {\r\n        const body = await request.json();\r\n        const newSource = await addSource(userId, body);\r\n        return NextResponse.json(newSource);\r\n    } catch (_error) {\r\n        return NextResponse.json({ error: 'Failed to create source' }, { status: 500 });\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\api\\storage\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\comparison\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AnalysisResult' is defined but never used.","line":13,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":13,"endColumn":32}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport { useSources } from \"@/hooks/useSources\";\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\r\nimport { ArrowLeftRight, Globe2, Scale, Users, Building, Loader2, Sparkles, AlertTriangle, RefreshCw } from \"lucide-react\";\r\nimport { LegitimacyAnalysisView } from \"@/components/policy/LegitimacyAnalysisView\";\r\nimport { synthesizeComparison } from \"@/services/analysis\";\r\n\r\nimport { Source, AnalysisResult, ComparativeSynthesis } from \"@/types\";\r\n\r\n// CulturalFraming type removed\r\n\r\nexport default function ComparisonPage() {\r\n    const { sources, isLoading, updateSource } = useSources();\r\n\r\n    // Filter for policy documents (non-traces)\r\n    const policyDocs = sources.filter(s => s.type !== \"Trace\");\r\n\r\n    const [selectedDocs, setSelectedDocs] = useState<string[]>([]);\r\n    const [activeTab, setActiveTab] = useState<\"cultural\" | \"logics\" | \"legitimacy\" | \"synthesis\">(\"cultural\");\r\n    const [isSynthesizing, setIsSynthesizing] = useState(false);\r\n    const [synthesisResult, setSynthesisResult] = useState<ComparativeSynthesis | null>(null);\r\n    const [synthesisError, setSynthesisError] = useState<string | null>(null);\r\n    const [regeneratingIds, setRegeneratingIds] = useState<Record<string, boolean>>({});\r\n\r\n    useEffect(() => {\r\n        if (isLoading) return;\r\n\r\n        // Auto-select first two docs\r\n        if (policyDocs.length >= 2 && selectedDocs.length === 0) {\r\n            setSelectedDocs([policyDocs[0].id, policyDocs[1].id]);\r\n        }\r\n    }, [isLoading, selectedDocs.length, policyDocs]);\r\n\r\n    const selectedSources = selectedDocs\r\n        .map(id => policyDocs.find(s => s.id === id))\r\n        .filter(Boolean) as Source[];\r\n\r\n    const logicIcons = {\r\n        market: Building,\r\n        state: Scale,\r\n        professional: Users,\r\n        community: Users,\r\n    };\r\n\r\n    const logicColors = {\r\n        market: \"text-purple-600 bg-purple-100\",\r\n        state: \"text-blue-600 bg-blue-100\",\r\n        professional: \"text-green-600 bg-green-100\",\r\n        community: \"text-orange-600 bg-orange-100\",\r\n    };\r\n\r\n    const handleSynthesize = async () => {\r\n        if (selectedSources.length < 2) return;\r\n\r\n        // Validation: Check if all analyses are present\r\n        const missingAnalysis = selectedSources.some(\r\n            s => !s.cultural_framing || !s.institutional_logics || !s.legitimacy_analysis\r\n        );\r\n\r\n        if (missingAnalysis) {\r\n            setSynthesisError(\"All selected documents must have Cultural Framing, Institutional Logics, and Legitimacy analysis completed before synthesis.\");\r\n            return;\r\n        }\r\n\r\n        setSynthesisError(null);\r\n        setIsSynthesizing(true);\r\n        setActiveTab(\"synthesis\");\r\n\r\n        try {\r\n            // Prepare documents for synthesis (strip unnecessary fields to save tokens if needed, but passing full object for now is fine as they contain the analysis)\r\n            const result = await synthesizeComparison(selectedSources);\r\n            // The API returns the synthesis in the analysis field, but untyped.\r\n            setSynthesisResult(result as unknown as ComparativeSynthesis);\r\n        } catch (error) {\r\n            console.error(\"Synthesis failed:\", error);\r\n            setSynthesisError(\"Failed to generate synthesis. Please try again.\");\r\n        } finally {\r\n            setIsSynthesizing(false);\r\n        }\r\n    };\r\n\r\n    const handleRegenerateCultural = async (source: Source) => {\r\n        setRegeneratingIds(prev => ({ ...prev, [source.id]: true }));\r\n\r\n        try {\r\n            const headers: HeadersInit = { 'Content-Type': 'application/json' };\r\n            if (process.env.NEXT_PUBLIC_ENABLE_DEMO_MODE === 'true' && process.env.NEXT_PUBLIC_DEMO_USER_ID) {\r\n                headers['x-demo-user-id'] = process.env.NEXT_PUBLIC_DEMO_USER_ID;\r\n            }\r\n\r\n            const response = await fetch('/api/analyze', {\r\n                method: 'POST',\r\n                headers: headers,\r\n                body: JSON.stringify({\r\n                    text: source.extractedText?.substring(0, 50000) || '',\r\n                    sourceType: 'Policy Document',\r\n                    analysisMode: 'cultural_framing',\r\n                    force: true,\r\n                    documentId: source.id,\r\n                    title: source.title\r\n                })\r\n            });\r\n\r\n            const data = await response.json();\r\n            if (data.success && data.analysis) {\r\n                await updateSource(source.id, { cultural_framing: data.analysis });\r\n            } else {\r\n                alert(\"Regeneration failed: \" + (data.error || \"Unknown error\"));\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Regeneration error:\", error);\r\n            alert(\"Failed to regenerate analysis.\");\r\n        } finally {\r\n            setRegeneratingIds(prev => ({ ...prev, [source.id]: false }));\r\n        }\r\n    };\r\n\r\n    const handleRegenerateLogics = async (source: Source) => {\r\n        setRegeneratingIds(prev => ({ ...prev, [source.id]: true }));\r\n        try {\r\n            const headers: HeadersInit = { 'Content-Type': 'application/json' };\r\n            if (process.env.NEXT_PUBLIC_ENABLE_DEMO_MODE === 'true' && process.env.NEXT_PUBLIC_DEMO_USER_ID) {\r\n                headers['x-demo-user-id'] = process.env.NEXT_PUBLIC_DEMO_USER_ID;\r\n            }\r\n\r\n            const response = await fetch('/api/analyze', {\r\n                method: 'POST',\r\n                headers: headers,\r\n                body: JSON.stringify({\r\n                    text: source.extractedText?.substring(0, 50000) || '',\r\n                    sourceType: 'Policy Document',\r\n                    analysisMode: 'institutional_logics',\r\n                    force: true,\r\n                    documentId: source.id,\r\n                    title: source.title\r\n                })\r\n            });\r\n            const data = await response.json();\r\n            if (data.success && data.analysis) {\r\n                await updateSource(source.id, { institutional_logics: data.analysis });\r\n            } else {\r\n                alert(\"Regeneration failed: \" + (data.error || \"Unknown error\"));\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Regeneration error:\", error);\r\n            alert(\"Failed to regenerate analysis.\");\r\n        } finally {\r\n            setRegeneratingIds(prev => ({ ...prev, [source.id]: false }));\r\n        }\r\n    };\r\n\r\n    const handleRegenerateLegitimacy = async (source: Source) => {\r\n        setRegeneratingIds(prev => ({ ...prev, [source.id]: true }));\r\n        try {\r\n            const headers: HeadersInit = { 'Content-Type': 'application/json' };\r\n            if (process.env.NEXT_PUBLIC_ENABLE_DEMO_MODE === 'true' && process.env.NEXT_PUBLIC_DEMO_USER_ID) {\r\n                headers['x-demo-user-id'] = process.env.NEXT_PUBLIC_DEMO_USER_ID;\r\n            }\r\n\r\n            const response = await fetch('/api/analyze', {\r\n                method: 'POST',\r\n                headers: headers,\r\n                body: JSON.stringify({\r\n                    text: source.extractedText?.substring(0, 50000) || '',\r\n                    sourceType: 'Policy Document',\r\n                    analysisMode: 'legitimacy',\r\n                    force: true,\r\n                    documentId: source.id,\r\n                    title: source.title\r\n                })\r\n            });\r\n            const data = await response.json();\r\n            if (data.success && data.analysis) {\r\n                await updateSource(source.id, { legitimacy_analysis: data.analysis });\r\n            } else {\r\n                alert(\"Regeneration failed: \" + (data.error || \"Unknown error\"));\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Regeneration error:\", error);\r\n            alert(\"Failed to regenerate analysis.\");\r\n        } finally {\r\n            setRegeneratingIds(prev => ({ ...prev, [source.id]: false }));\r\n        }\r\n    };\r\n\r\n    if (isLoading) {\r\n        return (\r\n            <div className=\"flex items-center justify-center h-64\">\r\n                <Loader2 className=\"h-8 w-8 animate-spin text-slate-400\" />\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"space-y-8\">\r\n            <div>\r\n                <h2 className=\"text-3xl font-bold tracking-tight text-slate-900\">Comparative Analysis</h2>\r\n                <p className=\"text-slate-500\">Compare cultural framing, institutional logics, and legitimacy across jurisdictions.</p>\r\n            </div>\r\n\r\n            {/* Definitions Card */}\r\n            <Card className=\"bg-slate-50 border-slate-200\">\r\n                <CardHeader className=\"pb-3\">\r\n                    <CardTitle className=\"text-base font-semibold text-slate-700\">Analysis Definitions</CardTitle>\r\n                </CardHeader>\r\n                <CardContent className=\"grid gap-4 md:grid-cols-3 text-sm\">\r\n                    <div>\r\n                        <div className=\"font-semibold text-slate-900 mb-1 flex items-center gap-2\">\r\n                            <Globe2 className=\"h-4 w-4 text-blue-600\" />\r\n                            Cultural Framing\r\n                        </div>\r\n                        <p className=\"text-slate-600\">\r\n                            How a policy problem is constructed through specific cultural lenses (e.g., market-driven vs. rights-driven).\r\n                        </p>\r\n                    </div>\r\n                    <div>\r\n                        <div className=\"font-semibold text-slate-900 mb-1 flex items-center gap-2\">\r\n                            <Scale className=\"h-4 w-4 text-purple-600\" />\r\n                            Institutional Logics\r\n                        </div>\r\n                        <p className=\"text-slate-600\">\r\n                            The organizing principles that shape behavior and decision-making (e.g., state, market, profession, community).\r\n                        </p>\r\n                    </div>\r\n                    <div>\r\n                        <div className=\"font-semibold text-slate-900 mb-1 flex items-center gap-2\">\r\n                            <Scale className=\"h-4 w-4 text-emerald-600\" />\r\n                            Legitimacy\r\n                        </div>\r\n                        <p className=\"text-slate-600\">\r\n                            The moral justifications used to defend or critique a system (based on Boltanski & Thvenot&apos;s Orders of Worth).\r\n                        </p>\r\n                    </div>\r\n                </CardContent>\r\n            </Card>\r\n\r\n            {/* Document Selector */}\r\n            <Card>\r\n                <CardHeader>\r\n                    <CardTitle className=\"flex items-center gap-2\">\r\n                        <ArrowLeftRight className=\"h-5 w-5\" />\r\n                        Select Documents to Compare\r\n                    </CardTitle>\r\n                    <CardDescription>Choose 2-3 policy documents for side-by-side analysis</CardDescription>\r\n                </CardHeader>\r\n                <CardContent>\r\n                    <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n                        {[0, 1, 2].map((index) => (\r\n                            <div key={index}>\r\n                                <label className=\"text-sm font-medium text-slate-700 mb-2 block\">\r\n                                    Document {index + 1} {index > 0 && \"(Optional)\"}\r\n                                </label>\r\n                                <Select\r\n                                    value={selectedDocs[index] || \"\"}\r\n                                    onValueChange={(value) => {\r\n                                        const newSelection = [...selectedDocs];\r\n                                        newSelection[index] = value;\r\n                                        setSelectedDocs(newSelection.filter(Boolean));\r\n                                    }}\r\n                                >\r\n                                    <SelectTrigger>\r\n                                        <SelectValue placeholder=\"Select document...\" />\r\n                                    </SelectTrigger>\r\n                                    <SelectContent>\r\n                                        {policyDocs.map((doc) => (\r\n                                            <SelectItem key={doc.id} value={doc.id}>\r\n                                                {doc.title}\r\n                                                {doc.jurisdiction && (\r\n                                                    <Badge variant=\"outline\" className=\"ml-2\">\r\n                                                        {doc.jurisdiction}\r\n                                                    </Badge>\r\n                                                )}\r\n                                            </SelectItem>\r\n                                        ))}\r\n                                    </SelectContent>\r\n                                </Select>\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                </CardContent>\r\n            </Card>\r\n\r\n            {/* Analysis Type Tabs */}\r\n            {selectedSources.length >= 2 && (\r\n                <>\r\n                    <div className=\"flex gap-2\">\r\n                        <Button\r\n                            variant={activeTab === \"cultural\" ? \"default\" : \"outline\"}\r\n                            onClick={() => setActiveTab(\"cultural\")}\r\n                            className=\"flex-1\"\r\n                        >\r\n                            <Globe2 className=\"mr-2 h-4 w-4\" />\r\n                            Cultural Framing\r\n                        </Button>\r\n                        <Button\r\n                            variant={activeTab === \"logics\" ? \"default\" : \"outline\"}\r\n                            onClick={() => setActiveTab(\"logics\")}\r\n                            className=\"flex-1\"\r\n                        >\r\n                            <Scale className=\"mr-2 h-4 w-4\" />\r\n                            Institutional Logics\r\n                        </Button>\r\n                        <Button\r\n                            variant={activeTab === \"legitimacy\" ? \"default\" : \"outline\"}\r\n                            onClick={() => setActiveTab(\"legitimacy\")}\r\n                            className=\"flex-1\"\r\n                        >\r\n                            <Scale className=\"mr-2 h-4 w-4\" />\r\n                            Legitimacy\r\n                        </Button>\r\n                        <Button\r\n                            variant={activeTab === \"synthesis\" ? \"default\" : \"outline\"}\r\n                            onClick={handleSynthesize}\r\n                            className=\"flex-1 bg-indigo-50 text-indigo-700 hover:bg-indigo-100 border-indigo-200\"\r\n                        >\r\n                            {isSynthesizing ? (\r\n                                <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\r\n                            ) : (\r\n                                <Sparkles className=\"mr-2 h-4 w-4\" />\r\n                            )}\r\n                            Synthesize\r\n                        </Button>\r\n                    </div>\r\n\r\n                    {synthesisError && (\r\n                        <div className=\"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md flex items-center gap-2 text-sm\">\r\n                            <AlertTriangle className=\"h-4 w-4\" />\r\n                            {synthesisError}\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* Cultural Framing Comparison */}\r\n                    {activeTab === \"cultural\" && (\r\n                        // ... existing cultural framing content\r\n                        <div className=\"space-y-6\">\r\n                            <Card>\r\n                                <CardHeader>\r\n                                    <CardTitle>Cultural Framing Comparison</CardTitle>\r\n                                    <CardDescription>\r\n                                        How do these jurisdictions differ in their cultural assumptions about AI governance?\r\n                                    </CardDescription>\r\n                                </CardHeader>\r\n                                <CardContent>\r\n                                    {!selectedSources[0]?.cultural_framing && (\r\n                                        <div className=\"text-center py-8 text-slate-500\">\r\n                                            <p className=\"mb-4\">No cultural framing analysis yet.</p>\r\n                                            <p className=\"text-sm\">\r\n                                                Run cultural framing analysis on these documents first.\r\n                                            </p>\r\n                                            <code className=\"text-xs bg-slate-100 px-2 py-1 rounded mt-2 block max-w-2xl mx-auto\">\r\n                                                analysisMode: &apos;cultural_framing&apos;\r\n                                            </code>\r\n                                        </div>\r\n                                    )}\r\n\r\n                                    {selectedSources[0]?.cultural_framing && (\r\n                                        <div className=\"space-y-8\">\r\n                                            {/* Cultural Distinctiveness Scores */}\r\n                                            <div>\r\n                                                <h4 className=\"font-semibold mb-4\">Cultural Distinctiveness</h4>\r\n                                                <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n                                                    {selectedSources.map((source, idx) => (\r\n                                                        <Card key={idx} className=\"bg-slate-50 relative\">\r\n                                                            <CardContent className=\"pt-6\">\r\n                                                                <div className=\"absolute top-2 right-2\">\r\n                                                                    <Button\r\n                                                                        variant=\"ghost\"\r\n                                                                        size=\"sm\"\r\n                                                                        className=\"h-6 w-6 p-0\"\r\n                                                                        onClick={() => handleRegenerateCultural(source)}\r\n                                                                        disabled={regeneratingIds[source.id]}\r\n                                                                        title=\"Regenerate Analysis (Bypass Cache)\"\r\n                                                                    >\r\n                                                                        <RefreshCw className={`h-3 w-3 ${regeneratingIds[source.id] ? 'animate-spin' : 'text-slate-400'}`} />\r\n                                                                    </Button>\r\n                                                                </div>\r\n                                                                <div className=\"text-center\">\r\n                                                                    <div className=\"text-3xl font-bold text-slate-900\">\r\n                                                                        {((source.cultural_framing?.cultural_distinctiveness_score ?? 0) * 100).toFixed(0)}%\r\n                                                                    </div>\r\n                                                                    <div className=\"text-sm text-slate-600 mt-1\">\r\n                                                                        {source.title}\r\n                                                                    </div>\r\n                                                                    <div className=\"text-xs text-slate-500 mt-2 italic\">\r\n                                                                        {source.cultural_framing?.dominant_cultural_logic}\r\n                                                                    </div>\r\n                                                                </div>\r\n                                                            </CardContent>\r\n                                                        </Card>\r\n                                                    ))}\r\n                                                </div>\r\n                                            </div>\r\n\r\n                                            {/* Dimension Comparison */}\r\n                                            {([\"state_market_society\", \"technology_role\", \"rights_conception\", \"historical_context\", \"epistemic_authority\"] as const).map((dimension) => (\r\n                                                <div key={dimension}>\r\n                                                    <h4 className=\"font-semibold mb-3 capitalize\">\r\n                                                        {dimension.replace(/_/g, \" \")}\r\n                                                    </h4>\r\n                                                    <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n                                                        {selectedSources.map((source, idx) => (\r\n                                                            <Card key={idx}>\r\n                                                                <CardContent className=\"pt-4\">\r\n                                                                    <div className=\"flex items-center justify-between mb-2\">\r\n                                                                        <div className=\"text-xs font-semibold text-slate-500\">\r\n                                                                            {source.title}\r\n                                                                        </div>\r\n                                                                        <Button\r\n                                                                            variant=\"ghost\"\r\n                                                                            size=\"sm\"\r\n                                                                            className=\"h-6 w-6 p-0\"\r\n                                                                            onClick={() => handleRegenerateCultural(source)}\r\n                                                                            disabled={regeneratingIds[source.id]}\r\n                                                                            title=\"Regenerate Analysis (Bypass Cache)\"\r\n                                                                        >\r\n                                                                            <RefreshCw className={`h-3 w-3 ${regeneratingIds[source.id] ? 'animate-spin' : 'text-slate-400'}`} />\r\n                                                                        </Button>\r\n                                                                    </div>\r\n                                                                    <div className=\"text-sm text-slate-700\">\r\n                                                                        {source.cultural_framing?.[dimension] || \"Not analyzed\"}\r\n                                                                    </div>\r\n                                                                </CardContent>\r\n                                                            </Card>\r\n                                                        ))}\r\n                                                    </div>\r\n                                                </div>\r\n                                            ))}\r\n                                        </div>\r\n                                    )}\r\n                                </CardContent>\r\n                            </Card>\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* Institutional Logics Comparison */}\r\n                    {activeTab === \"logics\" && (\r\n                        // ... existing institutional logics content\r\n                        <div className=\"space-y-6\">\r\n                            <Card>\r\n                                <CardHeader>\r\n                                    <CardTitle>Institutional Logics Comparison</CardTitle>\r\n                                    <CardDescription>\r\n                                        Which institutional logics dominate in each jurisdiction?\r\n                                    </CardDescription>\r\n                                </CardHeader>\r\n                                <CardContent>\r\n                                    {!selectedSources[0]?.institutional_logics && (\r\n                                        <div className=\"text-center py-8 text-slate-500\">\r\n                                            <p className=\"mb-4\">No institutional logics analysis yet.</p>\r\n                                            <p className=\"text-sm\">\r\n                                                Run institutional logics analysis on these documents first.\r\n                                            </p>\r\n                                            <code className=\"text-xs bg-slate-100 px-2 py-1 rounded mt-2 block max-w-2xl mx-auto\">\r\n                                                analysisMode: &apos;institutional_logics&apos;\r\n                                            </code>\r\n                                        </div>\r\n                                    )}\r\n\r\n                                    {selectedSources[0]?.institutional_logics && (\r\n                                        <div className=\"space-y-8\">\r\n                                            {/* Logic Strength Comparison */}\r\n                                            {([\"market\", \"state\", \"professional\", \"community\"] as const).map((logic) => {\r\n                                                const Icon = logicIcons[logic];\r\n                                                return (\r\n                                                    <div key={logic}>\r\n                                                        <h4 className=\"font-semibold mb-4 flex items-center gap-2 capitalize\">\r\n                                                            <Icon className=\"h-5 w-5\" />\r\n                                                            {logic} Logic\r\n                                                        </h4>\r\n                                                        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n                                                            {selectedSources.map((source, idx) => {\r\n                                                                const logicData = source.institutional_logics?.logics?.[logic];\r\n                                                                return (\r\n                                                                    <Card key={idx} className={logicColors[logic as keyof typeof logicColors]}>\r\n                                                                        <CardContent className=\"pt-6\">\r\n                                                                            <div className=\"text-xs font-semibold mb-2\">\r\n                                                                                {source.title}\r\n                                                                            </div>\r\n                                                                            <div className=\"mb-3\">\r\n                                                                                <div className=\"flex items-center justify-between mb-1\">\r\n                                                                                    <span className=\"text-xs\">Strength</span>\r\n                                                                                    <span className=\"text-sm font-bold\">\r\n                                                                                        {((logicData?.strength || 0) * 100).toFixed(0)}%\r\n                                                                                    </span>\r\n                                                                                </div>\r\n                                                                                <div className=\"w-full bg-white rounded-full h-2\">\r\n                                                                                    <div\r\n                                                                                        className=\"bg-slate-800 h-2 rounded-full\"\r\n                                                                                        style={{ width: `${(logicData?.strength || 0) * 100}%` }}\r\n                                                                                    />\r\n                                                                                </div>\r\n                                                                            </div>\r\n                                                                            <div className=\"text-xs space-y-2\">\r\n                                                                                <div>\r\n                                                                                    <span className=\"font-semibold\">Material:</span>{\" \"}\r\n                                                                                    {logicData?.material || \"N/A\"}\r\n                                                                                </div>\r\n                                                                                <div>\r\n                                                                                    <span className=\"font-semibold\">Discursive:</span>{\" \"}\r\n                                                                                    {logicData?.discursive || \"N/A\"}\r\n                                                                                </div>\r\n                                                                            </div>\r\n                                                                        </CardContent>\r\n                                                                    </Card>\r\n                                                                );\r\n                                                            })}\r\n                                                        </div>\r\n                                                    </div>\r\n                                                );\r\n                                            })}\r\n\r\n                                            {/* Dominant Logic Summary */}\r\n                                            <div>\r\n                                                <h4 className=\"font-semibold mb-4\">Dominant Logic</h4>\r\n                                                <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n                                                    {selectedSources.map((source, idx) => (\r\n                                                        <Card key={idx} className=\"bg-slate-50 relative\">\r\n                                                            <CardContent className=\"pt-6\">\r\n                                                                <div className=\"absolute top-2 right-2\">\r\n                                                                    <Button\r\n                                                                        variant=\"ghost\"\r\n                                                                        size=\"sm\"\r\n                                                                        className=\"h-6 w-6 p-0\"\r\n                                                                        onClick={() => handleRegenerateLogics(source)}\r\n                                                                        disabled={regeneratingIds[source.id]}\r\n                                                                        title=\"Regenerate Analysis (Bypass Cache)\"\r\n                                                                    >\r\n                                                                        <RefreshCw className={`h-3 w-3 ${regeneratingIds[source.id] ? 'animate-spin' : 'text-slate-400'}`} />\r\n                                                                    </Button>\r\n                                                                </div>\r\n                                                                <div className=\"text-center\">\r\n                                                                    <Badge className=\"text-lg px-4 py-2 capitalize\">\r\n                                                                        {source.institutional_logics?.dominant_logic || \"Unknown\"}\r\n                                                                    </Badge>\r\n                                                                    <div className=\"text-xs text-slate-600 mt-3\">\r\n                                                                        {source.title}\r\n                                                                    </div>\r\n                                                                    <div className=\"text-xs text-slate-700 mt-4 text-left\">\r\n                                                                        {source.institutional_logics?.overall_assessment || \"No assessment\"}\r\n                                                                    </div>\r\n                                                                </div>\r\n                                                            </CardContent>\r\n                                                        </Card>\r\n                                                    ))}\r\n                                                </div>\r\n                                            </div>\r\n\r\n                                            {/* Logic Conflicts */}\r\n                                            <div>\r\n                                                <h4 className=\"font-semibold mb-4\">Logic Conflicts</h4>\r\n                                                <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n                                                    {selectedSources.map((source, idx) => (\r\n                                                        <Card key={idx}>\r\n                                                            <CardContent className=\"pt-6\">\r\n                                                                <div className=\"text-xs font-semibold text-slate-500 mb-3\">\r\n                                                                    {source.title}\r\n                                                                </div>\r\n                                                                <div className=\"space-y-3\">\r\n                                                                    {source.institutional_logics?.logic_conflicts?.map((conflict, idx) => (\r\n                                                                        <div key={idx} className=\"text-xs space-y-1 p-2 bg-amber-50 rounded border border-amber-200\">\r\n                                                                            <div className=\"font-semibold text-amber-800\">\r\n                                                                                {conflict.between}\r\n                                                                            </div>\r\n                                                                            <div className=\"text-slate-700\">\r\n                                                                                <span className=\"font-semibold\">Site:</span> {conflict.site_of_conflict}\r\n                                                                            </div>\r\n                                                                            <div className=\"text-slate-700\">\r\n                                                                                <span className=\"font-semibold\">Resolution:</span> {conflict.resolution_strategy}\r\n                                                                            </div>\r\n                                                                        </div>\r\n                                                                    ))}\r\n                                                                    {(!source.institutional_logics?.logic_conflicts || source.institutional_logics.logic_conflicts.length === 0) && (\r\n                                                                        <div className=\"text-slate-500 italic\">No conflicts identified</div>\r\n                                                                    )}\r\n                                                                </div>\r\n                                                            </CardContent>\r\n                                                        </Card>\r\n                                                    ))}\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n                                    )}\r\n                                </CardContent>\r\n                            </Card>\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* Legitimacy Analysis Comparison */}\r\n                    {activeTab === \"legitimacy\" && (\r\n                        <div className=\"space-y-6\">\r\n                            <Card>\r\n                                <CardHeader>\r\n                                    <CardTitle>Legitimacy & Justification Comparison</CardTitle>\r\n                                    <CardDescription>\r\n                                        Compare the moral arguments and orders of worth used in each jurisdiction.\r\n                                    </CardDescription>\r\n                                </CardHeader>\r\n                                <CardContent>\r\n                                    {!selectedSources[0]?.legitimacy_analysis && (\r\n                                        <div className=\"text-center py-8 text-slate-500\">\r\n                                            <p className=\"mb-4\">No legitimacy analysis yet.</p>\r\n                                            <p className=\"text-sm\">\r\n                                                Run legitimacy analysis on these documents first.\r\n                                            </p>\r\n                                            <code className=\"text-xs bg-slate-100 px-2 py-1 rounded mt-2 block max-w-2xl mx-auto\">\r\n                                                analysisMode: &apos;legitimacy&apos;\r\n                                            </code>\r\n                                        </div>\r\n                                    )}\r\n\r\n                                    {selectedSources[0]?.legitimacy_analysis && (\r\n                                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8\">\r\n                                            {selectedSources.map((source, idx) => (\r\n                                                <div key={idx} className=\"space-y-4\">\r\n                                                    <div className=\"flex items-center justify-between border-b pb-2\">\r\n                                                        <h3 className=\"font-semibold text-lg\">{source.title}</h3>\r\n                                                        <Button\r\n                                                            variant=\"ghost\"\r\n                                                            size=\"sm\"\r\n                                                            className=\"h-8 w-8 p-0\"\r\n                                                            onClick={() => handleRegenerateLegitimacy(source)}\r\n                                                            disabled={regeneratingIds[source.id]}\r\n                                                            title=\"Regenerate Analysis (Bypass Cache)\"\r\n                                                        >\r\n                                                            <RefreshCw className={`h-4 w-4 ${regeneratingIds[source.id] ? 'animate-spin' : 'text-slate-400'}`} />\r\n                                                        </Button>\r\n                                                    </div>\r\n                                                    {source.legitimacy_analysis && (\r\n                                                        <LegitimacyAnalysisView analysis={source.legitimacy_analysis} />\r\n                                                    )}\r\n                                                </div>\r\n                                            ))}\r\n                                        </div>\r\n                                    )}\r\n                                </CardContent>\r\n                            </Card>\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* Comparative Synthesis Tab */}\r\n                    {activeTab === \"synthesis\" && (\r\n                        <div className=\"space-y-6\">\r\n                            <Card className=\"border-indigo-100 shadow-sm\">\r\n                                <CardHeader className=\"bg-indigo-50/50\">\r\n                                    <CardTitle className=\"text-indigo-900 flex items-center gap-2\">\r\n                                        <Sparkles className=\"h-5 w-5 text-indigo-600\" />\r\n                                        Comparative Synthesis\r\n                                    </CardTitle>\r\n                                    <CardDescription>\r\n                                        AI-generated synthesis of cultural, institutional, and legitimacy dynamics across jurisdictions.\r\n                                    </CardDescription>\r\n                                </CardHeader>\r\n                                <CardContent className=\"pt-6\">\r\n                                    {!synthesisResult && !isSynthesizing && (\r\n                                        <div className=\"text-center py-12 text-slate-500\">\r\n                                            <Sparkles className=\"h-12 w-12 mx-auto mb-4 text-slate-300\" />\r\n                                            <p>Click &quot;Synthesize&quot; to generate a comparative analysis.</p>\r\n                                        </div>\r\n                                    )}\r\n\r\n                                    {isSynthesizing && (\r\n                                        <div className=\"text-center py-12 text-slate-500\">\r\n                                            <Loader2 className=\"h-12 w-12 mx-auto mb-4 animate-spin text-indigo-500\" />\r\n                                            <p>Synthesizing analysis across {selectedSources.length} documents...</p>\r\n                                            <p className=\"text-xs text-slate-400 mt-2\">This may take a minute.</p>\r\n                                        </div>\r\n                                    )}\r\n\r\n                                    {synthesisResult && (\r\n                                        <div className=\"space-y-8\">\r\n                                            {/* Executive Summary */}\r\n                                            <div>\r\n                                                <h3 className=\"text-lg font-semibold text-slate-900 mb-3\">Executive Summary</h3>\r\n                                                <div className=\"prose prose-slate max-w-none bg-slate-50 p-6 rounded-lg border border-slate-100\">\r\n                                                    <p className=\"whitespace-pre-wrap\">{synthesisResult.executive_summary}</p>\r\n                                                </div>\r\n                                            </div>\r\n\r\n                                            {/* Deep Dive Grid */}\r\n                                            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\r\n                                                <Card>\r\n                                                    <CardHeader className=\"pb-2\">\r\n                                                        <CardTitle className=\"text-base flex items-center gap-2\">\r\n                                                            <Globe2 className=\"h-4 w-4 text-blue-600\" />\r\n                                                            Cultural Divergence\r\n                                                        </CardTitle>\r\n                                                    </CardHeader>\r\n                                                    <CardContent>\r\n                                                        <p className=\"text-sm text-slate-600\">{synthesisResult.cultural_divergence}</p>\r\n                                                    </CardContent>\r\n                                                </Card>\r\n                                                <Card>\r\n                                                    <CardHeader className=\"pb-2\">\r\n                                                        <CardTitle className=\"text-base flex items-center gap-2\">\r\n                                                            <Building className=\"h-4 w-4 text-purple-600\" />\r\n                                                            Institutional Conflict\r\n                                                        </CardTitle>\r\n                                                    </CardHeader>\r\n                                                    <CardContent>\r\n                                                        <p className=\"text-sm text-slate-600\">{synthesisResult.institutional_conflict}</p>\r\n                                                    </CardContent>\r\n                                                </Card>\r\n                                                <Card>\r\n                                                    <CardHeader className=\"pb-2\">\r\n                                                        <CardTitle className=\"text-base flex items-center gap-2\">\r\n                                                            <Scale className=\"h-4 w-4 text-emerald-600\" />\r\n                                                            Legitimacy Tensions\r\n                                                        </CardTitle>\r\n                                                    </CardHeader>\r\n                                                    <CardContent>\r\n                                                        <p className=\"text-sm text-slate-600\">{synthesisResult.legitimacy_tensions}</p>\r\n                                                    </CardContent>\r\n                                                </Card>\r\n                                            </div>\r\n\r\n                                            {/* Synthesis Matrix */}\r\n                                            <div>\r\n                                                <h3 className=\"text-lg font-semibold text-slate-900 mb-4\">Comparative Matrix</h3>\r\n                                                <div className=\"border rounded-lg overflow-hidden\">\r\n                                                    <table className=\"w-full text-sm text-left\">\r\n                                                        <thead className=\"bg-slate-50 text-slate-700 font-semibold border-b\">\r\n                                                            <tr>\r\n                                                                <th className=\"px-6 py-3 w-1/4\">Dimension</th>\r\n                                                                <th className=\"px-6 py-3\">Comparative Analysis</th>\r\n                                                            </tr>\r\n                                                        </thead>\r\n                                                        <tbody className=\"divide-y divide-slate-100\">\r\n                                                            {synthesisResult.synthesis_matrix?.map((row, idx) => (\r\n                                                                <tr key={idx} className=\"hover:bg-slate-50/50\">\r\n                                                                    <td className=\"px-6 py-4 font-medium text-slate-900 bg-slate-50/30\">\r\n                                                                        {row.dimension}\r\n                                                                    </td>\r\n                                                                    <td className=\"px-6 py-4 text-slate-600\">\r\n                                                                        {row.comparison}\r\n                                                                    </td>\r\n                                                                </tr>\r\n                                                            ))}\r\n                                                        </tbody>\r\n                                                    </table>\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n                                    )}\r\n                                </CardContent>\r\n                            </Card>\r\n                        </div>\r\n                    )}\r\n                </>\r\n            )}\r\n\r\n            {selectedSources.length < 2 && (\r\n                <Card className=\"bg-slate-50 border-dashed\">\r\n                    <CardContent className=\"pt-6 text-center text-slate-500\">\r\n                        <Globe2 className=\"h-12 w-12 mx-auto mb-4 text-slate-400\" />\r\n                        <p>Select at least 2 documents above to begin comparing</p>\r\n                    </CardContent>\r\n                </Card>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\cultural\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\data\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'generateSearchTerms' is defined but never used.","line":6,"column":27,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":46}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState, useRef } from \"react\";\r\nimport { useSources } from \"@/hooks/useSources\";\r\nimport { Source, LegitimacyAnalysis, PositionalityData } from \"@/types\";\r\nimport { analyzeDocument, generateSearchTerms, AnalysisMode } from \"@/services/analysis\";\r\nimport { extractTextFromPDF } from \"@/utils/pdfExtractor\";\r\nimport { DocumentCard } from \"@/components/policy/DocumentCard\";\r\nimport { AddDocumentDialog } from \"@/components/policy/AddDocumentDialog\";\r\nimport { ViewSourceDialog } from \"@/components/policy/ViewSourceDialog\";\r\nimport { EditSourceDialog } from \"@/components/policy/EditSourceDialog\";\r\nimport { DocumentToolbar } from \"@/components/policy/DocumentToolbar\";\r\nimport { AddUrlDialog } from \"@/components/policy/AddUrlDialog\";\r\nimport { PositionalityDialog } from \"@/components/reflexivity/PositionalityDialog\";\r\nimport { Loader2 } from \"lucide-react\";\r\n\r\nexport default function PolicyDocumentsPage() {\r\n    const { sources, isLoading: isSourcesLoading, addSource, updateSource, deleteSource } = useSources();\r\n    const [searchQuery, setSearchQuery] = useState(\"\");\r\n    const [isAddDialogOpen, setIsAddDialogOpen] = useState(false);\r\n    const [isUrlDialogOpen, setIsUrlDialogOpen] = useState(false);\r\n    const [analyzingId, setAnalyzingId] = useState<string | null>(null);\r\n    const [searchingId, setSearchingId] = useState<string | null>(null);\r\n    const [isUploading, setIsUploading] = useState(false);\r\n    const [viewingSource, setViewingSource] = useState<Source | null>(null);\r\n    const [editingSource, setEditingSource] = useState<Source | null>(null);\r\n    const [isPositionalityDialogOpen, setIsPositionalityDialogOpen] = useState(false);\r\n    const [pendingAnalysis, setPendingAnalysis] = useState<{ sourceId: string, mode: AnalysisMode, force: boolean } | null>(null);\r\n    const fileInputRef = useRef<HTMLInputElement | null>(null);\r\n\r\n    const filteredSources = sources.filter(source =>\r\n        source.type !== 'Trace' &&\r\n        (source.title.toLowerCase().includes(searchQuery.toLowerCase()) ||\r\n            source.description.toLowerCase().includes(searchQuery.toLowerCase()))\r\n    );\r\n\r\n    const handlePDFUpload = async (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        const file = e.target.files?.[0];\r\n        if (!file) return;\r\n\r\n        setIsUploading(true);\r\n        try {\r\n            const extractionResult = await extractTextFromPDF(file);\r\n            const text = typeof extractionResult === 'string' ? extractionResult : extractionResult.text;\r\n            const newDoc: Source = {\r\n                id: Date.now().toString(),\r\n                title: file.name.replace('.pdf', ''),\r\n                description: `Uploaded ${new Date().toLocaleDateString()}`,\r\n                type: \"PDF\",\r\n                addedDate: new Date().toLocaleDateString(),\r\n                status: \"Active Case\",\r\n                colorClass: \"bg-purple-100\",\r\n                iconClass: \"text-purple-600\",\r\n                extractedText: text\r\n            };\r\n            await addSource(newDoc);\r\n            alert('PDF uploaded successfully!');\r\n        } catch (error) {\r\n            console.error('PDF upload error:', error);\r\n            alert('Failed to upload PDF. Please try again.');\r\n        } finally {\r\n            setIsUploading(false);\r\n            if (fileInputRef.current) {\r\n                fileInputRef.current.value = '';\r\n            }\r\n        }\r\n    };\r\n\r\n    const handleUrlAdd = async (url: string) => {\r\n        const headers: HeadersInit = { 'Content-Type': 'application/json' };\r\n        if (process.env.NEXT_PUBLIC_ENABLE_DEMO_MODE === 'true' && process.env.NEXT_PUBLIC_DEMO_USER_ID) {\r\n            headers['x-demo-user-id'] = process.env.NEXT_PUBLIC_DEMO_USER_ID;\r\n        }\r\n\r\n        const response = await fetch('/api/fetch-url', {\r\n            method: 'POST',\r\n            headers: headers,\r\n            body: JSON.stringify({ url })\r\n        });\r\n\r\n        const data = await response.json();\r\n\r\n        if (!response.ok) {\r\n            throw new Error(data.error || 'Failed to fetch URL');\r\n        }\r\n\r\n        const newDoc: Source = {\r\n            id: Date.now().toString(),\r\n            title: data.title || url,\r\n            description: `Fetched from ${new URL(url).hostname}`,\r\n            type: \"Web\",\r\n            addedDate: new Date().toLocaleDateString(),\r\n            status: \"Active Case\",\r\n            colorClass: \"bg-emerald-100\",\r\n            iconClass: \"text-emerald-600\",\r\n            extractedText: data.content,\r\n            url: data.url\r\n        };\r\n\r\n        await addSource(newDoc);\r\n        alert('Website content added successfully!');\r\n    };\r\n\r\n    const handleAddSource = async (title: string, description: string, pageCount: string, publicationDate: string, version: string) => {\r\n        const source: Source = {\r\n            id: Date.now().toString(),\r\n            title,\r\n            description,\r\n            type: \"Text\",\r\n            pageCount: pageCount ? parseInt(pageCount) : undefined,\r\n            publicationDate: publicationDate || undefined,\r\n            version: version || undefined,\r\n            addedDate: new Date().toLocaleDateString(),\r\n            status: \"Active Case\",\r\n            colorClass: \"bg-blue-100\",\r\n            iconClass: \"text-blue-600\"\r\n        };\r\n        await addSource(source);\r\n    };\r\n\r\n    const handleEditSource = async (sourceId: string, updates: Partial<Source>) => {\r\n        await updateSource(sourceId, updates);\r\n    };\r\n\r\n    const handleAnalyze = async (sourceId: string, mode: AnalysisMode) => {\r\n        const source = sources.find(s => s.id === sourceId);\r\n        if (!source || !source.extractedText) {\r\n            alert('No text available to analyze. Please upload a PDF or add text first.');\r\n            return;\r\n        }\r\n\r\n        // Check if analysis already exists\r\n        let force = false;\r\n        const hasAnalysis =\r\n            (mode === 'dsf' && source.analysis) ||\r\n            (mode === 'cultural_framing' && source.cultural_framing) ||\r\n            (mode === 'institutional_logics' && source.institutional_logics) ||\r\n            (mode === 'legitimacy' && source.legitimacy_analysis);\r\n\r\n        if (hasAnalysis) {\r\n            if (!confirm('Analysis already exists for this document. Click OK to FORCE a re-run (bypassing cache), or Cancel to abort.')) {\r\n                return;\r\n            }\r\n            force = true;\r\n        }\r\n\r\n        setPendingAnalysis({ sourceId, mode, force });\r\n        setIsPositionalityDialogOpen(true);\r\n    };\r\n\r\n    const proceedWithAnalysis = async (positionalityData: PositionalityData) => {\r\n        if (!pendingAnalysis) return;\r\n        const { sourceId, mode, force } = pendingAnalysis;\r\n        const source = sources.find(s => s.id === sourceId);\r\n\r\n        setIsPositionalityDialogOpen(false);\r\n\r\n        if (!source || !source.extractedText) return;\r\n\r\n        setAnalyzingId(sourceId);\r\n        try {\r\n            const result = await analyzeDocument(\r\n                source.extractedText.substring(0, 150000),\r\n                mode,\r\n                'Policy Document',\r\n                force,\r\n                sourceId,\r\n                source.title,\r\n                positionalityData\r\n            );\r\n\r\n            const updates: Partial<Source> = {};\r\n            if (mode === 'dsf') updates.analysis = result;\r\n            if (mode === 'cultural_framing') updates.cultural_framing = result;\r\n            if (mode === 'institutional_logics') updates.institutional_logics = result;\r\n            if (mode === 'legitimacy') updates.legitimacy_analysis = result as unknown as LegitimacyAnalysis;\r\n\r\n            await updateSource(sourceId, updates);\r\n\r\n            if (mode === 'dsf') {\r\n                alert('Analysis complete! Scroll down to see results.');\r\n            } else {\r\n                alert(` ${mode === 'cultural_framing' ? 'Cultural framing' : mode === 'institutional_logics' ? 'Institutional logics' : 'Legitimacy'} analysis complete! Go to Comparison page to view results.`);\r\n            }\r\n        } catch (error: unknown) {\r\n            const errorMessage = error instanceof Error ? error.message : 'Unknown error';\r\n            alert(`Analysis failed: ${errorMessage}`);\r\n        } finally {\r\n            setAnalyzingId(null);\r\n            setPendingAnalysis(null);\r\n        }\r\n    };\r\n\r\n    const handleFindTraces = async (source: Source) => {\r\n        if (!source.extractedText) {\r\n            alert('Please upload a PDF or add text first before finding traces.');\r\n            return;\r\n        }\r\n\r\n        setSearchingId(source.id);\r\n        try {\r\n            // Generate search terms from the document text\r\n            const headers: HeadersInit = { 'Content-Type': 'application/json' };\r\n            if (process.env.NEXT_PUBLIC_ENABLE_DEMO_MODE === 'true' && process.env.NEXT_PUBLIC_DEMO_USER_ID) {\r\n                headers['x-demo-user-id'] = process.env.NEXT_PUBLIC_DEMO_USER_ID;\r\n            }\r\n\r\n            const response = await fetch('/api/search', {\r\n                method: 'POST',\r\n                headers: headers,\r\n                body: JSON.stringify({\r\n                    policyText: source.extractedText.substring(0, 3000),\r\n                    maxResults: 5\r\n                })\r\n            });\r\n\r\n            const result = await response.json();\r\n\r\n            if (result.success && Array.isArray(result.results) && result.results.length > 0) {\r\n                // Create trace sources from search results\r\n                const newTraces: Source[] = result.results.map((item: { title: string; snippet: string; link: string }) => ({\r\n                    id: Date.now().toString() + Math.random().toString(36).substr(2, 9),\r\n                    title: `[Trace] ${item.title}`,\r\n                    description: item.snippet || 'No description available',\r\n                    type: \"Trace\" as const,\r\n                    extractedText: `${item.snippet}\\n\\nSource: ${item.link}\\n\\nFound via search for: \"${result.searchQuery || 'policy analysis'}\"`,\r\n                    addedDate: new Date().toLocaleDateString(\"en-US\", { month: \"short\", day: \"numeric\", year: \"numeric\" }),\r\n                    status: \"Active Case\" as const,\r\n                    colorClass: \"bg-blue-100\",\r\n                    iconClass: \"text-blue-600\"\r\n                }));\r\n\r\n                // Add all traces to the store\r\n                for (const trace of newTraces) {\r\n                    await addSource(trace);\r\n                }\r\n\r\n                alert(` Found ${newTraces.length} empirical traces!\\n\\nSearch query: \"${result.searchQuery}\"\\n\\nTraces have been added to your sources. Go to the Resistance page to analyze them.`);\r\n            } else {\r\n                alert(`No traces found. ${result.error || 'Try analyzing the document first or check your Google Search API configuration.'}`);\r\n            }\r\n        } catch (error: unknown) {\r\n            console.error('Search error:', error);\r\n            const errorMessage = error instanceof Error ? error.message : 'Unknown error';\r\n            alert(`Failed to search for traces: ${errorMessage}\\n\\nMake sure your Google Search API credentials are configured in .env.local`);\r\n        } finally {\r\n            setSearchingId(null);\r\n        }\r\n    };\r\n\r\n    const handleDelete = async (sourceId: string) => {\r\n        if (confirm('Are you sure you want to delete this source?')) {\r\n            await deleteSource(sourceId);\r\n        }\r\n    };\r\n\r\n    if (isSourcesLoading) {\r\n        return (\r\n            <div className=\"flex items-center justify-center h-64\">\r\n                <Loader2 className=\"h-8 w-8 animate-spin text-slate-400\" />\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"space-y-8\">\r\n            <DocumentToolbar\r\n                searchQuery={searchQuery}\r\n                onSearchChange={setSearchQuery}\r\n                onUpload={handlePDFUpload}\r\n                isUploading={isUploading}\r\n                fileInputRef={fileInputRef}\r\n                onAddClick={() => setIsAddDialogOpen(true)}\r\n                onAddUrlClick={() => setIsUrlDialogOpen(true)}\r\n            />\r\n\r\n            <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-3\">\r\n                {filteredSources.map((source) => (\r\n                    <DocumentCard\r\n                        key={source.id}\r\n                        source={source}\r\n                        isAnalyzing={analyzingId === source.id}\r\n                        isSearching={searchingId === source.id}\r\n                        onAnalyze={handleAnalyze}\r\n                        onDelete={handleDelete}\r\n                        onEdit={(source) => setEditingSource(source)}\r\n                        onFindTraces={handleFindTraces}\r\n                        onView={(source) => setViewingSource(source)}\r\n                        onUpdateSource={updateSource}\r\n                    />\r\n                ))}\r\n            </div>\r\n\r\n            <AddDocumentDialog\r\n                open={isAddDialogOpen}\r\n                onOpenChange={setIsAddDialogOpen}\r\n                onAdd={handleAddSource}\r\n            />\r\n\r\n            <AddUrlDialog\r\n                open={isUrlDialogOpen}\r\n                onOpenChange={setIsUrlDialogOpen}\r\n                onAdd={handleUrlAdd}\r\n            />\r\n\r\n            <ViewSourceDialog\r\n                source={viewingSource}\r\n                onOpenChange={(open) => !open && setViewingSource(null)}\r\n            />\r\n\r\n            <EditSourceDialog\r\n                source={editingSource}\r\n                open={!!editingSource}\r\n                onOpenChange={(open) => !open && setEditingSource(null)}\r\n                onSave={handleEditSource}\r\n            />\r\n\r\n            <PositionalityDialog\r\n                isOpen={isPositionalityDialogOpen}\r\n                onClose={() => setIsPositionalityDialogOpen(false)}\r\n                onConfirm={proceedWithAnalysis}\r\n            />\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\data\\page_temp.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\demo\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Lock' is defined but never used.","line":7,"column":56,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":60},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Info' is defined but never used.","line":7,"column":136,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":140},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CheckCircle2' is defined but never used.","line":7,"column":142,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":154},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":117,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":117,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6539,6542],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6539,6542],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":135,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":135,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8639,8642],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8639,8642],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":186,"column":266,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[12033,12334],"text":" for analyzing global AI governance. Unlike standard legal compliance tools, it functions as an &quot;epistemic lens,\" revealing the hidden structural power dynamics, cultural assumptions, and colonial legacies embedded within policy texts (e.g., the EU AI Act, Brazils PL 2338).\r\n                        "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[12033,12334],"text":" for analyzing global AI governance. Unlike standard legal compliance tools, it functions as an &ldquo;epistemic lens,\" revealing the hidden structural power dynamics, cultural assumptions, and colonial legacies embedded within policy texts (e.g., the EU AI Act, Brazils PL 2338).\r\n                        "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[12033,12334],"text":" for analyzing global AI governance. Unlike standard legal compliance tools, it functions as an &#34;epistemic lens,\" revealing the hidden structural power dynamics, cultural assumptions, and colonial legacies embedded within policy texts (e.g., the EU AI Act, Brazils PL 2338).\r\n                        "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[12033,12334],"text":" for analyzing global AI governance. Unlike standard legal compliance tools, it functions as an &rdquo;epistemic lens,\" revealing the hidden structural power dynamics, cultural assumptions, and colonial legacies embedded within policy texts (e.g., the EU AI Act, Brazils PL 2338).\r\n                        "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":186,"column":282,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[12033,12334],"text":" for analyzing global AI governance. Unlike standard legal compliance tools, it functions as an \"epistemic lens,&quot; revealing the hidden structural power dynamics, cultural assumptions, and colonial legacies embedded within policy texts (e.g., the EU AI Act, Brazils PL 2338).\r\n                        "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[12033,12334],"text":" for analyzing global AI governance. Unlike standard legal compliance tools, it functions as an \"epistemic lens,&ldquo; revealing the hidden structural power dynamics, cultural assumptions, and colonial legacies embedded within policy texts (e.g., the EU AI Act, Brazils PL 2338).\r\n                        "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[12033,12334],"text":" for analyzing global AI governance. Unlike standard legal compliance tools, it functions as an \"epistemic lens,&#34; revealing the hidden structural power dynamics, cultural assumptions, and colonial legacies embedded within policy texts (e.g., the EU AI Act, Brazils PL 2338).\r\n                        "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[12033,12334],"text":" for analyzing global AI governance. Unlike standard legal compliance tools, it functions as an \"epistemic lens,&rdquo; revealing the hidden structural power dynamics, cultural assumptions, and colonial legacies embedded within policy texts (e.g., the EU AI Act, Brazils PL 2338).\r\n                        "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":204,"column":130,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[13799,13877],"text":"It visualizes governance not as static text, but as active &quot;assemblages.\" The "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[13799,13877],"text":"It visualizes governance not as static text, but as active &ldquo;assemblages.\" The "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[13799,13877],"text":"It visualizes governance not as static text, but as active &#34;assemblages.\" The "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[13799,13877],"text":"It visualizes governance not as static text, but as active &rdquo;assemblages.\" The "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":204,"column":143,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[13799,13877],"text":"It visualizes governance not as static text, but as active \"assemblages.&quot; The "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[13799,13877],"text":"It visualizes governance not as static text, but as active \"assemblages.&ldquo; The "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[13799,13877],"text":"It visualizes governance not as static text, but as active \"assemblages.&#34; The "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[13799,13877],"text":"It visualizes governance not as static text, but as active \"assemblages.&rdquo; The "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":204,"column":232,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[13914,14096],"text":" traces how specific policy mechanisms (e.g., &quot;sandboxes\") constrain or afford possibilities for diverse actors, distinguishing between material infrastructures and discursive norms."},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[13914,14096],"text":" traces how specific policy mechanisms (e.g., &ldquo;sandboxes\") constrain or afford possibilities for diverse actors, distinguishing between material infrastructures and discursive norms."},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[13914,14096],"text":" traces how specific policy mechanisms (e.g., &#34;sandboxes\") constrain or afford possibilities for diverse actors, distinguishing between material infrastructures and discursive norms."},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[13914,14096],"text":" traces how specific policy mechanisms (e.g., &rdquo;sandboxes\") constrain or afford possibilities for diverse actors, distinguishing between material infrastructures and discursive norms."},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":204,"column":242,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[13914,14096],"text":" traces how specific policy mechanisms (e.g., \"sandboxes&quot;) constrain or afford possibilities for diverse actors, distinguishing between material infrastructures and discursive norms."},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[13914,14096],"text":" traces how specific policy mechanisms (e.g., \"sandboxes&ldquo;) constrain or afford possibilities for diverse actors, distinguishing between material infrastructures and discursive norms."},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[13914,14096],"text":" traces how specific policy mechanisms (e.g., \"sandboxes&#34;) constrain or afford possibilities for diverse actors, distinguishing between material infrastructures and discursive norms."},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[13914,14096],"text":" traces how specific policy mechanisms (e.g., \"sandboxes&rdquo;) constrain or afford possibilities for diverse actors, distinguishing between material infrastructures and discursive norms."},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":208,"column":162,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[14426,14671],"text":" that quantifies the &quot;epistemic distance\" between frameworks. It generates \"Coloniality Scores\" to highlight where Global North standards may be overshadowing local contexts, visualizing these asymmetries via radar charts and synthesis matrices."},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[14426,14671],"text":" that quantifies the &ldquo;epistemic distance\" between frameworks. It generates \"Coloniality Scores\" to highlight where Global North standards may be overshadowing local contexts, visualizing these asymmetries via radar charts and synthesis matrices."},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[14426,14671],"text":" that quantifies the &#34;epistemic distance\" between frameworks. It generates \"Coloniality Scores\" to highlight where Global North standards may be overshadowing local contexts, visualizing these asymmetries via radar charts and synthesis matrices."},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[14426,14671],"text":" that quantifies the &rdquo;epistemic distance\" between frameworks. It generates \"Coloniality Scores\" to highlight where Global North standards may be overshadowing local contexts, visualizing these asymmetries via radar charts and synthesis matrices."},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":208,"column":181,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[14426,14671],"text":" that quantifies the \"epistemic distance&quot; between frameworks. It generates \"Coloniality Scores\" to highlight where Global North standards may be overshadowing local contexts, visualizing these asymmetries via radar charts and synthesis matrices."},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[14426,14671],"text":" that quantifies the \"epistemic distance&ldquo; between frameworks. It generates \"Coloniality Scores\" to highlight where Global North standards may be overshadowing local contexts, visualizing these asymmetries via radar charts and synthesis matrices."},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[14426,14671],"text":" that quantifies the \"epistemic distance&#34; between frameworks. It generates \"Coloniality Scores\" to highlight where Global North standards may be overshadowing local contexts, visualizing these asymmetries via radar charts and synthesis matrices."},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[14426,14671],"text":" that quantifies the \"epistemic distance&rdquo; between frameworks. It generates \"Coloniality Scores\" to highlight where Global North standards may be overshadowing local contexts, visualizing these asymmetries via radar charts and synthesis matrices."},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":208,"column":216,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[14426,14671],"text":" that quantifies the \"epistemic distance\" between frameworks. It generates &quot;Coloniality Scores\" to highlight where Global North standards may be overshadowing local contexts, visualizing these asymmetries via radar charts and synthesis matrices."},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[14426,14671],"text":" that quantifies the \"epistemic distance\" between frameworks. It generates &ldquo;Coloniality Scores\" to highlight where Global North standards may be overshadowing local contexts, visualizing these asymmetries via radar charts and synthesis matrices."},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[14426,14671],"text":" that quantifies the \"epistemic distance\" between frameworks. It generates &#34;Coloniality Scores\" to highlight where Global North standards may be overshadowing local contexts, visualizing these asymmetries via radar charts and synthesis matrices."},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[14426,14671],"text":" that quantifies the \"epistemic distance\" between frameworks. It generates &rdquo;Coloniality Scores\" to highlight where Global North standards may be overshadowing local contexts, visualizing these asymmetries via radar charts and synthesis matrices."},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":208,"column":235,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[14426,14671],"text":" that quantifies the \"epistemic distance\" between frameworks. It generates \"Coloniality Scores&quot; to highlight where Global North standards may be overshadowing local contexts, visualizing these asymmetries via radar charts and synthesis matrices."},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[14426,14671],"text":" that quantifies the \"epistemic distance\" between frameworks. It generates \"Coloniality Scores&ldquo; to highlight where Global North standards may be overshadowing local contexts, visualizing these asymmetries via radar charts and synthesis matrices."},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[14426,14671],"text":" that quantifies the \"epistemic distance\" between frameworks. It generates \"Coloniality Scores&#34; to highlight where Global North standards may be overshadowing local contexts, visualizing these asymmetries via radar charts and synthesis matrices."},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[14426,14671],"text":" that quantifies the \"epistemic distance\" between frameworks. It generates \"Coloniality Scores&rdquo; to highlight where Global North standards may be overshadowing local contexts, visualizing these asymmetries via radar charts and synthesis matrices."},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":212,"column":234,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[15047,15295],"text":" engine. It searches live data sources (forums, Reddit) to find &quot;micro-resistances\"real-world examples of how workers and communities subvert or navigate algorithmic control (e.g., \"gambiarra\" or workarounds), grounding theory in lived experience."},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[15047,15295],"text":" engine. It searches live data sources (forums, Reddit) to find &ldquo;micro-resistances\"real-world examples of how workers and communities subvert or navigate algorithmic control (e.g., \"gambiarra\" or workarounds), grounding theory in lived experience."},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[15047,15295],"text":" engine. It searches live data sources (forums, Reddit) to find &#34;micro-resistances\"real-world examples of how workers and communities subvert or navigate algorithmic control (e.g., \"gambiarra\" or workarounds), grounding theory in lived experience."},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[15047,15295],"text":" engine. It searches live data sources (forums, Reddit) to find &rdquo;micro-resistances\"real-world examples of how workers and communities subvert or navigate algorithmic control (e.g., \"gambiarra\" or workarounds), grounding theory in lived experience."},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":212,"column":252,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[15047,15295],"text":" engine. It searches live data sources (forums, Reddit) to find \"micro-resistances&quot;real-world examples of how workers and communities subvert or navigate algorithmic control (e.g., \"gambiarra\" or workarounds), grounding theory in lived experience."},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[15047,15295],"text":" engine. It searches live data sources (forums, Reddit) to find \"micro-resistances&ldquo;real-world examples of how workers and communities subvert or navigate algorithmic control (e.g., \"gambiarra\" or workarounds), grounding theory in lived experience."},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[15047,15295],"text":" engine. It searches live data sources (forums, Reddit) to find \"micro-resistances&#34;real-world examples of how workers and communities subvert or navigate algorithmic control (e.g., \"gambiarra\" or workarounds), grounding theory in lived experience."},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[15047,15295],"text":" engine. It searches live data sources (forums, Reddit) to find \"micro-resistances&rdquo;real-world examples of how workers and communities subvert or navigate algorithmic control (e.g., \"gambiarra\" or workarounds), grounding theory in lived experience."},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":212,"column":352,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[15047,15295],"text":" engine. It searches live data sources (forums, Reddit) to find \"micro-resistances\"real-world examples of how workers and communities subvert or navigate algorithmic control (e.g., &quot;gambiarra\" or workarounds), grounding theory in lived experience."},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[15047,15295],"text":" engine. It searches live data sources (forums, Reddit) to find \"micro-resistances\"real-world examples of how workers and communities subvert or navigate algorithmic control (e.g., &ldquo;gambiarra\" or workarounds), grounding theory in lived experience."},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[15047,15295],"text":" engine. It searches live data sources (forums, Reddit) to find \"micro-resistances\"real-world examples of how workers and communities subvert or navigate algorithmic control (e.g., &#34;gambiarra\" or workarounds), grounding theory in lived experience."},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[15047,15295],"text":" engine. It searches live data sources (forums, Reddit) to find \"micro-resistances\"real-world examples of how workers and communities subvert or navigate algorithmic control (e.g., &rdquo;gambiarra\" or workarounds), grounding theory in lived experience."},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":212,"column":362,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[15047,15295],"text":" engine. It searches live data sources (forums, Reddit) to find \"micro-resistances\"real-world examples of how workers and communities subvert or navigate algorithmic control (e.g., \"gambiarra&quot; or workarounds), grounding theory in lived experience."},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[15047,15295],"text":" engine. It searches live data sources (forums, Reddit) to find \"micro-resistances\"real-world examples of how workers and communities subvert or navigate algorithmic control (e.g., \"gambiarra&ldquo; or workarounds), grounding theory in lived experience."},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[15047,15295],"text":" engine. It searches live data sources (forums, Reddit) to find \"micro-resistances\"real-world examples of how workers and communities subvert or navigate algorithmic control (e.g., \"gambiarra&#34; or workarounds), grounding theory in lived experience."},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[15047,15295],"text":" engine. It searches live data sources (forums, Reddit) to find \"micro-resistances\"real-world examples of how workers and communities subvert or navigate algorithmic control (e.g., \"gambiarra&rdquo; or workarounds), grounding theory in lived experience."},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":319,"column":65,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[23375,23442],"text":"\r\n                                                                &quot;"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[23375,23442],"text":"\r\n                                                                &ldquo;"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[23375,23442],"text":"\r\n                                                                &#34;"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[23375,23442],"text":"\r\n                                                                &rdquo;"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":319,"column":78,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[23454,23521],"text":"&quot;\r\n                                                                "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[23454,23521],"text":"&ldquo;\r\n                                                                "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[23454,23521],"text":"&#34;\r\n                                                                "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[23454,23521],"text":"&rdquo;\r\n                                                                "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":422,"column":77,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[30826,30999],"text":"\r\n                                        Hover over cells to reveal specific &quot;bridging concepts\" that can reconcile these differences.\r\n                                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[30826,30999],"text":"\r\n                                        Hover over cells to reveal specific &ldquo;bridging concepts\" that can reconcile these differences.\r\n                                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[30826,30999],"text":"\r\n                                        Hover over cells to reveal specific &#34;bridging concepts\" that can reconcile these differences.\r\n                                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[30826,30999],"text":"\r\n                                        Hover over cells to reveal specific &rdquo;bridging concepts\" that can reconcile these differences.\r\n                                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":422,"column":95,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[30826,30999],"text":"\r\n                                        Hover over cells to reveal specific \"bridging concepts&quot; that can reconcile these differences.\r\n                                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[30826,30999],"text":"\r\n                                        Hover over cells to reveal specific \"bridging concepts&ldquo; that can reconcile these differences.\r\n                                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[30826,30999],"text":"\r\n                                        Hover over cells to reveal specific \"bridging concepts&#34; that can reconcile these differences.\r\n                                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[30826,30999],"text":"\r\n                                        Hover over cells to reveal specific \"bridging concepts&rdquo; that can reconcile these differences.\r\n                                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":431,"column":59,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[31596,31762],"text":"\r\n                                        Use the suggested &quot;Policy Implications\" to draft regulations that work across borders.\r\n                                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[31596,31762],"text":"\r\n                                        Use the suggested &ldquo;Policy Implications\" to draft regulations that work across borders.\r\n                                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[31596,31762],"text":"\r\n                                        Use the suggested &#34;Policy Implications\" to draft regulations that work across borders.\r\n                                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[31596,31762],"text":"\r\n                                        Use the suggested &rdquo;Policy Implications\" to draft regulations that work across borders.\r\n                                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":431,"column":79,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[31596,31762],"text":"\r\n                                        Use the suggested \"Policy Implications&quot; to draft regulations that work across borders.\r\n                                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[31596,31762],"text":"\r\n                                        Use the suggested \"Policy Implications&ldquo; to draft regulations that work across borders.\r\n                                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[31596,31762],"text":"\r\n                                        Use the suggested \"Policy Implications&#34; to draft regulations that work across borders.\r\n                                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[31596,31762],"text":"\r\n                                        Use the suggested \"Policy Implications&rdquo; to draft regulations that work across borders.\r\n                                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":484,"column":132,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[35316,35317],"text":"&quot;"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[35316,35317],"text":"&ldquo;"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[35316,35317],"text":"&#34;"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[35316,35317],"text":"&rdquo;"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":484,"column":159,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[35343,35344],"text":"&quot;"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[35343,35344],"text":"&ldquo;"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[35343,35344],"text":"&#34;"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[35343,35344],"text":"&rdquo;"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":501,"column":37,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[36577,36681],"text":"\r\n                                    &quot;Article 14(a): Providers of high-risk AI systems shall implement "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[36577,36681],"text":"\r\n                                    &ldquo;Article 14(a): Providers of high-risk AI systems shall implement "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[36577,36681],"text":"\r\n                                    &#34;Article 14(a): Providers of high-risk AI systems shall implement "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[36577,36681],"text":"\r\n                                    &rdquo;Article 14(a): Providers of high-risk AI systems shall implement "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":501,"column":370,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[36738,36983],"text":" protocols. These protocols must demonstrate not only technical compliance but also alignment with local cultural norms and fundamental rights frameworks of the deployment context, subject to third-party audit.&quot;\r\n                                "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[36738,36983],"text":" protocols. These protocols must demonstrate not only technical compliance but also alignment with local cultural norms and fundamental rights frameworks of the deployment context, subject to third-party audit.&ldquo;\r\n                                "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[36738,36983],"text":" protocols. These protocols must demonstrate not only technical compliance but also alignment with local cultural norms and fundamental rights frameworks of the deployment context, subject to third-party audit.&#34;\r\n                                "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[36738,36983],"text":" protocols. These protocols must demonstrate not only technical compliance but also alignment with local cultural norms and fundamental rights frameworks of the deployment context, subject to third-party audit.&rdquo;\r\n                                "},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":26,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport Link from \"next/link\";\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { ArrowLeft, BrainCircuit, Lightbulb, Sparkles, Lock, FileText, Activity, Grid, Download, Share2, Maximize2, SlidersHorizontal, Info, CheckCircle2 } from \"lucide-react\";\r\nimport { CulturalHoleCard } from \"@/components/CulturalHoleCard\";\r\nimport { CulturalHoleNetwork } from \"@/components/CulturalHoleNetwork\";\r\nimport { CulturalHoleMatrix } from \"@/components/CulturalHoleMatrix\";\r\nimport { CulturalAnalysisResult, BridgingConcept } from \"@/types/cultural\";\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\r\nimport { AnalysisResults } from \"@/components/policy/AnalysisResults\";\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription } from \"@/components/ui/dialog\";\r\nimport { useState } from \"react\";\r\n\r\n// --- FROZEN DEMO DATA ---\r\nconst DEMO_ANALYSIS: CulturalAnalysisResult = {\r\n    timestamp: new Date().toISOString(),\r\n    summary: \"This comparative analysis exposes a foundational epistemic divergence: The EU operates on a logic of 'Market Hygiene' (mitigating risk to facilitate trade), while Brazil's framework is grounded in 'Situated Rights' (protecting collective vulnerability against power asymmetry). The US model remains distinct as 'Geopolitical Techno-Optimism'.\",\r\n    clusters: [\r\n        {\r\n            id: \"c1\",\r\n            name: \"EU: Instrumental Rationality\",\r\n            description: \"A framework where safety is operationalized as product compliance. Rights are proceduralized into technical standards.\",\r\n            themes: [\"Market Hygiene\", \"Technocratic Universalism\", \"Risk Taxonomy\", \"Procedural Fairness\"],\r\n            sources: [\"EU AI Act\"],\r\n            centroid: [0.15, 0.25],\r\n            size: 5,\r\n            quotes: [\r\n                { text: \"The purpose of this Regulation is to improve the functioning of the internal market...\", source: \"EU AI Act, Recital 1\" },\r\n                { text: \"High-risk AI systems should be designed... to ensure appropriate levels of accuracy, robustness and cybersecurity.\", source: \"EU AI Act, Art. 15\" }\r\n            ]\r\n        },\r\n        {\r\n            id: \"c2\",\r\n            name: \"Brazil: Rights-Based Precaution\",\r\n            description: \"A framework emphasizing the redress of historical inequality and collective harm, viewing data as a manifestation of personality.\",\r\n            themes: [\"Data Sovereignty\", \"Algorithmic Reparations\", \"Collective Redress\", \"Reverse Burden of Proof\"],\r\n            sources: [\"Brazil PL 2338\"],\r\n            centroid: [0.85, 0.85],\r\n            size: 5,\r\n            quotes: [\r\n                { text: \"The use of AI systems must observe... non-discrimination, justice, and the correction of biases...\", source: \"PL 2338/23, Art. 3\" },\r\n                { text: \"Ensuring the centrality of the human person and the preservation of democratic regimes.\", source: \"PL 2338/23, Art. 1\" }\r\n            ]\r\n        },\r\n        {\r\n            id: \"c3\",\r\n            name: \"US: Geopolitical Acceleration\",\r\n            description: \"Governance serves to maintain strategic hegemony. Regulation is voluntary to avoid slowing down innovation velocity.\",\r\n            themes: [\"National Security\", \"Innovation Velocity\", \"Voluntary Commitments\", \"Industry Self-Policing\"],\r\n            sources: [\"US Exec. Order 14110\"],\r\n            centroid: [0.45, 0.75],\r\n            size: 4,\r\n            quotes: [\r\n                { text: \"Leading the world in innovation and discovery...\", source: \"EO 14110\" },\r\n                { text: \"We must govern the development and use of AI safely and responsibly [without] stifling innovation.\", source: \"EO 14110\" }\r\n            ]\r\n        }\r\n    ],\r\n    holes: [\r\n        {\r\n            id: \"h1\",\r\n            clusterA: \"c1\",\r\n            clusterB: \"c2\",\r\n            distance: 0.78,\r\n            opportunity: \"Bridging the gap between EU 'Technical Safety' and Brazilian 'Social Justice'.\",\r\n            policyImplication: \"Develop 'Socio-Technical Conformity Assessments' where EU technical standards must be validated against Brazilian racial impact indicators.\",\r\n            bridgingConcepts: [\r\n                {\r\n                    concept: \"Cosmotechnical Alignment\",\r\n                    explanation: \"Harmonizing technical standards not by universalizing them, but by adapting them to local cosmologies and social realities.\"\r\n                },\r\n                {\r\n                    concept: \"Situated Risk Scoring\",\r\n                    explanation: \"Risk metrics that weigh 'cultural harm' and 'erasure' as heavily as physical safety or discrimination.\"\r\n                }\r\n            ]\r\n        },\r\n        {\r\n            id: \"h2\",\r\n            clusterA: \"c1\",\r\n            clusterB: \"c3\",\r\n            distance: 0.45,\r\n            opportunity: \"Harmonizing 'Auditable Innovation' mechanisms to allow US firms market access without diluting EU safety.\",\r\n            policyImplication: \"Create 'Transatlantic Safe Harbors' where US voluntary commitments are legally recognized if they meet specific EU audit thresholds.\",\r\n            bridgingConcepts: [\r\n                {\r\n                    concept: \"Binding Self-Regulation\",\r\n                    explanation: \"Voluntary industry codes that become legally enforceable contracts once adopted.\"\r\n                }\r\n            ]\r\n        },\r\n        {\r\n            id: \"h3\",\r\n            clusterA: \"c2\",\r\n            clusterB: \"c3\",\r\n            distance: 0.92,\r\n            opportunity: \"Reconciling 'Data Sovereignty' with 'Global Innovation Flows'.\",\r\n            policyImplication: \"Implement 'Sovereign Compute Zones' where US companies invest in local Brazil infrastructure in exchange for data access.\",\r\n            bridgingConcepts: [\r\n                {\r\n                    concept: \"Infrastructural Sovereignty\",\r\n                    explanation: \"Ensuring that the physical hardware and compute power for local AI resides within national borders.\"\r\n                },\r\n                {\r\n                    concept: \"Epistemic Reparations\",\r\n                    explanation: \"US firms funding local research to 'correct' the biases in their foundation models using local data.\"\r\n                }\r\n            ]\r\n        }\r\n    ]\r\n};\r\n\r\n// Mock Data for Document Analysis\r\nconst DEMO_FULL_ANALYSIS: any = {\r\n    key_insight: \"The EU AI Act represents a 'Brussels Effect' strategy, attempting to export a risk-based technocratic governance model that prioritizes market safety over situated social justice, potentially creating a 'compliance industrial complex' that marginalizes non-European epistemologies.\",\r\n    governance_power_accountability: \"Centralized enforcement through the AI Office and national competent authorities. Accountability is procedural, focused on conformity assessments rather than direct democratic oversight.\",\r\n    plurality_inclusion_embodiment: \"Limited. The 'risk' taxonomy is universalizing, failing to account for how AI harms are differentially embodied across race, gender, and geography (e.g., migration control systems).\",\r\n    agency_codesign_self_determination: \"Low. The Act is top-down regulation. Affected communities have little role in the design or audit of high-risk systems, which are largely self-assessed by providers.\",\r\n    reflexivity_situated_praxis: \"Absent. The Act assumes a 'view from nowhere' objectivity in risk calculation, ignoring the situated nature of data and the colonial history of classification systems.\",\r\n    legitimacy_claims: {\r\n        source: \"Industrial/Civic Compromise\",\r\n        mechanisms: \"Standardization (CEN/CENELEC), Conformity Assessments, CE Marking\",\r\n        tensions: \"Tension between 'protecting fundamental rights' (Civic) and 'ensuring the proper functioning of the internal market' (Industrial/Market).\"\r\n    },\r\n    assemblage_dynamics: {\r\n        territorialization: \"Stabilizes the 'Single Market' for AI through harmonized rules, creating a bounded territory of 'trustworthy AI' that excludes non-compliant external systems.\",\r\n        deterritorialization: \"Disrupts national regulatory autonomy, shifting power to supranational bodies and private standard-setting organizations.\",\r\n        coding: \"Codes 'risk' as a technical property of the system, rather than a relational property of power dynamics, translating social harm into engineering metrics.\"\r\n    }\r\n};\r\n\r\nconst DEMO_STANDARD_ANALYSIS: any = {\r\n    key_insight: \"The EU AI Act establishes a comprehensive risk-based framework for AI safety, ensuring market harmonization while protecting fundamental rights through technical standards and conformity assessments.\",\r\n    governance_power_accountability: \"Clear governance structure with EU AI Office and national authorities. Accountability ensured through ex-ante conformity assessments and post-market monitoring.\",\r\n    plurality_inclusion_embodiment: \"Standardized approach to fundamental rights impact assessments. Focus on technical bias mitigation and data quality requirements.\",\r\n    agency_codesign_self_determination: \"Transparency obligations for high-risk systems (e.g., registration in EU database) empower users. Human oversight requirements ensure agency.\",\r\n    reflexivity_situated_praxis: \"Objective risk classification based on intended purpose and deployment context. Rigorous testing and validation protocols.\",\r\n    legitimacy_claims: {\r\n        source: \"Democratic/Legal\",\r\n        mechanisms: \"Parliamentary Process, Expert Consultation, Impact Assessments\",\r\n        tensions: \"Balancing innovation with regulation.\"\r\n    },\r\n    assemblage_dynamics: {\r\n        territorialization: \"Creates a trusted single market for AI.\",\r\n        deterritorialization: \"Removes barriers to cross-border AI trade.\",\r\n        coding: \"Codifies safety and fundamental rights into technical requirements.\"\r\n    }\r\n};\r\n\r\nexport default function DemoPage() {\r\n    const [analysisMode, setAnalysisMode] = useState<'standard' | 'decolonial'>('decolonial');\r\n    const [isLiveMode, setIsLiveMode] = useState(false);\r\n    const [selectedConcept, setSelectedConcept] = useState<BridgingConcept | null>(null);\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-slate-50 pb-20\">\r\n            {/* Demo Header */}\r\n            <div className=\"bg-slate-900 text-white py-12 px-6\">\r\n                <div className=\"max-w-7xl mx-auto\">\r\n                    <div className=\"flex items-center gap-4 mb-6\">\r\n                        <Link href=\"/\">\r\n                            <Button variant=\"ghost\" className=\"text-slate-300 hover:text-white pl-0\">\r\n                                <ArrowLeft className=\"mr-2 h-4 w-4\" />\r\n                                Back to Home\r\n                            </Button>\r\n                        </Link>\r\n                        <Badge variant=\"secondary\" className=\"bg-blue-500/20 text-blue-200 border-blue-500/50\">\r\n                            Demo Mode\r\n                        </Badge>\r\n\r\n                    </div>\r\n                    <h1 className=\"text-3xl font-bold tracking-tight sm:text-4xl mb-4\">\r\n                        A quick overview of Assemblage-AI\r\n                    </h1>\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"max-w-7xl mx-auto px-6 -mt-8\">\r\n                <div className=\"bg-white rounded-xl p-8 shadow-sm border border-slate-200 mb-8 space-y-6\">\r\n                    <div>\r\n                        <h2 className=\"text-2xl font-bold text-slate-900 mb-2\">System Function: Decolonial Situatedness in Global AI Governance Research Platform</h2>\r\n                        <p className=\"text-slate-700 leading-relaxed\">\r\n                            This application is a specialized research instrument designed to operationalize the <strong>Decolonial Situatedness Framework (DSF)</strong> for analyzing global AI governance. Unlike standard legal compliance tools, it functions as an \"epistemic lens,\" revealing the hidden structural power dynamics, cultural assumptions, and colonial legacies embedded within policy texts (e.g., the EU AI Act, Brazils PL 2338).\r\n                        </p>\r\n                    </div>\r\n\r\n                    <div>\r\n                        <h3 className=\"text-lg font-bold text-slate-900 mb-3\">Core Capabilities</h3>\r\n                        <div className=\"grid md:grid-cols-2 gap-6\">\r\n                            <div>\r\n                                <h4 className=\"font-semibold text-slate-800 mb-1\">1. Multi-Lens Algorithmic Analysis</h4>\r\n                                <p className=\"text-sm text-slate-600 mb-2\">The system employs advanced LLM-driven qualitative analysis to interpret documents through distinct theoretical frameworks:</p>\r\n                                <ul className=\"list-disc list-inside text-sm text-slate-600 space-y-1 ml-2\">\r\n                                    <li><strong>Institutional Logics:</strong> Identifies conflicting values (Market vs. State vs. Community).</li>\r\n                                    <li><strong>Cultural Framing:</strong> Exposes regionally specific assumptions about technology and rights.</li>\r\n                                    <li><strong>Legitimacy Dynamics:</strong> Maps the moral justifications (Orders of Worth) used to defend authority.</li>\r\n                                </ul>\r\n                            </div>\r\n                            <div>\r\n                                <h4 className=\"font-semibold text-slate-800 mb-1\">2. Ecosystem & Assemblage Mapping</h4>\r\n                                <p className=\"text-sm text-slate-600\">It visualizes governance not as static text, but as active \"assemblages.\" The <strong>Ecosystem Impact Map</strong> traces how specific policy mechanisms (e.g., \"sandboxes\") constrain or afford possibilities for diverse actors, distinguishing between material infrastructures and discursive norms.</p>\r\n                            </div>\r\n                            <div>\r\n                                <h4 className=\"font-semibold text-slate-800 mb-1\">3. Comparative Synthesis</h4>\r\n                                <p className=\"text-sm text-slate-600\">The platform features a <strong>Convergence/Divergence Engine</strong> that quantifies the \"epistemic distance\" between frameworks. It generates \"Coloniality Scores\" to highlight where Global North standards may be overshadowing local contexts, visualizing these asymmetries via radar charts and synthesis matrices.</p>\r\n                            </div>\r\n                            <div>\r\n                                <h4 className=\"font-semibold text-slate-800 mb-1\">4. Empirical Grounding (Micro-Resistance)</h4>\r\n                                <p className=\"text-sm text-slate-600\">To counter abstract high-level rhetoric, the system integrates an <strong>Empirical Traces</strong> engine. It searches live data sources (forums, Reddit) to find \"micro-resistances\"real-world examples of how workers and communities subvert or navigate algorithmic control (e.g., \"gambiarra\" or workarounds), grounding theory in lived experience.</p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <p className=\"text-slate-700 italic border-l-4 border-indigo-500 pl-4 py-1 bg-slate-50\">\r\n                        Ultimately, this system transforms static policy analysis into a dynamic, comparative critique, empowering researchers to challenge hegemonic norms in global AI governance.\r\n                    </p>\r\n                </div>\r\n                <Tabs defaultValue=\"document\" className=\"w-full\">\r\n                    <TabsList className=\"grid w-full grid-cols-3 bg-white p-1 rounded-xl shadow-sm border border-slate-200 mb-8\">\r\n                        <TabsTrigger value=\"document\" className=\"data-[state=active]:bg-blue-50 data-[state=active]:text-blue-700 data-[state=active]:shadow-none py-3\">\r\n                            <FileText className=\"mr-2 h-4 w-4\" /> Document Analysis\r\n                        </TabsTrigger>\r\n                        <TabsTrigger value=\"cultural\" className=\"data-[state=active]:bg-blue-50 data-[state=active]:text-blue-700 data-[state=active]:shadow-none py-3\">\r\n                            <BrainCircuit className=\"mr-2 h-4 w-4\" /> Cultural Analysis\r\n                        </TabsTrigger>\r\n                        <TabsTrigger value=\"matrix\" className=\"data-[state=active]:bg-blue-50 data-[state=active]:text-blue-700 data-[state=active]:shadow-none py-3\">\r\n                            <Grid className=\"mr-2 h-4 w-4\" /> Comparison Matrix\r\n                        </TabsTrigger>\r\n                    </TabsList>\r\n\r\n                    <TabsContent value=\"cultural\" className=\"space-y-8 animate-in fade-in slide-in-from-bottom-4 duration-500\">\r\n                        {/* Main Content Grid */}\r\n                        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\r\n\r\n                            {/* Left Column: Context & Clusters */}\r\n                            <div className=\"space-y-6 lg:col-span-2\">\r\n                                {/* Summary Card */}\r\n                                <Card className=\"shadow-lg border-blue-100\">\r\n                                    <CardHeader className=\"bg-gradient-to-r from-blue-50 to-white border-b border-blue-50\">\r\n                                        <div className=\"flex items-center gap-2\">\r\n                                            <Sparkles className=\"h-5 w-5 text-blue-600\" />\r\n                                            <CardTitle className=\"text-blue-900\">Executive Summary</CardTitle>\r\n                                        </div>\r\n                                    </CardHeader>\r\n                                    <CardContent className=\"pt-6\">\r\n                                        <p className=\"text-slate-700 leading-relaxed text-lg\">\r\n                                            {DEMO_ANALYSIS.summary}\r\n                                        </p>\r\n                                    </CardContent>\r\n                                </Card>\r\n\r\n                                {/* Network Visualization (Mocked) */}\r\n                                <Card className=\"shadow-md\">\r\n                                    <CardHeader>\r\n                                        <div className=\"flex items-center justify-between\">\r\n                                            <div className=\"flex items-center gap-2\">\r\n                                                <BrainCircuit className=\"h-5 w-5 text-slate-600\" />\r\n                                                <CardTitle>Discourse Cluster Network</CardTitle>\r\n                                            </div>\r\n                                            <Button\r\n                                                variant=\"ghost\"\r\n                                                size=\"sm\"\r\n                                                className={`text-slate-400 hover:text-slate-600 ${isLiveMode ? 'text-indigo-600 bg-indigo-50' : ''}`}\r\n                                                onClick={() => setIsLiveMode(!isLiveMode)}\r\n                                            >\r\n                                                {isLiveMode ? <Activity className=\"h-4 w-4 mr-2 animate-pulse\" /> : <Maximize2 className=\"h-4 w-4 mr-2\" />}\r\n                                                {isLiveMode ? \"Live Mode Active\" : \"Fullscreen\"}\r\n                                            </Button>\r\n                                        </div>\r\n                                        <CardDescription>\r\n                                            Visualizing the semantic distance between EU and Brazilian policy concepts.\r\n                                        </CardDescription>\r\n                                    </CardHeader>\r\n                                    <CardContent>\r\n                                        <div className=\"h-[400px] bg-slate-50 rounded-xl border border-slate-200 flex items-center justify-center relative overflow-hidden\">\r\n                                            <CulturalHoleNetwork\r\n                                                clusters={DEMO_ANALYSIS.clusters}\r\n                                                holes={DEMO_ANALYSIS.holes}\r\n                                                isLive={isLiveMode}\r\n                                            />\r\n                                        </div>\r\n                                    </CardContent>\r\n                                </Card>\r\n\r\n                                {/* Detailed Clusters */}\r\n                                <div className=\"grid gap-6 md:grid-cols-2\">\r\n                                    {DEMO_ANALYSIS.clusters.map((cluster) => (\r\n                                        <Card key={cluster.id} className=\"border-t-4 border-t-blue-500 shadow-sm hover:shadow-md transition-shadow\">\r\n                                            <CardHeader>\r\n                                                <CardTitle className=\"text-lg\">{cluster.name}</CardTitle>\r\n                                                <div className=\"flex flex-wrap gap-2 mt-2\">\r\n                                                    {cluster.sources.map(s => (\r\n                                                        <Badge key={s} variant=\"outline\" className=\"text-xs\">{s}</Badge>\r\n                                                    ))}\r\n                                                </div>\r\n                                            </CardHeader>\r\n                                            <CardContent className=\"space-y-4\">\r\n                                                <p className=\"text-sm text-slate-600\">{cluster.description}</p>\r\n\r\n                                                <div>\r\n                                                    <h4 className=\"text-xs font-semibold text-slate-900 uppercase tracking-wider mb-2\">Key Themes</h4>\r\n                                                    <div className=\"flex flex-wrap gap-1\">\r\n                                                        {cluster.themes.map(t => (\r\n                                                            <Badge key={t} variant=\"secondary\" className=\"bg-slate-100 text-slate-700 hover:bg-slate-200\">\r\n                                                                {t}\r\n                                                            </Badge>\r\n                                                        ))}\r\n                                                    </div>\r\n                                                </div>\r\n\r\n                                                <div className=\"bg-slate-50 p-3 rounded-lg border border-slate-100\">\r\n                                                    <h4 className=\"text-xs font-semibold text-slate-900 uppercase tracking-wider mb-2\">Evidence</h4>\r\n                                                    <ul className=\"space-y-2\">\r\n                                                        {cluster.quotes?.map((quote, i) => (\r\n                                                            <li key={i} className=\"text-xs text-slate-600 italic border-l-2 border-blue-300 pl-2\">\r\n                                                                \"{quote.text}\"\r\n                                                                <span className=\"block text-[10px] text-slate-400 not-italic mt-1\"> {quote.source}</span>\r\n                                                            </li>\r\n                                                        ))}\r\n                                                    </ul>\r\n                                                </div>\r\n                                            </CardContent>\r\n                                        </Card>\r\n                                    ))}\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Right Column: Cultural Holes & Insights */}\r\n                            <div className=\"space-y-6\">\r\n                                <div className=\"bg-gradient-to-br from-slate-900 via-indigo-950 to-slate-900 text-white p-6 rounded-xl shadow-2xl border border-indigo-500/30 relative overflow-hidden\">\r\n                                    {/* Decorative background element */}\r\n                                    <div className=\"absolute top-0 right-0 w-64 h-64 bg-indigo-500/10 rounded-full blur-3xl -mr-32 -mt-32 pointer-events-none\"></div>\r\n\r\n                                    <div className=\"relative z-10\">\r\n                                        <div className=\"flex items-center gap-3 mb-6\">\r\n                                            <div className=\"p-2 bg-indigo-500/20 rounded-lg border border-indigo-500/30\">\r\n                                                <Lightbulb className=\"h-5 w-5 text-yellow-400\" />\r\n                                            </div>\r\n                                            <div>\r\n                                                <h3 className=\"text-lg font-bold text-white leading-tight\">Detected Cultural Holes</h3>\r\n                                                <p className=\"text-indigo-200 text-xs mt-1\">\r\n                                                    Strategic opportunities for innovation\r\n                                                </p>\r\n                                            </div>\r\n                                        </div>\r\n\r\n                                        <div className=\"space-y-4\">\r\n                                            {DEMO_ANALYSIS.holes.map((hole) => (\r\n                                                <CulturalHoleCard\r\n                                                    key={hole.id}\r\n                                                    hole={hole}\r\n                                                    clusters={DEMO_ANALYSIS.clusters}\r\n                                                />\r\n                                            ))}\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n\r\n\r\n                            </div>\r\n                        </div>\r\n                    </TabsContent>\r\n\r\n                    <TabsContent value=\"matrix\" className=\"space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500\">\r\n                        <div className=\"max-w-5xl mx-auto\">\r\n                            <div className=\"mb-8 text-center\">\r\n                                <h2 className=\"text-2xl font-bold text-slate-900 mb-2\">Cross-Cultural Comparison Matrix</h2>\r\n                                <p className=\"text-slate-600 max-w-2xl mx-auto\">\r\n                                    Identify structural gaps and opportunities for bridging between different regulatory frameworks.\r\n                                    Darker red cells indicate larger cultural distances.\r\n                                </p>\r\n                            </div>\r\n\r\n                            <Card className=\"shadow-xl border-slate-200 overflow-hidden\">\r\n                                <CardHeader className=\"bg-slate-50 border-b border-slate-100 pb-4\">\r\n                                    <div className=\"flex justify-between items-center\">\r\n                                        <div className=\"flex items-center gap-2\">\r\n                                            <Grid className=\"h-5 w-5 text-indigo-600\" />\r\n                                            <CardTitle className=\"text-lg text-slate-800\">Distance Matrix</CardTitle>\r\n                                        </div>\r\n                                        <div className=\"flex items-center gap-4\">\r\n                                            <div className=\"hidden md:flex items-center gap-2 bg-slate-100 px-3 py-1.5 rounded-full\">\r\n                                                <SlidersHorizontal className=\"h-3 w-3 text-slate-500\" />\r\n                                                <span className=\"text-xs font-medium text-slate-600\">Threshold:</span>\r\n                                                <input type=\"range\" className=\"w-24 h-1 bg-slate-300 rounded-lg appearance-none cursor-pointer\" />\r\n                                                <span className=\"text-xs font-medium text-slate-600\">0.5</span>\r\n                                            </div>\r\n                                            <Badge variant=\"outline\" className=\"bg-white\">\r\n                                                {DEMO_ANALYSIS.clusters.length} Clusters Analyzed\r\n                                            </Badge>\r\n                                        </div>\r\n                                    </div>\r\n                                </CardHeader>\r\n                                <CardContent className=\"p-8 flex justify-center bg-white\">\r\n                                    <CulturalHoleMatrix\r\n                                        clusters={DEMO_ANALYSIS.clusters}\r\n                                        holes={DEMO_ANALYSIS.holes}\r\n                                        onConceptClick={setSelectedConcept}\r\n                                    />\r\n                                </CardContent>\r\n                            </Card>\r\n\r\n                            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6 mt-8\">\r\n                                <div className=\"bg-white p-6 rounded-xl border border-slate-200 shadow-sm\">\r\n                                    <div className=\"h-10 w-10 bg-red-100 rounded-lg flex items-center justify-center mb-4\">\r\n                                        <Activity className=\"h-5 w-5 text-red-600\" />\r\n                                    </div>\r\n                                    <h3 className=\"font-semibold text-slate-900 mb-2\">Identify Gaps</h3>\r\n                                    <p className=\"text-sm text-slate-600\">\r\n                                        Locate high-distance pairs (red cells) where regulatory frameworks are most divergent.\r\n                                    </p>\r\n                                </div>\r\n                                <div className=\"bg-white p-6 rounded-xl border border-slate-200 shadow-sm\">\r\n                                    <div className=\"h-10 w-10 bg-amber-100 rounded-lg flex items-center justify-center mb-4\">\r\n                                        <Lightbulb className=\"h-5 w-5 text-amber-600\" />\r\n                                    </div>\r\n                                    <h3 className=\"font-semibold text-slate-900 mb-2\">Find Opportunities</h3>\r\n                                    <p className=\"text-sm text-slate-600\">\r\n                                        Hover over cells to reveal specific \"bridging concepts\" that can reconcile these differences.\r\n                                    </p>\r\n                                </div>\r\n                                <div className=\"bg-white p-6 rounded-xl border border-slate-200 shadow-sm\">\r\n                                    <div className=\"h-10 w-10 bg-blue-100 rounded-lg flex items-center justify-center mb-4\">\r\n                                        <BrainCircuit className=\"h-5 w-5 text-blue-600\" />\r\n                                    </div>\r\n                                    <h3 className=\"font-semibold text-slate-900 mb-2\">Design Policy</h3>\r\n                                    <p className=\"text-sm text-slate-600\">\r\n                                        Use the suggested \"Policy Implications\" to draft regulations that work across borders.\r\n                                    </p>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </TabsContent>\r\n\r\n                    <TabsContent value=\"document\" className=\"space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500\">\r\n                        <div className=\"max-w-4xl mx-auto\">\r\n                            <div className=\"mb-6\">\r\n                                <h2 className=\"text-2xl font-bold text-slate-900\">Document Analysis: EU AI Act</h2>\r\n                                <p className=\"text-slate-600\">\r\n                                    Deep structural analysis using the Decolonial Situatedness Framework.\r\n                                </p>\r\n                            </div>\r\n                            <div className=\"flex flex-col sm:flex-row gap-4 justify-between items-start sm:items-center mb-6\">\r\n                                <div className=\"bg-slate-100 p-1 rounded-lg inline-flex\">\r\n                                    <button\r\n                                        onClick={() => setAnalysisMode('standard')}\r\n                                        className={`px-4 py-2 rounded-md text-sm font-medium transition-all ${analysisMode === 'standard' ? 'bg-white text-slate-900 shadow-sm' : 'text-slate-500 hover:text-slate-700'}`}\r\n                                    >\r\n                                        Standard Risk Assessment\r\n                                    </button>\r\n                                    <button\r\n                                        onClick={() => setAnalysisMode('decolonial')}\r\n                                        className={`px-4 py-2 rounded-md text-sm font-medium transition-all ${analysisMode === 'decolonial' ? 'bg-indigo-600 text-white shadow-sm' : 'text-slate-500 hover:text-slate-700'}`}\r\n                                    >\r\n                                        Decolonial Critique\r\n                                    </button>\r\n                                </div>\r\n                                <div className=\"flex gap-2\">\r\n                                    <Button variant=\"outline\" className=\"gap-2 text-slate-600\">\r\n                                        <Download className=\"h-4 w-4\" /> Export PDF\r\n                                    </Button>\r\n                                    <Button variant=\"outline\" className=\"gap-2 text-slate-600\">\r\n                                        <Share2 className=\"h-4 w-4\" /> Share Report\r\n                                    </Button>\r\n                                </div>\r\n                            </div>\r\n                            <AnalysisResults analysis={analysisMode === 'decolonial' ? DEMO_FULL_ANALYSIS : DEMO_STANDARD_ANALYSIS} />\r\n                        </div>\r\n                    </TabsContent>\r\n                </Tabs>\r\n\r\n                {/* Policy Drafter Dialog */}\r\n                <Dialog open={!!selectedConcept} onOpenChange={(open) => !open && setSelectedConcept(null)}>\r\n                    <DialogContent className=\"max-w-2xl\">\r\n                        <DialogHeader>\r\n                            <DialogTitle className=\"flex items-center gap-2 text-xl\">\r\n                                <Sparkles className=\"h-5 w-5 text-indigo-600\" />\r\n                                Generative Policy Drafter\r\n                            </DialogTitle>\r\n                            <DialogDescription>\r\n                                Drafting a policy clause based on the bridging concept: <span className=\"font-bold text-slate-900\">\"{selectedConcept?.concept}\"</span>\r\n                            </DialogDescription>\r\n                        </DialogHeader>\r\n\r\n                        <div className=\"space-y-4 mt-4\">\r\n                            <div className=\"bg-slate-50 p-4 rounded-lg border border-slate-200\">\r\n                                <h4 className=\"text-xs font-bold text-slate-500 uppercase mb-2\">Context</h4>\r\n                                <p className=\"text-sm text-slate-700\">{selectedConcept?.explanation}</p>\r\n                            </div>\r\n\r\n                            <div className=\"bg-indigo-50 p-6 rounded-xl border border-indigo-100 relative overflow-hidden\">\r\n                                <div className=\"absolute top-0 right-0 w-32 h-32 bg-indigo-200/50 rounded-full blur-3xl -mr-16 -mt-16 pointer-events-none\"></div>\r\n                                <h4 className=\"text-sm font-bold text-indigo-900 mb-3 flex items-center gap-2\">\r\n                                    <FileText className=\"h-4 w-4\" />\r\n                                    Drafted Clause (v0.1)\r\n                                </h4>\r\n                                <p className=\"font-mono text-sm text-indigo-900 leading-relaxed bg-white/50 p-4 rounded-lg border border-indigo-200/50\">\r\n                                    \"Article 14(a): Providers of high-risk AI systems shall implement <strong>{selectedConcept?.concept.toLowerCase()}</strong> protocols. These protocols must demonstrate not only technical compliance but also alignment with local cultural norms and fundamental rights frameworks of the deployment context, subject to third-party audit.\"\r\n                                </p>\r\n                            </div>\r\n\r\n                            <div className=\"flex justify-end gap-2 mt-4\">\r\n                                <Button variant=\"outline\" onClick={() => setSelectedConcept(null)}>Close</Button>\r\n                                <Button className=\"bg-indigo-600 hover:bg-indigo-700\">\r\n                                    <Download className=\"h-4 w-4 mr-2\" /> Save to Drafts\r\n                                </Button>\r\n                            </div>\r\n                        </div>\r\n                    </DialogContent>\r\n                </Dialog>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\ecosystem\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useRef' is defined but never used.","line":3,"column":31,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":37},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":20,"column":64,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":20,"endColumn":67,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1252,1255],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1252,1255],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'actors'. Either include it or remove the dependency array.","line":64,"column":8,"nodeType":"ArrayExpression","endLine":64,"endColumn":56,"suggestions":[{"desc":"Update the dependencies array to be: [actors, actors.length]","fix":{"range":[3117,3165],"text":"[actors, actors.length]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a complex expression in the dependency array. Extract it to a separate variable so it can be statically checked.","line":64,"column":24,"nodeType":"CallExpression","endLine":64,"endColumn":55},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'relations' is assigned a value but never used.","line":166,"column":60,"nodeType":null,"messageId":"unusedVar","endLine":166,"endColumn":69},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":172,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":172,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7563,7566],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7563,7566],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":182,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":182,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8136,8139],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8136,8139],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState, useEffect, useRef } from \"react\";\r\nimport { useServerStorage } from \"@/hooks/useServerStorage\";\r\nimport { EcosystemActor, EcosystemConfiguration } from \"@/types/ecosystem\";\r\n\r\n// Components\r\nimport { ActorList } from \"@/components/ecosystem/ActorList\";\r\nimport { EcosystemMap } from \"@/components/ecosystem/EcosystemMap\";\r\nimport { CulturalHolesAnalysis } from \"@/components/ecosystem/CulturalHolesAnalysis\";\r\nimport { ConfigurationDialog } from \"@/components/ecosystem/ConfigurationDialog\";\r\n\r\nexport default function EcosystemPage() {\r\n    const [actors, setActors] = useServerStorage<EcosystemActor[]>(\"ecosystem_actors\", []);\r\n    const [configurations, setConfigurations] = useServerStorage<EcosystemConfiguration[]>(\"ecosystem_configurations\", []);\r\n    const [selectedActorId, setSelectedActorId] = useServerStorage<string | null>(\"ecosystem_selected_actor_id\", null);\r\n    const [isSimulating, setIsSimulating] = useState(false);\r\n    const [simulationQuery, setSimulationQuery] = useServerStorage<string>(\"ecosystem_simulation_query\", \"AI startups and policy actors in Brussels\");\r\n    const [isDialogOpen, setIsDialogOpen] = useState(false);\r\n    const [culturalHoles, setCulturalHoles] = useServerStorage<any>(\"ecosystem_cultural_holes\", null);\r\n    const [isAnalyzingHoles, setIsAnalyzingHoles] = useState(false);\r\n\r\n    // Interaction Modes\r\n    const [interactionMode, setInteractionMode] = useState<\"drag\" | \"select\">(\"drag\");\r\n    const [selectedForGrouping, setSelectedForGrouping] = useState<string[]>([]);\r\n    const [isConfigDialogOpen, setIsConfigDialogOpen] = useState(false);\r\n    const [newConfigName, setNewConfigName] = useState(\"\");\r\n    const [newConfigDesc, setNewConfigDesc] = useState(\"\");\r\n\r\n    // Extraction State\r\n    const [isExtractionDialogOpen, setIsExtractionDialogOpen] = useState(false);\r\n    const [extractionText, setExtractionText] = useState(\"\");\r\n    const [isExtracting, setIsExtracting] = useState(false);\r\n\r\n    // Graph interaction state\r\n    const [positions, setPositions] = useState<Record<string, { x: number, y: number }>>({});\r\n    const [mounted, setMounted] = useState(false);\r\n\r\n    useEffect(() => {\r\n        setMounted(true);\r\n    }, []);\r\n\r\n    // Initialize positions when actors change\r\n    useEffect(() => {\r\n        setPositions(prev => {\r\n            const newPositions = { ...prev };\r\n            let hasChanges = false;\r\n            actors.forEach((actor, i) => {\r\n                if (!newPositions[actor.id]) {\r\n                    const totalActors = actors.length;\r\n                    const angle = (i / totalActors) * 2 * Math.PI;\r\n                    const centerX = 350;\r\n                    const centerY = 200;\r\n                    const radius = 120;\r\n                    newPositions[actor.id] = {\r\n                        x: centerX + radius * Math.cos(angle),\r\n                        y: centerY + radius * Math.sin(angle)\r\n                    };\r\n                    hasChanges = true;\r\n                }\r\n            });\r\n            return hasChanges ? newPositions : prev;\r\n        });\r\n    }, [actors.length, actors.map(a => a.id).join(',')]);\r\n\r\n    const handleSimulate = async () => {\r\n        setIsSimulating(true);\r\n        try {\r\n            const headers: HeadersInit = { 'Content-Type': 'application/json' };\r\n            if (process.env.NEXT_PUBLIC_ENABLE_DEMO_MODE === 'true' && process.env.NEXT_PUBLIC_DEMO_USER_ID) {\r\n                headers['x-demo-user-id'] = process.env.NEXT_PUBLIC_DEMO_USER_ID;\r\n            }\r\n\r\n            const response = await fetch('/api/ecosystem/simulate', {\r\n                method: 'POST',\r\n                headers: headers,\r\n                body: JSON.stringify({ query: simulationQuery })\r\n            });\r\n            const data = await response.json();\r\n            if (data.success && data.actors) {\r\n                setActors(prev => {\r\n                    const existingNames = new Set(prev.map(a => a.name.toLowerCase()));\r\n                    const newUniqueActors = data.actors.filter((a: EcosystemActor) => !existingNames.has(a.name.toLowerCase()));\r\n\r\n                    if (newUniqueActors.length === 0) {\r\n                        alert(\"No new unique actors found.\");\r\n                        return prev;\r\n                    }\r\n\r\n                    return [...prev, ...newUniqueActors];\r\n                });\r\n                setIsDialogOpen(false);\r\n            } else {\r\n                alert(\"Simulation failed: \" + (data.error || \"Unknown error\"));\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Simulation error:\", error);\r\n            alert(\"Failed to simulate ecosystem.\");\r\n        } finally {\r\n            setIsSimulating(false);\r\n        }\r\n    };\r\n\r\n    const handleAnalyzeHoles = async () => {\r\n        if (actors.length < 2) {\r\n            alert(\"Need at least 2 actors to analyze cultural holes.\");\r\n            return;\r\n        }\r\n        setIsAnalyzingHoles(true);\r\n        try {\r\n            // Map actors to sources format for the advanced analysis API\r\n            const sources = actors.map(a => ({\r\n                id: a.id,\r\n                title: a.name,\r\n                text: `ACTOR TYPE: ${a.type}\\nDESCRIPTION: ${a.description}\\nINFLUENCE: ${a.influence}`\r\n            }));\r\n\r\n            const headers: HeadersInit = { 'Content-Type': 'application/json' };\r\n            if (process.env.NEXT_PUBLIC_ENABLE_DEMO_MODE === 'true' && process.env.NEXT_PUBLIC_DEMO_USER_ID) {\r\n                headers['x-demo-user-id'] = process.env.NEXT_PUBLIC_DEMO_USER_ID;\r\n            }\r\n\r\n            const response = await fetch('/api/cultural-analysis', {\r\n                method: 'POST',\r\n                headers: headers,\r\n                body: JSON.stringify({\r\n                    sources: sources,\r\n                    lensId: 'default'\r\n                })\r\n            });\r\n            const data = await response.json();\r\n            if (data.success && data.analysis) {\r\n                setCulturalHoles(data.analysis);\r\n            } else {\r\n                alert(\"Analysis failed: \" + (data.error || \"Unknown error\"));\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Holes analysis error:\", error);\r\n            alert(\"Failed to analyze cultural holes.\");\r\n        } finally {\r\n            setIsAnalyzingHoles(false);\r\n        }\r\n    };\r\n\r\n    const handleExtractAssemblage = async () => {\r\n        if (!extractionText.trim()) return;\r\n        setIsExtracting(true);\r\n        try {\r\n            const headers: HeadersInit = { 'Content-Type': 'application/json' };\r\n            if (process.env.NEXT_PUBLIC_ENABLE_DEMO_MODE === 'true' && process.env.NEXT_PUBLIC_DEMO_USER_ID) {\r\n                headers['x-demo-user-id'] = process.env.NEXT_PUBLIC_DEMO_USER_ID;\r\n            }\r\n\r\n            const response = await fetch('/api/analyze', {\r\n                method: 'POST',\r\n                headers: headers,\r\n                body: JSON.stringify({\r\n                    text: extractionText,\r\n                    analysisMode: 'assemblage_extraction',\r\n                    sourceType: 'User Input'\r\n                })\r\n            });\r\n\r\n            const data = await response.json();\r\n            if (data.success && data.analysis) {\r\n                const { assemblage, actors: newActorsList, relations } = data.analysis;\r\n\r\n                // 1. Process Actors\r\n                const memberIds: string[] = [];\r\n                const currentActors = [...actors];\r\n\r\n                newActorsList.forEach((newActor: any) => {\r\n                    // Check if actor exists (fuzzy match by name)\r\n                    const existing = currentActors.find(a => a.name.toLowerCase() === newActor.name.toLowerCase());\r\n                    if (existing) {\r\n                        memberIds.push(existing.id);\r\n                    } else {\r\n                        const id = crypto.randomUUID();\r\n                        const createdActor: EcosystemActor = {\r\n                            id,\r\n                            name: newActor.name,\r\n                            type: (newActor.type as any) || \"Civil Society\", // Default fallback\r\n                            description: newActor.description || \"\",\r\n                            influence: \"Medium\",\r\n                            metrics: { influence: 5, alignment: 5, resistance: 5 }\r\n                        };\r\n                        currentActors.push(createdActor);\r\n                        memberIds.push(id);\r\n\r\n                        // Assign random position\r\n                        setPositions(prev => ({\r\n                            ...prev,\r\n                            [id]: { x: Math.random() * 600 + 100, y: Math.random() * 300 + 50 }\r\n                        }));\r\n                    }\r\n                });\r\n\r\n                setActors(currentActors);\r\n\r\n                // 2. Create Configuration\r\n                if (memberIds.length > 0) {\r\n                    const newConfig: EcosystemConfiguration = {\r\n                        id: crypto.randomUUID(),\r\n                        name: assemblage.name || \"New Assemblage\",\r\n                        description: assemblage.description || \"Extracted from text\",\r\n                        memberIds,\r\n                        properties: {\r\n                            stability: assemblage.properties?.stability || \"Medium\",\r\n                            generativity: assemblage.properties?.generativity || \"Medium\"\r\n                        },\r\n                        color: `hsl(${Math.random() * 360}, 70%, 80%)`\r\n                    };\r\n                    setConfigurations(prev => [...prev, newConfig]);\r\n                }\r\n\r\n                setIsExtractionDialogOpen(false);\r\n                setExtractionText(\"\");\r\n            } else {\r\n                alert(\"Extraction failed: \" + (data.error || \"Unknown error\"));\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Extraction failed:\", error);\r\n            alert(\"Failed to extract assemblage. Please try again.\");\r\n        } finally {\r\n            setIsExtracting(false);\r\n        }\r\n    };\r\n\r\n    const handleClearAll = () => {\r\n        setActors([]);\r\n        setConfigurations([]);\r\n        setSelectedActorId(null);\r\n        setCulturalHoles(null);\r\n        setPositions({});\r\n        setSelectedForGrouping([]);\r\n    };\r\n\r\n    const handleClearCache = async () => {\r\n        try {\r\n            const headers: HeadersInit = {};\r\n            if (process.env.NEXT_PUBLIC_ENABLE_DEMO_MODE === 'true' && process.env.NEXT_PUBLIC_DEMO_USER_ID) {\r\n                headers['x-demo-user-id'] = process.env.NEXT_PUBLIC_DEMO_USER_ID;\r\n            }\r\n\r\n            const response = await fetch('/api/ecosystem/clear-cache', {\r\n                method: 'POST',\r\n                headers: headers\r\n            });\r\n            const data = await response.json();\r\n            if (data.success) {\r\n                alert(\"Cache cleared! Run a new simulation to get actors with website URLs.\");\r\n            } else {\r\n                alert(\"Failed to clear cache: \" + (data.error || \"Unknown error\"));\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Clear cache error:\", error);\r\n            alert(\"Failed to clear cache.\");\r\n        }\r\n    };\r\n\r\n    // Configuration Management\r\n    const handleCreateConfiguration = () => {\r\n        if (selectedForGrouping.length < 2) {\r\n            alert(\"Select at least 2 actors to create a configuration.\");\r\n            return;\r\n        }\r\n        setIsConfigDialogOpen(true);\r\n    };\r\n\r\n    const confirmCreateConfiguration = () => {\r\n        const newConfig: EcosystemConfiguration = {\r\n            id: crypto.randomUUID(),\r\n            name: newConfigName || \"New Configuration\",\r\n            description: newConfigDesc || \"A unified entity of actors.\",\r\n            memberIds: selectedForGrouping,\r\n            properties: {\r\n                stability: \"Medium\",\r\n                generativity: \"Medium\"\r\n            },\r\n            color: `hsl(${Math.random() * 360}, 70%, 85%)` // Random pastel color\r\n        };\r\n\r\n        setConfigurations(prev => [...prev, newConfig]);\r\n        setIsConfigDialogOpen(false);\r\n        setNewConfigName(\"\");\r\n        setNewConfigDesc(\"\");\r\n        setSelectedForGrouping([]);\r\n        setInteractionMode(\"drag\"); // Switch back to drag mode\r\n    };\r\n\r\n    const toggleSelection = (actorId: string) => {\r\n        setSelectedForGrouping(prev => {\r\n            const isSelected = prev.includes(actorId);\r\n            return isSelected\r\n                ? prev.filter(id => id !== actorId)\r\n                : [...prev, actorId];\r\n        });\r\n    };\r\n\r\n    const handleActorDrag = (actorId: string, x: number, y: number) => {\r\n        setPositions(prev => ({\r\n            ...prev,\r\n            [actorId]: { x, y }\r\n        }));\r\n    };\r\n\r\n    const handleConfigDrag = (configId: string, dx: number, dy: number) => {\r\n        const config = configurations.find(c => c.id === configId);\r\n        if (!config) return;\r\n\r\n        setPositions(prev => {\r\n            const newPositions = { ...prev };\r\n            config.memberIds.forEach(memberId => {\r\n                const currentPos = prev[memberId];\r\n                if (currentPos) {\r\n                    newPositions[memberId] = {\r\n                        x: currentPos.x + dx,\r\n                        y: currentPos.y + dy\r\n                    };\r\n                }\r\n            });\r\n            return newPositions;\r\n        });\r\n    };\r\n\r\n    if (!mounted) return null;\r\n\r\n    return (\r\n        <div className=\"flex flex-col lg:flex-row h-full gap-6\">\r\n            {/* Sidebar: Actor Management */}\r\n            <div className=\"w-full lg:w-80 flex flex-col gap-4 shrink-0\">\r\n                <ActorList\r\n                    actors={actors}\r\n                    selectedActorId={selectedActorId}\r\n                    onSelectActor={setSelectedActorId}\r\n                    onClearAll={handleClearAll}\r\n                    isSimulating={isSimulating}\r\n                    simulationQuery={simulationQuery}\r\n                    setSimulationQuery={setSimulationQuery}\r\n                    onSimulate={handleSimulate}\r\n                    isDialogOpen={isDialogOpen}\r\n                    setIsDialogOpen={setIsDialogOpen}\r\n                    onClearCache={handleClearCache}\r\n                    isExtracting={isExtracting}\r\n                    extractionText={extractionText}\r\n                    setExtractionText={setExtractionText}\r\n                    onExtract={handleExtractAssemblage}\r\n                    isExtractionDialogOpen={isExtractionDialogOpen}\r\n                    setIsExtractionDialogOpen={setIsExtractionDialogOpen}\r\n                    isAnalyzingHoles={isAnalyzingHoles}\r\n                    onAnalyze={handleAnalyzeHoles}\r\n                />\r\n            </div>\r\n\r\n            {/* Main Content: Visualizations */}\r\n            <div className=\"flex-1 flex flex-col gap-6 overflow-y-auto pb-10\">\r\n                <div>\r\n                    <h2 className=\"text-3xl font-bold tracking-tight text-slate-900\">Field-Level Ecosystem</h2>\r\n                    <p className=\"text-slate-500\">Mapping the social structure, network ties, and cultural holes in the AI governance field.</p>\r\n                </div>\r\n\r\n                <EcosystemMap\r\n                    actors={actors}\r\n                    configurations={configurations}\r\n                    positions={positions}\r\n                    interactionMode={interactionMode}\r\n                    setInteractionMode={setInteractionMode}\r\n                    selectedForGrouping={selectedForGrouping}\r\n                    onToggleSelection={toggleSelection}\r\n                    onCreateConfiguration={handleCreateConfiguration}\r\n                    onActorDrag={handleActorDrag}\r\n                    onConfigDrag={handleConfigDrag}\r\n                />\r\n\r\n                <CulturalHolesAnalysis\r\n                    culturalHoles={culturalHoles}\r\n                    isAnalyzingHoles={isAnalyzingHoles}\r\n                    onAnalyze={handleAnalyzeHoles}\r\n                />\r\n            </div>\r\n\r\n            <ConfigurationDialog\r\n                isOpen={isConfigDialogOpen}\r\n                onClose={() => setIsConfigDialogOpen(false)}\r\n                name={newConfigName}\r\n                setName={setNewConfigName}\r\n                description={newConfigDesc}\r\n                setDescription={setNewConfigDesc}\r\n                onConfirm={confirmCreateConfiguration}\r\n            />\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\empirical\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'FileText' is defined but never used.","line":20,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":20,"endColumn":18},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":222,"column":85,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[10818,10893],"text":"Add a new trace manually or use &quot;Find Traces\" on the Policy Documents page."},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[10818,10893],"text":"Add a new trace manually or use &ldquo;Find Traces\" on the Policy Documents page."},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[10818,10893],"text":"Add a new trace manually or use &#34;Find Traces\" on the Policy Documents page."},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[10818,10893],"text":"Add a new trace manually or use &rdquo;Find Traces\" on the Policy Documents page."},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":222,"column":97,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[10818,10893],"text":"Add a new trace manually or use \"Find Traces&quot; on the Policy Documents page."},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[10818,10893],"text":"Add a new trace manually or use \"Find Traces&ldquo; on the Policy Documents page."},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[10818,10893],"text":"Add a new trace manually or use \"Find Traces&#34; on the Policy Documents page."},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[10818,10893],"text":"Add a new trace manually or use \"Find Traces&rdquo; on the Policy Documents page."},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState } from \"react\";\r\nimport { useSources } from \"@/hooks/useSources\";\r\nimport { Source } from \"@/types\";\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport {\r\n    Dialog,\r\n    DialogContent,\r\n    DialogDescription,\r\n    DialogFooter,\r\n    DialogHeader,\r\n    DialogTitle,\r\n    DialogTrigger,\r\n} from \"@/components/ui/dialog\";\r\nimport { FileText, Plus, Search, Filter, Sparkles, Loader2, Trash, Eye } from \"lucide-react\";\r\nimport { AnalysisResults } from \"@/components/policy/AnalysisResults\";\r\n\r\nexport default function EmpiricalPage() {\r\n    const { sources, isLoading, addSource, updateSource, deleteSource } = useSources();\r\n    const [searchQuery, setSearchQuery] = useState(\"\");\r\n    const [isAddDialogOpen, setIsAddDialogOpen] = useState(false);\r\n    const [analyzingId, setAnalyzingId] = useState<string | null>(null);\r\n    const [newSource, setNewSource] = useState({\r\n        title: \"\",\r\n        description: \"\",\r\n        type: \"Trace\",\r\n        text: \"\",\r\n    });\r\n\r\n    const [viewingSource, setViewingSource] = useState<Source | null>(null);\r\n\r\n    const filteredSources = sources.filter((source) =>\r\n        source.type === \"Trace\" &&\r\n        (source.title.toLowerCase().includes(searchQuery.toLowerCase()) ||\r\n            source.description.toLowerCase().includes(searchQuery.toLowerCase()))\r\n    );\r\n\r\n    const handleAddSource = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        const source: Source = {\r\n            id: Date.now().toString(),\r\n            title: newSource.title,\r\n            description: newSource.description,\r\n            type: \"Trace\",\r\n            addedDate: new Date().toLocaleDateString(\"en-US\", { month: \"short\", day: \"numeric\", year: \"numeric\" }),\r\n            status: \"Active Case\",\r\n            colorClass: \"bg-orange-100\",\r\n            iconClass: \"text-orange-600\",\r\n            extractedText: newSource.text,\r\n        };\r\n        await addSource(source);\r\n        setNewSource({ title: \"\", description: \"\", type: \"Trace\", text: \"\" });\r\n        setIsAddDialogOpen(false);\r\n    };\r\n\r\n    const handleAnalyze = async (sourceId: string) => {\r\n        const source = sources.find(s => s.id === sourceId);\r\n        if (!source || !source.extractedText) {\r\n            alert('No text available to analyze.');\r\n            return;\r\n        }\r\n\r\n        setAnalyzingId(sourceId);\r\n        try {\r\n            const headers: HeadersInit = { 'Content-Type': 'application/json' };\r\n            if (process.env.NEXT_PUBLIC_ENABLE_DEMO_MODE === 'true' && process.env.NEXT_PUBLIC_DEMO_USER_ID) {\r\n                headers['x-demo-user-id'] = process.env.NEXT_PUBLIC_DEMO_USER_ID;\r\n            }\r\n\r\n            const response = await fetch('/api/analyze', {\r\n                method: 'POST',\r\n                headers: headers,\r\n                body: JSON.stringify({\r\n                    text: source.extractedText.substring(0, 4000), // Limit to first 4000 chars\r\n                    sourceType: 'Empirical Trace'\r\n                })\r\n            });\r\n\r\n            const result = await response.json();\r\n\r\n            if (result.success) {\r\n                await updateSource(sourceId, { analysis: result.analysis });\r\n                alert('Analysis complete! Scroll down to see results.');\r\n            } else {\r\n                alert(`Analysis failed: ${result.error || 'Unknown error'} `);\r\n            }\r\n        } catch (error) {\r\n            console.error('Analysis error:', error);\r\n            alert('Failed to analyze. Make sure your OpenAI API key is configured in .env.local');\r\n        } finally {\r\n            setAnalyzingId(null);\r\n        }\r\n    };\r\n\r\n    const handleDelete = async (sourceId: string) => {\r\n        if (confirm('Are you sure you want to delete this source?')) {\r\n            await deleteSource(sourceId);\r\n        }\r\n    };\r\n\r\n    const handleDeleteAll = async () => {\r\n        if (confirm('Are you sure you want to delete ALL empirical traces? This action cannot be undone.')) {\r\n            const traceIds = sources.filter(s => s.type === \"Trace\").map(s => s.id);\r\n            for (const id of traceIds) {\r\n                await deleteSource(id);\r\n            }\r\n        }\r\n    };\r\n\r\n    if (isLoading) {\r\n        return (\r\n            <div className=\"flex items-center justify-center h-64\">\r\n                <Loader2 className=\"h-8 w-8 animate-spin text-slate-400\" />\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"space-y-8\">\r\n            <div className=\"flex items-center justify-between\">\r\n                <div>\r\n                    <h2 className=\"text-3xl font-bold tracking-tight text-slate-900\">Empirical Data</h2>\r\n                    <p className=\"text-slate-500\">Manage empirical traces (public comments, forum posts, interviews).</p>\r\n                </div>\r\n                <div className=\"flex gap-2\">\r\n                    <Button\r\n                        variant=\"destructive\"\r\n                        onClick={handleDeleteAll}\r\n                        disabled={filteredSources.length === 0}\r\n                    >\r\n                        <Trash className=\"mr-2 h-4 w-4\" /> Delete All Traces\r\n                    </Button>\r\n                    <Dialog open={isAddDialogOpen} onOpenChange={setIsAddDialogOpen}>\r\n                        <DialogTrigger asChild>\r\n                            <Button className=\"bg-slate-900 text-white hover:bg-slate-800\">\r\n                                <Plus className=\"mr-2 h-4 w-4\" /> Add Trace\r\n                            </Button>\r\n                        </DialogTrigger>\r\n                        <DialogContent className=\"sm:max-w-[500px]\">\r\n                            <DialogHeader>\r\n                                <DialogTitle>Add New Empirical Trace</DialogTitle>\r\n                                <DialogDescription>\r\n                                    Add a forum post, public comment, or interview transcript.\r\n                                </DialogDescription>\r\n                            </DialogHeader>\r\n                            <form onSubmit={handleAddSource}>\r\n                                <div className=\"grid gap-4 py-4\">\r\n                                    <div className=\"grid grid-cols-4 items-center gap-4\">\r\n                                        <Label htmlFor=\"title\" className=\"text-right\">\r\n                                            Title\r\n                                        </Label>\r\n                                        <Input\r\n                                            id=\"title\"\r\n                                            value={newSource.title}\r\n                                            onChange={(e) => setNewSource({ ...newSource, title: e.target.value })}\r\n                                            className=\"col-span-3 text-slate-900\"\r\n                                            required\r\n                                            placeholder=\"e.g., Reddit Thread on Uber\"\r\n                                        />\r\n                                    </div>\r\n                                    <div className=\"grid grid-cols-4 items-center gap-4\">\r\n                                        <Label htmlFor=\"description\" className=\"text-right\">\r\n                                            Description\r\n                                        </Label>\r\n                                        <Input\r\n                                            id=\"description\"\r\n                                            value={newSource.description}\r\n                                            onChange={(e) => setNewSource({ ...newSource, description: e.target.value })}\r\n                                            className=\"col-span-3 text-slate-900\"\r\n                                            required\r\n                                            placeholder=\"e.g., Drivers discussing algorithm changes\"\r\n                                        />\r\n                                    </div>\r\n                                    <div className=\"grid grid-cols-4 items-start gap-4\">\r\n                                        <Label htmlFor=\"text\" className=\"text-right pt-2\">\r\n                                            Content\r\n                                        </Label>\r\n                                        <textarea\r\n                                            id=\"text\"\r\n                                            value={newSource.text}\r\n                                            onChange={(e) => setNewSource({ ...newSource, text: e.target.value })}\r\n                                            className=\"col-span-3 flex min-h-[100px] w-full rounded-md border border-slate-200 bg-white px-3 py-2 text-sm ring-offset-white placeholder:text-slate-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-950 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 text-slate-900\"\r\n                                            placeholder=\"Paste the text content of the trace here...\"\r\n                                            required\r\n                                        />\r\n                                    </div>\r\n                                </div>\r\n                                <DialogFooter>\r\n                                    <Button type=\"submit\">Save Trace</Button>\r\n                                </DialogFooter>\r\n                            </form>\r\n                        </DialogContent>\r\n                    </Dialog>\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"flex items-center space-x-2\">\r\n                <div className=\"relative flex-1\">\r\n                    <Search className=\"absolute left-2.5 top-2.5 h-4 w-4 text-slate-500\" />\r\n                    <Input\r\n                        type=\"text\"\r\n                        placeholder=\"Search traces...\"\r\n                        className=\"w-full pl-9\"\r\n                        value={searchQuery}\r\n                        onChange={(e) => setSearchQuery(e.target.value)}\r\n                    />\r\n                </div>\r\n                <Button variant=\"outline\" className=\"border-slate-200\">\r\n                    <Filter className=\"mr-2 h-4 w-4\" /> Filter\r\n                </Button>\r\n            </div>\r\n\r\n            <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-3\">\r\n                {filteredSources.length === 0 ? (\r\n                    <div className=\"col-span-full text-center py-12 text-slate-500\">\r\n                        <p>No empirical traces found.</p>\r\n                        <p className=\"text-sm mt-2\">Add a new trace manually or use \"Find Traces\" on the Policy Documents page.</p>\r\n                    </div>\r\n                ) : (\r\n                    filteredSources.map((source) => (\r\n                        <Card key={source.id} className=\"hover:shadow-md transition-shadow\">\r\n                            <CardHeader className=\"flex flex-col md:flex-row items-start justify-between space-y-4 md:space-y-0 pb-2\">\r\n                                <div className=\"space-y-1 flex-1 min-w-0 pr-0 md:pr-4 w-full\">\r\n                                    <CardTitle className=\"text-base font-semibold break-words\">{source.title}</CardTitle>\r\n                                    <CardDescription className=\"break-words\">{source.description}</CardDescription>\r\n                                </div>\r\n                                <div className=\"flex items-center gap-2 shrink-0 w-full md:w-auto justify-end md:justify-start\">\r\n                                    <Button\r\n                                        variant=\"ghost\"\r\n                                        size=\"sm\"\r\n                                        onClick={() => setViewingSource(source)}\r\n                                        className=\"h-8 w-8 p-0 hover:bg-blue-100 hover:text-blue-600\"\r\n                                        title=\"View trace content\"\r\n                                    >\r\n                                        <Eye className=\"h-4 w-4\" />\r\n                                    </Button>\r\n                                    <Button\r\n                                        variant=\"ghost\"\r\n                                        size=\"sm\"\r\n                                        onClick={() => handleDelete(source.id)}\r\n                                        className=\"h-8 w-8 p-0 hover:bg-red-100 hover:text-red-600\"\r\n                                    >\r\n                                        <Trash className=\"h-4 w-4\" />\r\n                                    </Button>\r\n                                </div>\r\n                            </CardHeader>\r\n                            <CardContent>\r\n                                <div className=\"mt-4 flex items-center space-x-2\">\r\n                                    <Badge variant=\"secondary\" className=\"bg-green-100 text-green-700 hover:bg-green-100\">\r\n                                        {source.status}\r\n                                    </Badge>\r\n                                    <span className=\"text-xs text-slate-500\">\r\n                                        {source.type}\r\n                                    </span>\r\n                                </div>\r\n                                <div className=\"mt-4 text-xs text-slate-500\">\r\n                                    Added: {source.addedDate}\r\n                                </div>\r\n                                {source.extractedText && (\r\n                                    <div className=\"mt-4\">\r\n                                        <Button\r\n                                            onClick={() => handleAnalyze(source.id)}\r\n                                            disabled={analyzingId === source.id}\r\n                                            className=\"w-full bg-purple-600 text-white hover:bg-purple-700\"\r\n                                            size=\"sm\"\r\n                                        >\r\n                                            {analyzingId === source.id ? (\r\n                                                <>\r\n                                                    <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\r\n                                                    Analyzing...\r\n                                                </>\r\n                                            ) : (\r\n                                                <>\r\n                                                    <Sparkles className=\"mr-2 h-4 w-4\" />\r\n                                                    Analyze with AI\r\n                                                </>\r\n                                            )}\r\n                                        </Button>\r\n                                    </div>\r\n                                )}\r\n                                {source.analysis && (\r\n                                    <AnalysisResults analysis={source.analysis} />\r\n                                )}\r\n                            </CardContent>\r\n                        </Card>\r\n                    ))\r\n                )}\r\n            </div>\r\n\r\n            <Dialog open={!!viewingSource} onOpenChange={(open) => !open && setViewingSource(null)}>\r\n                <DialogContent className=\"max-w-3xl max-h-[80vh] flex flex-col\">\r\n                    <DialogHeader>\r\n                        <DialogTitle>{viewingSource?.title}</DialogTitle>\r\n                        <DialogDescription>\r\n                            Extracted text content from {viewingSource?.type}\r\n                        </DialogDescription>\r\n                    </DialogHeader>\r\n                    <div className=\"flex-1 overflow-y-auto p-4 bg-slate-50 rounded-md border border-slate-200 text-sm font-mono whitespace-pre-wrap\">\r\n                        {viewingSource?.extractedText ? (\r\n                            viewingSource.extractedText.split(/(https?:\\/\\/[^\\s]+)/g).map((part, index) =>\r\n                                part.match(/https?:\\/\\/[^\\s]+/) ? (\r\n                                    <a\r\n                                        key={index}\r\n                                        href={part}\r\n                                        target=\"_blank\"\r\n                                        rel=\"noopener noreferrer\"\r\n                                        className=\"text-blue-600 hover:underline break-all\"\r\n                                    >\r\n                                        {part}\r\n                                    </a>\r\n                                ) : (\r\n                                    <span key={index}>{part}</span>\r\n                                )\r\n                            )\r\n                        ) : (\r\n                            \"No text content available.\"\r\n                        )}\r\n                    </div>\r\n                </DialogContent>\r\n            </Dialog>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\glossary\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardDescription' is defined but never used.","line":3,"column":29,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":44},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'BookOpen' is defined but never used.","line":5,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":18},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":99,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":99,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5565,5568],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5565,5568],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":101,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":101,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5675,5678],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5675,5678],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { BookOpen, Quote, ExternalLink } from \"lucide-react\";\r\n\r\nconst TERMS = [\r\n    {\r\n        term: \"Algorithmic Assemblage\",\r\n        definition: \"A complex, emergently structured sociotechnical system where value creation, capture, and resource orchestration occur. It is not just a tool but a dynamic arrangement of code, data, humans, norms, and material resources.\",\r\n        scholar: \"Faraj, S., Pachidi, S., & Sayegh, K. (2018); Hannigan, T., et al. (2025)\",\r\n        category: \"Core Concept\",\r\n        url: \"https://www.callsforpapers.org/special-issues/algorithmic-assemblages\"\r\n    },\r\n    {\r\n        term: \"Discursive Field\",\r\n        definition: \"A social domain structured by language and meaning-making practices. In this context, it refers to how algorithmic technologies differentially circumscribe meaning across global fields and societies.\",\r\n        scholar: \"Miranda, S., et al. (2022)\",\r\n        category: \"Macro\",\r\n        url: \"https://doi.org/10.25300/MISQ/2022/15736\"\r\n    },\r\n    {\r\n        term: \"Legitimacy Dynamics\",\r\n        definition: \"The processes by which an algorithmic system or institution justifies its authority and right to exist. This involves navigating tensions between different forms of legitimacy (e.g., democratic, technocratic, market-based).\",\r\n        scholar: \"Jennings, P.D., et al. (2025)\",\r\n        category: \"Macro\",\r\n        url: \"https://www.callsforpapers.org/special-issues/algorithmic-assemblages\"\r\n    },\r\n    {\r\n        term: \"Sociotechnical System\",\r\n        definition: \"An approach that views technology and social structures as inextricably linked. Algorithms are not isolated technical artifacts but are embedded in and shape social relations.\",\r\n        scholar: \"Faraj, S., et al. (2018)\",\r\n        category: \"Core Concept\",\r\n        url: \"https://doi.org/10.1016/j.infoandorg.2018.02.005\"\r\n    },\r\n    {\r\n        term: \"Gambiarra\",\r\n        definition: \"A Brazilian term for 'workaround' or 'kludge'. In this context, it represents a form of micro-resistance where users creatively repurpose or subvert algorithmic systems to meet their needs.\",\r\n        scholar: \"Decolonial Theory / Local Context\",\r\n        category: \"Micro (Resistance)\"\r\n    },\r\n    {\r\n        term: \"Cultural Hole\",\r\n        definition: \"A gap or disconnect in meaning, language, or values between different groups within an ecosystem (e.g., between policymakers and developers). These holes can be sources of misunderstanding or opportunities for innovation.\",\r\n        scholar: \"Hannigan, T. (Interpretive Data Science)\",\r\n        category: \"Meso\",\r\n        url: \"https://interpretivedatascience.com/\"\r\n    },\r\n    {\r\n        term: \"Institutional Logic\",\r\n        definition: \"The socially constructed, historical patterns of material practices, assumptions, values, beliefs, and rules by which individuals produce and reproduce their material subsistence, organize time and space, and provide meaning to their social reality.\",\r\n        scholar: \"Thornton, Ocasio, & Lounsbury (2012); Applied by Jennings/Faraj\",\r\n        category: \"Meso\"\r\n    },\r\n    {\r\n        term: \"Resource Orchestration\",\r\n        definition: \"The process by which assets are structured, bundled, and leveraged to create value. In algorithmic assemblages, this orchestration often shifts from within organizations to loosely coupled platforms.\",\r\n        scholar: \"Hannigan, T., et al. (2025)\",\r\n        category: \"Macro\",\r\n        url: \"https://www.callsforpapers.org/special-issues/algorithmic-assemblages\"\r\n    }\r\n];\r\n\r\nexport default function GlossaryPage() {\r\n    return (\r\n        <div className=\"space-y-8\">\r\n            <div>\r\n                <h2 className=\"text-3xl font-bold tracking-tight text-slate-900\">\r\n                    Critical Glossary\r\n                </h2>\r\n                <p className=\"text-slate-500\">\r\n                    Key theoretical concepts for the analysis of Algorithmic Assemblages.\r\n                </p>\r\n            </div>\r\n\r\n\r\n\r\n            <div className=\"grid gap-6 md:grid-cols-2\">\r\n                {TERMS.map((item, index) => (\r\n                    <Card key={index} className=\"hover:shadow-md transition-shadow\">\r\n                        <CardHeader className=\"pb-2\">\r\n                            <div className=\"flex items-start justify-between\">\r\n                                <CardTitle className=\"text-xl font-semibold text-slate-800\">\r\n                                    {item.term}\r\n                                </CardTitle>\r\n                                <Badge variant=\"outline\" className=\"text-xs\">\r\n                                    {item.category}\r\n                                </Badge>\r\n                            </div>\r\n                        </CardHeader>\r\n                        <CardContent className=\"space-y-4\">\r\n                            <p className=\"text-slate-600 leading-relaxed\">\r\n                                {item.definition}\r\n                            </p>\r\n                            <div className=\"flex items-center gap-2 text-xs text-slate-500 bg-slate-50 p-2 rounded border border-slate-100\">\r\n                                <Quote className=\"h-3 w-3 text-indigo-400\" />\r\n                                <span className=\"font-medium\">Scholarship:</span>\r\n                                <span className=\"italic\">{item.scholar}</span>\r\n                                {(item as any).url && (\r\n                                    <a\r\n                                        href={(item as any).url}\r\n                                        target=\"_blank\"\r\n                                        rel=\"noopener noreferrer\"\r\n                                        className=\"ml-auto flex items-center gap-1 text-indigo-600 hover:text-indigo-800 hover:underline\"\r\n                                    >\r\n                                        <ExternalLink className=\"h-3 w-3\" />\r\n                                        <span className=\"hidden sm:inline\">View Source</span>\r\n                                    </a>\r\n                                )}\r\n                            </div>\r\n                        </CardContent>\r\n                    </Card>\r\n                ))}\r\n            </div>\r\n        </div >\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\governance\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Source' is defined but never used.","line":5,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":16},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'lastRunTime' is assigned a value but never used.","line":154,"column":12,"nodeType":null,"messageId":"unusedVar","endLine":154,"endColumn":23},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":311,"column":99,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[15262,15383],"text":" page and re-run the &quot;DSF Analysis\" for these documents to generate the necessary data.\r\n                                "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[15262,15383],"text":" page and re-run the &ldquo;DSF Analysis\" for these documents to generate the necessary data.\r\n                                "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[15262,15383],"text":" page and re-run the &#34;DSF Analysis\" for these documents to generate the necessary data.\r\n                                "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[15262,15383],"text":" page and re-run the &rdquo;DSF Analysis\" for these documents to generate the necessary data.\r\n                                "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":311,"column":112,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[15262,15383],"text":" page and re-run the \"DSF Analysis&quot; for these documents to generate the necessary data.\r\n                                "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[15262,15383],"text":" page and re-run the \"DSF Analysis&ldquo; for these documents to generate the necessary data.\r\n                                "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[15262,15383],"text":" page and re-run the \"DSF Analysis&#34; for these documents to generate the necessary data.\r\n                                "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[15262,15383],"text":" page and re-run the \"DSF Analysis&rdquo; for these documents to generate the necessary data.\r\n                                "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":566,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":566,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[33753,33756],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[33753,33756],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":569,"column":57,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[33971,34030],"text":"\r\n                                                        &quot;"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[33971,34030],"text":"\r\n                                                        &ldquo;"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[33971,34030],"text":"\r\n                                                        &#34;"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[33971,34030],"text":"\r\n                                                        &rdquo;"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":569,"column":71,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":569,"endColumn":74,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[34043,34046],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[34043,34046],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":569,"column":82,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[34054,34109],"text":"&quot;\r\n                                                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[34054,34109],"text":"&ldquo;\r\n                                                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[34054,34109],"text":"&#34;\r\n                                                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[34054,34109],"text":"&rdquo;\r\n                                                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":591,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":591,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[35921,35924],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[35921,35924],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":594,"column":57,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[36139,36198],"text":"\r\n                                                        &quot;"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[36139,36198],"text":"\r\n                                                        &ldquo;"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[36139,36198],"text":"\r\n                                                        &#34;"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[36139,36198],"text":"\r\n                                                        &rdquo;"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":594,"column":71,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":594,"endColumn":74,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[36211,36214],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[36211,36214],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":594,"column":82,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[36222,36277],"text":"&quot;\r\n                                                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[36222,36277],"text":"&ldquo;\r\n                                                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[36222,36277],"text":"&#34;\r\n                                                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[36222,36277],"text":"&rdquo;\r\n                                                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":633,"column":90,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":633,"endColumn":93,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[38364,38367],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[38364,38367],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":657,"column":90,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":657,"endColumn":93,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[40021,40024],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[40021,40024],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":12,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState } from \"react\";\r\nimport { useSources } from \"@/hooks/useSources\";\r\nimport { Source } from \"@/types\";\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Textarea } from \"@/components/ui/textarea\";\r\nimport { Scale, Shield, Globe, AlertTriangle, Users, Sparkles, Brain, Loader2, Info } from \"lucide-react\";\r\nimport { RadarChart, PolarGrid, PolarAngleAxis, PolarRadiusAxis, Radar, Legend, ResponsiveContainer } from 'recharts';\r\nimport {\r\n    Dialog,\r\n    DialogContent,\r\n    DialogDescription,\r\n    DialogHeader,\r\n    DialogTitle,\r\n    DialogTrigger,\r\n} from \"@/components/ui/dialog\";\r\n\r\nimport { GovernanceCompass } from \"@/components/governance/GovernanceCompass\";\r\nimport { DriftVector } from \"@/lib/governance\";\r\n\r\nconst COMPARISONS = [\r\n    {\r\n        id: \"risk\",\r\n        title: \"Risk Classification\",\r\n        icon: AlertTriangle,\r\n        eu: {\r\n            title: \"Pyramid of Risk\",\r\n            description: \"Four levels: Unacceptable (banned), High Risk (regulated), Limited Risk (transparency), Minimal Risk (no obligations).\",\r\n            badge: \"Prescriptive\",\r\n            color: \"bg-blue-50 text-blue-700\"\r\n        },\r\n        brazil: {\r\n            title: \"Risk Categories\",\r\n            description: \"Excessive Risk (banned) and High Risk. Assessment criteria are similar but more flexible in initial definitions.\",\r\n            badge: \"Principled\",\r\n            color: \"bg-yellow-50 text-yellow-700\"\r\n        }\r\n    },\r\n    {\r\n        id: \"enforcement\",\r\n        title: \"Enforcement Bodies\",\r\n        icon: Shield,\r\n        eu: {\r\n            title: \"AI Office & National Authorities\",\r\n            description: \"Centralized AI Office within the Commission for general purpose AI; national supervisory authorities for other systems.\",\r\n            badge: \"Centralized/Hybrid\",\r\n            color: \"bg-blue-50 text-blue-700\"\r\n        },\r\n        brazil: {\r\n            title: \"Competent Authority\",\r\n            description: \"Designation of a coordinating authority to articulate with existing sectoral regulators (an 'orchestrator' model).\",\r\n            badge: \"Networked\",\r\n            color: \"bg-yellow-50 text-yellow-700\"\r\n        }\r\n    },\r\n    {\r\n        id: \"rights\",\r\n        title: \"Rights & Redress\",\r\n        icon: Users,\r\n        eu: {\r\n            title: \"Fundamental Rights Impact\",\r\n            description: \"Requirement for deployers of high-risk systems. Right to explanation and complaints to national authorities.\",\r\n            badge: \"Procedural\",\r\n            color: \"bg-blue-50 text-blue-700\"\r\n        },\r\n        brazil: {\r\n            title: \"Rights of Affected Persons\",\r\n            description: \"Explicit catalogue of rights including explanation, contestation, and non-discrimination. Stronger focus on individual redress.\",\r\n            badge: \"Rights-Based\",\r\n            color: \"bg-yellow-50 text-yellow-700\"\r\n        }\r\n    },\r\n    {\r\n        id: \"scope\",\r\n        title: \"Territorial Scope\",\r\n        icon: Globe,\r\n        eu: {\r\n            title: \"Brussels Effect\",\r\n            description: \"Applies to any provider placing systems on the EU market or where output is used in the EU.\",\r\n            badge: \"Extraterritorial\",\r\n            color: \"bg-blue-50 text-blue-700\"\r\n        },\r\n        brazil: {\r\n            title: \"National Sovereignty\",\r\n            description: \"Applies to systems used or developed in Brazil, or processing data of individuals in Brazil.\",\r\n            badge: \"Territorial\",\r\n            color: \"bg-yellow-50 text-yellow-700\"\r\n        }\r\n    }\r\n];\r\n\r\nconst BASELINE_INSIGHTS = {\r\n    EU: {\r\n        governance_power_accountability: \"Centralized product safety framework focused on market regulation. Power resides in the AI Office and national competent authorities.\",\r\n        plurality_inclusion_embodiment: \"Limited inclusion mechanisms. Focus is on technical standards and expert bodies rather than diverse knowledge systems.\",\r\n        agency_codesign_self_determination: \"Provides rights to explanation and complaints, but limited scope for co-design or refusal by affected communities.\",\r\n        reflexivity_situated_praxis: \"Low reflexivity; assumes universal applicability of Western technical standards and risk definitions.\"\r\n    },\r\n    Brazil: {\r\n        governance_power_accountability: \"Networked 'orchestrator' model coordinating sectoral regulators. Strong emphasis on civil liability and redress.\",\r\n        plurality_inclusion_embodiment: \"Stronger focus on non-discrimination and the rights of affected groups, reflecting Brazil's social stratification context.\",\r\n        agency_codesign_self_determination: \"Explicit rights to contestation, explanation, and human review. Emphasizes the 'centrality of the human person'.\",\r\n        reflexivity_situated_praxis: \"Moderate reflexivity; adapts global models to local legal tradition but still operates within a modernization paradigm.\"\r\n    }\r\n};\r\n\r\nconst PILLAR_DEFINITIONS = {\r\n    risk: {\r\n        description: \"How the framework categorizes AI systems based on potential harm to health, safety, or fundamental rights.\",\r\n        configurations: [\r\n            { badge: \"Prescriptive\", text: \"Relies on a fixed, pre-defined list of high-risk use cases (Top-down).\" },\r\n            { badge: \"Principled\", text: \"Risk is assessed case-by-case based on abstract principles and impact (Flexible).\" }\r\n        ]\r\n    },\r\n    enforcement: {\r\n        description: \"The institutional architecture established to oversee compliance and sanction violations.\",\r\n        configurations: [\r\n            { badge: \"Centralized\", text: \"A single new authority (e.g., AI Office) holds primary power.\" },\r\n            { badge: \"Networked\", text: \"Existing sectoral regulators enforce rules, coordinated by a central body.\" },\r\n            { badge: \"Hybrid\", text: \"A mix of central oversight for general systems and sectoral enforcement for specific uses.\" }\r\n        ]\r\n    },\r\n    rights: {\r\n        description: \"The mechanisms available for individuals to understand, challenge, or seek redress for AI decisions.\",\r\n        configurations: [\r\n            { badge: \"Procedural\", text: \"Focuses on transparency, documentation, and the 'right to explanation'.\" },\r\n            { badge: \"Rights-Based\", text: \"Focuses on substantive human rights, civil liability, and compensation for harm.\" }\r\n        ]\r\n    },\r\n    scope: {\r\n        description: \"The jurisdictional reach of the regulationwho must comply and where.\",\r\n        configurations: [\r\n            { badge: \"Extraterritorial\", text: \"Applies to foreign actors if they place systems on the local market (e.g., 'Brussels Effect').\" },\r\n            { badge: \"Territorial\", text: \"Applies strictly within national borders.\" },\r\n            { badge: \"Sovereign\", text: \"Emphasizes national control over data and infrastructure (Data Sovereignty).\" }\r\n        ]\r\n    }\r\n};\r\n\r\nexport default function GovernancePage() {\r\n    const { sources, isLoading } = useSources();\r\n    const [selectedSourceA, setSelectedSourceA] = useState<string>(\"EU\");\r\n    const [selectedSourceB, setSelectedSourceB] = useState<string>(\"\");\r\n\r\n    // Governance Compass State\r\n    const [selectedPolicyText, setSelectedPolicyText] = useState<string>(\"\");\r\n    const [selectedTechText, setSelectedTechText] = useState<string>(\"\");\r\n    const [driftAnalysis, setDriftAnalysis] = useState<DriftVector | null>(null);\r\n    const [isAnalyzingDrift, setIsAnalyzingDrift] = useState(false);\r\n    const [error, setError] = useState<string | null>(null);\r\n    const [lastRunTime, setLastRunTime] = useState<string | null>(null);\r\n\r\n    const runDriftAnalysis = async (policy: string, tech: string) => {\r\n        setError(null);\r\n        setLastRunTime(new Date().toLocaleTimeString());\r\n        console.log(\"Running drift analysis with:\", { policyLength: policy?.length, techLength: tech?.length });\r\n        if (!policy || !tech) {\r\n            setError(\"Please select both policy and technical documents with valid text content.\");\r\n            return;\r\n        }\r\n\r\n        setIsAnalyzingDrift(true);\r\n        try {\r\n            const headers: HeadersInit = { 'Content-Type': 'application/json' };\r\n            if (process.env.NEXT_PUBLIC_ENABLE_DEMO_MODE === 'true' && process.env.NEXT_PUBLIC_DEMO_USER_ID) {\r\n                headers['x-demo-user-id'] = process.env.NEXT_PUBLIC_DEMO_USER_ID;\r\n            }\r\n\r\n            const response = await fetch('/api/governance/compass', {\r\n                method: 'POST',\r\n                headers: headers,\r\n                body: JSON.stringify({ policyText: policy, techText: tech })\r\n            });\r\n\r\n            const data = await response.json();\r\n            console.log(\"Drift analysis response:\", data);\r\n\r\n            if (data.success) {\r\n                setDriftAnalysis(data.analysis);\r\n            } else {\r\n                setError(`Analysis failed: ${data.error || \"Unknown error from server\"}`);\r\n            }\r\n        } catch (err) {\r\n            console.error(\"Drift analysis failed\", err);\r\n            setError(\"Failed to run analysis. Check console for details.\");\r\n        } finally {\r\n            setIsAnalyzingDrift(false);\r\n        }\r\n    };\r\n\r\n    // Filter sources that have analysis data\r\n    const analyzedSources = sources.filter(s => s.analysis);\r\n\r\n    // Helper to get governance scores or default values\r\n    const getScores = (sourceId: string) => {\r\n        if (sourceId === \"EU\") return { centralization: 85, rights_focus: 60, flexibility: 40, market_power: 95, procedurality: 85 };\r\n        if (sourceId === \"Brazil\") return { centralization: 45, rights_focus: 90, flexibility: 80, market_power: 50, procedurality: 55 };\r\n\r\n        const source = analyzedSources.find(s => s.id === sourceId);\r\n        return source?.analysis?.governance_scores || { centralization: 0, rights_focus: 0, flexibility: 0, market_power: 0, procedurality: 0 };\r\n    };\r\n\r\n    const scoresA = getScores(selectedSourceA);\r\n    const scoresB = getScores(selectedSourceB);\r\n\r\n    const dynamicRadarData = [\r\n        { dimension: 'Centralization', A: scoresA.centralization, B: scoresB.centralization },\r\n        { dimension: 'Rights Focus', A: scoresA.rights_focus, B: scoresB.rights_focus },\r\n        { dimension: 'Flexibility', A: scoresA.flexibility, B: scoresB.flexibility },\r\n        { dimension: 'Market Power', A: scoresA.market_power, B: scoresB.market_power },\r\n        { dimension: 'Procedural', A: scoresA.procedurality, B: scoresB.procedurality },\r\n    ];\r\n\r\n    const getLabel = (id: string) => {\r\n        if (id === \"EU\") return \"EU AI Act\";\r\n        if (id === \"Brazil\") return \"Brazil PL 2338\";\r\n        return analyzedSources.find(s => s.id === id)?.title || \"Unknown\";\r\n    };\r\n\r\n    const isMissingScores = (id: string) => {\r\n        if (id === \"EU\" || id === \"Brazil\") return false;\r\n        const source = analyzedSources.find(s => s.id === id);\r\n        return !source?.analysis?.governance_scores;\r\n    };\r\n\r\n    const showWarning = isMissingScores(selectedSourceA) || isMissingScores(selectedSourceB);\r\n\r\n    const getSummary = (id: string) => {\r\n        if (id === \"EU\") return {\r\n            title: \"EU AI Act\",\r\n            description: \"A product safety framework focused on market regulation and risk mitigation.\",\r\n            color: \"blue\"\r\n        };\r\n        if (id === \"Brazil\") return {\r\n            title: \"Brazil PL 2338\",\r\n            description: \"A rights-based framework emphasizing civil liability and redress for affected individuals.\",\r\n            color: \"yellow\"\r\n        };\r\n\r\n        const source = analyzedSources.find(s => s.id === id);\r\n        return {\r\n            title: source?.title || \"Unknown Policy\",\r\n            description: source?.analysis?.key_insight || \"No analysis available.\",\r\n            color: \"slate\"\r\n        };\r\n    };\r\n\r\n    const summaryA = getSummary(selectedSourceA);\r\n    const summaryB = getSummary(selectedSourceB);\r\n\r\n    const isDefaultComparison = selectedSourceA === \"EU\" && selectedSourceB === \"Brazil\";\r\n\r\n    if (isLoading) {\r\n        return (\r\n            <div className=\"flex items-center justify-center h-64\">\r\n                <Loader2 className=\"h-8 w-8 animate-spin text-slate-400\" />\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"space-y-8\">\r\n            <div>\r\n                <h2 className=\"text-3xl font-bold tracking-tight text-slate-900\">Resource Orchestration</h2>\r\n                <p className=\"text-slate-500\">Comparative analysis of governance mechanisms across AI frameworks.</p>\r\n            </div>\r\n\r\n            {/* Radar Chart Visualization */}\r\n            <Card>\r\n                <CardHeader>\r\n                    <div className=\"flex items-center justify-between\">\r\n                        <div>\r\n                            <CardTitle>Framework Comparison</CardTitle>\r\n                            <CardDescription>Visual comparison of governance characteristics</CardDescription>\r\n                        </div>\r\n                        <div className=\"flex gap-4\">\r\n                            <select\r\n                                className=\"p-2 border rounded-md text-sm bg-white\"\r\n                                value={selectedSourceA}\r\n                                onChange={(e) => setSelectedSourceA(e.target.value)}\r\n                            >\r\n                                <option value=\"EU\">EU AI Act (Baseline)</option>\r\n                                {analyzedSources.map(s => (\r\n                                    <option key={s.id} value={s.id}>{s.title}</option>\r\n                                ))}\r\n                            </select>\r\n                            <select\r\n                                className=\"p-2 border rounded-md text-sm bg-white\"\r\n                                value={selectedSourceB}\r\n                                onChange={(e) => setSelectedSourceB(e.target.value)}\r\n                            >\r\n                                <option value=\"EU\">EU AI Act (Baseline)</option>\r\n                                {analyzedSources.map(s => (\r\n                                    <option key={s.id} value={s.id}>{s.title}</option>\r\n                                ))}\r\n                            </select>\r\n                        </div>\r\n                    </div>\r\n                </CardHeader>\r\n                <CardContent className=\"flex flex-col items-center\">\r\n                    {showWarning && (\r\n                        <div className=\"w-full mb-4 p-4 bg-yellow-50 border border-yellow-200 rounded-md flex items-start gap-3\">\r\n                            <AlertTriangle className=\"h-5 w-5 text-yellow-600 mt-0.5\" />\r\n                            <div>\r\n                                <h4 className=\"text-sm font-semibold text-yellow-800\">Re-analysis Required</h4>\r\n                                <p className=\"text-sm text-yellow-700\">\r\n                                    One or more selected sources are missing governance scores. Please go to the\r\n                                    <span className=\"font-bold\"> Data </span> page and re-run the \"DSF Analysis\" for these documents to generate the necessary data.\r\n                                </p>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n                    <ResponsiveContainer width=\"100%\" height={400}>\r\n                        <RadarChart data={dynamicRadarData}>\r\n                            <PolarGrid stroke=\"#e2e8f0\" />\r\n                            <PolarAngleAxis dataKey=\"dimension\" tick={{ fill: '#64748b', fontSize: 12 }} />\r\n                            <PolarRadiusAxis angle={90} domain={[0, 100]} tick={{ fill: '#94a3b8', fontSize: 10 }} />\r\n                            <Radar name={getLabel(selectedSourceA)} dataKey=\"A\" stroke=\"#3b82f6\" fill=\"#3b82f6\" fillOpacity={0.3} />\r\n                            <Radar name={getLabel(selectedSourceB)} dataKey=\"B\" stroke=\"#eab308\" fill=\"#eab308\" fillOpacity={0.3} />\r\n                            <Legend wrapperStyle={{ paddingTop: '20px' }} />\r\n                        </RadarChart>\r\n                    </ResponsiveContainer>\r\n                </CardContent>\r\n            </Card>\r\n\r\n            {/* Dynamic Governance Insights */}\r\n            {analyzedSources.length > 0 && (\r\n                <div className=\"space-y-4\">\r\n                    <div className=\"flex items-center space-x-2\">\r\n                        <Brain className=\"h-6 w-6 text-purple-600\" />\r\n                        <h3 className=\"text-2xl font-bold text-slate-900\">Grounded Governance Insights</h3>\r\n                        <Badge className=\"bg-purple-100 text-purple-700\">\r\n                            Empirical\r\n                        </Badge>\r\n                    </div>\r\n                    <div className=\"grid gap-4 md:grid-cols-2\">\r\n                        {[selectedSourceA, selectedSourceB].map((sourceId) => {\r\n                            const isBaseline = sourceId === \"EU\" || sourceId === \"Brazil\";\r\n                            const source = analyzedSources.find(s => s.id === sourceId);\r\n                            const insights = isBaseline\r\n                                ? BASELINE_INSIGHTS[sourceId as keyof typeof BASELINE_INSIGHTS]\r\n                                : source?.analysis;\r\n\r\n                            if (!insights && !isBaseline) return null;\r\n\r\n                            const title = isBaseline\r\n                                ? (sourceId === \"EU\" ? \"EU AI Act\" : \"Brazil PL 2338\")\r\n                                : source?.title;\r\n\r\n                            return (\r\n                                <Card key={sourceId} className=\"border-purple-100 bg-purple-50/30\">\r\n                                    <CardHeader className=\"pb-2\">\r\n                                        <div className=\"flex items-center space-x-2\">\r\n                                            <Sparkles className=\"h-4 w-4 text-purple-600\" />\r\n                                            <CardTitle className=\"text-base\">{title}</CardTitle>\r\n                                        </div>\r\n                                    </CardHeader>\r\n                                    <CardContent className=\"text-sm space-y-2\">\r\n                                        {insights?.governance_power_accountability && (\r\n                                            <div>\r\n                                                <span className=\"font-semibold text-purple-900\">Governance & Power: </span>\r\n                                                <span className=\"text-slate-700\">{insights.governance_power_accountability}</span>\r\n                                            </div>\r\n                                        )}\r\n                                        {insights?.plurality_inclusion_embodiment && (\r\n                                            <div>\r\n                                                <span className=\"font-semibold text-blue-900\">Plurality & Inclusion: </span>\r\n                                                <span className=\"text-slate-700\">{insights.plurality_inclusion_embodiment}</span>\r\n                                            </div>\r\n                                        )}\r\n                                        {insights?.agency_codesign_self_determination && (\r\n                                            <div>\r\n                                                <span className=\"font-semibold text-green-900\">Agency & Co-Design: </span>\r\n                                                <span className=\"text-slate-700\">{insights.agency_codesign_self_determination}</span>\r\n                                            </div>\r\n                                        )}\r\n                                        {insights?.reflexivity_situated_praxis && (\r\n                                            <div>\r\n                                                <span className=\"font-semibold text-orange-900\">Reflexivity: </span>\r\n                                                <span className=\"text-slate-700\">{insights.reflexivity_situated_praxis}</span>\r\n                                            </div>\r\n                                        )}\r\n                                    </CardContent>\r\n                                </Card>\r\n                            );\r\n                        })}\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            <div className=\"grid gap-6\">\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4\">\r\n                    <div className={`p-4 bg-${summaryA.color}-50 rounded-lg border border-${summaryA.color}-100`}>\r\n                        <div className=\"flex items-center space-x-2 mb-2\">\r\n                            <Globe className={`h-5 w-5 text-${summaryA.color}-600`} />\r\n                            <h3 className={`font-bold text-${summaryA.color}-900`}>{summaryA.title}</h3>\r\n                        </div>\r\n                        <p className={`text-sm text-${summaryA.color}-700`}>\r\n                            {summaryA.description}\r\n                        </p>\r\n                    </div>\r\n                    <div className={`p-4 bg-${summaryB.color}-50 rounded-lg border border-${summaryB.color}-100`}>\r\n                        <div className=\"flex items-center space-x-2 mb-2\">\r\n                            <Globe className={`h-5 w-5 text-${summaryB.color}-600`} />\r\n                            <h3 className={`font-bold text-${summaryB.color}-900`}>{summaryB.title}</h3>\r\n                        </div>\r\n                        <p className={`text-sm text-${summaryB.color}-700`}>\r\n                            {summaryB.description}\r\n                        </p>\r\n                    </div>\r\n                </div>\r\n\r\n                {isDefaultComparison ? (\r\n                    COMPARISONS.map((item) => (\r\n                        <Card key={item.id} className=\"overflow-hidden\">\r\n                            <CardHeader className=\"bg-slate-50/50 border-b pb-4\">\r\n                                <div className=\"flex items-center space-x-2\">\r\n                                    <div className=\"p-2 bg-white rounded-md shadow-sm border\">\r\n                                        <item.icon className=\"h-5 w-5 text-slate-600\" />\r\n                                    </div>\r\n                                    <Dialog>\r\n                                        <DialogTrigger asChild>\r\n                                            <Button variant=\"ghost\" className=\"p-0 h-auto text-lg font-semibold text-slate-800 hover:bg-transparent flex items-center gap-2\">\r\n                                                {item.title} <Info className=\"h-4 w-4 text-slate-400\" />\r\n                                            </Button>\r\n                                        </DialogTrigger>\r\n                                        <DialogContent>\r\n                                            <DialogHeader>\r\n                                                <DialogTitle>{item.title}</DialogTitle>\r\n                                                <DialogDescription>\r\n                                                    {PILLAR_DEFINITIONS[item.id as keyof typeof PILLAR_DEFINITIONS].description}\r\n                                                </DialogDescription>\r\n                                            </DialogHeader>\r\n                                            <div className=\"space-y-4 mt-4\">\r\n                                                <h4 className=\"font-semibold text-sm text-slate-900\">Key Configurations</h4>\r\n                                                <div className=\"grid gap-3\">\r\n                                                    {PILLAR_DEFINITIONS[item.id as keyof typeof PILLAR_DEFINITIONS].configurations.map((config, idx) => (\r\n                                                        <div key={idx} className=\"bg-slate-50 p-3 rounded border border-slate-100\">\r\n                                                            <span className=\"font-bold text-xs uppercase tracking-wider text-indigo-700 block mb-1\">\r\n                                                                {config.badge}\r\n                                                            </span>\r\n                                                            <span className=\"text-sm text-slate-600\">\r\n                                                                {config.text}\r\n                                                            </span>\r\n                                                        </div>\r\n                                                    ))}\r\n                                                </div>\r\n                                            </div>\r\n                                        </DialogContent>\r\n                                    </Dialog>\r\n                                </div>\r\n                            </CardHeader>\r\n                            <CardContent className=\"p-0\">\r\n                                <div className=\"grid md:grid-cols-2 divide-y md:divide-y-0 md:divide-x\">\r\n                                    <div className=\"p-6 space-y-3\">\r\n                                        <div className=\"flex items-center justify-between\">\r\n                                            <span className=\"text-xs font-bold text-blue-600 uppercase tracking-wider\">EU Approach</span>\r\n                                            <Badge variant=\"secondary\" className=\"bg-blue-100 text-blue-700 hover:bg-blue-100\">\r\n                                                {item.eu.badge}\r\n                                            </Badge>\r\n                                        </div>\r\n                                        <h4 className=\"font-medium text-slate-900\">{item.eu.title}</h4>\r\n                                        <p className=\"text-sm text-slate-600 leading-relaxed\">\r\n                                            {item.eu.description}\r\n                                        </p>\r\n                                    </div>\r\n                                    <div className=\"p-6 space-y-3\">\r\n                                        <div className=\"flex items-center justify-between\">\r\n                                            <span className=\"text-xs font-bold text-yellow-600 uppercase tracking-wider\">Brazil Approach</span>\r\n                                            <Badge variant=\"secondary\" className=\"bg-yellow-100 text-yellow-700 hover:bg-yellow-100\">\r\n                                                {item.brazil.badge}\r\n                                            </Badge>\r\n                                        </div>\r\n                                        <h4 className=\"font-medium text-slate-900\">{item.brazil.title}</h4>\r\n                                        <p className=\"text-sm text-slate-600 leading-relaxed\">\r\n                                            {item.brazil.description}\r\n                                        </p>\r\n                                    </div>\r\n                                </div>\r\n                            </CardContent>\r\n                        </Card>\r\n                    ))\r\n                ) : (\r\n                    COMPARISONS.map((item) => {\r\n                        // Helper to get pillar data handling baselines\r\n                        const getPillarData = (sourceId: string, comparisonId: string) => {\r\n                            if (sourceId === \"EU\") {\r\n                                const comp = COMPARISONS.find(c => c.id === comparisonId);\r\n                                return comp ? { ...comp.eu, isBaseline: true } : null;\r\n                            }\r\n                            if (sourceId === \"Brazil\") {\r\n                                const comp = COMPARISONS.find(c => c.id === comparisonId);\r\n                                return comp ? { ...comp.brazil, isBaseline: true } : null;\r\n                            }\r\n                            const source = analyzedSources.find(s => s.id === sourceId);\r\n                            const pillar = source?.analysis?.structural_pillars?.[comparisonId as keyof typeof source.analysis.structural_pillars];\r\n                            return pillar ? { ...pillar, isBaseline: false } : null;\r\n                        };\r\n\r\n                        const pillarA = getPillarData(selectedSourceA, item.id);\r\n                        const pillarB = getPillarData(selectedSourceB, item.id);\r\n\r\n                        if (!pillarA && !pillarB) return null;\r\n\r\n                        return (\r\n                            <Card key={item.id} className=\"overflow-hidden\">\r\n                                <CardHeader className=\"bg-slate-50/50 border-b pb-4\">\r\n                                    <div className=\"flex items-center space-x-2\">\r\n                                        <div className=\"p-2 bg-white rounded-md shadow-sm border\">\r\n                                            <item.icon className=\"h-5 w-5 text-slate-600\" />\r\n                                        </div>\r\n                                        <Dialog>\r\n                                            <DialogTrigger asChild>\r\n                                                <Button variant=\"ghost\" className=\"p-0 h-auto text-lg font-semibold text-slate-800 hover:bg-transparent flex items-center gap-2\">\r\n                                                    {item.title} <Info className=\"h-4 w-4 text-slate-400\" />\r\n                                                </Button>\r\n                                            </DialogTrigger>\r\n                                            <DialogContent>\r\n                                                <DialogHeader>\r\n                                                    <DialogTitle>{item.title}</DialogTitle>\r\n                                                    <DialogDescription>\r\n                                                        {PILLAR_DEFINITIONS[item.id as keyof typeof PILLAR_DEFINITIONS].description}\r\n                                                    </DialogDescription>\r\n                                                </DialogHeader>\r\n                                                <div className=\"space-y-4 mt-4\">\r\n                                                    <h4 className=\"font-semibold text-sm text-slate-900\">Key Configurations</h4>\r\n                                                    <div className=\"grid gap-3\">\r\n                                                        {PILLAR_DEFINITIONS[item.id as keyof typeof PILLAR_DEFINITIONS].configurations.map((config, idx) => (\r\n                                                            <div key={idx} className=\"bg-slate-50 p-3 rounded border border-slate-100\">\r\n                                                                <span className=\"font-bold text-xs uppercase tracking-wider text-indigo-700 block mb-1\">\r\n                                                                    {config.badge}\r\n                                                                </span>\r\n                                                                <span className=\"text-sm text-slate-600\">\r\n                                                                    {config.text}\r\n                                                                </span>\r\n                                                            </div>\r\n                                                        ))}\r\n                                                    </div>\r\n                                                </div>\r\n                                            </DialogContent>\r\n                                        </Dialog>\r\n                                    </div>\r\n                                </CardHeader>\r\n                                <CardContent className=\"p-0\">\r\n                                    <div className=\"grid md:grid-cols-2 divide-y md:divide-y-0 md:divide-x\">\r\n                                        <div className=\"p-6 space-y-3\">\r\n                                            <div className=\"flex items-center justify-between\">\r\n                                                <span className=\"text-xs font-bold text-blue-600 uppercase tracking-wider\">{summaryA.title}</span>\r\n                                                {pillarA?.badge && (\r\n                                                    <Badge variant=\"secondary\" className={`\r\n                                                        ${pillarA.isBaseline && selectedSourceA === \"EU\" ? \"bg-blue-100 text-blue-700\" : \"\"}\r\n                                                        ${pillarA.isBaseline && selectedSourceA === \"Brazil\" ? \"bg-yellow-100 text-yellow-700\" : \"\"}\r\n                                                        ${!pillarA.isBaseline ? \"bg-slate-100 text-slate-700\" : \"\"}\r\n                                                    `}>\r\n                                                        {pillarA.badge}\r\n                                                    </Badge>\r\n                                                )}\r\n                                            </div>\r\n                                            <h4 className=\"font-medium text-slate-900\">{pillarA?.title || \"Not analyzed\"}</h4>\r\n                                            <p className=\"text-sm text-slate-600 leading-relaxed\">\r\n                                                {pillarA?.description || \"Structural analysis not available for this dimension.\"}\r\n                                            </p>\r\n                                            {(pillarA as any)?.quote && (\r\n                                                <div className=\"mt-3 pt-3 border-t border-slate-100\">\r\n                                                    <p className=\"text-xs text-slate-500 italic\">\r\n                                                        \"{(pillarA as any).quote}\"\r\n                                                    </p>\r\n                                                </div>\r\n                                            )}\r\n                                        </div>\r\n                                        <div className=\"p-6 space-y-3\">\r\n                                            <div className=\"flex items-center justify-between\">\r\n                                                <span className=\"text-xs font-bold text-yellow-600 uppercase tracking-wider\">{summaryB.title}</span>\r\n                                                {pillarB?.badge && (\r\n                                                    <Badge variant=\"secondary\" className={`\r\n                                                        ${pillarB.isBaseline && selectedSourceB === \"EU\" ? \"bg-blue-100 text-blue-700\" : \"\"}\r\n                                                        ${pillarB.isBaseline && selectedSourceB === \"Brazil\" ? \"bg-yellow-100 text-yellow-700\" : \"\"}\r\n                                                        ${!pillarB.isBaseline ? \"bg-slate-100 text-slate-700\" : \"\"}\r\n                                                    `}>\r\n                                                        {pillarB.badge}\r\n                                                    </Badge>\r\n                                                )}\r\n                                            </div>\r\n                                            <h4 className=\"font-medium text-slate-900\">{pillarB?.title || \"Not analyzed\"}</h4>\r\n                                            <p className=\"text-sm text-slate-600 leading-relaxed\">\r\n                                                {pillarB?.description || \"Structural analysis not available for this dimension.\"}\r\n                                            </p>\r\n                                            {(pillarB as any)?.quote && (\r\n                                                <div className=\"mt-3 pt-3 border-t border-slate-100\">\r\n                                                    <p className=\"text-xs text-slate-500 italic\">\r\n                                                        \"{(pillarB as any).quote}\"\r\n                                                    </p>\r\n                                                </div>\r\n                                            )}\r\n                                        </div>\r\n                                    </div>\r\n                                </CardContent>\r\n                            </Card>\r\n                        );\r\n                    })\r\n                )}\r\n            </div>\r\n            {/* Governance Compass Section */}\r\n            <div className=\"space-y-4 pt-8 border-t\">\r\n                <div className=\"flex items-center space-x-2\">\r\n                    <Scale className=\"h-6 w-6 text-blue-600\" />\r\n                    <h3 className=\"text-2xl font-bold text-slate-900\">Governance Drift Analysis</h3>\r\n                    <Badge className=\"bg-blue-100 text-blue-700\">\r\n                        New\r\n                    </Badge>\r\n                </div>\r\n                <p className=\"text-slate-500\">\r\n                    Analyze the gap between ethical rhetoric (Policy) and technical reality (Implementation).\r\n                </p>\r\n\r\n                <div className=\"grid md:grid-cols-3 gap-6\">\r\n                    <Card className=\"md:col-span-1\">\r\n                        <CardHeader>\r\n                            <CardTitle>Analysis Input</CardTitle>\r\n                            <CardDescription>Select sources to compare</CardDescription>\r\n                        </CardHeader>\r\n                        <CardContent className=\"space-y-4\">\r\n                            <div className=\"space-y-2\">\r\n                                <label className=\"text-sm font-medium\">Policy Rhetoric (Text A)</label>\r\n                                <select\r\n                                    className=\"w-full p-2 border rounded-md text-sm mb-2\"\r\n                                    onChange={(e) => {\r\n                                        const source = sources.find(s => s.id === e.target.value);\r\n                                        // Fallback to 'text' if 'extractedText' is missing\r\n                                        const text = source?.extractedText || (source as any)?.text || \"\";\r\n                                        setSelectedPolicyText(text);\r\n                                    }}\r\n                                >\r\n                                    <option value=\"\">Select Policy Document (Optional)...</option>\r\n                                    {sources.map(s => (\r\n                                        <option key={s.id} value={s.id}>{s.title}</option>\r\n                                    ))}\r\n                                </select>\r\n                                <Textarea\r\n                                    placeholder=\"Or paste policy text here...\"\r\n                                    value={selectedPolicyText}\r\n                                    onChange={(e) => setSelectedPolicyText(e.target.value)}\r\n                                    className=\"h-32\"\r\n                                />\r\n                                <p className=\"text-xs text-slate-400 text-right\">{selectedPolicyText.length} chars</p>\r\n                            </div>\r\n                            <div className=\"space-y-2\">\r\n                                <label className=\"text-sm font-medium\">Technical Reality (Text B)</label>\r\n                                <select\r\n                                    className=\"w-full p-2 border rounded-md text-sm mb-2\"\r\n                                    onChange={(e) => {\r\n                                        const source = sources.find(s => s.id === e.target.value);\r\n                                        // Fallback to 'text' if 'extractedText' is missing\r\n                                        const text = source?.extractedText || (source as any)?.text || \"\";\r\n                                        setSelectedTechText(text);\r\n                                    }}\r\n                                >\r\n                                    <option value=\"\">Select Technical Spec (Optional)...</option>\r\n                                    {sources.map(s => (\r\n                                        <option key={s.id} value={s.id}>{s.title}</option>\r\n                                    ))}\r\n                                </select>\r\n                                <Textarea\r\n                                    placeholder=\"Or paste technical spec text here...\"\r\n                                    value={selectedTechText}\r\n                                    onChange={(e) => setSelectedTechText(e.target.value)}\r\n                                    className=\"h-32\"\r\n                                />\r\n                                <p className=\"text-xs text-slate-400 text-right\">{selectedTechText.length} chars</p>\r\n                            </div>\r\n\r\n                            <Button\r\n                                className=\"w-full\"\r\n                                onClick={() => runDriftAnalysis(selectedPolicyText, selectedTechText)}\r\n                                disabled={!selectedPolicyText || !selectedTechText || isAnalyzingDrift}\r\n                            >\r\n                                {isAnalyzingDrift ? (\r\n                                    <>\r\n                                        <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\r\n                                        Analyzing...\r\n                                    </>\r\n                                ) : (\r\n                                    <>\r\n                                        <Scale className=\"mr-2 h-4 w-4\" />\r\n                                        Run Drift Analysis\r\n                                    </>\r\n                                )}\r\n                            </Button>\r\n\r\n                            {error && (\r\n                                <div className=\"p-3 text-sm text-red-600 bg-red-50 rounded-md border border-red-200\">\r\n                                    Error: {error}\r\n                                </div>\r\n                            )}\r\n\r\n                            {isAnalyzingDrift && (\r\n                                <div className=\"flex items-center justify-center py-4\">\r\n                                    <Loader2 className=\"h-6 w-6 animate-spin text-blue-600\" />\r\n                                    <span className=\"ml-2 text-sm text-slate-500\">Calculating drift...</span>\r\n                                </div>\r\n                            )}\r\n                        </CardContent>\r\n                    </Card>\r\n\r\n                    <div className=\"md:col-span-2\">\r\n                        <GovernanceCompass analysis={driftAnalysis} />\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            {/* Debug Info Panel Removed */}\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\literature\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'BookOpen' is defined but never used.","line":6,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":18},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":14,"column":75,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[678,970],"text":"\r\n                    This module maps the theoretical underpinnings of the &quot;Decolonial Situatedness in Global AI Governance\" project.\r\n                    It grounds the application's methodology in key scholarship across Decolonial Studies, STS, and Critical Legal Theory.\r\n                "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[678,970],"text":"\r\n                    This module maps the theoretical underpinnings of the &ldquo;Decolonial Situatedness in Global AI Governance\" project.\r\n                    It grounds the application's methodology in key scholarship across Decolonial Studies, STS, and Critical Legal Theory.\r\n                "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[678,970],"text":"\r\n                    This module maps the theoretical underpinnings of the &#34;Decolonial Situatedness in Global AI Governance\" project.\r\n                    It grounds the application's methodology in key scholarship across Decolonial Studies, STS, and Critical Legal Theory.\r\n                "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[678,970],"text":"\r\n                    This module maps the theoretical underpinnings of the &rdquo;Decolonial Situatedness in Global AI Governance\" project.\r\n                    It grounds the application's methodology in key scholarship across Decolonial Studies, STS, and Critical Legal Theory.\r\n                "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":14,"column":123,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[678,970],"text":"\r\n                    This module maps the theoretical underpinnings of the \"Decolonial Situatedness in Global AI Governance&quot; project.\r\n                    It grounds the application's methodology in key scholarship across Decolonial Studies, STS, and Critical Legal Theory.\r\n                "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[678,970],"text":"\r\n                    This module maps the theoretical underpinnings of the \"Decolonial Situatedness in Global AI Governance&ldquo; project.\r\n                    It grounds the application's methodology in key scholarship across Decolonial Studies, STS, and Critical Legal Theory.\r\n                "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[678,970],"text":"\r\n                    This module maps the theoretical underpinnings of the \"Decolonial Situatedness in Global AI Governance&#34; project.\r\n                    It grounds the application's methodology in key scholarship across Decolonial Studies, STS, and Critical Legal Theory.\r\n                "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[678,970],"text":"\r\n                    This module maps the theoretical underpinnings of the \"Decolonial Situatedness in Global AI Governance&rdquo; project.\r\n                    It grounds the application's methodology in key scholarship across Decolonial Studies, STS, and Critical Legal Theory.\r\n                "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":15,"column":47,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[678,970],"text":"\r\n                    This module maps the theoretical underpinnings of the \"Decolonial Situatedness in Global AI Governance\" project.\r\n                    It grounds the application&apos;s methodology in key scholarship across Decolonial Studies, STS, and Critical Legal Theory.\r\n                "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[678,970],"text":"\r\n                    This module maps the theoretical underpinnings of the \"Decolonial Situatedness in Global AI Governance\" project.\r\n                    It grounds the application&lsquo;s methodology in key scholarship across Decolonial Studies, STS, and Critical Legal Theory.\r\n                "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[678,970],"text":"\r\n                    This module maps the theoretical underpinnings of the \"Decolonial Situatedness in Global AI Governance\" project.\r\n                    It grounds the application&#39;s methodology in key scholarship across Decolonial Studies, STS, and Critical Legal Theory.\r\n                "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[678,970],"text":"\r\n                    This module maps the theoretical underpinnings of the \"Decolonial Situatedness in Global AI Governance\" project.\r\n                    It grounds the application&rsquo;s methodology in key scholarship across Decolonial Studies, STS, and Critical Legal Theory.\r\n                "},"desc":"Replace with `&rsquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":77,"column":203,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[5570,5770],"text":" to map the flow from Actors &rarr; Mechanisms &rarr; Impacts, visualizing how the EU AI Act and PL 2338 function as &quot;assemblages\" of power rather than just text.\r\n                                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[5570,5770],"text":" to map the flow from Actors &rarr; Mechanisms &rarr; Impacts, visualizing how the EU AI Act and PL 2338 function as &ldquo;assemblages\" of power rather than just text.\r\n                                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[5570,5770],"text":" to map the flow from Actors &rarr; Mechanisms &rarr; Impacts, visualizing how the EU AI Act and PL 2338 function as &#34;assemblages\" of power rather than just text.\r\n                                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[5570,5770],"text":" to map the flow from Actors &rarr; Mechanisms &rarr; Impacts, visualizing how the EU AI Act and PL 2338 function as &rdquo;assemblages\" of power rather than just text.\r\n                                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":77,"column":215,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[5570,5770],"text":" to map the flow from Actors &rarr; Mechanisms &rarr; Impacts, visualizing how the EU AI Act and PL 2338 function as \"assemblages&quot; of power rather than just text.\r\n                                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[5570,5770],"text":" to map the flow from Actors &rarr; Mechanisms &rarr; Impacts, visualizing how the EU AI Act and PL 2338 function as \"assemblages&ldquo; of power rather than just text.\r\n                                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[5570,5770],"text":" to map the flow from Actors &rarr; Mechanisms &rarr; Impacts, visualizing how the EU AI Act and PL 2338 function as \"assemblages&#34; of power rather than just text.\r\n                                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[5570,5770],"text":" to map the flow from Actors &rarr; Mechanisms &rarr; Impacts, visualizing how the EU AI Act and PL 2338 function as \"assemblages&rdquo; of power rather than just text.\r\n                                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":93,"column":51,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[6445,6596],"text":"\r\n                                    Analyzing how &quot;universal\" AI governance reinforces Global North epistemologies.\r\n                                "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[6445,6596],"text":"\r\n                                    Analyzing how &ldquo;universal\" AI governance reinforces Global North epistemologies.\r\n                                "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[6445,6596],"text":"\r\n                                    Analyzing how &#34;universal\" AI governance reinforces Global North epistemologies.\r\n                                "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[6445,6596],"text":"\r\n                                    Analyzing how &rdquo;universal\" AI governance reinforces Global North epistemologies.\r\n                                "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":93,"column":61,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[6445,6596],"text":"\r\n                                    Analyzing how \"universal&quot; AI governance reinforces Global North epistemologies.\r\n                                "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[6445,6596],"text":"\r\n                                    Analyzing how \"universal&ldquo; AI governance reinforces Global North epistemologies.\r\n                                "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[6445,6596],"text":"\r\n                                    Analyzing how \"universal&#34; AI governance reinforces Global North epistemologies.\r\n                                "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[6445,6596],"text":"\r\n                                    Analyzing how \"universal&rdquo; AI governance reinforces Global North epistemologies.\r\n                                "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":119,"column":142,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[8919,9078],"text":", questioning the &quot;universal\" applicability of the EU's \"Risk-Based Approach\" when transplanted to the Brazilian context.\r\n                                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[8919,9078],"text":", questioning the &ldquo;universal\" applicability of the EU's \"Risk-Based Approach\" when transplanted to the Brazilian context.\r\n                                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[8919,9078],"text":", questioning the &#34;universal\" applicability of the EU's \"Risk-Based Approach\" when transplanted to the Brazilian context.\r\n                                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[8919,9078],"text":", questioning the &rdquo;universal\" applicability of the EU's \"Risk-Based Approach\" when transplanted to the Brazilian context.\r\n                                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":119,"column":152,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[8919,9078],"text":", questioning the \"universal&quot; applicability of the EU's \"Risk-Based Approach\" when transplanted to the Brazilian context.\r\n                                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[8919,9078],"text":", questioning the \"universal&ldquo; applicability of the EU's \"Risk-Based Approach\" when transplanted to the Brazilian context.\r\n                                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[8919,9078],"text":", questioning the \"universal&#34; applicability of the EU's \"Risk-Based Approach\" when transplanted to the Brazilian context.\r\n                                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[8919,9078],"text":", questioning the \"universal&rdquo; applicability of the EU's \"Risk-Based Approach\" when transplanted to the Brazilian context.\r\n                                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":119,"column":177,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[8919,9078],"text":", questioning the \"universal\" applicability of the EU&apos;s \"Risk-Based Approach\" when transplanted to the Brazilian context.\r\n                                    "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[8919,9078],"text":", questioning the \"universal\" applicability of the EU&lsquo;s \"Risk-Based Approach\" when transplanted to the Brazilian context.\r\n                                    "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[8919,9078],"text":", questioning the \"universal\" applicability of the EU&#39;s \"Risk-Based Approach\" when transplanted to the Brazilian context.\r\n                                    "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[8919,9078],"text":", questioning the \"universal\" applicability of the EU&rsquo;s \"Risk-Based Approach\" when transplanted to the Brazilian context.\r\n                                    "},"desc":"Replace with `&rsquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":119,"column":180,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[8919,9078],"text":", questioning the \"universal\" applicability of the EU's &quot;Risk-Based Approach\" when transplanted to the Brazilian context.\r\n                                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[8919,9078],"text":", questioning the \"universal\" applicability of the EU's &ldquo;Risk-Based Approach\" when transplanted to the Brazilian context.\r\n                                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[8919,9078],"text":", questioning the \"universal\" applicability of the EU's &#34;Risk-Based Approach\" when transplanted to the Brazilian context.\r\n                                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[8919,9078],"text":", questioning the \"universal\" applicability of the EU's &rdquo;Risk-Based Approach\" when transplanted to the Brazilian context.\r\n                                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":119,"column":200,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[8919,9078],"text":", questioning the \"universal\" applicability of the EU's \"Risk-Based Approach&quot; when transplanted to the Brazilian context.\r\n                                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[8919,9078],"text":", questioning the \"universal\" applicability of the EU's \"Risk-Based Approach&ldquo; when transplanted to the Brazilian context.\r\n                                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[8919,9078],"text":", questioning the \"universal\" applicability of the EU's \"Risk-Based Approach&#34; when transplanted to the Brazilian context.\r\n                                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[8919,9078],"text":", questioning the \"universal\" applicability of the EU's \"Risk-Based Approach&rdquo; when transplanted to the Brazilian context.\r\n                                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":161,"column":105,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[12097,12229],"text":", where we map &quot;Friction Points\" and \"Subversion Strategies\" in the implementation of AI laws.\r\n                                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[12097,12229],"text":", where we map &ldquo;Friction Points\" and \"Subversion Strategies\" in the implementation of AI laws.\r\n                                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[12097,12229],"text":", where we map &#34;Friction Points\" and \"Subversion Strategies\" in the implementation of AI laws.\r\n                                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[12097,12229],"text":", where we map &rdquo;Friction Points\" and \"Subversion Strategies\" in the implementation of AI laws.\r\n                                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":161,"column":121,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[12097,12229],"text":", where we map \"Friction Points&quot; and \"Subversion Strategies\" in the implementation of AI laws.\r\n                                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[12097,12229],"text":", where we map \"Friction Points&ldquo; and \"Subversion Strategies\" in the implementation of AI laws.\r\n                                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[12097,12229],"text":", where we map \"Friction Points&#34; and \"Subversion Strategies\" in the implementation of AI laws.\r\n                                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[12097,12229],"text":", where we map \"Friction Points&rdquo; and \"Subversion Strategies\" in the implementation of AI laws.\r\n                                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":161,"column":127,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[12097,12229],"text":", where we map \"Friction Points\" and &quot;Subversion Strategies\" in the implementation of AI laws.\r\n                                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[12097,12229],"text":", where we map \"Friction Points\" and &ldquo;Subversion Strategies\" in the implementation of AI laws.\r\n                                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[12097,12229],"text":", where we map \"Friction Points\" and &#34;Subversion Strategies\" in the implementation of AI laws.\r\n                                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[12097,12229],"text":", where we map \"Friction Points\" and &rdquo;Subversion Strategies\" in the implementation of AI laws.\r\n                                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":161,"column":149,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[12097,12229],"text":", where we map \"Friction Points\" and \"Subversion Strategies&quot; in the implementation of AI laws.\r\n                                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[12097,12229],"text":", where we map \"Friction Points\" and \"Subversion Strategies&ldquo; in the implementation of AI laws.\r\n                                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[12097,12229],"text":", where we map \"Friction Points\" and \"Subversion Strategies&#34; in the implementation of AI laws.\r\n                                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[12097,12229],"text":", where we map \"Friction Points\" and \"Subversion Strategies&rdquo; in the implementation of AI laws.\r\n                                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":187,"column":89,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[13967,14034],"text":" The EU&apos;s unilateral power to regulate global markets (Bradford) - "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[13967,14034],"text":" The EU&lsquo;s unilateral power to regulate global markets (Bradford) - "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[13967,14034],"text":" The EU&#39;s unilateral power to regulate global markets (Bradford) - "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[13967,14034],"text":" The EU&rsquo;s unilateral power to regulate global markets (Bradford) - "},"desc":"Replace with `&rsquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":203,"column":129,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[15330,15480],"text":" to analyze the &quot;Brussels Effect\" not as a neutral diffusion of standards, but as a form of \"Legal Imperialism.\"\r\n                                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[15330,15480],"text":" to analyze the &ldquo;Brussels Effect\" not as a neutral diffusion of standards, but as a form of \"Legal Imperialism.\"\r\n                                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[15330,15480],"text":" to analyze the &#34;Brussels Effect\" not as a neutral diffusion of standards, but as a form of \"Legal Imperialism.\"\r\n                                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[15330,15480],"text":" to analyze the &rdquo;Brussels Effect\" not as a neutral diffusion of standards, but as a form of \"Legal Imperialism.\"\r\n                                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":203,"column":145,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[15330,15480],"text":" to analyze the \"Brussels Effect&quot; not as a neutral diffusion of standards, but as a form of \"Legal Imperialism.\"\r\n                                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[15330,15480],"text":" to analyze the \"Brussels Effect&ldquo; not as a neutral diffusion of standards, but as a form of \"Legal Imperialism.\"\r\n                                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[15330,15480],"text":" to analyze the \"Brussels Effect&#34; not as a neutral diffusion of standards, but as a form of \"Legal Imperialism.\"\r\n                                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[15330,15480],"text":" to analyze the \"Brussels Effect&rdquo; not as a neutral diffusion of standards, but as a form of \"Legal Imperialism.\"\r\n                                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":203,"column":205,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[15330,15480],"text":" to analyze the \"Brussels Effect\" not as a neutral diffusion of standards, but as a form of &quot;Legal Imperialism.\"\r\n                                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[15330,15480],"text":" to analyze the \"Brussels Effect\" not as a neutral diffusion of standards, but as a form of &ldquo;Legal Imperialism.\"\r\n                                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[15330,15480],"text":" to analyze the \"Brussels Effect\" not as a neutral diffusion of standards, but as a form of &#34;Legal Imperialism.\"\r\n                                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[15330,15480],"text":" to analyze the \"Brussels Effect\" not as a neutral diffusion of standards, but as a form of &rdquo;Legal Imperialism.\"\r\n                                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":203,"column":224,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[15330,15480],"text":" to analyze the \"Brussels Effect\" not as a neutral diffusion of standards, but as a form of \"Legal Imperialism.&quot;\r\n                                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[15330,15480],"text":" to analyze the \"Brussels Effect\" not as a neutral diffusion of standards, but as a form of \"Legal Imperialism.&ldquo;\r\n                                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[15330,15480],"text":" to analyze the \"Brussels Effect\" not as a neutral diffusion of standards, but as a form of \"Legal Imperialism.&#34;\r\n                                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[15330,15480],"text":" to analyze the \"Brussels Effect\" not as a neutral diffusion of standards, but as a form of \"Legal Imperialism.&rdquo;\r\n                                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":219,"column":65,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[16167,16301],"text":"\r\n                                    Acknowledging the researcher&apos;s position within the assemblage.\r\n                                "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[16167,16301],"text":"\r\n                                    Acknowledging the researcher&lsquo;s position within the assemblage.\r\n                                "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[16167,16301],"text":"\r\n                                    Acknowledging the researcher&#39;s position within the assemblage.\r\n                                "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[16167,16301],"text":"\r\n                                    Acknowledging the researcher&rsquo;s position within the assemblage.\r\n                                "},"desc":"Replace with `&rsquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":243,"column":108,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[18341,18511],"text":" via the &quot;Methodological Log\" and \"Positionality Statement,\" ensuring the researcher does not claim a \"God Trick\" view from nowhere.\r\n                                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[18341,18511],"text":" via the &ldquo;Methodological Log\" and \"Positionality Statement,\" ensuring the researcher does not claim a \"God Trick\" view from nowhere.\r\n                                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[18341,18511],"text":" via the &#34;Methodological Log\" and \"Positionality Statement,\" ensuring the researcher does not claim a \"God Trick\" view from nowhere.\r\n                                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[18341,18511],"text":" via the &rdquo;Methodological Log\" and \"Positionality Statement,\" ensuring the researcher does not claim a \"God Trick\" view from nowhere.\r\n                                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":243,"column":127,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[18341,18511],"text":" via the \"Methodological Log&quot; and \"Positionality Statement,\" ensuring the researcher does not claim a \"God Trick\" view from nowhere.\r\n                                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[18341,18511],"text":" via the \"Methodological Log&ldquo; and \"Positionality Statement,\" ensuring the researcher does not claim a \"God Trick\" view from nowhere.\r\n                                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[18341,18511],"text":" via the \"Methodological Log&#34; and \"Positionality Statement,\" ensuring the researcher does not claim a \"God Trick\" view from nowhere.\r\n                                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[18341,18511],"text":" via the \"Methodological Log&rdquo; and \"Positionality Statement,\" ensuring the researcher does not claim a \"God Trick\" view from nowhere.\r\n                                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":243,"column":133,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[18341,18511],"text":" via the \"Methodological Log\" and &quot;Positionality Statement,\" ensuring the researcher does not claim a \"God Trick\" view from nowhere.\r\n                                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[18341,18511],"text":" via the \"Methodological Log\" and &ldquo;Positionality Statement,\" ensuring the researcher does not claim a \"God Trick\" view from nowhere.\r\n                                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[18341,18511],"text":" via the \"Methodological Log\" and &#34;Positionality Statement,\" ensuring the researcher does not claim a \"God Trick\" view from nowhere.\r\n                                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[18341,18511],"text":" via the \"Methodological Log\" and &rdquo;Positionality Statement,\" ensuring the researcher does not claim a \"God Trick\" view from nowhere.\r\n                                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":243,"column":158,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[18341,18511],"text":" via the \"Methodological Log\" and \"Positionality Statement,&quot; ensuring the researcher does not claim a \"God Trick\" view from nowhere.\r\n                                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[18341,18511],"text":" via the \"Methodological Log\" and \"Positionality Statement,&ldquo; ensuring the researcher does not claim a \"God Trick\" view from nowhere.\r\n                                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[18341,18511],"text":" via the \"Methodological Log\" and \"Positionality Statement,&#34; ensuring the researcher does not claim a \"God Trick\" view from nowhere.\r\n                                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[18341,18511],"text":" via the \"Methodological Log\" and \"Positionality Statement,&rdquo; ensuring the researcher does not claim a \"God Trick\" view from nowhere.\r\n                                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":243,"column":201,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[18341,18511],"text":" via the \"Methodological Log\" and \"Positionality Statement,\" ensuring the researcher does not claim a &quot;God Trick\" view from nowhere.\r\n                                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[18341,18511],"text":" via the \"Methodological Log\" and \"Positionality Statement,\" ensuring the researcher does not claim a &ldquo;God Trick\" view from nowhere.\r\n                                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[18341,18511],"text":" via the \"Methodological Log\" and \"Positionality Statement,\" ensuring the researcher does not claim a &#34;God Trick\" view from nowhere.\r\n                                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[18341,18511],"text":" via the \"Methodological Log\" and \"Positionality Statement,\" ensuring the researcher does not claim a &rdquo;God Trick\" view from nowhere.\r\n                                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":243,"column":211,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[18341,18511],"text":" via the \"Methodological Log\" and \"Positionality Statement,\" ensuring the researcher does not claim a \"God Trick&quot; view from nowhere.\r\n                                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[18341,18511],"text":" via the \"Methodological Log\" and \"Positionality Statement,\" ensuring the researcher does not claim a \"God Trick&ldquo; view from nowhere.\r\n                                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[18341,18511],"text":" via the \"Methodological Log\" and \"Positionality Statement,\" ensuring the researcher does not claim a \"God Trick&#34; view from nowhere.\r\n                                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[18341,18511],"text":" via the \"Methodological Log\" and \"Positionality Statement,\" ensuring the researcher does not claim a \"God Trick&rdquo; view from nowhere.\r\n                                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":284,"column":103,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[21474,21671],"text":" to analyze the &quot;moral vocabulary\" of AI policy documents, identifying which \"Orders of Worth\" (e.g., Industrial efficiency vs. Civic solidarity) are dominant.\r\n                                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[21474,21671],"text":" to analyze the &ldquo;moral vocabulary\" of AI policy documents, identifying which \"Orders of Worth\" (e.g., Industrial efficiency vs. Civic solidarity) are dominant.\r\n                                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[21474,21671],"text":" to analyze the &#34;moral vocabulary\" of AI policy documents, identifying which \"Orders of Worth\" (e.g., Industrial efficiency vs. Civic solidarity) are dominant.\r\n                                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[21474,21671],"text":" to analyze the &rdquo;moral vocabulary\" of AI policy documents, identifying which \"Orders of Worth\" (e.g., Industrial efficiency vs. Civic solidarity) are dominant.\r\n                                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":284,"column":120,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[21474,21671],"text":" to analyze the \"moral vocabulary&quot; of AI policy documents, identifying which \"Orders of Worth\" (e.g., Industrial efficiency vs. Civic solidarity) are dominant.\r\n                                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[21474,21671],"text":" to analyze the \"moral vocabulary&ldquo; of AI policy documents, identifying which \"Orders of Worth\" (e.g., Industrial efficiency vs. Civic solidarity) are dominant.\r\n                                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[21474,21671],"text":" to analyze the \"moral vocabulary&#34; of AI policy documents, identifying which \"Orders of Worth\" (e.g., Industrial efficiency vs. Civic solidarity) are dominant.\r\n                                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[21474,21671],"text":" to analyze the \"moral vocabulary&rdquo; of AI policy documents, identifying which \"Orders of Worth\" (e.g., Industrial efficiency vs. Civic solidarity) are dominant.\r\n                                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":284,"column":164,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[21474,21671],"text":" to analyze the \"moral vocabulary\" of AI policy documents, identifying which &quot;Orders of Worth\" (e.g., Industrial efficiency vs. Civic solidarity) are dominant.\r\n                                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[21474,21671],"text":" to analyze the \"moral vocabulary\" of AI policy documents, identifying which &ldquo;Orders of Worth\" (e.g., Industrial efficiency vs. Civic solidarity) are dominant.\r\n                                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[21474,21671],"text":" to analyze the \"moral vocabulary\" of AI policy documents, identifying which &#34;Orders of Worth\" (e.g., Industrial efficiency vs. Civic solidarity) are dominant.\r\n                                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[21474,21671],"text":" to analyze the \"moral vocabulary\" of AI policy documents, identifying which &rdquo;Orders of Worth\" (e.g., Industrial efficiency vs. Civic solidarity) are dominant.\r\n                                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":284,"column":180,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[21474,21671],"text":" to analyze the \"moral vocabulary\" of AI policy documents, identifying which \"Orders of Worth&quot; (e.g., Industrial efficiency vs. Civic solidarity) are dominant.\r\n                                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[21474,21671],"text":" to analyze the \"moral vocabulary\" of AI policy documents, identifying which \"Orders of Worth&ldquo; (e.g., Industrial efficiency vs. Civic solidarity) are dominant.\r\n                                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[21474,21671],"text":" to analyze the \"moral vocabulary\" of AI policy documents, identifying which \"Orders of Worth&#34; (e.g., Industrial efficiency vs. Civic solidarity) are dominant.\r\n                                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[21474,21671],"text":" to analyze the \"moral vocabulary\" of AI policy documents, identifying which \"Orders of Worth&rdquo; (e.g., Industrial efficiency vs. Civic solidarity) are dominant.\r\n                                    "},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":32,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\r\nimport { BookOpen, Network, Scale, Users, Lightbulb, Globe, ShieldCheck } from \"lucide-react\";\r\n\r\nexport default function LiteraturePage() {\r\n    return (\r\n        <div className=\"space-y-8 max-w-7xl mx-auto\">\r\n            <div className=\"flex flex-col gap-2\">\r\n                <h1 className=\"text-3xl font-bold text-slate-900\">Theoretical Framework & Literature Review</h1>\r\n                <p className=\"text-slate-600 max-w-3xl\">\r\n                    This module maps the theoretical underpinnings of the \"Decolonial Situatedness in Global AI Governance\" project.\r\n                    It grounds the application's methodology in key scholarship across Decolonial Studies, STS, and Critical Legal Theory.\r\n                </p>\r\n            </div>\r\n\r\n            <Tabs defaultValue=\"assemblage\" className=\"w-full\">\r\n                <TabsList className=\"grid w-full grid-cols-6 bg-slate-100 p-1 rounded-lg\">\r\n                    <TabsTrigger value=\"assemblage\" className=\"data-[state=active]:bg-white data-[state=active]:shadow-sm\">\r\n                        <Network size={16} className=\"mr-2\" /> Assemblage Theory\r\n                    </TabsTrigger>\r\n                    <TabsTrigger value=\"decolonial\" className=\"data-[state=active]:bg-white data-[state=active]:shadow-sm\">\r\n                        <Globe size={16} className=\"mr-2\" /> Decoloniality\r\n                    </TabsTrigger>\r\n                    <TabsTrigger value=\"resistance\" className=\"data-[state=active]:bg-white data-[state=active]:shadow-sm\">\r\n                        <Users size={16} className=\"mr-2\" /> Resistance\r\n                    </TabsTrigger>\r\n                    <TabsTrigger value=\"legal\" className=\"data-[state=active]:bg-white data-[state=active]:shadow-sm\">\r\n                        <Scale size={16} className=\"mr-2\" /> Critical Legal\r\n                    </TabsTrigger>\r\n                    <TabsTrigger value=\"reflexivity\" className=\"data-[state=active]:bg-white data-[state=active]:shadow-sm\">\r\n                        <Lightbulb size={16} className=\"mr-2\" /> Reflexivity\r\n                    </TabsTrigger>\r\n                    <TabsTrigger value=\"legitimacy\" className=\"data-[state=active]:bg-white data-[state=active]:shadow-sm\">\r\n                        <ShieldCheck size={16} className=\"mr-2\" /> Legitimacy\r\n                    </TabsTrigger>\r\n                </TabsList>\r\n\r\n                <div className=\"mt-6 space-y-6\">\r\n                    {/* Assemblage Theory Content */}\r\n                    <TabsContent value=\"assemblage\" className=\"space-y-6\">\r\n                        <Card>\r\n                            <CardHeader>\r\n                                <CardTitle className=\"flex items-center gap-2\">\r\n                                    <Network className=\"text-blue-600\" />\r\n                                    Algorithmic Assemblages\r\n                                </CardTitle>\r\n                                <CardDescription>\r\n                                    Understanding AI governance not as static laws, but as dynamic, socio-technical flows.\r\n                                </CardDescription>\r\n                            </CardHeader>\r\n                            <CardContent className=\"space-y-4\">\r\n                                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                                    <div className=\"space-y-3\">\r\n                                        <h3 className=\"font-semibold text-slate-900\">Key Concepts</h3>\r\n                                        <ul className=\"list-disc list-inside text-sm text-slate-600 space-y-2\">\r\n                                            <li><strong>Assemblage (Agencement):</strong> A heterogeneous composition of human and non-human actors (Deleuze & Guattari).</li>\r\n                                            <li><strong>Translation:</strong> The process by which actors modify and displace goals (Latour/Callon).</li>\r\n                                            <li><strong>Performativity:</strong> How algorithms enact the realities they purport to describe (MacKenzie).</li>\r\n                                        </ul>\r\n                                    </div>\r\n                                    <div className=\"space-y-3\">\r\n                                        <h3 className=\"font-semibold text-slate-900\">Key Scholars</h3>\r\n                                        <div className=\"flex flex-wrap gap-2\">\r\n                                            <Badge variant=\"outline\">Deleuze & Guattari</Badge>\r\n                                            <Badge variant=\"outline\">Bruno Latour</Badge>\r\n                                            <Badge variant=\"outline\">Louise Amoore</Badge>\r\n                                            <Badge variant=\"outline\">N. Katherine Hayles</Badge>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"bg-slate-50 p-4 rounded-lg border border-slate-100 mt-4\">\r\n                                    <h4 className=\"text-sm font-semibold text-slate-800 mb-2\">Application in Project:</h4>\r\n                                    <p className=\"text-sm text-slate-600\">\r\n                                        Used in the <strong>Synthesis Module</strong> to map the flow from Actors &rarr; Mechanisms &rarr; Impacts, visualizing how the EU AI Act and PL 2338 function as \"assemblages\" of power rather than just text.\r\n                                    </p>\r\n                                </div>\r\n                            </CardContent>\r\n                        </Card>\r\n                    </TabsContent>\r\n\r\n                    {/* Decoloniality Content */}\r\n                    <TabsContent value=\"decolonial\" className=\"space-y-6\">\r\n                        <Card>\r\n                            <CardHeader>\r\n                                <CardTitle className=\"flex items-center gap-2\">\r\n                                    <Globe className=\"text-emerald-600\" />\r\n                                    Decolonial Situatedness\r\n                                </CardTitle>\r\n                                <CardDescription>\r\n                                    Analyzing how \"universal\" AI governance reinforces Global North epistemologies.\r\n                                </CardDescription>\r\n                            </CardHeader>\r\n                            <CardContent className=\"space-y-4\">\r\n                                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                                    <div className=\"space-y-3\">\r\n                                        <h3 className=\"font-semibold text-slate-900\">Key Concepts</h3>\r\n                                        <ul className=\"list-disc list-inside text-sm text-slate-600 space-y-2\">\r\n                                            <li><strong>Coloniality of Power:</strong> The continuity of colonial forms of domination after the end of colonial administrations (Quijano).</li>\r\n                                            <li><strong>Border Thinking:</strong> Thinking from the exteriority of the modern/colonial world system (Mignolo).</li>\r\n                                            <li><strong>Data Colonialism:</strong> The extraction of data from the Global South for value capture in the North (Couldry & Mejias).</li>\r\n                                        </ul>\r\n                                    </div>\r\n                                    <div className=\"space-y-3\">\r\n                                        <h3 className=\"font-semibold text-slate-900\">Key Scholars</h3>\r\n                                        <div className=\"flex flex-wrap gap-2\">\r\n                                            <Badge variant=\"outline\">Anbal Quijano</Badge>\r\n                                            <Badge variant=\"outline\">Walter Mignolo</Badge>\r\n                                            <Badge variant=\"outline\">Sylvia Wynter</Badge>\r\n                                            <Badge variant=\"outline\">Paola Ricaurte</Badge>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"bg-emerald-50 p-4 rounded-lg border border-emerald-100 mt-4\">\r\n                                    <h4 className=\"text-sm font-semibold text-emerald-900 mb-2\">Application in Project:</h4>\r\n                                    <p className=\"text-sm text-emerald-800\">\r\n                                        Informs the <strong>Ontology Module</strong> and <strong>Cultural Analysis</strong>, questioning the \"universal\" applicability of the EU's \"Risk-Based Approach\" when transplanted to the Brazilian context.\r\n                                    </p>\r\n                                </div>\r\n                            </CardContent>\r\n                        </Card>\r\n                    </TabsContent>\r\n\r\n                    {/* Resistance Content */}\r\n                    <TabsContent value=\"resistance\" className=\"space-y-6\">\r\n                        <Card>\r\n                            <CardHeader>\r\n                                <CardTitle className=\"flex items-center gap-2\">\r\n                                    <Users className=\"text-amber-600\" />\r\n                                    Micro-Resistance & Friction\r\n                                </CardTitle>\r\n                                <CardDescription>\r\n                                    Identifying how local actors adapt, resist, or subvert algorithmic governance.\r\n                                </CardDescription>\r\n                            </CardHeader>\r\n                            <CardContent className=\"space-y-4\">\r\n                                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                                    <div className=\"space-y-3\">\r\n                                        <h3 className=\"font-semibold text-slate-900\">Key Concepts</h3>\r\n                                        <ul className=\"list-disc list-inside text-sm text-slate-600 space-y-2\">\r\n                                            <li><strong>Weapons of the Weak:</strong> Everyday forms of peasant resistance (Scott).</li>\r\n                                            <li><strong>Friction:</strong> The awkward, unequal, unstable, and creative qualities of interconnection (Tsing).</li>\r\n                                            <li><strong>Glitch Feminism:</strong> Using the error/glitch as a site of resistance (Russell).</li>\r\n                                        </ul>\r\n                                    </div>\r\n                                    <div className=\"space-y-3\">\r\n                                        <h3 className=\"font-semibold text-slate-900\">Key Scholars</h3>\r\n                                        <div className=\"flex flex-wrap gap-2\">\r\n                                            <Badge variant=\"outline\">James C. Scott</Badge>\r\n                                            <Badge variant=\"outline\">Anna Lowenhaupt Tsing</Badge>\r\n                                            <Badge variant=\"outline\">Legacy Russell</Badge>\r\n                                            <Badge variant=\"outline\">Saidiya Hartman</Badge>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"bg-amber-50 p-4 rounded-lg border border-amber-100 mt-4\">\r\n                                    <h4 className=\"text-sm font-semibold text-amber-900 mb-2\">Application in Project:</h4>\r\n                                    <p className=\"text-sm text-amber-800\">\r\n                                        Central to the <strong>Resistance Module</strong>, where we map \"Friction Points\" and \"Subversion Strategies\" in the implementation of AI laws.\r\n                                    </p>\r\n                                </div>\r\n                            </CardContent>\r\n                        </Card>\r\n                    </TabsContent>\r\n\r\n                    {/* Critical Legal Content */}\r\n                    <TabsContent value=\"legal\" className=\"space-y-6\">\r\n                        <Card>\r\n                            <CardHeader>\r\n                                <CardTitle className=\"flex items-center gap-2\">\r\n                                    <Scale className=\"text-indigo-600\" />\r\n                                    Critical Legal Theory & TWAIL\r\n                                </CardTitle>\r\n                                <CardDescription>\r\n                                    Examining international law as a site of struggle and hierarchy.\r\n                                </CardDescription>\r\n                            </CardHeader>\r\n                            <CardContent className=\"space-y-4\">\r\n                                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                                    <div className=\"space-y-3\">\r\n                                        <h3 className=\"font-semibold text-slate-900\">Key Concepts</h3>\r\n                                        <ul className=\"list-disc list-inside text-sm text-slate-600 space-y-2\">\r\n                                            <li><strong>Legal Transplants:</strong> The movement of laws across borders and their mutation (Watson/Frankenberg).</li>\r\n                                            <li><strong>TWAIL:</strong> Third World Approaches to International Law, critiquing the colonial origins of international norms.</li>\r\n                                            <li><strong>Brussels Effect:</strong> The EU's unilateral power to regulate global markets (Bradford) - <em>critiqued here</em>.</li>\r\n                                        </ul>\r\n                                    </div>\r\n                                    <div className=\"space-y-3\">\r\n                                        <h3 className=\"font-semibold text-slate-900\">Key Scholars</h3>\r\n                                        <div className=\"flex flex-wrap gap-2\">\r\n                                            <Badge variant=\"outline\">Antony Anghie</Badge>\r\n                                            <Badge variant=\"outline\">B.S. Chimni</Badge>\r\n                                            <Badge variant=\"outline\">Anu Bradford</Badge>\r\n                                            <Badge variant=\"outline\">Gnter Frankenberg</Badge>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"bg-indigo-50 p-4 rounded-lg border border-indigo-100 mt-4\">\r\n                                    <h4 className=\"text-sm font-semibold text-indigo-900 mb-2\">Application in Project:</h4>\r\n                                    <p className=\"text-sm text-indigo-800\">\r\n                                        Used in the <strong>Data Module</strong> and <strong>Comparison</strong> to analyze the \"Brussels Effect\" not as a neutral diffusion of standards, but as a form of \"Legal Imperialism.\"\r\n                                    </p>\r\n                                </div>\r\n                            </CardContent>\r\n                        </Card>\r\n                    </TabsContent>\r\n\r\n                    {/* Reflexivity Content */}\r\n                    <TabsContent value=\"reflexivity\" className=\"space-y-6\">\r\n                        <Card>\r\n                            <CardHeader>\r\n                                <CardTitle className=\"flex items-center gap-2\">\r\n                                    <Lightbulb className=\"text-purple-600\" />\r\n                                    Feminist Standpoint & Reflexivity\r\n                                </CardTitle>\r\n                                <CardDescription>\r\n                                    Acknowledging the researcher's position within the assemblage.\r\n                                </CardDescription>\r\n                            </CardHeader>\r\n                            <CardContent className=\"space-y-4\">\r\n                                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                                    <div className=\"space-y-3\">\r\n                                        <h3 className=\"font-semibold text-slate-900\">Key Concepts</h3>\r\n                                        <ul className=\"list-disc list-inside text-sm text-slate-600 space-y-2\">\r\n                                            <li><strong>Situated Knowledges:</strong> The view from a body, always complex, contradictory, structuring, and structured (Haraway).</li>\r\n                                            <li><strong>Strong Objectivity:</strong> Starting research from the lives of marginalized groups to produce less partial accounts (Harding).</li>\r\n                                        </ul>\r\n                                    </div>\r\n                                    <div className=\"space-y-3\">\r\n                                        <h3 className=\"font-semibold text-slate-900\">Key Scholars</h3>\r\n                                        <div className=\"flex flex-wrap gap-2\">\r\n                                            <Badge variant=\"outline\">Donna Haraway</Badge>\r\n                                            <Badge variant=\"outline\">Sandra Harding</Badge>\r\n                                            <Badge variant=\"outline\">Patricia Hill Collins</Badge>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"bg-purple-50 p-4 rounded-lg border border-purple-100 mt-4\">\r\n                                    <h4 className=\"text-sm font-semibold text-purple-900 mb-2\">Application in Project:</h4>\r\n                                    <p className=\"text-sm text-purple-800\">\r\n                                        Operationalized in the <strong>Reflexivity Module</strong> via the \"Methodological Log\" and \"Positionality Statement,\" ensuring the researcher does not claim a \"God Trick\" view from nowhere.\r\n                                    </p>\r\n                                </div>\r\n                            </CardContent>\r\n                        </Card>\r\n                    </TabsContent>\r\n\r\n                    {/* Legitimacy Content */}\r\n                    <TabsContent value=\"legitimacy\" className=\"space-y-6\">\r\n                        <Card>\r\n                            <CardHeader>\r\n                                <CardTitle className=\"flex items-center gap-2\">\r\n                                    <ShieldCheck className=\"text-rose-600\" />\r\n                                    Sociology of Critique & Orders of Worth\r\n                                </CardTitle>\r\n                                <CardDescription>\r\n                                    Analyzing how actors justify their actions and claims to legitimacy.\r\n                                </CardDescription>\r\n                            </CardHeader>\r\n                            <CardContent className=\"space-y-4\">\r\n                                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                                    <div className=\"space-y-3\">\r\n                                        <h3 className=\"font-semibold text-slate-900\">Key Concepts</h3>\r\n                                        <ul className=\"list-disc list-inside text-sm text-slate-600 space-y-2\">\r\n                                            <li><strong>Orders of Worth (Cits):</strong> Distinct worlds of justification (Market, Industrial, Civic, Domestic, Inspired, Fame).</li>\r\n                                            <li><strong>Tests of Worth:</strong> Moments where legitimacy is challenged and must be proven through evidence.</li>\r\n                                            <li><strong>Compromise:</strong> Fragile agreements formed between conflicting orders of worth.</li>\r\n                                        </ul>\r\n                                    </div>\r\n                                    <div className=\"space-y-3\">\r\n                                        <h3 className=\"font-semibold text-slate-900\">Key Scholars</h3>\r\n                                        <div className=\"flex flex-wrap gap-2\">\r\n                                            <Badge variant=\"outline\">Luc Boltanski</Badge>\r\n                                            <Badge variant=\"outline\">Laurent Thvenot</Badge>\r\n                                            <Badge variant=\"outline\">Eve Chiapello</Badge>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"bg-rose-50 p-4 rounded-lg border border-rose-100 mt-4\">\r\n                                    <h4 className=\"text-sm font-semibold text-rose-900 mb-2\">Application in Project:</h4>\r\n                                    <p className=\"text-sm text-rose-800\">\r\n                                        Used in the <strong>Legitimacy Module</strong> to analyze the \"moral vocabulary\" of AI policy documents, identifying which \"Orders of Worth\" (e.g., Industrial efficiency vs. Civic solidarity) are dominant.\r\n                                    </p>\r\n                                </div>\r\n                            </CardContent>\r\n                        </Card>\r\n                    </TabsContent>\r\n                </div>\r\n            </Tabs>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\login\\[[...login]]\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\ontology\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Globe' is defined but never used.","line":22,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":22,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Brain' is defined but never used.","line":22,"column":17,"nodeType":null,"messageId":"unusedVar","endLine":22,"endColumn":22},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Share2' is defined but never used.","line":22,"column":24,"nodeType":null,"messageId":"unusedVar","endLine":22,"endColumn":30},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Database' is defined but never used.","line":22,"column":32,"nodeType":null,"messageId":"unusedVar","endLine":22,"endColumn":40},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Scale' is defined but never used.","line":22,"column":42,"nodeType":null,"messageId":"unusedVar","endLine":22,"endColumn":47}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState } from \"react\";\r\nimport { useServerStorage } from \"@/hooks/useServerStorage\";\r\nimport { useSources } from \"@/hooks/useSources\";\r\nimport { Card, CardContent } from \"@/components/ui/card\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Network, ArrowRightLeft, Sparkles, Loader2 } from \"lucide-react\";\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\r\nimport { OntologyData, OntologyNode, ComparisonResult } from \"@/types/ontology\";\r\nimport { getColorForCategory } from \"@/lib/ontology-utils\";\r\n\r\n// Components\r\nimport { OntologyMap } from \"@/components/ontology/OntologyMap\";\r\nimport { ConceptList } from \"@/components/ontology/ConceptList\";\r\nimport { MapGallery } from \"@/components/ontology/MapGallery\";\r\nimport { ConceptDetailsModal } from \"@/components/ontology/ConceptDetailsModal\";\r\nimport { ComparisonView } from \"@/components/ontology/ComparisonView\";\r\n\r\n// Static Data (Fallback) - Kept for initial state visualization\r\nimport { Globe, Brain, Share2, Database, Scale } from \"lucide-react\";\r\n\r\nconst STATIC_CONCEPTS = [\r\n    {\r\n        id: \"0\",\r\n        label: \"Coloniality of Power\",\r\n        description: \"The living legacy of colonialism in contemporary power structures, defining who has the authority to classify and organize the world.\",\r\n        quote: \"The coloniality of power is not just a historical event, but a continuous process of ordering the world.\",\r\n        category: \"Core\",\r\n        color: \"#fca5a5\",\r\n        x: 250, y: 50\r\n    },\r\n    {\r\n        id: \"1\",\r\n        label: \"Algorithmic Rationality\",\r\n        description: \"The logic by which algorithms order, sort, and prioritize information, often embedding specific cultural and epistemological values.\",\r\n        quote: \"Algorithms are not neutral tools; they are crystallized forms of rationality.\",\r\n        category: \"Mechanism\",\r\n        color: \"#d8b4fe\",\r\n        x: 450, y: 150\r\n    },\r\n    {\r\n        id: \"2\",\r\n        label: \"Global South State\",\r\n        description: \"The political entity situated in the periphery of the world-system, navigating the imposition of external AI norms while asserting sovereignty.\",\r\n        quote: \"The state in the Global South is not merely a regulator but a site of contestation.\",\r\n        category: \"Actor\",\r\n        color: \"#93c5fd\",\r\n        x: 50, y: 150\r\n    },\r\n    {\r\n        id: \"3\",\r\n        label: \"Data Extractivism\",\r\n        description: \"The process of extracting data from human life and turning it into a resource for capital accumulation.\",\r\n        quote: \"Data is the new oil, but the extraction process leaves behind social pollution.\",\r\n        category: \"Mechanism\",\r\n        color: \"#d8b4fe\",\r\n        x: 400, y: 300\r\n    },\r\n    {\r\n        id: \"4\",\r\n        label: \"Fundamental Rights\",\r\n        description: \"The set of ethical and legal principles protected by frameworks like the EU AI Act, often framed as universal but historically situated.\",\r\n        quote: \"Rights are the language through which power is negotiated and contested.\",\r\n        category: \"Value\",\r\n        color: \"#86efac\",\r\n        x: 100, y: 300\r\n    },\r\n    {\r\n        id: \"5\",\r\n        label: \"Sociotechnical Assemblage\",\r\n        description: \"Complex arrangements of humans, machines, norms, and resources that constitute AI systems as loosely coupled, emergently structured entities.\",\r\n        quote: \"AI is not a thing, but an assemblage of social and technical relations that orchestrate value.\",\r\n        category: \"Core\",\r\n        color: \"#fca5a5\",\r\n        x: 250, y: 200\r\n    },\r\n] as OntologyNode[];\r\n\r\nconst STATIC_NETWORK_LINKS = [\r\n    { source: \"0\", target: \"1\", relation: \"informs\" },\r\n    { source: \"0\", target: \"2\", relation: \"constrains\" },\r\n    { source: \"0\", target: \"5\", relation: \"shapes\" },\r\n    { source: \"1\", target: \"3\", relation: \"enables\" },\r\n    { source: \"1\", target: \"5\", relation: \"structures\" },\r\n    { source: \"2\", target: \"4\", relation: \"protects\" },\r\n    { source: \"2\", target: \"5\", relation: \"regulates\" },\r\n    { source: \"3\", target: \"5\", relation: \"feeds\" },\r\n    { source: \"4\", target: \"5\", relation: \"embedded in\" },\r\n];\r\n\r\nexport default function OntologyPage() {\r\n    const { sources } = useSources();\r\n    const [selectedSourceId, setSelectedSourceId] = useServerStorage<string>(\"ontology_selected_source_id\", \"\");\r\n    const [isAnalyzing, setIsAnalyzing] = useState(false);\r\n    const [ontologyMaps, setOntologyMaps] = useServerStorage<Record<string, OntologyData>>(\"ontology_maps\", {});\r\n\r\n    // Comparison State\r\n    const [isComparing, setIsComparing] = useState(false);\r\n    const [selectedForComparison, setSelectedForComparison] = useState<string[]>([]);\r\n    const [comparisonResult, setComparisonResult] = useState<ComparisonResult | null>(null);\r\n    const [isComparingLoading, setIsComparingLoading] = useState(false);\r\n\r\n    // Interactivity State\r\n    const [selectedNodeId, setSelectedNodeId] = useServerStorage<string | null>(\"ontology_selected_node_id\", null);\r\n    const [selectedCategory, setSelectedCategory] = useState<string | null>(null);\r\n\r\n    // Filter sources that have text available for analysis\r\n    const analyzedSources = sources.filter(s => s.extractedText);\r\n\r\n    // Get the currently active map based on selectedSourceId\r\n    const currentOntologyData = (selectedSourceId && ontologyMaps && ontologyMaps[selectedSourceId])\r\n        ? ontologyMaps[selectedSourceId]\r\n        : null;\r\n\r\n    const handleGenerateOntology = async () => {\r\n        const source = analyzedSources.find(s => s.id === selectedSourceId);\r\n        if (!source || !source.extractedText) return;\r\n\r\n        setIsAnalyzing(true);\r\n        try {\r\n            const headers: HeadersInit = { 'Content-Type': 'application/json' };\r\n            if (process.env.NEXT_PUBLIC_ENABLE_DEMO_MODE === 'true' && process.env.NEXT_PUBLIC_DEMO_USER_ID) {\r\n                headers['x-demo-user-id'] = process.env.NEXT_PUBLIC_DEMO_USER_ID;\r\n            }\r\n\r\n            const response = await fetch('/api/analyze', {\r\n                method: 'POST',\r\n                headers: headers,\r\n                body: JSON.stringify({\r\n                    text: source.extractedText.substring(0, 3000), // Limit text length\r\n                    analysisMode: 'ontology',\r\n                    force: true // Force refresh to bypass cache\r\n                })\r\n            });\r\n\r\n            const data = await response.json();\r\n            if (data.success && data.analysis) {\r\n                // Process nodes to add coordinates and colors\r\n                const processedNodes = data.analysis.nodes.map((node: OntologyNode, index: number) => ({\r\n                    ...node,\r\n                    x: 300 + 200 * Math.cos(2 * Math.PI * index / data.analysis.nodes.length),\r\n                    y: 200 + 150 * Math.sin(2 * Math.PI * index / data.analysis.nodes.length),\r\n                    color: getColorForCategory(node.category)\r\n                }));\r\n\r\n                const newMap: OntologyData = {\r\n                    summary: data.analysis.summary,\r\n                    nodes: processedNodes,\r\n                    links: data.analysis.links\r\n                };\r\n\r\n                // Update the maps record\r\n                setOntologyMaps({\r\n                    ...ontologyMaps,\r\n                    [selectedSourceId]: newMap\r\n                });\r\n            } else {\r\n                alert(\"Analysis failed: \" + (data.error || \"Unknown error\"));\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Ontology generation error:\", error);\r\n            alert(\"Failed to generate ontology.\");\r\n        } finally {\r\n            setIsAnalyzing(false);\r\n        }\r\n    };\r\n\r\n    const handleCompareOntologies = async () => {\r\n        if (selectedForComparison.length !== 2) return;\r\n\r\n        const sourceAId = selectedForComparison[0];\r\n        const sourceBId = selectedForComparison[1];\r\n        const sourceA = sources.find(s => s.id === sourceAId);\r\n        const sourceB = sources.find(s => s.id === sourceBId);\r\n        const mapA = ontologyMaps?.[sourceAId];\r\n        const mapB = ontologyMaps?.[sourceBId];\r\n\r\n        if (!sourceA || !sourceB || !mapA || !mapB) return;\r\n\r\n        setIsComparingLoading(true);\r\n        setComparisonResult(null);\r\n\r\n        try {\r\n            const headers: HeadersInit = { 'Content-Type': 'application/json' };\r\n            if (process.env.NEXT_PUBLIC_ENABLE_DEMO_MODE === 'true' && process.env.NEXT_PUBLIC_DEMO_USER_ID) {\r\n                headers['x-demo-user-id'] = process.env.NEXT_PUBLIC_DEMO_USER_ID;\r\n            }\r\n\r\n            const response = await fetch('/api/analyze', {\r\n                method: 'POST',\r\n                headers: headers,\r\n                body: JSON.stringify({\r\n                    analysisMode: 'ontology_comparison',\r\n                    sourceA: { title: sourceA.title, data: mapA },\r\n                    sourceB: { title: sourceB.title, data: mapB },\r\n                    force: true\r\n                })\r\n            });\r\n\r\n            const data = await response.json();\r\n            if (data.success && data.analysis) {\r\n                setComparisonResult(data.analysis);\r\n            } else {\r\n                alert(\"Comparison failed: \" + (data.error || \"Unknown error\"));\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Comparison error:\", error);\r\n            alert(\"Failed to compare ontologies.\");\r\n        } finally {\r\n            setIsComparingLoading(false);\r\n        }\r\n    };\r\n\r\n    const toggleComparisonSelection = (sourceId: string) => {\r\n        if (selectedForComparison.includes(sourceId)) {\r\n            setSelectedForComparison(prev => prev.filter(id => id !== sourceId));\r\n        } else {\r\n            if (selectedForComparison.length < 2) {\r\n                setSelectedForComparison(prev => [...prev, sourceId]);\r\n            }\r\n        }\r\n    };\r\n\r\n    const handleNodeDrag = (nodeId: string, x: number, y: number) => {\r\n        if (selectedSourceId && currentOntologyData) {\r\n            const updatedNodes = currentOntologyData.nodes.map(node =>\r\n                node.id === nodeId ? { ...node, x, y } : node\r\n            );\r\n\r\n            setOntologyMaps({\r\n                ...ontologyMaps,\r\n                [selectedSourceId]: {\r\n                    ...currentOntologyData,\r\n                    nodes: updatedNodes\r\n                }\r\n            });\r\n        }\r\n    };\r\n\r\n    // Filtering Logic\r\n    const displayNodes = currentOntologyData\r\n        ? currentOntologyData.nodes.filter(n => !selectedCategory || n.category === selectedCategory)\r\n        : STATIC_CONCEPTS;\r\n\r\n    const displayLinks = currentOntologyData\r\n        ? currentOntologyData.links.filter(l => {\r\n            const sourceNode = currentOntologyData.nodes.find(n => n.id === l.source);\r\n            const targetNode = currentOntologyData.nodes.find(n => n.id === l.target);\r\n            if (selectedCategory) {\r\n                return sourceNode?.category === selectedCategory && targetNode?.category === selectedCategory;\r\n            }\r\n            return true;\r\n        })\r\n        : STATIC_NETWORK_LINKS;\r\n\r\n    const selectedNode = currentOntologyData\r\n        ? currentOntologyData.nodes.find(n => n.id === selectedNodeId)\r\n        : STATIC_CONCEPTS.find(n => n.id === selectedNodeId);\r\n\r\n    return (\r\n        <div className=\"space-y-8\">\r\n            <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-4\">\r\n                <div>\r\n                    <h2 className=\"text-3xl font-bold text-slate-900 flex items-center gap-2\">\r\n                        <Network className=\"h-8 w-8 text-indigo-600\" />\r\n                        Concept Network\r\n                    </h2>\r\n                    <div className=\"text-slate-500 mt-2 flex flex-wrap items-center gap-2 text-sm\">\r\n                        Visualizing the assemblage:\r\n                        <Badge variant=\"secondary\" className=\"bg-red-100 text-red-700 hover:bg-red-200 border-red-200 cursor-default\">Core</Badge>\r\n                        <Badge variant=\"secondary\" className=\"bg-purple-100 text-purple-700 hover:bg-purple-200 border-purple-200 cursor-default\">Mechanism</Badge>\r\n                        <Badge variant=\"secondary\" className=\"bg-blue-100 text-blue-700 hover:bg-blue-200 border-blue-200 cursor-default\">Actor</Badge>\r\n                        <Badge variant=\"secondary\" className=\"bg-green-100 text-green-700 hover:bg-green-200 border-green-200 cursor-default\">Value</Badge>\r\n                    </div>\r\n                </div>\r\n                <div className=\"flex items-center gap-3\">\r\n                    <Button\r\n                        variant={isComparing ? \"secondary\" : \"outline\"}\r\n                        onClick={() => {\r\n                            setIsComparing(!isComparing);\r\n                            setComparisonResult(null);\r\n                            setSelectedForComparison([]);\r\n                        }}\r\n                        className=\"gap-2\"\r\n                    >\r\n                        <ArrowRightLeft className=\"h-4 w-4\" />\r\n                        {isComparing ? \"Exit Comparison\" : \"Compare Maps\"}\r\n                    </Button>\r\n\r\n                    {!isComparing && (\r\n                        <>\r\n                            <Select value={selectedSourceId} onValueChange={setSelectedSourceId}>\r\n                                <SelectTrigger className=\"w-[280px]\">\r\n                                    <SelectValue placeholder=\"Select a source to analyze\" />\r\n                                </SelectTrigger>\r\n                                <SelectContent>\r\n                                    {analyzedSources.map((source) => (\r\n                                        <SelectItem key={source.id} value={source.id}>\r\n                                            {source.title}\r\n                                        </SelectItem>\r\n                                    ))}\r\n                                </SelectContent>\r\n                            </Select>\r\n                            <Button\r\n                                onClick={handleGenerateOntology}\r\n                                disabled={!selectedSourceId || isAnalyzing}\r\n                                className=\"bg-indigo-600 hover:bg-indigo-700 text-white\"\r\n                            >\r\n                                {isAnalyzing ? (\r\n                                    <>\r\n                                        <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\r\n                                        Analyzing...\r\n                                    </>\r\n                                ) : (\r\n                                    <>\r\n                                        <Sparkles className=\"mr-2 h-4 w-4\" />\r\n                                        Generate Map\r\n                                    </>\r\n                                )}\r\n                            </Button>\r\n                        </>\r\n                    )}\r\n                </div>\r\n            </div>\r\n\r\n            {/* Comparison Result View */}\r\n            {isComparing && comparisonResult && (\r\n                <ComparisonView result={comparisonResult} />\r\n            )}\r\n\r\n            {/* Main Visualization */}\r\n            {!isComparing && (\r\n                <>\r\n                    {currentOntologyData?.summary && (\r\n                        <Card className=\"bg-slate-50 border-indigo-100\">\r\n                            <CardContent className=\"pt-6\">\r\n                                <p className=\"text-slate-700 leading-relaxed\">\r\n                                    <span className=\"font-semibold text-indigo-700\">Analysis Summary: </span>\r\n                                    {currentOntologyData.summary}\r\n                                </p>\r\n                            </CardContent>\r\n                        </Card>\r\n                    )}\r\n\r\n                    <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\r\n                        <div className=\"lg:col-span-2 space-y-4\">\r\n                            <OntologyMap\r\n                                nodes={displayNodes}\r\n                                links={displayLinks}\r\n                                selectedCategory={selectedCategory}\r\n                                onSelectCategory={setSelectedCategory}\r\n                                selectedNodeId={selectedNodeId}\r\n                                onSelectNode={setSelectedNodeId}\r\n                                onNodeDrag={handleNodeDrag}\r\n                            />\r\n                        </div>\r\n\r\n                        <ConceptList\r\n                            nodes={displayNodes}\r\n                            selectedNodeId={selectedNodeId}\r\n                            onSelectNode={setSelectedNodeId}\r\n                        />\r\n                    </div>\r\n                </>\r\n            )}\r\n\r\n            <MapGallery\r\n                ontologyMaps={ontologyMaps}\r\n                sources={sources}\r\n                selectedSourceId={selectedSourceId}\r\n                onSelectSource={setSelectedSourceId}\r\n                isComparing={isComparing}\r\n                selectedForComparison={selectedForComparison}\r\n                onToggleComparisonSelection={toggleComparisonSelection}\r\n                onCompare={handleCompareOntologies}\r\n                isComparingLoading={isComparingLoading}\r\n            />\r\n\r\n            <ConceptDetailsModal\r\n                selectedNode={selectedNode || null}\r\n                isOpen={!!selectedNodeId}\r\n                onClose={() => setSelectedNodeId(null)}\r\n                isStatic={!currentOntologyData}\r\n            />\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Layers' is defined but never used.","line":23,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":23,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Library' is defined but never used.","line":31,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":31,"endColumn":10},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":468,"column":15,"nodeType":"JSXOpeningElement","endLine":472,"endColumn":17}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport Link from \"next/link\";\nimport { useUser } from \"@clerk/nextjs\";\nimport { Source } from \"@/types\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { useSources } from \"@/hooks/useSources\";\nimport {\n  Database,\n  BookOpen,\n  Scale,\n  Users,\n  Scan,\n  Network,\n  Lightbulb,\n  ArrowRight,\n  FileText,\n  Search,\n  Zap,\n  Activity,\n  Upload,\n  Layers,\n  Cpu,\n  GitGraph,\n  Shield,\n  Lock,\n  GraduationCap,\n  Building,\n  Play,\n  Library\n} from \"lucide-react\";\n\n// --- DASHBOARD DATA ---\nconst features = [\n  // Data Collection\n  {\n    name: \"Documents\",\n    href: \"/data\",\n    icon: Database,\n    description: \"Archive of primary policy texts (PDFs) and source materials\",\n    color: \"bg-blue-50 text-blue-700 border-blue-200\",\n    iconColor: \"text-blue-600\",\n  },\n  {\n    name: \"Empirical Data\",\n    href: \"/empirical\",\n    icon: Users,\n    description: \"Collect and organize empirical traces from web sources\",\n    color: \"bg-indigo-50 text-indigo-700 border-indigo-200\",\n    iconColor: \"text-indigo-600\",\n  },\n  // Micro Analysis\n  {\n    name: \"Resistance\",\n    href: \"/resistance\",\n    icon: Users,\n    description: \"Analyze micro-resistance strategies and counter-conduct\",\n    color: \"bg-red-50 text-red-700 border-red-200\",\n    iconColor: \"text-red-600\",\n  },\n  {\n    name: \"Critical Reflection\",\n    href: \"/reflexivity\",\n    icon: Scan,\n    description: \"Examine how your own perspective and context shape the analysis\",\n    color: \"bg-orange-50 text-orange-700 border-orange-200\",\n    iconColor: \"text-orange-600\",\n  },\n  // Meso Analysis\n  {\n    name: \"Ecosystem Analysis\",\n    href: \"/ecosystem\",\n    icon: Users,\n    description: \"Map actors, detect cultural holes, and visualize social networks\",\n    color: \"bg-emerald-50 text-emerald-700 border-emerald-200\",\n    iconColor: \"text-emerald-600\",\n  },\n  {\n    name: \"Cross-Case Analysis\",\n    href: \"/synthesis\",\n    icon: Network,\n    description: \"Cross-case analysis and AI-powered framework comparison\",\n    color: \"bg-teal-50 text-teal-700 border-teal-200\",\n    iconColor: \"text-teal-600\",\n  },\n  // Macro Analysis\n  {\n    name: \"Comparison\",\n    href: \"/comparison\",\n    icon: Scale,\n    description: \"Side-by-side comparison of governance frameworks\",\n    color: \"bg-cyan-50 text-cyan-700 border-cyan-200\",\n    iconColor: \"text-cyan-600\",\n  },\n  {\n    name: \"Governance\",\n    href: \"/governance\",\n    icon: Scale,\n    description: \"Analyze resource orchestration and institutional logics\",\n    color: \"bg-green-50 text-green-700 border-green-200\",\n    iconColor: \"text-green-600\",\n  },\n  {\n    name: \"Cultural Framing\",\n    href: \"/cultural\",\n    icon: Lightbulb,\n    description: \"Examine cultural framing and epistemic authority\",\n    color: \"bg-amber-50 text-amber-700 border-amber-200\",\n    iconColor: \"text-amber-600\",\n  },\n  {\n    name: \"Concept Network\",\n    href: \"/ontology\",\n    icon: BookOpen,\n    description: \"Visual map of key concepts and their relationships\",\n    color: \"bg-purple-50 text-purple-700 border-purple-200\",\n    iconColor: \"text-purple-600\",\n  },\n  {\n    name: \"Temporal Dynamics\",\n    href: \"/timeline\",\n    icon: Activity,\n    description: \"Track the evolution of governance concepts over time\",\n    color: \"bg-pink-50 text-pink-700 border-pink-200\",\n    iconColor: \"text-pink-600\",\n  },\n];\n\n// --- COMPONENTS ---\n\nfunction LandingPage() {\n  return (\n    <div className=\"flex flex-col min-h-screen bg-white\">\n      {/* Hero Section */}\n      <div className=\"relative isolate px-6 pt-14 lg:px-8 bg-slate-900 text-white overflow-hidden\">\n        {/* Background Image */}\n        <div\n          className=\"absolute inset-0 -z-20\"\n          style={{\n            backgroundImage: \"url('/landing-bg.png')\",\n            backgroundSize: \"cover\",\n            backgroundPosition: \"center\",\n            opacity: 0.4\n          }}\n        />\n        {/* Gradient Overlay */}\n        <div className=\"absolute inset-0 -z-10 bg-gradient-to-b from-slate-900/90 via-slate-900/80 to-slate-900 lg:from-slate-900/80 lg:via-slate-900/50\" />\n\n        <div className=\"absolute inset-x-0 -top-40 -z-10 transform-gpu overflow-hidden blur-3xl sm:-top-80\" aria-hidden=\"true\">\n          <div className=\"relative left-[calc(50%-11rem)] aspect-[1155/678] w-[36.125rem] -translate-x-1/2 rotate-[30deg] bg-gradient-to-tr from-[#ff80b5] to-[#9089fc] opacity-20 sm:left-[calc(50%-30rem)] sm:w-[72.1875rem]\" style={{ clipPath: 'polygon(74.1% 44.1%, 100% 61.6%, 97.5% 26.9%, 85.5% 0.1%, 80.7% 2%, 72.5% 32.5%, 60.2% 62.4%, 52.4% 68.1%, 47.5% 58.3%, 45.2% 34.5%, 27.5% 76.7%, 0.1% 64.9%, 17.9% 100%, 27.6% 76.8%, 76.1% 97.7%, 74.1% 44.1%)' }} />\n        </div>\n\n        {/* Abstract Data Grid Background */}\n        <div className=\"absolute inset-0 -z-10 bg-[linear-gradient(to_right,#80808012_1px,transparent_1px),linear-gradient(to_bottom,#80808012_1px,transparent_1px)] bg-[size:24px_24px]\"></div>\n\n        <div className=\"mx-auto max-w-2xl py-32 sm:py-48 lg:py-56 text-center\">\n          <div className=\"hidden sm:mb-8 sm:flex sm:justify-center\">\n            <div className=\"relative rounded-full px-3 py-1 text-sm leading-6 text-slate-300 ring-1 ring-white/10 hover:ring-white/20\">\n              Advanced Research Tool for Complex Systems\n            </div>\n          </div>\n          <h1 className=\"text-4xl font-bold tracking-tight text-white sm:text-6xl\">\n            Assemblage AI\n          </h1>\n          <p className=\"mt-6 text-lg leading-8 text-slate-200\">\n            <Link href=\"/glossary\" className=\"inline-flex items-center gap-2 px-4 py-1.5 rounded-full bg-white/5 border border-white/10 hover:bg-white/10 hover:border-blue-500/50 hover:scale-105 transition-all duration-300 group\">\n              <span className=\"text-slate-300 group-hover:text-white transition-colors\">What is</span>\n              <span className=\"text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-emerald-400 font-bold\">Assemblage AI</span>\n              <span className=\"text-slate-400 group-hover:text-blue-400 transition-colors\">?</span>\n            </Link>\n          </p>\n          <p className=\"mt-4 text-sm text-slate-300 max-w-2xl mx-auto leading-relaxed text-left\">\n            Assemblage-AI is a platform dedicated to analyzing and managing AI governance, policy frameworks, and structural dynamics. It offers tools for data collection, ecosystem mapping, and critical reflection to explore the complexities of AI systems. Key insights include the challenges of centralized governance, limited inclusivity, and the tension between civic values and market-driven innovation. With resources like critical glossaries and literature reviews, Assemblage-AI aims to foster responsible and equitable AI practices while addressing global regulatory and ethical challenges.\n          </p>\n          <div className=\"mt-10 flex items-center justify-center gap-x-6\">\n            <Link href=\"/demo\">\n              <Button size=\"lg\" className=\"bg-emerald-600 hover:bg-emerald-500 text-white border border-emerald-400/30 px-8 transition-all hover:scale-105 group shadow-lg shadow-emerald-900/20\">\n                <Activity className=\"mr-2 h-4 w-4 group-hover:animate-pulse\" />\n                Explore Analysis Output\n              </Button>\n            </Link>\n          </div>\n          <div className=\"mt-8 flex flex-col items-center justify-center gap-6\">\n            <Link href=\"/login\" className=\"text-sm font-semibold leading-6 text-white hover:text-blue-300\">\n              Log in to your account <span aria-hidden=\"true\"></span>\n            </Link>\n            <Link href=\"/sign-up\">\n              <Button size=\"lg\" className=\"bg-blue-600 hover:bg-blue-500 text-white font-semibold px-8\">\n                Get Started\n              </Button>\n            </Link>\n          </div>\n\n          {/* CSS-Based Dashboard Preview */}\n          <div className=\"mt-16 flow-root sm:mt-24\">\n            <div className=\"-m-2 rounded-xl bg-gray-900/5 p-2 ring-1 ring-inset ring-gray-900/10 lg:-m-4 lg:rounded-2xl lg:p-4\">\n              <div className=\"relative rounded-xl bg-slate-900/80 shadow-2xl ring-1 ring-white/10 backdrop-blur-md overflow-hidden group\">\n                {/* \n                  VIDEO EFFECT INSTRUCTION:\n                  To use a real video instead of the mock UI, uncomment the following video tag and remove the \"Mock UI Body\" div below.\n                  Ensure you have a file named 'demo.mp4' in your public folder.\n                */}\n                {\n                  <video\n                    controls\n                    playsInline\n                    className=\"w-full h-full object-cover opacity-90\"\n                  >\n                    <source src=\"/Sequence 01.mp4#t=0.001\" type=\"video/mp4\" />\n                  </video>\n                }\n\n                {/* Scanline/CRT Effect Overlay */}\n                <div className=\"absolute inset-0 pointer-events-none z-50 bg-[linear-gradient(rgba(18,16,16,0)_50%,rgba(0,0,0,0.25)_50%),linear-gradient(90deg,rgba(255,0,0,0.06),rgba(0,255,0,0.02),rgba(0,0,255,0.06))] bg-[length:100%_4px,3px_100%] bg-repeat opacity-20\"></div>\n                <div className=\"absolute inset-0 pointer-events-none z-50 bg-gradient-to-b from-white/5 to-transparent opacity-10\"></div>\n\n\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Global Coverage Section */}\n      <div className=\"bg-white py-10 border-b border-slate-100\">\n        <div className=\"mx-auto max-w-7xl px-6 lg:px-8\">\n          <p className=\"text-center text-sm font-semibold leading-8 text-slate-500 uppercase tracking-widest\">\n            Comparative Analysis of Major AI Regimes\n          </p>\n          <div className=\"mx-auto mt-8 grid max-w-lg grid-cols-4 items-center gap-x-8 gap-y-10 sm:max-w-xl sm:gap-x-10 sm:grid-cols-4 lg:mx-0 lg:max-w-none lg:grid-cols-4\">\n            <div className=\"col-span-1 flex flex-col items-center justify-center gap-2 group cursor-default\">\n              <span className=\"text-4xl filter grayscale group-hover:grayscale-0 transition-all duration-300 transform group-hover:scale-110\"></span>\n              <span className=\"text-xs font-bold text-slate-400 group-hover:text-blue-600 transition-colors\">EU AI Act</span>\n            </div>\n            <div className=\"col-span-1 flex flex-col items-center justify-center gap-2 group cursor-default\">\n              <span className=\"text-4xl filter grayscale group-hover:grayscale-0 transition-all duration-300 transform group-hover:scale-110\"></span>\n              <span className=\"text-xs font-bold text-slate-400 group-hover:text-blue-600 transition-colors\">US Executive Order</span>\n            </div>\n            <div className=\"col-span-1 flex flex-col items-center justify-center gap-2 group cursor-default\">\n              <span className=\"text-4xl filter grayscale group-hover:grayscale-0 transition-all duration-300 transform group-hover:scale-110\"></span>\n              <span className=\"text-xs font-bold text-slate-400 group-hover:text-blue-600 transition-colors\">China Interim Measures</span>\n            </div>\n            <div className=\"col-span-1 flex flex-col items-center justify-center gap-2 group cursor-default\">\n              <span className=\"text-4xl filter grayscale group-hover:grayscale-0 transition-all duration-300 transform group-hover:scale-110\"></span>\n              <span className=\"text-xs font-bold text-slate-400 group-hover:text-blue-600 transition-colors\">Brazil PL 2338</span>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div className=\"bg-white py-12 border-b border-slate-100\">\n        <div className=\"mx-auto max-w-7xl px-6 lg:px-8\">\n          <p className=\"text-center text-sm font-semibold leading-8 text-slate-500 uppercase tracking-widest\">\n            Powered by industry-leading technology\n          </p>\n          <div className=\"mx-auto mt-8 grid max-w-lg grid-cols-3 items-center gap-x-8 gap-y-10 sm:max-w-xl sm:gap-x-10 lg:mx-0 lg:max-w-none lg:grid-cols-3\">\n            {/* Google Logo */}\n            <div className=\"col-span-1 flex justify-center\">\n              <div className=\"flex items-center gap-2 grayscale hover:grayscale-0 transition-all duration-300 opacity-60 hover:opacity-100\">\n                <svg className=\"h-8 w-8\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n                  <path d=\"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z\" fill=\"#4285F4\" />\n                  <path d=\"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z\" fill=\"#34A853\" />\n                  <path d=\"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z\" fill=\"#FBBC05\" />\n                  <path d=\"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z\" fill=\"#EA4335\" />\n                </svg>\n                <span className=\"text-xl font-bold text-slate-600\">Google</span>\n              </div>\n            </div>\n\n            {/* OpenAI Logo */}\n            <div className=\"col-span-1 flex justify-center\">\n              <div className=\"flex items-center gap-2 grayscale hover:grayscale-0 transition-all duration-300 opacity-60 hover:opacity-100\">\n                <svg className=\"h-8 w-8 text-black\" viewBox=\"0 0 24 24\" fill=\"currentColor\" xmlns=\"http://www.w3.org/2000/svg\">\n                  <path d=\"M22.2819 9.8211a5.9847 5.9847 0 0 0-.5157-4.9108 6.0462 6.0462 0 0 0-6.5098-2.9A6.0651 6.0651 0 0 0 4.9807 4.1818a5.9847 5.9847 0 0 0-3.9977 2.9 6.0462 6.0462 0 0 0 .7427 7.0966 5.98 5.98 0 0 0 .511 4.9107 6.0462 6.0462 0 0 0 6.5146 2.9001A5.9847 5.9847 0 0 0 13.2599 24a6.0557 6.0557 0 0 0 5.7718-4.2058 5.9894 5.9894 0 0 0 3.9977-2.9001 6.0557 6.0557 0 0 0-.7475-7.0729zm-9.022 12.6081a4.4755 4.4755 0 0 1-2.8764-1.0408l.1419-.0804 4.7783-2.7582a.7948.7948 0 0 0 .3927-.6813v-6.7369l2.02 1.1686a.071.071 0 0 1 .038.052v5.5826a4.504 4.504 0 0 1-4.4945 4.4944zm-9.6607-4.1254a4.4708 4.4708 0 0 1-.5346-3.0137l.142.0852 4.783 2.7582a.7712.7712 0 0 0 .7806 0l5.8428-3.3685v2.3324a.0804.0804 0 0 1-.0332.0615L9.74 19.9502a4.4992 4.4992 0 0 1-6.1408-1.6464zM2.3408 7.8956a4.485 4.485 0 0 1 2.3655-1.9728V11.6a.7664.7664 0 0 0 .3879.6765l5.8144 3.3543-2.0201 1.1685a.0757.0757 0 0 1-.071 0l-4.8303-2.7865A4.504 4.504 0 0 1 2.3408 7.872zm16.5963 3.8558L13.1038 8.364 15.1195 7.2a.0757.0757 0 0 1 .071 0l4.8303 2.7913a4.4944 4.4944 0 0 1-.6765 8.1042v-5.6772a.79.79 0 0 0-.407-.667zm2.0107-3.0231l-.142-.0852-4.7735-2.7818a.7759.7759 0 0 0-.7854 0L9.409 9.2297V6.8974a.0662.0662 0 0 1 .0284-.0615l4.8303-2.7866a4.4992 4.4992 0 0 1 6.6802 4.66zM8.3065 12.863l-2.02-1.1638a.0804.0804 0 0 1-.038-.0567V6.0742a4.4992 4.4992 0 0 1 7.3757-3.4537l-.142.0805L8.704 5.459a.7948.7948 0 0 0-.3927.6813zm1.09-1.1088l2.9251-1.6923 2.9251 1.6923v3.3846l-2.9251 1.6923-2.9251-1.6923z\" />\n                </svg>\n                <span className=\"text-xl font-bold text-slate-600\">OpenAI</span>\n              </div>\n            </div>\n\n            {/* Redis Logo */}\n            <div className=\"col-span-1 flex justify-center\">\n              <div className=\"flex items-center gap-2 grayscale hover:grayscale-0 transition-all duration-300 opacity-60 hover:opacity-100\">\n                <svg className=\"h-8 w-8 text-red-600\" viewBox=\"0 0 24 24\" fill=\"currentColor\" xmlns=\"http://www.w3.org/2000/svg\">\n                  <path d=\"M20.4 3.6H3.6C1.6 3.6 0 5.2 0 7.2v9.6c0 2 1.6 3.6 3.6 3.6h16.8c2 0 3.6-1.6 3.6-3.6V7.2c0-2-1.6-3.6-3.6-3.6zm-12 12H4.8v-2.4h3.6v2.4zm0-4.8H4.8V8.4h3.6v2.4zm4.8 4.8H9.6v-2.4h3.6v2.4zm0-4.8H9.6V8.4h3.6v2.4zm4.8 4.8h-3.6v-2.4h3.6v2.4zm0-4.8h-3.6V8.4h3.6v2.4zm4.8 4.8h-3.6v-2.4h3.6v2.4zm0-4.8h-3.6V8.4h3.6v2.4z\" />\n                </svg>\n                <span className=\"text-xl font-bold text-slate-600\">Redis</span>\n              </div>\n            </div>\n\n            {/* Gemini Logo */}\n            <div className=\"col-span-1 flex justify-center\">\n              <div className=\"flex items-center gap-2 grayscale hover:grayscale-0 transition-all duration-300 opacity-60 hover:opacity-100\">\n                <svg className=\"h-8 w-8\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n                  <path d=\"M12 2L14.5 9.5L22 12L14.5 14.5L12 22L9.5 14.5L2 12L9.5 9.5L12 2Z\" fill=\"url(#gemini-gradient)\" />\n                  <defs>\n                    <linearGradient id=\"gemini-gradient\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\">\n                      <stop offset=\"0%\" stopColor=\"#4E85F7\" />\n                      <stop offset=\"100%\" stopColor=\"#D6669D\" />\n                    </linearGradient>\n                  </defs>\n                </svg>\n                <span className=\"text-xl font-bold text-slate-600\">Gemini</span>\n              </div>\n            </div>\n\n            {/* Next.js Logo */}\n            <div className=\"col-span-1 flex justify-center\">\n              <div className=\"flex items-center gap-2 grayscale hover:grayscale-0 transition-all duration-300 opacity-60 hover:opacity-100\">\n                <svg className=\"h-8 w-8\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n                  <path d=\"M12 2L2 19.7778H22L12 2Z\" fill=\"black\" className=\"fill-slate-900\" />\n                </svg>\n                <span className=\"text-xl font-bold text-slate-600\">Next.js</span>\n              </div>\n            </div>\n\n            {/* Grok Logo */}\n            <div className=\"col-span-1 flex justify-center\">\n              <div className=\"flex items-center gap-2 grayscale hover:grayscale-0 transition-all duration-300 opacity-60 hover:opacity-100\">\n                <svg className=\"h-8 w-8\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n                  <rect width=\"24\" height=\"24\" rx=\"4\" className=\"fill-slate-900\" />\n                  <path d=\"M6 18L18 6M18 6H10M18 6V14\" stroke=\"white\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" />\n                </svg>\n                <span className=\"text-xl font-bold text-slate-600\">Grok</span>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Value Proposition */}\n      <div className=\"py-24 sm:py-32 bg-slate-50\">\n        <div className=\"mx-auto max-w-7xl px-6 lg:px-8\">\n          <div className=\"mx-auto max-w-2xl lg:text-center\">\n            <h2 className=\"text-base font-semibold leading-7 text-blue-600\">Methodology</h2>\n            <p className=\"mt-2 text-3xl font-bold tracking-tight text-slate-900 sm:text-4xl\">\n              From Archive to Insight\n            </p>\n            <p className=\"mt-6 text-lg leading-8 text-slate-600\">\n              A systematic approach to analyzing complex textual datasets through multiple theoretical lenses.\n            </p>\n\n            {/* Video Panel */}\n            <div className=\"mt-12 w-full max-w-4xl mx-auto\">\n              <div className=\"bg-slate-900 rounded-xl border border-slate-800 overflow-hidden shadow-2xl\">\n                <div className=\"p-4 border-b border-slate-800 bg-slate-900/50\">\n                  <h3 className=\"text-white font-semibold flex items-center gap-2\">\n                    <div className=\"p-1 bg-indigo-500/20 rounded\">\n                      <Play className=\"h-4 w-4 text-indigo-400\" />\n                    </div>\n                    Introduction To Assemblage-AI\n                  </h3>\n                  <p className=\"text-sm text-slate-400 mt-1\">\n                    A video exploration of the need for Assemblage-AI.\n                  </p>\n                </div>\n                <div className=\"aspect-video w-full bg-black relative\">\n                  <video\n                    controls\n                    className=\"w-full h-full object-contain\"\n                    poster=\"/landing-bg.png\"\n                  >\n                    <source src=\"/assemblagebr.mp4\" type=\"video/mp4\" />\n                    Your browser does not support the video tag.\n                  </video>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div className=\"mx-auto mt-16 max-w-2xl sm:mt-20 lg:mt-24 lg:max-w-none\">\n            <dl className=\"grid max-w-xl grid-cols-1 gap-x-8 gap-y-16 lg:max-w-none lg:grid-cols-3\">\n              <div className=\"flex flex-col\">\n                <dt className=\"flex items-center gap-x-3 text-base font-semibold leading-7 text-slate-900\">\n                  <div className=\"h-10 w-10 flex items-center justify-center rounded-lg bg-blue-600\">\n                    <Database className=\"h-6 w-6 text-white\" aria-hidden=\"true\" />\n                  </div>\n                  Data Ingestion\n                </dt>\n                <dd className=\"mt-4 flex flex-auto flex-col text-base leading-7 text-slate-600\">\n                  <p className=\"flex-auto\">\n                    Upload PDFs, scrape web traces, and organize your primary sources. The system automatically extracts text and prepares it for analysis.\n                  </p>\n                </dd>\n              </div>\n              <div className=\"flex flex-col\">\n                <dt className=\"flex items-center gap-x-3 text-base font-semibold leading-7 text-slate-900\">\n                  <div className=\"h-10 w-10 flex items-center justify-center rounded-lg bg-indigo-600\">\n                    <Cpu className=\"h-6 w-6 text-white\" aria-hidden=\"true\" />\n                  </div>\n                  AI-Powered Analysis\n                </dt>\n                <dd className=\"mt-4 flex flex-auto flex-col text-base leading-7 text-slate-600\">\n                  <p className=\"flex-auto\">\n                    Apply specific theoretical lenses (Resistance, Cultural Framing, Institutional Logics) using advanced LLMs to extract structured insights.\n                  </p>\n                </dd>\n              </div>\n              <div className=\"flex flex-col\">\n                <dt className=\"flex items-center gap-x-3 text-base font-semibold leading-7 text-slate-900\">\n                  <div className=\"h-10 w-10 flex items-center justify-center rounded-lg bg-teal-600\">\n                    <GitGraph className=\"h-6 w-6 text-white\" aria-hidden=\"true\" />\n                  </div>\n                  Network Synthesis\n                </dt>\n                <dd className=\"mt-4 flex flex-auto flex-col text-base leading-7 text-slate-600\">\n                  <p className=\"flex-auto\">\n                    Visualize relationships between actors, concepts, and documents. Detect cultural holes and generate comparative reports.\n                  </p>\n                </dd>\n              </div>\n            </dl>\n          </div>\n        </div>\n      </div>\n\n      {/* Audience Section */}\n      <div className=\"py-24 sm:py-32 bg-white border-t border-slate-100\">\n        <div className=\"mx-auto max-w-7xl px-6 lg:px-8\">\n          <div className=\"mx-auto max-w-2xl lg:text-center mb-16\">\n            <h2 className=\"text-base font-semibold leading-7 text-indigo-600\">Community</h2>\n            <p className=\"mt-2 text-3xl font-bold tracking-tight text-slate-900 sm:text-4xl\">\n              Who uses Assemblage-AI?\n            </p>\n          </div>\n          <div className=\"mx-auto grid max-w-2xl grid-cols-1 gap-8 lg:max-w-none lg:grid-cols-3\">\n            <div className=\"flex flex-col items-start p-6 bg-slate-50 rounded-2xl\">\n              <div className=\"p-3 bg-blue-100 rounded-xl mb-4\">\n                <GraduationCap className=\"h-6 w-6 text-blue-600\" />\n              </div>\n              <h3 className=\"text-lg font-semibold text-slate-900 mb-2\">Academic Researchers</h3>\n              <p className=\"text-slate-600 leading-relaxed\">\n                Scholars in STS, Information Systems, and Law studying AI policy, algorithmic governance, and sociotechnical imaginaries.\n              </p>\n            </div>\n            <div className=\"flex flex-col items-start p-6 bg-slate-50 rounded-2xl\">\n              <div className=\"p-3 bg-indigo-100 rounded-xl mb-4\">\n                <Building className=\"h-6 w-6 text-indigo-600\" />\n              </div>\n              <h3 className=\"text-lg font-semibold text-slate-900 mb-2\">Policy Teams</h3>\n              <p className=\"text-slate-600 leading-relaxed\">\n                Regulators and analysts comparing global AI frameworks, tracking compliance logic, and identifying regulatory gaps.\n              </p>\n            </div>\n            <div className=\"flex flex-col items-start p-6 bg-slate-50 rounded-2xl\">\n              <div className=\"p-3 bg-teal-100 rounded-xl mb-4\">\n                <Users className=\"h-6 w-6 text-teal-600\" />\n              </div>\n              <h3 className=\"text-lg font-semibold text-slate-900 mb-2\">Advocates & NGOs</h3>\n              <p className=\"text-slate-600 leading-relaxed\">\n                Civil society organizations examining power dynamics, data justice, and the social impact of algorithmic systems.\n              </p>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Trust & Ethics Section */}\n      <div className=\"py-24 sm:py-32 bg-slate-900 text-slate-300\">\n        <div className=\"mx-auto max-w-7xl px-6 lg:px-8\">\n          <div className=\"mx-auto max-w-2xl lg:mx-0 flex flex-col lg:flex-row items-center gap-12\">\n            <div className=\"lg:w-1/2\">\n              <h2 className=\"text-3xl font-bold tracking-tight text-white sm:text-4xl\">Trust, Ethics & Privacy</h2>\n              <p className=\"mt-6 text-lg leading-8\">\n                Built for critical research with a commitment to data sovereignty and transparency.\n              </p>\n            </div>\n            <div className=\"lg:w-1/2 relative\">\n              <div className=\"absolute inset-0 bg-blue-500/20 blur-3xl rounded-full\"></div>\n              <img\n                src=\"/trust-ethics.png\"\n                alt=\"Digital Trust and Privacy\"\n                className=\"relative rounded-2xl shadow-2xl border border-white/10 w-full max-w-md mx-auto hover:scale-105 transition-transform duration-500\"\n              />\n            </div>\n          </div>\n          <div className=\"mx-auto mt-16 grid max-w-2xl grid-cols-1 gap-8 lg:mx-0 lg:max-w-none lg:grid-cols-2\">\n            <div className=\"flex flex-col\">\n              <dt className=\"flex items-center gap-x-3 text-base font-semibold leading-7 text-white\">\n                <Lock className=\"h-5 w-5 text-blue-400\" aria-hidden=\"true\" />\n                Data Handling & Privacy\n              </dt>\n              <dd className=\"mt-4 flex flex-auto flex-col text-base leading-7\">\n                <p className=\"flex-auto\">\n                  Uploaded documents are stored securely and are <strong>never used to train public AI models</strong>. You retain full ownership of your data. Files can be permanently deleted from our servers at any time.\n                </p>\n              </dd>\n            </div>\n            <div className=\"flex flex-col\">\n              <dt className=\"flex items-center gap-x-3 text-base font-semibold leading-7 text-white\">\n                <Shield className=\"h-5 w-5 text-blue-400\" aria-hidden=\"true\" />\n                Research Context\n              </dt>\n              <dd className=\"mt-4 flex flex-auto flex-col text-base leading-7\">\n                <p className=\"flex-auto\">\n                  Developed as part of academic research on using AI for critical analysis. This open-source tool is designed to reveal power structures, not reinforce them.\n                </p>\n              </dd>\n            </div>\n          </div>\n\n          {/* Privacy Badges */}\n          <div className=\"mt-16 pt-10 border-t border-white/10 flex flex-wrap justify-center gap-8 opacity-80\">\n            <div className=\"flex items-center gap-2 px-4 py-2 bg-white/5 rounded-full border border-white/10\">\n              <Shield className=\"h-4 w-4 text-emerald-400\" />\n              <span className=\"text-sm font-medium text-slate-300\">GDPR Ready</span>\n            </div>\n            <div className=\"flex items-center gap-2 px-4 py-2 bg-white/5 rounded-full border border-white/10\">\n              <Lock className=\"h-4 w-4 text-blue-400\" />\n              <span className=\"text-sm font-medium text-slate-300\">End-to-End Encrypted</span>\n            </div>\n            <div className=\"flex items-center gap-2 px-4 py-2 bg-white/5 rounded-full border border-white/10\">\n              <Database className=\"h-4 w-4 text-purple-400\" />\n              <span className=\"text-sm font-medium text-slate-300\">No Model Training</span>\n            </div>\n            <div className=\"flex items-center gap-2 px-4 py-2 bg-white/5 rounded-full border border-white/10\">\n              <GitGraph className=\"h-4 w-4 text-orange-400\" />\n              <span className=\"text-sm font-medium text-slate-300\">Open Source</span>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Footer */}\n      <footer className=\"bg-slate-950 text-slate-400 py-12 border-t border-slate-900\">\n        <div className=\"mx-auto max-w-7xl px-6 lg:px-8 grid grid-cols-1 md:grid-cols-4 gap-8\">\n          <div className=\"col-span-1 md:col-span-2\">\n            <div className=\"flex items-center gap-2 mb-4\">\n              <div className=\"h-8 w-8 bg-gradient-to-br from-blue-500 to-emerald-500 rounded-lg\"></div>\n              <span className=\"text-xl font-bold text-white\">Assemblage-AI</span>\n            </div>\n            <p className=\"text-sm leading-relaxed max-w-xs\">\n              An open-source platform for critical AI governance research, bridging the gap between policy intent and algorithmic reality.\n            </p>\n          </div>\n          <div>\n            <h4 className=\"text-white font-semibold mb-4\">Platform</h4>\n            <ul className=\"space-y-2 text-sm\">\n              <li><Link href=\"/data\" className=\"hover:text-blue-400 transition-colors\">Data Collection</Link></li>\n              <li><Link href=\"/ecosystem\" className=\"hover:text-blue-400 transition-colors\">Ecosystem Map</Link></li>\n              <li><Link href=\"/synthesis\" className=\"hover:text-blue-400 transition-colors\">Analysis Tools</Link></li>\n              <li><Link href=\"/demo\" className=\"hover:text-blue-400 transition-colors\">Live Demo</Link></li>\n            </ul>\n          </div>\n          <div>\n            <h4 className=\"text-white font-semibold mb-4\">Resources</h4>\n            <ul className=\"space-y-2 text-sm\">\n              <li><Link href=\"#\" className=\"hover:text-blue-400 transition-colors\">Documentation</Link></li>\n              <li><Link href=\"#\" className=\"hover:text-blue-400 transition-colors\">GitHub Repository</Link></li>\n              <li><Link href=\"#\" className=\"hover:text-blue-400 transition-colors\">Privacy Policy</Link></li>\n              <li><Link href=\"#\" className=\"hover:text-blue-400 transition-colors\">Contact</Link></li>\n            </ul>\n          </div>\n        </div>\n        <div className=\"mx-auto max-w-7xl px-6 lg:px-8 mt-12 pt-8 border-t border-slate-900 text-xs text-center\">\n          &copy; {new Date().getFullYear()} Assemblage-AI Research Group. Open Source (MIT License).\n        </div>\n      </footer>\n    </div>\n  );\n}\n\n// ...\n\nfunction Dashboard({ sources }: { sources: Source[] }) {\n  const docCount = sources.filter(s => s.type !== 'Trace').length;\n  const traceCount = sources.filter(s => s.type === 'Trace').length;\n  const analyzedCount = sources.filter(s => s.analysis || s.cultural_framing || s.institutional_logics).length;\n\n  return (\n    <div className=\"space-y-8\">\n      {/* Dashboard Header */}\n      <div className=\"bg-white p-6 rounded-xl border border-slate-200 shadow-sm\">\n        <h2 className=\"text-2xl font-bold tracking-tight text-slate-900\">\n          Assemblage Dashboard\n        </h2>\n        <p className=\"text-slate-500 mt-1\">\n          Welcome back. Continue your critical analysis of complex narratives.\n        </p>\n      </div>\n\n      {/* Metric Cards */}\n      <div className=\"grid gap-4 md:grid-cols-3\">\n        <Card className=\"bg-gradient-to-br from-blue-50 to-white border-blue-100\">\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium text-blue-900\">\n              Documents\n            </CardTitle>\n            <div className=\"h-8 w-8 rounded-full bg-blue-100 flex items-center justify-center\">\n              <FileText className=\"h-4 w-4 text-blue-600\" />\n            </div>\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-3xl font-bold text-blue-900\">{docCount}</div>\n            <p className=\"text-xs text-blue-600 mt-1 font-medium\">\n              Primary policy texts\n            </p>\n          </CardContent>\n        </Card>\n        <Card className=\"bg-gradient-to-br from-indigo-50 to-white border-indigo-100\">\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium text-indigo-900\">\n              Empirical Traces\n            </CardTitle>\n            <div className=\"h-8 w-8 rounded-full bg-indigo-100 flex items-center justify-center\">\n              <Search className=\"h-4 w-4 text-indigo-600\" />\n            </div>\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-3xl font-bold text-indigo-900\">{traceCount}</div>\n            <p className=\"text-xs text-indigo-600 mt-1 font-medium\">\n              Collected from web sources\n            </p>\n          </CardContent>\n        </Card>\n        <Card className=\"bg-gradient-to-br from-emerald-50 to-white border-emerald-100\">\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium text-emerald-900\">\n              Analyzed Sources\n            </CardTitle>\n            <div className=\"h-8 w-8 rounded-full bg-emerald-100 flex items-center justify-center\">\n              <Activity className=\"h-4 w-4 text-emerald-600\" />\n            </div>\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-3xl font-bold text-emerald-900\">{analyzedCount}</div>\n            <p className=\"text-xs text-emerald-600 mt-1 font-medium\">\n              Processed with AI lenses\n            </p>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Quick Actions */}\n      <div>\n        <h3 className=\"text-lg font-semibold text-slate-900 mb-4\">Quick Actions</h3>\n        <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-4\">\n          <Link href=\"/data\">\n            <div className=\"group relative flex flex-col items-center justify-center p-6 bg-white border-2 border-dashed border-slate-200 rounded-xl hover:border-blue-500 hover:bg-blue-50/50 transition-all duration-200 cursor-pointer\">\n              <div className=\"h-12 w-12 rounded-full bg-blue-100 flex items-center justify-center mb-3 group-hover:scale-110 transition-transform duration-200\">\n                <Upload className=\"h-6 w-6 text-blue-600\" />\n              </div>\n              <span className=\"font-semibold text-slate-900 group-hover:text-blue-700\">Upload Document</span>\n              <span className=\"text-xs text-slate-500 mt-1\">Add new PDF policy text</span>\n            </div>\n          </Link>\n          <Link href=\"/empirical\">\n            <div className=\"group relative flex flex-col items-center justify-center p-6 bg-white border-2 border-dashed border-slate-200 rounded-xl hover:border-indigo-500 hover:bg-indigo-50/50 transition-all duration-200 cursor-pointer\">\n              <div className=\"h-12 w-12 rounded-full bg-indigo-100 flex items-center justify-center mb-3 group-hover:scale-110 transition-transform duration-200\">\n                <Search className=\"h-6 w-6 text-indigo-600\" />\n              </div>\n              <span className=\"font-semibold text-slate-900 group-hover:text-indigo-700\">Find Traces</span>\n              <span className=\"text-xs text-slate-500 mt-1\">Search web for evidence</span>\n            </div>\n          </Link>\n          <Link href=\"/comparison\">\n            <div className=\"group relative flex flex-col items-center justify-center p-6 bg-white border-2 border-dashed border-slate-200 rounded-xl hover:border-cyan-500 hover:bg-cyan-50/50 transition-all duration-200 cursor-pointer\">\n              <div className=\"h-12 w-12 rounded-full bg-cyan-100 flex items-center justify-center mb-3 group-hover:scale-110 transition-transform duration-200\">\n                <Scale className=\"h-6 w-6 text-cyan-600\" />\n              </div>\n              <span className=\"font-semibold text-slate-900 group-hover:text-cyan-700\">Compare Frameworks</span>\n              <span className=\"text-xs text-slate-500 mt-1\">Side-by-side analysis</span>\n            </div>\n          </Link>\n          <Link href=\"/synthesis\">\n            <div className=\"group relative flex flex-col items-center justify-center p-6 bg-white border-2 border-dashed border-slate-200 rounded-xl hover:border-teal-500 hover:bg-teal-50/50 transition-all duration-200 cursor-pointer\">\n              <div className=\"h-12 w-12 rounded-full bg-teal-100 flex items-center justify-center mb-3 group-hover:scale-110 transition-transform duration-200\">\n                <Zap className=\"h-6 w-6 text-teal-600\" />\n              </div>\n              <span className=\"font-semibold text-slate-900 group-hover:text-teal-700\">Generate Report</span>\n              <span className=\"text-xs text-slate-500 mt-1\">Create synthesis PDF</span>\n            </div>\n          </Link>\n        </div>\n      </div>\n\n      {/* Features Grid */}\n      <div>\n        <h3 className=\"text-xl font-semibold text-slate-900 mb-4\">Research Tools</h3>\n        <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-3\">\n          {features.map((feature) => {\n            const Icon = feature.icon;\n            return (\n              <Link key={feature.name} href={feature.href}>\n                <Card className={`${feature.color} border-2 hover:shadow-lg transition-all cursor-pointer group animate-in fade-in slide-in-from-bottom-8 duration-1000 fill-mode-both`}>\n                  <CardHeader>\n                    <div className=\"flex items-start justify-between\">\n                      <div className=\"flex items-center gap-3\">\n                        <div className=\"p-2 bg-white rounded-lg\">\n                          <Icon className={`h-5 w-5 ${feature.iconColor}`} />\n                        </div>\n                        <CardTitle className=\"text-base\">{feature.name}</CardTitle>\n                      </div>\n                    </div>\n                    <CardDescription className=\"text-sm mt-2\">\n                      {feature.description}\n                    </CardDescription>\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"flex items-center text-sm font-medium group-hover:translate-x-1 transition-transform\">\n                      Open tool\n                      <ArrowRight className=\"ml-2 h-4 w-4\" />\n                    </div>\n                  </CardContent>\n                </Card>\n              </Link>\n            );\n          })}\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default function Home() {\n  const { isLoaded, isSignedIn } = useUser();\n  const { sources } = useSources();\n\n  if (!isLoaded) {\n    return <div className=\"flex items-center justify-center h-screen\">Loading...</div>;\n  }\n\n  if (!isSignedIn) {\n    // Bypass login if demo mode is enabled\n    // if (process.env.NEXT_PUBLIC_ENABLE_DEMO_MODE === \"true\") {\n    //   return <Dashboard sources={sources} />;\n    // }\n    return <LandingPage />;\n  }\n\n  return <Dashboard sources={sources} />;\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\reflexivity\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Badge' is defined but never used.","line":9,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":9,"endColumn":15},{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`fetchLogs` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\nC:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\reflexivity\\page.tsx:27:9\n  25 |\n  26 |     useEffect(() => {\n> 27 |         fetchLogs();\n     |         ^^^^^^^^^ `fetchLogs` accessed before it is declared\n  28 |     }, []);\n  29 |\n  30 |     const fetchLogs = async () => {\n\nC:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\reflexivity\\page.tsx:30:5\n  28 |     }, []);\n  29 |\n> 30 |     const fetchLogs = async () => {\n     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 31 |         try {\n     | ^^^^^^^^^^^^^\n> 32 |             const headers: HeadersInit = { 'Content-Type': 'application/json' };\n     \n     | ^^^^^^^^^^^^^\n> 44 |         }\n     | ^^^^^^^^^^^^^\n> 45 |     };\n     | ^^^^^^^ `fetchLogs` is declared here\n  46 |\n  47 |     const handleSave = () => {\n  48 |         setSaveStatus(\"saving\");","line":27,"column":9,"nodeType":null,"endLine":27,"endColumn":18},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":114,"column":25,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[5336,5546],"text":"\r\n                        &quot;To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical' but 'decolonial'.\"  Walter Mignolo\r\n                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[5336,5546],"text":"\r\n                        &ldquo;To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical' but 'decolonial'.\"  Walter Mignolo\r\n                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[5336,5546],"text":"\r\n                        &#34;To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical' but 'decolonial'.\"  Walter Mignolo\r\n                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[5336,5546],"text":"\r\n                        &rdquo;To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical' but 'decolonial'.\"  Walter Mignolo\r\n                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":114,"column":141,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[5336,5546],"text":"\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just &apos;critical' but 'decolonial'.\"  Walter Mignolo\r\n                    "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[5336,5546],"text":"\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just &lsquo;critical' but 'decolonial'.\"  Walter Mignolo\r\n                    "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[5336,5546],"text":"\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just &#39;critical' but 'decolonial'.\"  Walter Mignolo\r\n                    "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[5336,5546],"text":"\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just &rsquo;critical' but 'decolonial'.\"  Walter Mignolo\r\n                    "},"desc":"Replace with `&rsquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":114,"column":150,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[5336,5546],"text":"\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical&apos; but 'decolonial'.\"  Walter Mignolo\r\n                    "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[5336,5546],"text":"\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical&lsquo; but 'decolonial'.\"  Walter Mignolo\r\n                    "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[5336,5546],"text":"\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical&#39; but 'decolonial'.\"  Walter Mignolo\r\n                    "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[5336,5546],"text":"\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical&rsquo; but 'decolonial'.\"  Walter Mignolo\r\n                    "},"desc":"Replace with `&rsquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":114,"column":156,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[5336,5546],"text":"\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical' but &apos;decolonial'.\"  Walter Mignolo\r\n                    "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[5336,5546],"text":"\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical' but &lsquo;decolonial'.\"  Walter Mignolo\r\n                    "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[5336,5546],"text":"\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical' but &#39;decolonial'.\"  Walter Mignolo\r\n                    "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[5336,5546],"text":"\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical' but &rsquo;decolonial'.\"  Walter Mignolo\r\n                    "},"desc":"Replace with `&rsquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":114,"column":167,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[5336,5546],"text":"\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical' but 'decolonial&apos;.\"  Walter Mignolo\r\n                    "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[5336,5546],"text":"\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical' but 'decolonial&lsquo;.\"  Walter Mignolo\r\n                    "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[5336,5546],"text":"\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical' but 'decolonial&#39;.\"  Walter Mignolo\r\n                    "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[5336,5546],"text":"\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical' but 'decolonial&rsquo;.\"  Walter Mignolo\r\n                    "},"desc":"Replace with `&rsquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":114,"column":169,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[5336,5546],"text":"\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical' but 'decolonial'.&quot;  Walter Mignolo\r\n                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[5336,5546],"text":"\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical' but 'decolonial'.&ldquo;  Walter Mignolo\r\n                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[5336,5546],"text":"\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical' but 'decolonial'.&#34;  Walter Mignolo\r\n                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[5336,5546],"text":"\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical' but 'decolonial'.&rdquo;  Walter Mignolo\r\n                    "},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":7,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport { useServerStorage } from \"@/hooks/useServerStorage\";\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Textarea } from \"@/components/ui/textarea\";\r\nimport { BookOpen, Save, UserCircle, History } from \"lucide-react\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { LogEntry } from \"@/components/reflexivity/LogEntry\";\r\nimport { MethodLog } from \"@/types/logs\";\r\n\r\nconst GUIDING_QUESTIONS = [\r\n    \"How does my location in the Global North/South affect my reading of these texts?\",\r\n    \"What assumptions am I making about 'universal' AI ethics?\",\r\n    \"Whose voices are missing from the documents I am analyzing?\",\r\n    \"How does my own disciplinary background shape my interpretation of 'risk' and 'harm'?\",\r\n];\r\n\r\n\r\nexport default function ReflexivityPage() {\r\n    const [journalEntry, setJournalEntry] = useServerStorage(\"research-journal\", \"\");\r\n    const [saveStatus, setSaveStatus] = useState<\"saved\" | \"saving\" | null>(null);\r\n    const [logs, setLogs] = useState<MethodLog[]>([]);\r\n\r\n    useEffect(() => {\r\n        fetchLogs();\r\n    }, []);\r\n\r\n    const fetchLogs = async () => {\r\n        try {\r\n            const headers: HeadersInit = { 'Content-Type': 'application/json' };\r\n            if (process.env.NEXT_PUBLIC_ENABLE_DEMO_MODE === 'true' && process.env.NEXT_PUBLIC_DEMO_USER_ID) {\r\n                headers['x-demo-user-id'] = process.env.NEXT_PUBLIC_DEMO_USER_ID;\r\n            }\r\n\r\n            const res = await fetch('/api/logs', { headers });\r\n            if (res.ok) {\r\n                const data = await res.json();\r\n                setLogs(data);\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Failed to fetch logs\", error);\r\n        }\r\n    };\r\n\r\n    const handleSave = () => {\r\n        setSaveStatus(\"saving\");\r\n        // The data is already saved via useLocalStorage, just show feedback\r\n        setTimeout(() => {\r\n            setSaveStatus(\"saved\");\r\n            setTimeout(() => setSaveStatus(null), 2000);\r\n        }, 300);\r\n    };\r\n\r\n    return (\r\n        <div className=\"space-y-8\">\r\n            <div>\r\n                <h2 className=\"text-3xl font-bold tracking-tight text-slate-900\">Critical Reflection</h2>\r\n                <p className=\"text-slate-500\">Documenting epistemic location and engaging with positionality.</p>\r\n            </div>\r\n\r\n\r\n            <div className=\"grid gap-6 md:grid-cols-2\">\r\n                <div className=\"space-y-6\">\r\n                    <Card>\r\n                        <CardHeader>\r\n                            <div className=\"flex items-center space-x-2\">\r\n                                <UserCircle className=\"h-5 w-5 text-slate-600\" />\r\n                                <CardTitle className=\"text-lg\">Guiding Questions</CardTitle>\r\n                            </div>\r\n                            <CardDescription>\r\n                                Prompts to consider during your analysis.\r\n                            </CardDescription>\r\n                        </CardHeader>\r\n                        <CardContent>\r\n                            <ul className=\"space-y-4\">\r\n                                {GUIDING_QUESTIONS.map((question, index) => (\r\n                                    <li key={index} className=\"flex items-start space-x-3 text-sm text-slate-700\">\r\n                                        <span className=\"flex h-6 w-6 shrink-0 items-center justify-center rounded-full bg-slate-100 text-xs font-medium text-slate-600\">\r\n                                            {index + 1}\r\n                                        </span>\r\n                                        <span className=\"pt-0.5\">{question}</span>\r\n                                    </li>\r\n                                ))}\r\n                            </ul>\r\n                        </CardContent>\r\n                    </Card>\r\n\r\n                    <Card>\r\n                        <CardHeader>\r\n                            <div className=\"flex items-center space-x-2\">\r\n                                <History className=\"h-5 w-5 text-slate-600\" />\r\n                                <CardTitle className=\"text-lg\">Methodological Log</CardTitle>\r\n                            </div>\r\n                            <CardDescription>\r\n                                Automated log of analysis actions and lenses applied.\r\n                            </CardDescription>\r\n                        </CardHeader>\r\n                        <CardContent>\r\n                            <div className=\"space-y-4 max-h-[400px] overflow-y-auto pr-2\">\r\n                                {logs.length === 0 ? (\r\n                                    <p className=\"text-sm text-slate-500 italic\">No actions logged yet.</p>\r\n                                ) : (\r\n                                    logs.map((log) => (\r\n                                        <LogEntry key={log.id} log={log} />\r\n                                    ))\r\n                                )}\r\n                            </div>\r\n                        </CardContent>\r\n                    </Card>\r\n\r\n                    <div className=\"bg-slate-50 p-4 rounded-lg border border-slate-200 text-sm text-slate-600 italic\">\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical' but 'decolonial'.\"  Walter Mignolo\r\n                    </div>\r\n                </div>\r\n\r\n                <Card className=\"flex flex-col h-full\">\r\n                    <CardHeader>\r\n                        <div className=\"flex items-center space-x-2\">\r\n                            <BookOpen className=\"h-5 w-5 text-slate-600\" />\r\n                            <CardTitle className=\"text-lg\">Research Journal</CardTitle>\r\n                        </div>\r\n                        <CardDescription>\r\n                            Record your thoughts, biases, and shifts in perspective.\r\n                        </CardDescription>\r\n                    </CardHeader>\r\n                    <CardContent className=\"flex-1 flex flex-col space-y-4\">\r\n                        <Textarea\r\n                            placeholder=\"Start writing your reflections here...\"\r\n                            className=\"flex-1 min-h-[300px] resize-none p-4 leading-relaxed text-slate-900\"\r\n                            value={journalEntry}\r\n                            onChange={(e) => setJournalEntry(e.target.value)}\r\n                        />\r\n                        <div className=\"flex justify-end\">\r\n                            <Button\r\n                                onClick={handleSave}\r\n                                className=\"bg-slate-900 text-white hover:bg-slate-800\"\r\n                                disabled={saveStatus === \"saving\"}\r\n                            >\r\n                                <Save className=\"mr-2 h-4 w-4\" />\r\n                                {saveStatus === \"saving\" ? \"Saving...\" : saveStatus === \"saved\" ? \"Saved!\" : \"Save Entry\"}\r\n                            </Button>\r\n                        </div>\r\n                    </CardContent>\r\n                </Card>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\resistance\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Input' is defined but never used.","line":11,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":11,"endColumn":15},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":163,"column":60,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":163,"endColumn":63,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7464,7467],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7464,7467],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":341,"column":83,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":341,"endColumn":86,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[17398,17401],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[17398,17401],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":375,"column":77,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[19394,19559],"text":"\r\n                                    No traces found. Go to Data page to add &quot;Empirical Trace\" sources or use \"Search for Traces\".\r\n                                "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[19394,19559],"text":"\r\n                                    No traces found. Go to Data page to add &ldquo;Empirical Trace\" sources or use \"Search for Traces\".\r\n                                "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[19394,19559],"text":"\r\n                                    No traces found. Go to Data page to add &#34;Empirical Trace\" sources or use \"Search for Traces\".\r\n                                "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[19394,19559],"text":"\r\n                                    No traces found. Go to Data page to add &rdquo;Empirical Trace\" sources or use \"Search for Traces\".\r\n                                "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":375,"column":93,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[19394,19559],"text":"\r\n                                    No traces found. Go to Data page to add \"Empirical Trace&quot; sources or use \"Search for Traces\".\r\n                                "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[19394,19559],"text":"\r\n                                    No traces found. Go to Data page to add \"Empirical Trace&ldquo; sources or use \"Search for Traces\".\r\n                                "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[19394,19559],"text":"\r\n                                    No traces found. Go to Data page to add \"Empirical Trace&#34; sources or use \"Search for Traces\".\r\n                                "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[19394,19559],"text":"\r\n                                    No traces found. Go to Data page to add \"Empirical Trace&rdquo; sources or use \"Search for Traces\".\r\n                                "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":375,"column":110,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[19394,19559],"text":"\r\n                                    No traces found. Go to Data page to add \"Empirical Trace\" sources or use &quot;Search for Traces\".\r\n                                "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[19394,19559],"text":"\r\n                                    No traces found. Go to Data page to add \"Empirical Trace\" sources or use &ldquo;Search for Traces\".\r\n                                "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[19394,19559],"text":"\r\n                                    No traces found. Go to Data page to add \"Empirical Trace\" sources or use &#34;Search for Traces\".\r\n                                "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[19394,19559],"text":"\r\n                                    No traces found. Go to Data page to add \"Empirical Trace\" sources or use &rdquo;Search for Traces\".\r\n                                "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":375,"column":128,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[19394,19559],"text":"\r\n                                    No traces found. Go to Data page to add \"Empirical Trace\" sources or use \"Search for Traces&quot;.\r\n                                "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[19394,19559],"text":"\r\n                                    No traces found. Go to Data page to add \"Empirical Trace\" sources or use \"Search for Traces&ldquo;.\r\n                                "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[19394,19559],"text":"\r\n                                    No traces found. Go to Data page to add \"Empirical Trace\" sources or use \"Search for Traces&#34;.\r\n                                "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[19394,19559],"text":"\r\n                                    No traces found. Go to Data page to add \"Empirical Trace\" sources or use \"Search for Traces&rdquo;.\r\n                                "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":455,"column":53,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[24941,24996],"text":"\r\n                                                    &quot;"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[24941,24996],"text":"\r\n                                                    &ldquo;"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[24941,24996],"text":"\r\n                                                    &#34;"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[24941,24996],"text":"\r\n                                                    &rdquo;"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":455,"column":86,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[25028,25079],"text":"&quot;\r\n                                                "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[25028,25079],"text":"&ldquo;\r\n                                                "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[25028,25079],"text":"&#34;\r\n                                                "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[25028,25079],"text":"&rdquo;\r\n                                                "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":468,"column":55,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[25827,25898],"text":"Select &quot;Analyze Trace\" to identify resistance strategies using the LLM."},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[25827,25898],"text":"Select &ldquo;Analyze Trace\" to identify resistance strategies using the LLM."},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[25827,25898],"text":"Select &#34;Analyze Trace\" to identify resistance strategies using the LLM."},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[25827,25898],"text":"Select &rdquo;Analyze Trace\" to identify resistance strategies using the LLM."},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":468,"column":69,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[25827,25898],"text":"Select \"Analyze Trace&quot; to identify resistance strategies using the LLM."},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[25827,25898],"text":"Select \"Analyze Trace&ldquo; to identify resistance strategies using the LLM."},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[25827,25898],"text":"Select \"Analyze Trace&#34; to identify resistance strategies using the LLM."},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[25827,25898],"text":"Select \"Analyze Trace&rdquo; to identify resistance strategies using the LLM."},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":10,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState } from \"react\";\r\nimport { toast } from \"sonner\";\r\nimport { useServerStorage } from \"@/hooks/useServerStorage\";\r\nimport { useSources } from \"@/hooks/useSources\";\r\nimport { Source } from \"@/types\";\r\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Zap, EyeOff, Activity, Wrench, Users, Play, Loader2, Quote, Search, Trash } from \"lucide-react\";\r\nimport {\r\n    Dialog,\r\n    DialogContent,\r\n    DialogDescription,\r\n    DialogFooter,\r\n    DialogHeader,\r\n    DialogTitle,\r\n    DialogTrigger,\r\n} from \"@/components/ui/dialog\";\r\n\r\nconst STRATEGY_DEFINITIONS = [\r\n    { title: \"Gambiarra\", icon: Wrench, color: \"text-orange-600\", bg: \"bg-orange-100\" },\r\n    { title: \"Obfuscation\", icon: EyeOff, color: \"text-slate-600\", bg: \"bg-slate-100\" },\r\n    { title: \"Solidarity\", icon: Users, color: \"text-green-600\", bg: \"bg-green-100\" },\r\n    { title: \"Refusal\", icon: Zap, color: \"text-red-600\", bg: \"bg-red-100\" },\r\n];\r\n\r\nexport default function ResistancePage() {\r\n    const { sources, addSource, updateSource, deleteSource, isLoading } = useSources();\r\n    const [selectedTraceId, setSelectedTraceId] = useServerStorage<string | null>(\"resistance_selected_trace_id\", null);\r\n    const [isAnalyzing, setIsAnalyzing] = useState(false);\r\n\r\n    // Filter for sources that are explicitly marked as 'Trace' or have text content\r\n    const traces = sources.filter(s => s.type === 'Trace' || (s.type === 'Text' && s.extractedText));\r\n\r\n    const handleAnalyzeTrace = async (trace: Source) => {\r\n        if (!trace.extractedText) return;\r\n\r\n        setIsAnalyzing(true);\r\n        try {\r\n            const headers: HeadersInit = { 'Content-Type': 'application/json' };\r\n            if (process.env.NEXT_PUBLIC_ENABLE_DEMO_MODE === 'true' && process.env.NEXT_PUBLIC_DEMO_USER_ID) {\r\n                headers['x-demo-user-id'] = process.env.NEXT_PUBLIC_DEMO_USER_ID;\r\n            }\r\n\r\n            const response = await fetch('/api/analyze', {\r\n                method: 'POST',\r\n                headers: headers,\r\n                body: JSON.stringify({\r\n                    text: trace.extractedText.substring(0, 3000),\r\n                    sourceType: 'Empirical Trace',\r\n                    analysisMode: 'resistance'\r\n                })\r\n            });\r\n\r\n            const result = await response.json();\r\n            if (result.success) {\r\n                await updateSource(trace.id, { resistance_analysis: result.analysis });\r\n                toast.success(\"Trace analyzed successfully!\");\r\n            } else {\r\n                if (response.status === 429 || result.error === \"Quota Exceeded\") {\r\n                    toast.error(\"Quota Exceeded\", {\r\n                        description: \"You have reached your lifetime API limit. Please contact admin.\",\r\n                        duration: 5000,\r\n                    });\r\n                } else {\r\n                    toast.error(\"Analysis failed\", { description: result.error });\r\n                }\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Analysis failed\", error);\r\n            toast.error(\"Failed to analyze trace.\");\r\n        } finally {\r\n            setIsAnalyzing(false);\r\n        }\r\n    };\r\n\r\n    const selectedTrace = traces.find(t => t.id === selectedTraceId);\r\n    const currentAnalysis = selectedTrace?.resistance_analysis;\r\n\r\n    const [isSearching, setIsSearching] = useState(false);\r\n    const [isSearchDialogOpen, setIsSearchDialogOpen] = useState(false);\r\n    const [searchSource, setSearchSource] = useState<Source | null>(null);\r\n    const [customQuery, setCustomQuery] = useServerStorage<string>(\"resistance_custom_query\", \"\");\r\n    const [selectedPlatforms, setSelectedPlatforms] = useServerStorage<string[]>(\"resistance_selected_platforms\", [\"reddit\", \"hackernews\", \"forums\"]);\r\n\r\n    const handleSearchTraces = async () => {\r\n        // Need either a policy source or custom query\r\n        if (!searchSource?.extractedText && !customQuery.trim()) {\r\n            alert(\"Please select a policy or enter a custom search query.\");\r\n            return;\r\n        }\r\n\r\n        setIsSearching(true);\r\n        try {\r\n            const headers: HeadersInit = { 'Content-Type': 'application/json' };\r\n            if (process.env.NEXT_PUBLIC_ENABLE_DEMO_MODE === 'true' && process.env.NEXT_PUBLIC_DEMO_USER_ID) {\r\n                headers['x-demo-user-id'] = process.env.NEXT_PUBLIC_DEMO_USER_ID;\r\n            }\r\n\r\n            const response = await fetch('/api/search-traces', {\r\n                method: 'POST',\r\n                headers: headers,\r\n                body: JSON.stringify({\r\n                    policyText: searchSource?.extractedText?.substring(0, 3000),\r\n                    customQuery: customQuery.trim() || undefined,\r\n                    platforms: selectedPlatforms\r\n                })\r\n            });\r\n\r\n            const result = await response.json();\r\n            if (result.success && Array.isArray(result.traces)) {\r\n                const newTraces = result.traces.map((trace: { title: string; description: string; query: string; content: string; sourceUrl: string }) => ({\r\n                    id: Math.random().toString(36).substr(2, 9),\r\n                    title: `[Web] ${trace.title}`,\r\n                    description: `${trace.description}  Query: \"${trace.query}\"`,\r\n                    type: \"Trace\",\r\n                    extractedText: `${trace.content}\\n\\nSource: ${trace.sourceUrl}`,\r\n                    addedDate: new Date().toLocaleDateString(\"en-US\", { month: \"short\", day: \"numeric\", year: \"numeric\" }),\r\n                    status: \"Active Case\",\r\n                    colorClass: \"bg-blue-100\",\r\n                    iconClass: \"text-blue-600\"\r\n                }));\r\n\r\n                // Add each new trace to the store\r\n                for (const trace of newTraces) {\r\n                    await addSource(trace);\r\n                }\r\n\r\n                toast.success(`Found ${newTraces.length} resistance traces from the web!`);\r\n                setCustomQuery(\"\"); // Reset query\r\n            } else {\r\n                if (response.status === 429 || result.error === \"Quota Exceeded\") {\r\n                    toast.error(\"Quota Exceeded\", {\r\n                        description: \"You have reached your lifetime API limit. Please contact admin.\",\r\n                        duration: 5000,\r\n                    });\r\n                } else {\r\n                    toast.error(\"Search failed\", { description: result.error || \"Unknown error\" });\r\n                }\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Search error:\", error);\r\n            toast.error(\"Failed to search for traces\", { description: \"Make sure your Google Search API is configured.\" });\r\n        } finally {\r\n            setIsSearching(false);\r\n            setIsSearchDialogOpen(false);\r\n        }\r\n    };\r\n\r\n    const handleDeleteTrace = async (traceId: string) => {\r\n        if (confirm(`Are you sure you want to delete this trace?`)) {\r\n            await deleteSource(traceId);\r\n            if (selectedTraceId === traceId) {\r\n                setSelectedTraceId(null);\r\n            }\r\n        }\r\n    };\r\n\r\n    const [isSynthesizing, setIsSynthesizing] = useState(false);\r\n    const [synthesisResult, setSynthesisResult] = useState<any>(null);\r\n\r\n    const handleSynthesizeFindings = async () => {\r\n        const analyzedTraces = traces.filter(t => t.resistance_analysis);\r\n        if (analyzedTraces.length < 2) {\r\n            toast.error(\"Not enough data\", { description: \"Please analyze at least 2 traces before synthesizing.\" });\r\n            return;\r\n        }\r\n\r\n        setIsSynthesizing(true);\r\n        try {\r\n            const headers: HeadersInit = { 'Content-Type': 'application/json' };\r\n            if (process.env.NEXT_PUBLIC_ENABLE_DEMO_MODE === 'true' && process.env.NEXT_PUBLIC_DEMO_USER_ID) {\r\n                headers['x-demo-user-id'] = process.env.NEXT_PUBLIC_DEMO_USER_ID;\r\n            }\r\n\r\n            const response = await fetch('/api/analyze', {\r\n                method: 'POST',\r\n                headers: headers,\r\n                body: JSON.stringify({\r\n                    analysisMode: 'resistance_synthesis',\r\n                    documents: analyzedTraces.map(t => ({\r\n                        title: t.title,\r\n                        content: t.extractedText,\r\n                        analysis: t.resistance_analysis\r\n                    }))\r\n                })\r\n            });\r\n\r\n            const result = await response.json();\r\n            if (result.success) {\r\n                setSynthesisResult(result.analysis);\r\n                toast.success(\"Synthesis complete!\");\r\n            } else {\r\n                toast.error(\"Synthesis failed\", { description: result.error });\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Synthesis error:\", error);\r\n            toast.error(\"Failed to synthesize findings.\");\r\n        } finally {\r\n            setIsSynthesizing(false);\r\n        }\r\n    };\r\n\r\n    if (isLoading) {\r\n        return (\r\n            <div className=\"flex items-center justify-center h-64\">\r\n                <Loader2 className=\"h-8 w-8 animate-spin text-slate-400\" />\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"space-y-8\">\r\n            <div className=\"flex items-center justify-between\">\r\n                <div>\r\n                    <h2 className=\"text-3xl font-bold tracking-tight text-slate-900\">Micro-Resistance Grounding</h2>\r\n                    <p className=\"text-slate-500\">Analyze empirical traces (forum posts, comments) to identify real-world resistance strategies.</p>\r\n                </div>\r\n                <div className=\"flex gap-2\">\r\n                    <Button\r\n                        variant=\"outline\"\r\n                        onClick={handleSynthesizeFindings}\r\n                        disabled={isSynthesizing || traces.filter(t => t.resistance_analysis).length < 2}\r\n                        className=\"border-purple-200 hover:bg-purple-50 text-purple-700\"\r\n                    >\r\n                        {isSynthesizing ? <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" /> : <Activity className=\"mr-2 h-4 w-4\" />}\r\n                        Synthesize Findings\r\n                    </Button>\r\n                    <Dialog open={isSearchDialogOpen} onOpenChange={setIsSearchDialogOpen}>\r\n                        <DialogTrigger asChild>\r\n                            <Button className=\"bg-blue-600 text-white hover:bg-blue-700\">\r\n                                <Search className=\"mr-2 h-4 w-4\" /> Search for Traces\r\n                            </Button>\r\n                        </DialogTrigger>\r\n                        <DialogContent className=\"sm:max-w-[600px]\">\r\n                            <DialogHeader>\r\n                                <DialogTitle>Search Web for Resistance Traces</DialogTitle>\r\n                                <DialogDescription>\r\n                                    Find real forum posts, Reddit threads, and discussions about resistance to AI policies.\r\n                                </DialogDescription>\r\n                            </DialogHeader>\r\n                            <div className=\"space-y-4 py-4\">\r\n                                <div>\r\n                                    <label className=\"text-sm font-medium text-slate-700 mb-2 block\">\r\n                                        Auto-extract from Policy (Optional)\r\n                                    </label>\r\n                                    <select\r\n                                        className=\"w-full p-2 border rounded-md text-sm\"\r\n                                        onChange={(e) => {\r\n                                            const source = sources.find(s => s.id === e.target.value);\r\n                                            setSearchSource(source || null);\r\n                                        }}\r\n                                    >\r\n                                        <option value=\"\">Select Policy...</option>\r\n                                        {sources.filter(s => s.type === 'PDF').map(s => (\r\n                                            <option key={s.id} value={s.id}>{s.title}</option>\r\n                                        ))}\r\n                                    </select>\r\n                                    <p className=\"text-xs text-slate-500 mt-1\">AI will extract key terms to search for</p>\r\n                                </div>\r\n\r\n                                <div className=\"relative\">\r\n                                    <div className=\"absolute inset-0 flex items-center\">\r\n                                        <span className=\"w-full border-t\" />\r\n                                    </div>\r\n                                    <div className=\"relative flex justify-center text-xs uppercase\">\r\n                                        <span className=\"bg-white px-2 text-slate-500\">Or</span>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"grid grid-cols-2 gap-2\">\r\n                                    {[\r\n                                        { id: 'reddit', label: 'Reddit' },\r\n                                        { id: 'hackernews', label: 'Hacker News' },\r\n                                        { id: 'forums', label: 'Forums' },\r\n                                        { id: 'twitter', label: 'Twitter/X' },\r\n                                        { id: 'technews', label: 'Tech News' },\r\n                                        { id: 'mastodon', label: 'Mastodon' }\r\n                                    ].map(platform => (\r\n                                        <label key={platform.id} className=\"flex items-center gap-2 cursor-pointer\">\r\n                                            <input\r\n                                                type=\"checkbox\"\r\n                                                checked={selectedPlatforms.includes(platform.id)}\r\n                                                onChange={(e) => {\r\n                                                    if (e.target.checked) {\r\n                                                        setSelectedPlatforms([...selectedPlatforms, platform.id]);\r\n                                                    } else {\r\n                                                        setSelectedPlatforms(selectedPlatforms.filter(p => p !== platform.id));\r\n                                                    }\r\n                                                }}\r\n                                                className=\"rounded\"\r\n                                            />\r\n                                            <span className=\"text-sm\">{platform.label}</span>\r\n                                        </label>\r\n                                    ))}\r\n                                </div>\r\n                            </div>\r\n\r\n                            <DialogFooter>\r\n                                <Button\r\n                                    onClick={handleSearchTraces}\r\n                                    disabled={(!searchSource && !customQuery.trim()) || isSearching}\r\n                                    className=\"bg-blue-600 hover:bg-blue-700\"\r\n                                >\r\n                                    {isSearching ? (\r\n                                        <>\r\n                                            <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\r\n                                            Searching Web...\r\n                                        </>\r\n                                    ) : (\r\n                                        <>\r\n                                            <Search className=\"mr-2 h-4 w-4\" />\r\n                                            Search\r\n                                        </>\r\n                                    )}\r\n                                </Button>\r\n                            </DialogFooter>\r\n                        </DialogContent>\r\n                    </Dialog>\r\n                </div>\r\n            </div>\r\n\r\n            {synthesisResult && (\r\n                <Card className=\"bg-purple-50 border-purple-200\">\r\n                    <CardHeader>\r\n                        <CardTitle className=\"text-purple-900 flex items-center\">\r\n                            <Activity className=\"mr-2 h-5 w-5\" /> Synthesis of Findings\r\n                        </CardTitle>\r\n                    </CardHeader>\r\n                    <CardContent className=\"space-y-4\">\r\n                        <div>\r\n                            <h4 className=\"font-semibold text-purple-900 mb-1\">Executive Summary</h4>\r\n                            <p className=\"text-purple-800 text-sm leading-relaxed\">{synthesisResult.executive_summary}</p>\r\n                        </div>\r\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                            <div>\r\n                                <h4 className=\"font-semibold text-purple-900 mb-2\">Dominant Strategies</h4>\r\n                                <ul className=\"space-y-2\">\r\n                                    {synthesisResult.dominant_strategies?.map((s: any, i: number) => (\r\n                                        <li key={i} className=\"text-sm bg-white p-2 rounded border border-purple-100\">\r\n                                            <span className=\"font-bold text-purple-700\">{s.strategy}</span> ({s.frequency}): {s.description}\r\n                                        </li>\r\n                                    ))}\r\n                                </ul>\r\n                            </div>\r\n                            <div>\r\n                                <h4 className=\"font-semibold text-purple-900 mb-2\">Emerging Themes</h4>\r\n                                <ul className=\"list-disc list-inside text-sm text-purple-800 space-y-1\">\r\n                                    {synthesisResult.emerging_themes?.map((t: string, i: number) => (\r\n                                        <li key={i}>{t}</li>\r\n                                    ))}\r\n                                </ul>\r\n                            </div>\r\n                        </div>\r\n                        <div>\r\n                            <h4 className=\"font-semibold text-purple-900 mb-1\">Policy Implications</h4>\r\n                            <p className=\"text-purple-800 text-sm\">{synthesisResult.implications_for_policy}</p>\r\n                        </div>\r\n                    </CardContent>\r\n                </Card>\r\n            )}\r\n\r\n            <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\r\n                {/* Left Column: Trace Selector */}\r\n                <div className=\"space-y-4\">\r\n                    <h3 className=\"font-semibold text-slate-900 flex items-center\">\r\n                        <Activity className=\"mr-2 h-4 w-4\" /> Available Traces\r\n                    </h3>\r\n                    <div className=\"space-y-2\">\r\n                        {traces.length === 0 && (\r\n                            <Card className=\"bg-slate-50 border-dashed\">\r\n                                <CardContent className=\"p-4 text-center text-sm text-slate-500\">\r\n                                    No traces found. Go to Data page to add \"Empirical Trace\" sources or use \"Search for Traces\".\r\n                                </CardContent>\r\n                            </Card>\r\n                        )}\r\n                        {traces.map(trace => (\r\n                            <Card\r\n                                key={trace.id}\r\n                                className={`transition-all hover:border-purple-400 ${selectedTraceId === trace.id ? 'border-purple-600 ring-1 ring-purple-600' : ''}`}\r\n                            >\r\n                                <CardContent className=\"p-4\">\r\n                                    <div className=\"flex items-start justify-between gap-2\">\r\n                                        <div\r\n                                            className=\"flex-1 min-w-0 pr-2 cursor-pointer\"\r\n                                            onClick={() => setSelectedTraceId(trace.id)}\r\n                                        >\r\n                                            <div className=\"font-medium text-slate-900 break-words\">{trace.title}</div>\r\n                                            <div className=\"text-xs text-slate-500 mt-1 break-words\">{trace.description}</div>\r\n                                            {trace.resistance_analysis && (\r\n                                                <Badge variant=\"secondary\" className=\"mt-2 bg-green-100 text-green-700\">\r\n                                                    Analyzed\r\n                                                </Badge>\r\n                                            )}\r\n                                        </div>\r\n                                        <Button\r\n                                            variant=\"ghost\"\r\n                                            size=\"sm\"\r\n                                            className=\"shrink-0 h-8 w-8 p-0 hover:bg-red-100 hover:text-red-600\"\r\n                                            onClick={(e) => {\r\n                                                e.stopPropagation();\r\n                                                handleDeleteTrace(trace.id);\r\n                                            }}\r\n                                        >\r\n                                            <Trash className=\"h-4 w-4\" />\r\n                                        </Button>\r\n                                    </div>\r\n                                </CardContent>\r\n                            </Card>\r\n                        ))}\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Middle Column: Analysis Area */}\r\n                <div className=\"lg:col-span-2 space-y-6\">\r\n                    {selectedTrace ? (\r\n                        <div className=\"space-y-6\">\r\n                            <Card>\r\n                                <CardHeader>\r\n                                    <CardTitle className=\"flex justify-between items-center\">\r\n                                        <span>Analysis: {selectedTrace.title}</span>\r\n                                        {!currentAnalysis && (\r\n                                            <Button\r\n                                                onClick={() => handleAnalyzeTrace(selectedTrace)}\r\n                                                disabled={isAnalyzing}\r\n                                                className=\"bg-purple-600 hover:bg-purple-700\"\r\n                                            >\r\n                                                {isAnalyzing ? <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" /> : <Play className=\"mr-2 h-4 w-4\" />}\r\n                                                Analyze Trace\r\n                                            </Button>\r\n                                        )}\r\n                                    </CardTitle>\r\n                                </CardHeader>\r\n                                <CardContent>\r\n                                    {currentAnalysis ? (\r\n                                        <div className=\"space-y-6\">\r\n                                            <div className=\"flex items-center space-x-4\">\r\n                                                <div className=\"p-3 bg-purple-100 rounded-full\">\r\n                                                    <Zap className=\"h-6 w-6 text-purple-600\" />\r\n                                                </div>\r\n                                                <div>\r\n                                                    <div className=\"text-sm text-slate-500 uppercase tracking-wider font-bold\">Strategy Detected</div>\r\n                                                    <div className=\"text-2xl font-bold text-slate-900\">{currentAnalysis.strategy_detected}</div>\r\n                                                </div>\r\n                                                <Badge className={currentAnalysis.confidence === 'High' ? 'bg-green-100 text-green-800' : 'bg-yellow-100 text-yellow-800'}>\r\n                                                    {currentAnalysis.confidence} Confidence\r\n                                                </Badge>\r\n                                            </div>\r\n\r\n                                            <div className=\"bg-slate-50 p-4 rounded-lg border border-slate-200 relative\">\r\n                                                <Quote className=\"absolute top-2 left-2 h-8 w-8 text-slate-200 -z-0\" />\r\n                                                <p className=\"text-slate-700 italic relative z-10 pl-6\">\r\n                                                    \"{currentAnalysis.evidence_quote}\"\r\n                                                </p>\r\n                                            </div>\r\n\r\n                                            <div>\r\n                                                <h4 className=\"font-semibold text-slate-900 mb-2\">Interpretation</h4>\r\n                                                <p className=\"text-slate-600 leading-relaxed\">\r\n                                                    {currentAnalysis.interpretation}\r\n                                                </p>\r\n                                            </div>\r\n                                        </div>\r\n                                    ) : (\r\n                                        <div className=\"text-center py-12 text-slate-500\">\r\n                                            <p>Select \"Analyze Trace\" to identify resistance strategies using the LLM.</p>\r\n                                        </div>\r\n                                    )}\r\n                                </CardContent>\r\n                            </Card>\r\n\r\n                            {/* Reference Definitions */}\r\n                            <div className=\"grid grid-cols-2 gap-4\">\r\n                                {STRATEGY_DEFINITIONS.map(def => (\r\n                                    <div key={def.title} className=\"flex items-center space-x-3 p-3 bg-white rounded-lg border border-slate-100 shadow-sm\">\r\n                                        <div className={`p-2 rounded-full ${def.bg}`}>\r\n                                            <def.icon className={`h-4 w-4 ${def.color}`} />\r\n                                        </div>\r\n                                        <span className=\"font-medium text-slate-700\">{def.title}</span>\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n                    ) : (\r\n                        <div className=\"flex flex-col items-center justify-center h-64 bg-slate-50 rounded-lg border-2 border-dashed border-slate-200\">\r\n                            <Activity className=\"h-10 w-10 text-slate-300 mb-4\" />\r\n                            <p className=\"text-slate-500\">Select a trace from the left to begin analysis</p>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </div>\r\n        </div >\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\sign-up\\[[...sign-up]]\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\synthesis\\page.tsx","messages":[{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":485,"column":103,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[30044,30199],"text":" To see AI-generated synthesis results, use the &quot;AI-Powered Framework Comparison\" tool above to compare two policy documents.\r\n                            "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[30044,30199],"text":" To see AI-generated synthesis results, use the &ldquo;AI-Powered Framework Comparison\" tool above to compare two policy documents.\r\n                            "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[30044,30199],"text":" To see AI-generated synthesis results, use the &#34;AI-Powered Framework Comparison\" tool above to compare two policy documents.\r\n                            "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[30044,30199],"text":" To see AI-generated synthesis results, use the &rdquo;AI-Powered Framework Comparison\" tool above to compare two policy documents.\r\n                            "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":485,"column":135,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[30044,30199],"text":" To see AI-generated synthesis results, use the \"AI-Powered Framework Comparison&quot; tool above to compare two policy documents.\r\n                            "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[30044,30199],"text":" To see AI-generated synthesis results, use the \"AI-Powered Framework Comparison&ldquo; tool above to compare two policy documents.\r\n                            "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[30044,30199],"text":" To see AI-generated synthesis results, use the \"AI-Powered Framework Comparison&#34; tool above to compare two policy documents.\r\n                            "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[30044,30199],"text":" To see AI-generated synthesis results, use the \"AI-Powered Framework Comparison&rdquo; tool above to compare two policy documents.\r\n                            "},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState } from \"react\";\r\nimport { useSources } from \"@/hooks/useSources\";\r\nimport { useServerStorage } from \"@/hooks/useServerStorage\";\r\nimport { Source } from \"@/types\";\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { GitMerge, GitPullRequest, AlertCircle, FileDown, CheckCircle2, Sparkles, Brain, Network, Loader2, RefreshCw } from \"lucide-react\";\r\nimport { generateSynthesisPDF } from \"@/utils/generateSynthesisPDF\";\r\nimport { AssemblageSankey } from \"@/components/AssemblageSankey\";\r\nimport { Radar, RadarChart, PolarGrid, PolarAngleAxis, PolarRadiusAxis, ResponsiveContainer, Legend, Tooltip, BarChart, Bar, XAxis, YAxis, CartesianGrid } from \"recharts\";\r\nimport { Info } from \"lucide-react\";\r\n\r\ninterface ComparisonResult {\r\n    risk: { convergence: string; divergence: string; coloniality: string; resistance: string; convergence_score?: number; coloniality_score?: number };\r\n    governance: { convergence: string; divergence: string; coloniality: string; resistance: string; convergence_score?: number; coloniality_score?: number };\r\n    rights: { convergence: string; divergence: string; coloniality: string; resistance: string; convergence_score?: number; coloniality_score?: number };\r\n    scope: { convergence: string; divergence: string; coloniality: string; resistance: string; convergence_score?: number; coloniality_score?: number };\r\n}\r\n\r\nimport { EcosystemImpact } from \"@/types\";\r\n\r\nconst SYNTHESIS_FINDINGS = [\r\n    {\r\n        key: \"risk\",\r\n        dimension: \"Risk Classification\",\r\n        convergence: \"Comparison of risk definitions and tiered obligations across frameworks.\",\r\n        divergence: \"Analysis of how risk categories are adapted to local social and political contexts.\",\r\n        coloniality: \"Examination of whether risk models reflect Global North assumptions or local realities.\",\r\n        resistance: \"Identification of mechanisms that allow for local adaptation of risk frameworks.\",\r\n        icon: AlertCircle,\r\n    },\r\n    {\r\n        key: \"governance\",\r\n        dimension: \"Governance Structure\",\r\n        convergence: \"Comparison of institutional designs (e.g., centralized vs. networked authorities).\",\r\n        divergence: \"Analysis of enforcement powers and coordination mechanisms.\",\r\n        coloniality: \"Assessment of whether governance models assume state capacities that may not exist.\",\r\n        resistance: \"Highlighting of innovative governance structures that leverage local expertise.\",\r\n        icon: GitMerge,\r\n    },\r\n    {\r\n        key: \"rights\",\r\n        dimension: \"Rights Framework\",\r\n        convergence: \"Comparison of individual rights (e.g., explanation, redress) and collective protections.\",\r\n        divergence: \"Analysis of the balance between procedural compliance and substantive rights.\",\r\n        coloniality: \"Examination of whether rights frameworks obscure underlying power asymmetries.\",\r\n        resistance: \"Identification of rights-based approaches that empower affected communities.\",\r\n        icon: CheckCircle2,\r\n    },\r\n    {\r\n        key: \"scope\",\r\n        dimension: \"Territorial Scope\",\r\n        convergence: \"Comparison of jurisdictional reach and extraterritorial application.\",\r\n        divergence: \"Analysis of data sovereignty claims and market power dynamics.\",\r\n        coloniality: \"Assessment of the 'Brussels Effect' and the imposition of external legal norms.\",\r\n        resistance: \"Highlighting of assertions of epistemic and legal autonomy.\",\r\n        icon: GitPullRequest,\r\n    },\r\n];\r\n\r\nexport default function SynthesisPage() {\r\n    const { sources, isLoading } = useSources();\r\n    const [isExporting, setIsExporting] = useState(false);\r\n\r\n    // Comparison State\r\n    const [sourceA, setSourceA] = useState<Source | null>(null);\r\n    const [sourceB, setSourceB] = useState<Source | null>(null);\r\n    const [isComparing, setIsComparing] = useState(false);\r\n    const [comparisonResult, setComparisonResult] = useServerStorage<ComparisonResult | null>(\"synthesis_comparison_result\", null);\r\n\r\n    // Ecosystem State\r\n    const [ecosystemSource, setEcosystemSource] = useState<Source | null>(null);\r\n    const [isMapping, setIsMapping] = useState(false);\r\n    const [ecosystemImpacts, setEcosystemImpacts] = useState<EcosystemImpact[]>([]);\r\n    const [interconnectionFilter, setInterconnectionFilter] = useState<\"All\" | \"Material\" | \"Discursive\" | \"Hybrid\">(\"All\");\r\n    const [viewMode, setViewMode] = useState<\"list\" | \"graph\">(\"list\");\r\n    const [chartView, setChartView] = useState<\"radar\" | \"bar\">(\"radar\");\r\n    const [showGuide, setShowGuide] = useState(true);\r\n\r\n    // Filter sources that have text available for analysis\r\n    const analyzedSources = sources.filter(s => s.analysis || s.extractedText);\r\n\r\n    const handleExport = () => {\r\n        if (!comparisonResult) {\r\n            alert(\"Please run a comparison first to generate a report.\");\r\n            return;\r\n        }\r\n\r\n        setIsExporting(true);\r\n        try {\r\n            // Transform comparisonResult into the format expected by generateSynthesisPDF\r\n            const findings = Object.entries(comparisonResult).map(([key, value]) => {\r\n                const typedValue = value as ComparisonResult[\"risk\"]; // All keys have same structure\r\n                const findingDef = SYNTHESIS_FINDINGS.find(f => f.key === key);\r\n                return {\r\n                    dimension: findingDef?.dimension || key,\r\n                    convergence: typedValue.convergence,\r\n                    divergence: typedValue.divergence,\r\n                    coloniality: typedValue.coloniality,\r\n                    resistance: typedValue.resistance\r\n                };\r\n            });\r\n\r\n            generateSynthesisPDF(findings);\r\n        } catch (error) {\r\n            console.error(\"Error generating PDF:\", error);\r\n            alert(\"Failed to generate PDF. Please try again.\");\r\n        } finally {\r\n            setTimeout(() => setIsExporting(false), 1000);\r\n        }\r\n    };\r\n\r\n    const handleCompare = async (forceRefresh = false) => {\r\n        if (!sourceA || !sourceB) return;\r\n\r\n        setIsComparing(true);\r\n        // setComparisonResult(null); // Keep previous result while loading so button stays visible\r\n\r\n        try {\r\n            const headers: HeadersInit = { 'Content-Type': 'application/json' };\r\n            if (process.env.NEXT_PUBLIC_ENABLE_DEMO_MODE === 'true' && process.env.NEXT_PUBLIC_DEMO_USER_ID) {\r\n                headers['x-demo-user-id'] = process.env.NEXT_PUBLIC_DEMO_USER_ID;\r\n            }\r\n\r\n            const response = await fetch('/api/analyze', {\r\n                method: 'POST',\r\n                headers: headers,\r\n                body: JSON.stringify({\r\n                    analysisMode: 'comparison',\r\n                    sourceA: { title: sourceA.title, text: sourceA.extractedText?.substring(0, 50000) || '' },\r\n                    sourceB: { title: sourceB.title, text: sourceB.extractedText?.substring(0, 50000) || '' },\r\n                    force: forceRefresh\r\n                })\r\n            });\r\n\r\n            const data = await response.json();\r\n            if (data.success && data.analysis) {\r\n                setComparisonResult(data.analysis);\r\n            } else {\r\n                alert(\"Comparison failed: \" + (data.error || \"Unknown error\"));\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Comparison error:\", error);\r\n            alert(\"Failed to generate comparison.\");\r\n        } finally {\r\n            setIsComparing(false);\r\n        }\r\n    };\r\n\r\n    const handleEcosystemMap = async () => {\r\n        if (!ecosystemSource) return;\r\n\r\n        setIsMapping(true);\r\n        try {\r\n            const headers: HeadersInit = { 'Content-Type': 'application/json' };\r\n            if (process.env.NEXT_PUBLIC_ENABLE_DEMO_MODE === 'true' && process.env.NEXT_PUBLIC_DEMO_USER_ID) {\r\n                headers['x-demo-user-id'] = process.env.NEXT_PUBLIC_DEMO_USER_ID;\r\n            }\r\n\r\n            const response = await fetch('/api/analyze', {\r\n                method: 'POST',\r\n                headers: headers,\r\n                body: JSON.stringify({\r\n                    text: ecosystemSource.extractedText?.substring(0, 30000) || '',\r\n                    sourceType: 'Policy Document',\r\n                    analysisMode: 'ecosystem'\r\n                })\r\n            });\r\n\r\n            const data = await response.json();\r\n            if (data.success && Array.isArray(data.analysis)) {\r\n                setEcosystemImpacts(data.analysis);\r\n            } else {\r\n                alert(\"Mapping failed: \" + (data.error || \"Unknown error\"));\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Mapping error:\", error);\r\n            alert(\"Failed to generate ecosystem map.\");\r\n        } finally {\r\n            setIsMapping(false);\r\n        }\r\n    };\r\n\r\n    if (isLoading) {\r\n        return (\r\n            <div className=\"flex items-center justify-center h-64\">\r\n                <Loader2 className=\"h-8 w-8 animate-spin text-slate-400\" />\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"space-y-8\">\r\n            <div className=\"flex items-center justify-between\">\r\n                <div>\r\n                    <h2 className=\"text-3xl font-bold tracking-tight text-slate-900\">Cross-Case Analysis</h2>\r\n                    <p className=\"text-slate-500\">Comparative analysis of AI governance frameworks using the Decolonial Situatedness Framework.</p>\r\n                </div>\r\n                <Button\r\n                    onClick={handleExport}\r\n                    className=\"bg-slate-900 text-white hover:bg-slate-800\"\r\n                    disabled={isExporting}\r\n                >\r\n                    <FileDown className=\"mr-2 h-4 w-4\" />\r\n                    {isExporting ? \"Generating PDF...\" : \"Export Report\"}\r\n                </Button>\r\n            </div>\r\n\r\n            <Card className=\"bg-gradient-to-br from-slate-50 to-blue-50 border-slate-200\">\r\n                <CardHeader>\r\n                    <CardTitle>Executive Summary</CardTitle>\r\n                    <CardDescription>Key insights from the comparative analysis</CardDescription>\r\n                </CardHeader>\r\n                <CardContent className=\"space-y-3 text-sm text-slate-700 leading-relaxed\">\r\n                    <p>\r\n                        This synthesis compares AI governance frameworks to identify patterns of convergence, divergence, and coloniality. By applying the Decolonial Situatedness Framework, we analyze how different jurisdictions approach risk, governance, rights, and territorial scope.\r\n                    </p>\r\n                    <p>\r\n                        <strong>Convergence:</strong> Identification of shared regulatory mechanisms, definitions, and risk classifications across frameworks.\r\n                    </p>\r\n                    <p>\r\n                        <strong>Divergence:</strong> Analysis of distinct approaches to enforcement, rights protections, and institutional design that reflect local contexts.\r\n                    </p>\r\n                    <p>\r\n                        <strong>Colonial Patterns:</strong> Examination of potential legal transplants, extraterritorial effects, and the imposition of Global North epistemologies.\r\n                    </p>\r\n                    <p>\r\n                        <strong>Decolonial Potential:</strong> Highlighting opportunities for epistemic autonomy, local adaptation, and resistance to hegemonic norms.\r\n                    </p>\r\n                </CardContent>\r\n            </Card>\r\n\r\n            {/* AI-Powered Comparison */}\r\n            {analyzedSources.length >= 2 && (\r\n                <Card className=\"border-purple-200\">\r\n                    <CardHeader>\r\n                        <div className=\"flex items-center gap-2\">\r\n                            <Brain className=\"h-5 w-5 text-purple-600\" />\r\n                            <CardTitle>AI-Powered Framework Comparison</CardTitle>\r\n                        </div>\r\n                        <CardDescription>\r\n                            Compare two policy documents to identify convergence, divergence, and colonial patterns\r\n                        </CardDescription>\r\n                    </CardHeader>\r\n                    <CardContent className=\"space-y-4\">\r\n                        <div className=\"grid grid-cols-2 gap-4\">\r\n                            <div className=\"space-y-2\">\r\n                                <label className=\"text-sm font-medium text-slate-700\">Source A</label>\r\n                                <select\r\n                                    className=\"w-full p-2 border rounded-md text-sm\"\r\n                                    onChange={(e) => {\r\n                                        const source = analyzedSources.find(s => s.id === e.target.value);\r\n                                        setSourceA(source || null);\r\n                                    }}\r\n                                >\r\n                                    <option value=\"\">Select first document...</option>\r\n                                    {analyzedSources.map(s => (\r\n                                        <option key={s.id} value={s.id}>{s.title}</option>\r\n                                    ))}\r\n                                </select>\r\n                            </div>\r\n                            <div className=\"space-y-2\">\r\n                                <label className=\"text-sm font-medium text-slate-700\">Source B</label>\r\n                                <select\r\n                                    className=\"w-full p-2 border rounded-md text-sm\"\r\n                                    onChange={(e) => {\r\n                                        const source = analyzedSources.find(s => s.id === e.target.value);\r\n                                        setSourceB(source || null);\r\n                                    }}\r\n                                >\r\n                                    <option value=\"\">Select second document...</option>\r\n                                    {analyzedSources.map(s => (\r\n                                        <option key={s.id} value={s.id}>{s.title}</option>\r\n                                    ))}\r\n                                </select>\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"flex gap-2\">\r\n                            <Button\r\n                                onClick={() => handleCompare(false)}\r\n                                disabled={!sourceA || !sourceB || isComparing}\r\n                                className=\"w-full bg-slate-900 hover:bg-slate-800\"\r\n                            >\r\n                                {isComparing ? (\r\n                                    <>\r\n                                        <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\r\n                                        Analyzing...\r\n                                    </>\r\n                                ) : (\r\n                                    <>\r\n                                        <Sparkles className=\"mr-2 h-4 w-4\" />\r\n                                        Compare Frameworks\r\n                                    </>\r\n                                )}\r\n                            </Button>\r\n                            {comparisonResult && (\r\n                                <Button\r\n                                    onClick={() => handleCompare(true)}\r\n                                    disabled={isComparing}\r\n                                    variant=\"outline\"\r\n                                    title=\"Force Regenerate (Bypass Cache)\"\r\n                                >\r\n                                    <RefreshCw className={`mr-2 h-4 w-4 ${isComparing ? 'animate-spin' : ''}`} />\r\n                                    Regenerate\r\n                                </Button>\r\n                            )}\r\n                        </div>\r\n\r\n                        {comparisonResult && (\r\n                            <div className=\"mt-8 space-y-6 pt-4 border-t\">\r\n                                <div className=\"h-[450px] w-full\">\r\n                                    <h4 className=\"font-semibold text-slate-900 mb-2 text-center\">Shape of Divergence</h4>\r\n                                    <p className=\"text-xs text-center text-slate-500 mb-4\">\r\n                                        Comparing: <span className=\"font-medium text-slate-700\">{sourceA?.title}</span> vs <span className=\"font-medium text-slate-700\">{sourceB?.title}</span>\r\n                                    </p>\r\n\r\n                                    <div className=\"flex justify-center mb-4 space-x-2\">\r\n                                        <button\r\n                                            onClick={() => setChartView(\"radar\")}\r\n                                            className={`px-3 py-1 text-xs font-medium rounded-md transition-colors ${chartView === \"radar\"\r\n                                                ? \"bg-slate-900 text-white\"\r\n                                                : \"bg-slate-100 text-slate-600 hover:bg-slate-200\"\r\n                                                }`}\r\n                                        >\r\n                                            Radar View\r\n                                        </button>\r\n                                        <button\r\n                                            onClick={() => setChartView(\"bar\")}\r\n                                            className={`px-3 py-1 text-xs font-medium rounded-md transition-colors ${chartView === \"bar\"\r\n                                                ? \"bg-slate-900 text-white\"\r\n                                                : \"bg-slate-100 text-slate-600 hover:bg-slate-200\"\r\n                                                }`}\r\n                                        >\r\n                                            Bar View\r\n                                        </button>\r\n                                    </div>\r\n\r\n                                    {\r\n                                        showGuide && (\r\n                                            <div className=\"mb-6 mx-auto max-w-2xl bg-blue-50 border border-blue-100 rounded-lg p-3 relative\">\r\n                                                <button\r\n                                                    onClick={() => setShowGuide(false)}\r\n                                                    className=\"absolute top-2 right-2 text-blue-400 hover:text-blue-600\"\r\n                                                >\r\n                                                    \r\n                                                </button>\r\n                                                <div className=\"flex gap-3\">\r\n                                                    <Info className=\"h-5 w-5 text-blue-600 shrink-0\" />\r\n                                                    <div className=\"text-xs text-blue-900 space-y-1\">\r\n                                                        <p className=\"font-semibold\">How to read this chart:</p>\r\n                                                        <p><span className=\"font-bold text-blue-700\">Convergence (Blue):</span> How similar the frameworks are. High score = Very similar rules/definitions.</p>\r\n                                                        <p><span className=\"font-bold text-red-700\">Coloniality (Red):</span> Power imbalance. High score = One framework is imposing values on the other.</p>\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n                                        )\r\n                                    }\r\n\r\n                                    <ResponsiveContainer width=\"100%\" height={300}>\r\n                                        {chartView === \"radar\" ? (\r\n                                            <RadarChart cx=\"50%\" cy=\"50%\" outerRadius=\"80%\" data={[\r\n                                                { subject: 'Risk', A: comparisonResult.risk.convergence_score || 0, B: comparisonResult.risk.coloniality_score || 0, fullMark: 10 },\r\n                                                { subject: 'Governance', A: comparisonResult.governance.convergence_score || 0, B: comparisonResult.governance.coloniality_score || 0, fullMark: 10 },\r\n                                                { subject: 'Rights', A: comparisonResult.rights.convergence_score || 0, B: comparisonResult.rights.coloniality_score || 0, fullMark: 10 },\r\n                                                { subject: 'Scope', A: comparisonResult.scope.convergence_score || 0, B: comparisonResult.scope.coloniality_score || 0, fullMark: 10 },\r\n                                            ]}>\r\n                                                <PolarGrid />\r\n                                                <PolarAngleAxis dataKey=\"subject\" />\r\n                                                <PolarRadiusAxis angle={30} domain={[0, 10]} />\r\n                                                <Tooltip />\r\n                                                <Radar name=\"Convergence (Similarity)\" dataKey=\"A\" stroke=\"#2563eb\" fill=\"#2563eb\" fillOpacity={0.5} />\r\n                                                <Radar name=\"Coloniality (Power Imbalance)\" dataKey=\"B\" stroke=\"#dc2626\" fill=\"#dc2626\" fillOpacity={0.5} />\r\n                                                <Legend />\r\n                                            </RadarChart>\r\n                                        ) : (\r\n                                            <BarChart\r\n                                                data={[\r\n                                                    { subject: 'Risk', Convergence: comparisonResult.risk.convergence_score || 0, Coloniality: comparisonResult.risk.coloniality_score || 0 },\r\n                                                    { subject: 'Governance', Convergence: comparisonResult.governance.convergence_score || 0, Coloniality: comparisonResult.governance.coloniality_score || 0 },\r\n                                                    { subject: 'Rights', Convergence: comparisonResult.rights.convergence_score || 0, Coloniality: comparisonResult.rights.coloniality_score || 0 },\r\n                                                    { subject: 'Scope', Convergence: comparisonResult.scope.convergence_score || 0, Coloniality: comparisonResult.scope.coloniality_score || 0 },\r\n                                                ]}\r\n                                                margin={{ top: 20, right: 30, left: 20, bottom: 5 }}\r\n                                            >\r\n                                                <CartesianGrid strokeDasharray=\"3 3\" />\r\n                                                <XAxis dataKey=\"subject\" />\r\n                                                <YAxis domain={[0, 10]} />\r\n                                                <Tooltip />\r\n                                                <Legend />\r\n                                                <Bar dataKey=\"Convergence\" fill=\"#2563eb\" name=\"Convergence (Similarity)\" />\r\n                                                <Bar dataKey=\"Coloniality\" fill=\"#dc2626\" name=\"Coloniality (Power Imbalance)\" />\r\n                                            </BarChart>\r\n                                        )}\r\n                                    </ResponsiveContainer>\r\n                                    <p className=\"text-xs text-center text-slate-400 mt-4\">\r\n                                        Scale 0-10: Higher scores indicate stronger presence of the attribute.\r\n                                    </p>\r\n                                </div >\r\n\r\n                                <h4 className=\"font-semibold text-slate-900\">Detailed Findings</h4>\r\n                                {\r\n                                    Object.entries(comparisonResult).map(([key, value]) => {\r\n                                        const typedValue = value as ComparisonResult[\"risk\"];\r\n                                        return (\r\n                                            <div key={key} className=\"space-y-2\">\r\n                                                <p className=\"text-sm font-medium text-slate-700 capitalize\">{key}</p>\r\n                                                <div className=\"grid grid-cols-2 gap-2 text-xs\">\r\n                                                    <div className=\"p-2 bg-green-50 rounded border border-green-200\">\r\n                                                        <span className=\"font-semibold text-green-700\">Convergence:</span>\r\n                                                        <p className=\"text-slate-600 mt-1\">{typedValue.convergence}</p>\r\n                                                    </div>\r\n                                                    <div className=\"p-2 bg-blue-50 rounded border border-blue-200\">\r\n                                                        <span className=\"font-semibold text-blue-700\">Divergence:</span>\r\n                                                        <p className=\"text-slate-600 mt-1\">{typedValue.divergence}</p>\r\n                                                    </div>\r\n                                                    <div className=\"p-2 bg-red-50 rounded border border-red-200\">\r\n                                                        <span className=\"font-semibold text-red-700\">Coloniality:</span>\r\n                                                        <p className=\"text-slate-600 mt-1\">{typedValue.coloniality}</p>\r\n                                                    </div>\r\n                                                    <div className=\"p-2 bg-purple-50 rounded border border-purple-200\">\r\n                                                        <span className=\"font-semibold text-purple-700\">Resistance:</span>\r\n                                                        <p className=\"text-slate-600 mt-1\">{typedValue.resistance}</p>\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n                                        )\r\n                                    })\r\n                                }\r\n                            </div >\r\n                        )\r\n                        }\r\n                    </CardContent >\r\n                </Card >\r\n            )}\r\n\r\n            {/* Synthesis Matrix */}\r\n            <div>\r\n                <h3 className=\"text-xl font-semibold text-slate-900 mb-4\">Synthesis Framework</h3>\r\n\r\n                {comparisonResult ? (\r\n                    // Show AI-generated comparison results\r\n                    <div className=\"grid gap-4\">\r\n                        {Object.entries(comparisonResult).map(([key, value]) => {\r\n                            const typedValue = value as ComparisonResult[\"risk\"];\r\n                            const finding = SYNTHESIS_FINDINGS.find(f => f.key === key);\r\n                            const Icon = finding?.icon || AlertCircle;\r\n                            return (\r\n                                <Card key={key}>\r\n                                    <CardHeader>\r\n                                        <div className=\"flex items-center gap-2\">\r\n                                            <Icon className=\"h-5 w-5 text-slate-600\" />\r\n                                            <CardTitle>{finding?.dimension || key}</CardTitle>\r\n                                        </div>\r\n                                    </CardHeader>\r\n                                    <CardContent className=\"space-y-3\">\r\n                                        <div className=\"p-3 bg-green-50 rounded-lg border border-green-200\">\r\n                                            <p className=\"text-xs font-bold text-green-700 uppercase mb-1\">Convergence</p>\r\n                                            <p className=\"text-sm text-slate-700\">{typedValue.convergence}</p>\r\n                                        </div>\r\n                                        <div className=\"p-3 bg-blue-50 rounded-lg border border-blue-200\">\r\n                                            <p className=\"text-xs font-bold text-blue-700 uppercase mb-1\">Divergence</p>\r\n                                            <p className=\"text-sm text-slate-700\">{typedValue.divergence}</p>\r\n                                        </div>\r\n                                        <div className=\"p-3 bg-red-50 rounded-lg border border-red-200\">\r\n                                            <p className=\"text-xs font-bold text-red-700 uppercase mb-1\">Coloniality</p>\r\n                                            <p className=\"text-sm text-slate-700\">{typedValue.coloniality}</p>\r\n                                        </div>\r\n                                        <div className=\"p-3 bg-purple-50 rounded-lg border border-purple-200\">\r\n                                            <p className=\"text-xs font-bold text-purple-700 uppercase mb-1\">Resistance</p>\r\n                                            <p className=\"text-sm text-slate-700\">{typedValue.resistance}</p>\r\n                                        </div>\r\n                                    </CardContent>\r\n                                </Card>\r\n                            );\r\n                        })}\r\n                    </div>\r\n                ) : (\r\n                    // Show placeholder framework when no comparison is active\r\n                    <>\r\n                        <div className=\"mb-4 p-4 bg-blue-50 border border-blue-200 rounded-lg\">\r\n                            <p className=\"text-sm text-blue-900\">\r\n                                <strong>Note:</strong> To see AI-generated synthesis results, use the \"AI-Powered Framework Comparison\" tool above to compare two policy documents.\r\n                            </p>\r\n                        </div>\r\n                        <div className=\"grid gap-4\">\r\n                            {SYNTHESIS_FINDINGS.map((finding) => {\r\n                                const Icon = finding.icon;\r\n                                return (\r\n                                    <Card key={finding.key} className=\"opacity-60\">\r\n                                        <CardHeader>\r\n                                            <div className=\"flex items-center gap-2\">\r\n                                                <Icon className=\"h-5 w-5 text-slate-600\" />\r\n                                                <CardTitle>{finding.dimension}</CardTitle>\r\n                                            </div>\r\n                                        </CardHeader>\r\n                                        <CardContent className=\"space-y-3\">\r\n                                            <div className=\"p-3 bg-green-50 rounded-lg border border-green-200\">\r\n                                                <p className=\"text-xs font-bold text-green-700 uppercase mb-1\">Convergence</p>\r\n                                                <p className=\"text-sm text-slate-700\">{finding.convergence}</p>\r\n                                            </div>\r\n                                            <div className=\"p-3 bg-blue-50 rounded-lg border border-blue-200\">\r\n                                                <p className=\"text-xs font-bold text-blue-700 uppercase mb-1\">Divergence</p>\r\n                                                <p className=\"text-sm text-slate-700\">{finding.divergence}</p>\r\n                                            </div>\r\n                                            <div className=\"p-3 bg-red-50 rounded-lg border border-red-200\">\r\n                                                <p className=\"text-xs font-bold text-red-700 uppercase mb-1\">Coloniality</p>\r\n                                                <p className=\"text-sm text-slate-700\">{finding.coloniality}</p>\r\n                                            </div>\r\n                                            <div className=\"p-3 bg-purple-50 rounded-lg border border-purple-200\">\r\n                                                <p className=\"text-xs font-bold text-purple-700 uppercase mb-1\">Resistance</p>\r\n                                                <p className=\"text-sm text-slate-700\">{finding.resistance}</p>\r\n                                            </div>\r\n                                        </CardContent>\r\n                                    </Card>\r\n                                );\r\n                            })}\r\n                        </div>\r\n                    </>\r\n                )}\r\n            </div>\r\n\r\n            {/* Ecosystem Impact Mapping */}\r\n            {\r\n                analyzedSources.length > 0 && (\r\n                    <Card className=\"border-teal-200\">\r\n                        <CardHeader>\r\n                            <div className=\"flex items-center gap-2\">\r\n                                <Network className=\"h-5 w-5 text-teal-600\" />\r\n                                <CardTitle>Ecosystem Impact Mapping</CardTitle>\r\n                            </div>\r\n                            <CardDescription>\r\n                                Map how policy mechanisms constrain or afford possibilities for ecosystem actors\r\n                            </CardDescription>\r\n                        </CardHeader>\r\n                        <CardContent className=\"space-y-4\">\r\n                            <div className=\"flex gap-4 items-end\">\r\n                                <div className=\"flex-1 space-y-2\">\r\n                                    <label className=\"text-sm font-medium text-slate-700\">Select Policy Document</label>\r\n                                    <select\r\n                                        className=\"w-full p-2 border rounded-md text-sm\"\r\n                                        onChange={(e) => {\r\n                                            const source = analyzedSources.find(s => s.id === e.target.value);\r\n                                            setEcosystemSource(source || null);\r\n                                        }}\r\n                                    >\r\n                                        <option value=\"\">Select document...</option>\r\n                                        {analyzedSources.map(s => (\r\n                                            <option key={s.id} value={s.id}>{s.title}</option>\r\n                                        ))}\r\n                                    </select>\r\n                                </div>\r\n                                <Button\r\n                                    className=\"bg-teal-600 text-white hover:bg-teal-700\"\r\n                                    onClick={handleEcosystemMap}\r\n                                    disabled={!ecosystemSource || isMapping}\r\n                                >\r\n                                    {isMapping ? (\r\n                                        <>\r\n                                            <Sparkles className=\"mr-2 h-4 w-4 animate-spin\" />\r\n                                            Mapping...\r\n                                        </>\r\n                                    ) : (\r\n                                        <>\r\n                                            <Network className=\"mr-2 h-4 w-4\" />\r\n                                            Generate Map\r\n                                        </>\r\n                                    )}\r\n                                </Button>\r\n                            </div>\r\n\r\n                            {ecosystemImpacts.length > 0 && (\r\n                                <div className=\"mt-4 space-y-3 pt-4 border-t\">\r\n                                    <div className=\"flex items-center justify-between\">\r\n                                        <h4 className=\"font-semibold text-slate-900\">Ecosystem Impacts</h4>\r\n                                        <div className=\"flex gap-2\">\r\n                                            <div className=\"flex bg-slate-100 rounded-lg p-1 mr-4\">\r\n                                                <button\r\n                                                    onClick={() => setViewMode(\"list\")}\r\n                                                    className={`px-3 py-1 text-xs font-medium rounded-md transition-colors ${viewMode === \"list\"\r\n                                                        ? \"bg-white text-slate-900 shadow-sm\"\r\n                                                        : \"text-slate-500 hover:text-slate-900\"\r\n                                                        }`}\r\n                                                >\r\n                                                    List View\r\n                                                </button>\r\n                                                <button\r\n                                                    onClick={() => setViewMode(\"graph\")}\r\n                                                    className={`px-3 py-1 text-xs font-medium rounded-md transition-colors ${viewMode === \"graph\"\r\n                                                        ? \"bg-white text-slate-900 shadow-sm\"\r\n                                                        : \"text-slate-500 hover:text-slate-900\"\r\n                                                        }`}\r\n                                                >\r\n                                                    Graph View\r\n                                                </button>\r\n                                            </div>\r\n\r\n                                            <Button\r\n                                                variant={interconnectionFilter === \"All\" ? \"default\" : \"outline\"}\r\n                                                size=\"sm\"\r\n                                                onClick={() => setInterconnectionFilter(\"All\")}\r\n                                            >\r\n                                                All\r\n                                            </Button>\r\n                                            <Button\r\n                                                variant={interconnectionFilter === \"Material\" ? \"default\" : \"outline\"}\r\n                                                size=\"sm\"\r\n                                                onClick={() => setInterconnectionFilter(\"Material\")}\r\n                                            >\r\n                                                Material\r\n                                            </Button>\r\n                                            <Button\r\n                                                variant={interconnectionFilter === \"Discursive\" ? \"default\" : \"outline\"}\r\n                                                size=\"sm\"\r\n                                                onClick={() => setInterconnectionFilter(\"Discursive\")}\r\n                                            >\r\n                                                Discursive\r\n                                            </Button>\r\n                                            <Button\r\n                                                variant={interconnectionFilter === \"Hybrid\" ? \"default\" : \"outline\"}\r\n                                                size=\"sm\"\r\n                                                onClick={() => setInterconnectionFilter(\"Hybrid\")}\r\n                                            >\r\n                                                Hybrid\r\n                                            </Button>\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    {viewMode === \"graph\" ? (\r\n                                        <div className=\"border rounded-lg p-4 bg-white min-h-[500px]\">\r\n                                            <AssemblageSankey\r\n                                                data={ecosystemImpacts.filter(impact =>\r\n                                                    interconnectionFilter === \"All\" ||\r\n                                                    impact.interconnection_type === interconnectionFilter\r\n                                                )}\r\n                                            />\r\n                                            <p className=\"text-center text-xs text-slate-500 mt-4\">\r\n                                                Visualizing the flow from <strong>Actors</strong>  <strong>Mechanisms</strong>  <strong>Impacts</strong>\r\n                                            </p>\r\n                                        </div>\r\n                                    ) : (\r\n                                        <div className=\"grid gap-3\">\r\n                                            {ecosystemImpacts\r\n                                                .filter(impact =>\r\n                                                    interconnectionFilter === \"All\" ||\r\n                                                    impact.interconnection_type === interconnectionFilter\r\n                                                )\r\n                                                .map((impact, i) => (\r\n                                                    <div key={i} className={`p-3 rounded-lg border ${impact.type === \"Constraint\"\r\n                                                        ? \"bg-red-50 border-red-200\"\r\n                                                        : \"bg-green-50 border-green-200\"\r\n                                                        }`}>\r\n                                                        <div className=\"flex items-start justify-between mb-2\">\r\n                                                            <span className={`text-xs font-bold uppercase ${impact.type === \"Constraint\" ? \"text-red-700\" : \"text-green-700\"\r\n                                                                }`}>\r\n                                                                {impact.type}\r\n                                                            </span>\r\n                                                            {impact.interconnection_type && (\r\n                                                                <Badge variant=\"outline\" className=\"text-xs\">\r\n                                                                    {impact.interconnection_type}\r\n                                                                </Badge>\r\n                                                            )}\r\n                                                        </div>\r\n                                                        <p className=\"text-sm font-semibold text-slate-900 mb-1\">{impact.actor}</p>\r\n                                                        <p className=\"text-xs text-slate-600 mb-1\">\r\n                                                            <span className=\"font-medium\">Mechanism:</span> {impact.mechanism}\r\n                                                        </p>\r\n                                                        <p className=\"text-xs text-slate-600\">\r\n                                                            <span className=\"font-medium\">Impact:</span> {impact.impact}\r\n                                                        </p>\r\n                                                    </div>\r\n                                                ))}\r\n                                        </div>\r\n                                    )}\r\n                                </div>\r\n                            )}\r\n                        </CardContent>\r\n                    </Card>\r\n                )\r\n            }\r\n\r\n\r\n        </div >\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\timeline\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'FileText' is defined but never used.","line":6,"column":27,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":35},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'index' is defined but never used.","line":241,"column":57,"nodeType":null,"messageId":"unusedVar","endLine":241,"endColumn":62}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useSources } from \"@/hooks/useSources\";\r\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Calendar, Clock, FileText, TrendingUp } from \"lucide-react\";\r\nimport { Source } from \"@/types\";\r\n\r\nexport default function TimelinePage() {\r\n    const { sources, isLoading } = useSources();\r\n\r\n    // Filter sources with dates and sort them\r\n    const timelineEvents = sources\r\n        .filter(s => s.publicationDate)\r\n        .sort((a, b) => new Date(a.publicationDate!).getTime() - new Date(b.publicationDate!).getTime());\r\n\r\n    // Analytics: Publications by year\r\n    const publicationsByYear: Record<number, Source[]> = {};\r\n    timelineEvents.forEach(source => {\r\n        const year = new Date(source.publicationDate!).getFullYear();\r\n        if (!publicationsByYear[year]) publicationsByYear[year] = [];\r\n        publicationsByYear[year].push(source);\r\n    });\r\n\r\n    // Analytics: Publications by jurisdiction\r\n    const publicationsByJurisdiction: Record<string, Source[]> = {};\r\n    timelineEvents.forEach(source => {\r\n        const jurisdiction = source.jurisdiction || 'Other';\r\n        if (!publicationsByJurisdiction[jurisdiction]) publicationsByJurisdiction[jurisdiction] = [];\r\n        publicationsByJurisdiction[jurisdiction].push(source);\r\n    });\r\n\r\n    // Analytics: Active Discourse Metric\r\n    const now = new Date();\r\n    const oneYearAgo = new Date(now.getFullYear() - 1, now.getMonth(), now.getDate());\r\n    const twoYearsAgo = new Date(now.getFullYear() - 2, now.getMonth(), now.getDate());\r\n\r\n    const recentDocs = timelineEvents.filter(s => new Date(s.publicationDate!) >= oneYearAgo).length;\r\n    const previousDocs = timelineEvents.filter(s => {\r\n        const date = new Date(s.publicationDate!);\r\n        return date >= twoYearsAgo && date < oneYearAgo;\r\n    }).length;\r\n\r\n    const activityTrend = previousDocs === 0 ? 'High' :\r\n        recentDocs > previousDocs * 1.5 ? 'Growing' :\r\n            recentDocs < previousDocs * 0.5 ? 'Declining' : 'Stable';\r\n\r\n    // Analytics: Peak activity period\r\n    const peakYear = Object.entries(publicationsByYear)\r\n        .sort(([, a], [, b]) => b.length - a.length)[0];\r\n\r\n    // Analytics: Jurisdiction leadership\r\n    const jurisdictionLeader = Object.entries(publicationsByJurisdiction)\r\n        .sort(([, a], [, b]) => b.length - a.length)[0];\r\n\r\n    if (isLoading) {\r\n        return <div className=\"p-8 text-center\">Loading timeline...</div>;\r\n    }\r\n\r\n    return (\r\n        <div className=\"space-y-8\">\r\n            <div className=\"flex items-center justify-between\">\r\n                <div>\r\n                    <h1 className=\"text-3xl font-bold tracking-tight\">Temporal Dynamics</h1>\r\n                    <p className=\"text-muted-foreground mt-2\">\r\n                        Track the evolution of AI governance discourse and policy adoption over time.\r\n                    </p>\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"grid gap-6 md:grid-cols-3\">\r\n                <Card>\r\n                    <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n                        <CardTitle className=\"text-sm font-medium\">Total Timeline Events</CardTitle>\r\n                        <Calendar className=\"h-4 w-4 text-muted-foreground\" />\r\n                    </CardHeader>\r\n                    <CardContent>\r\n                        <div className=\"text-2xl font-bold\">{timelineEvents.length}</div>\r\n                        <p className=\"text-xs text-muted-foreground\">Documents with publication dates</p>\r\n                    </CardContent>\r\n                </Card>\r\n                <Card>\r\n                    <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n                        <CardTitle className=\"text-sm font-medium\">Date Range</CardTitle>\r\n                        <Clock className=\"h-4 w-4 text-muted-foreground\" />\r\n                    </CardHeader>\r\n                    <CardContent>\r\n                        <div className=\"text-2xl font-bold\">\r\n                            {timelineEvents.length > 0\r\n                                ? `${new Date(timelineEvents[0].publicationDate!).getFullYear()} - ${new Date(timelineEvents[timelineEvents.length - 1].publicationDate!).getFullYear()}`\r\n                                : \"N/A\"}\r\n                        </div>\r\n                        <p className=\"text-xs text-muted-foreground\">Earliest to latest document</p>\r\n                    </CardContent>\r\n                </Card>\r\n                <Card>\r\n                    <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n                        <CardTitle className=\"text-sm font-medium\">Active Discourse</CardTitle>\r\n                        <TrendingUp className=\"h-4 w-4 text-muted-foreground\" />\r\n                    </CardHeader>\r\n                    <CardContent>\r\n                        <div className=\"text-2xl font-bold\">{activityTrend}</div>\r\n                        <p className=\"text-xs text-muted-foreground\">\r\n                            {recentDocs} docs last year vs. {previousDocs} prior year\r\n                        </p>\r\n                    </CardContent>\r\n                </Card>\r\n            </div>\r\n\r\n            {/* New Analytics Cards */}\r\n            {timelineEvents.length > 0 && (\r\n                <div className=\"grid gap-6 md:grid-cols-2\">\r\n                    <Card>\r\n                        <CardHeader>\r\n                            <CardTitle className=\"text-base\">Peak Activity Period</CardTitle>\r\n                            <CardDescription>Year with most publications</CardDescription>\r\n                        </CardHeader>\r\n                        <CardContent>\r\n                            {peakYear && (\r\n                                <div>\r\n                                    <div className=\"text-3xl font-bold text-indigo-700 mb-2\">{peakYear[0]}</div>\r\n                                    <p className=\"text-sm text-slate-600\">\r\n                                        {peakYear[1].length} publication{peakYear[1].length !== 1 ? 's' : ''}\r\n                                    </p>\r\n                                    <div className=\"mt-3 flex flex-wrap gap-1\">\r\n                                        {Object.entries(\r\n                                            peakYear[1].reduce((acc: Record<string, number>, s: Source) => {\r\n                                                const j = s.jurisdiction || 'Other';\r\n                                                acc[j] = (acc[j] || 0) + 1;\r\n                                                return acc;\r\n                                            }, {})\r\n                                        ).map(([jurisdiction, count]) => (\r\n                                            <Badge key={jurisdiction} variant=\"outline\" className=\"text-xs\">\r\n                                                {jurisdiction}: {count}\r\n                                            </Badge>\r\n                                        ))}\r\n                                    </div>\r\n                                </div>\r\n                            )}\r\n                        </CardContent>\r\n                    </Card>\r\n\r\n                    <Card>\r\n                        <CardHeader>\r\n                            <CardTitle className=\"text-base\">Most Active Jurisdiction</CardTitle>\r\n                            <CardDescription>Publication leadership</CardDescription>\r\n                        </CardHeader>\r\n                        <CardContent>\r\n                            {jurisdictionLeader && (\r\n                                <div>\r\n                                    <div className=\"text-3xl font-bold text-indigo-700 mb-2\">{jurisdictionLeader[0]}</div>\r\n                                    <p className=\"text-sm text-slate-600\">\r\n                                        {jurisdictionLeader[1].length} publication{jurisdictionLeader[1].length !== 1 ? 's' : ''} total\r\n                                    </p>\r\n                                    <div className=\"mt-3 space-y-1\">\r\n                                        {jurisdictionLeader[1][0] && (\r\n                                            <p className=\"text-xs text-slate-500\">\r\n                                                First: {new Date(jurisdictionLeader[1][0].publicationDate!).getFullYear()}\r\n                                            </p>\r\n                                        )}\r\n                                        {jurisdictionLeader[1][jurisdictionLeader[1].length - 1] && (\r\n                                            <p className=\"text-xs text-slate-500\">\r\n                                                Latest: {new Date(jurisdictionLeader[1][jurisdictionLeader[1].length - 1].publicationDate!).getFullYear()}\r\n                                            </p>\r\n                                        )}\r\n                                    </div>\r\n                                </div>\r\n                            )}\r\n                        </CardContent>\r\n                    </Card>\r\n                </div>\r\n            )}\r\n\r\n            {/* Publication Frequency Chart */}\r\n            {timelineEvents.length > 0 && Object.keys(publicationsByYear).length > 0 && (\r\n                <Card>\r\n                    <CardHeader>\r\n                        <CardTitle>Publication Frequency Over Time</CardTitle>\r\n                        <CardDescription>Number of documents published each year</CardDescription>\r\n                    </CardHeader>\r\n                    <CardContent>\r\n                        <div className=\"space-y-4\">\r\n                            {Object.entries(publicationsByYear)\r\n                                .sort(([a], [b]) => Number(a) - Number(b))\r\n                                .map(([year, docs]) => {\r\n                                    const maxCount = Math.max(...Object.values(publicationsByYear).map(d => d.length));\r\n                                    const percentage = (docs.length / maxCount) * 100;\r\n\r\n                                    return (\r\n                                        <div key={year}>\r\n                                            <div className=\"flex items-center justify-between mb-1\">\r\n                                                <span className=\"text-sm font-medium\">{year}</span>\r\n                                                <span className=\"text-sm text-slate-600\">{docs.length} doc{docs.length !== 1 ? 's' : ''}</span>\r\n                                            </div>\r\n                                            <div className=\"w-full bg-slate-100 rounded-full h-6 relative overflow-hidden\">\r\n                                                <div\r\n                                                    className=\"bg-gradient-to-r from-indigo-500 to-indigo-600 h-6 rounded-full flex items-center px-2 transition-all\"\r\n                                                    style={{ width: `${Math.max(percentage, 5)}%` }}\r\n                                                >\r\n                                                    <div className=\"flex gap-1\">\r\n                                                        {Object.entries(\r\n                                                            docs.reduce((acc: Record<string, number>, s: Source) => {\r\n                                                                const j = s.jurisdiction || 'Other';\r\n                                                                acc[j] = (acc[j] || 0) + 1;\r\n                                                                return acc;\r\n                                                            }, {})\r\n                                                        ).map(([jurisdiction]) => (\r\n                                                            <div\r\n                                                                key={jurisdiction}\r\n                                                                className={`w-2 h-2 rounded-full ${jurisdiction === 'EU' ? 'bg-blue-300' :\r\n                                                                    jurisdiction === 'Brazil' ? 'bg-green-300' :\r\n                                                                        jurisdiction === 'US' ? 'bg-red-300' : 'bg-slate-300'\r\n                                                                    }`}\r\n                                                                title={jurisdiction}\r\n                                                            />\r\n                                                        ))}\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n                                    );\r\n                                })}\r\n                        </div>\r\n                    </CardContent>\r\n                </Card>\r\n            )}\r\n\r\n            {/* Timeline */}\r\n            <Card>\r\n                <CardHeader>\r\n                    <CardTitle>Policy Timeline</CardTitle>\r\n                    <CardDescription>Chronological evolution of AI governance documents</CardDescription>\r\n                </CardHeader>\r\n                <CardContent>\r\n                    <div className=\"relative border-l-2 border-slate-200 ml-4 md:ml-8 space-y-12 py-4\">\r\n                        {timelineEvents.length === 0 ? (\r\n                            <div className=\"pl-8 text-muted-foreground\">\r\n                                No documents with publication dates found. Edit your documents to add dates.\r\n                            </div>\r\n                        ) : (\r\n                            timelineEvents.map((source, index) => (\r\n                                <div key={source.id} className=\"relative pl-8 md:pl-12\">\r\n                                    {/* Timeline Dot */}\r\n                                    <div className={`absolute -left-[9px] top-0 h-4 w-4 rounded-full border-2 border-white ${source.jurisdiction === 'EU' ? 'bg-blue-500' :\r\n                                        source.jurisdiction === 'Brazil' ? 'bg-green-500' :\r\n                                            source.jurisdiction === 'US' ? 'bg-red-500' : 'bg-slate-500'\r\n                                        }`} />\r\n\r\n                                    {/* Date Label */}\r\n                                    <div className=\"mb-1 text-sm font-semibold text-slate-500\">\r\n                                        {new Date(source.publicationDate!).toLocaleDateString(\"en-US\", {\r\n                                            year: 'numeric',\r\n                                            month: 'long',\r\n                                            day: 'numeric'\r\n                                        })}\r\n                                    </div>\r\n\r\n                                    {/* Content Card */}\r\n                                    <Card className=\"w-full max-w-3xl hover:shadow-md transition-shadow\">\r\n                                        <CardHeader>\r\n                                            <div className=\"flex items-start justify-between\">\r\n                                                <div>\r\n                                                    <div className=\"flex items-center gap-2 mb-1\">\r\n                                                        <CardTitle className=\"text-lg text-indigo-700\">\r\n                                                            {source.title}\r\n                                                        </CardTitle>\r\n                                                        {source.version && (\r\n                                                            <Badge variant=\"outline\">v{source.version}</Badge>\r\n                                                        )}\r\n                                                        {source.jurisdiction && (\r\n                                                            <Badge className={\r\n                                                                source.jurisdiction === 'EU' ? 'bg-blue-100 text-blue-800 hover:bg-blue-100' :\r\n                                                                    source.jurisdiction === 'Brazil' ? 'bg-green-100 text-green-800 hover:bg-green-100' :\r\n                                                                        'bg-red-100 text-red-800 hover:bg-red-100'\r\n                                                            }>\r\n                                                                {source.jurisdiction}\r\n                                                            </Badge>\r\n                                                        )}\r\n                                                    </div>\r\n                                                    <CardDescription>{source.description}</CardDescription>\r\n                                                </div>\r\n                                                <div className=\"flex gap-2\">\r\n                                                    {/* Placeholder for future actions */}\r\n                                                </div>\r\n                                            </div>\r\n                                        </CardHeader>\r\n                                        <CardContent>\r\n                                            {source.extractedText && (\r\n                                                <p className=\"text-sm text-slate-600 line-clamp-3\">\r\n                                                    {source.extractedText.substring(0, 300)}...\r\n                                                </p>\r\n                                            )}\r\n                                            {source.analysis && (\r\n                                                <div className=\"mt-4 pt-4 border-t\">\r\n                                                    <h4 className=\"text-xs font-semibold uppercase text-slate-500 mb-2\">Key Insight</h4>\r\n                                                    <p className=\"text-sm\">{source.analysis.key_insight || \"No insight available.\"}</p>\r\n                                                </div>\r\n                                            )}\r\n                                        </CardContent>\r\n                                    </Card>\r\n                                </div>\r\n                            ))\r\n                        )}\r\n                    </div>\r\n                </CardContent>\r\n            </Card>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\AnalysisResults.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\AssemblageSankey.tsx","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Use \"@ts-expect-error\" instead of \"@ts-ignore\", as \"@ts-ignore\" will do nothing if the following line is error-free.","line":56,"column":17,"nodeType":"Line","messageId":"tsIgnoreInsteadOfExpectError","endLine":56,"endColumn":30,"suggestions":[{"messageId":"replaceTsIgnoreWithTsExpectError","fix":{"range":[1896,1909],"text":"// @ts-expect-error"},"desc":"Replace \"@ts-ignore\" with \"@ts-expect-error\"."}]}],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":152,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":152,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5464,5467],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5464,5467],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":185,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":185,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7231,7234],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7231,7234],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useMemo, useRef } from \"react\";\r\nimport { ResponsiveContainer, Sankey, Tooltip, Layer, Rectangle } from \"recharts\";\r\nimport { EcosystemImpact } from \"@/types\";\r\n\r\ninterface AssemblageSankeyProps {\r\n    data: EcosystemImpact[];\r\n    height?: number;\r\n}\r\n\r\nexport function AssemblageSankey({ data, height = 500 }: AssemblageSankeyProps) {\r\n    const chartData = useMemo(() => {\r\n        const nodes: { name: string }[] = [];\r\n        const links: { source: number; target: number; value: number; type?: string }[] = [];\r\n\r\n        const nodeMap = new Map<string, number>();\r\n\r\n        const getNodeIndex = (name: string) => {\r\n            if (!nodeMap.has(name)) {\r\n                nodeMap.set(name, nodes.length);\r\n                nodes.push({ name });\r\n            }\r\n            return nodeMap.get(name)!;\r\n        };\r\n\r\n        data.forEach(item => {\r\n            const actorIdx = getNodeIndex(item.actor);\r\n            const mechanismIdx = getNodeIndex(item.mechanism);\r\n            const impactIdx = getNodeIndex(item.impact);\r\n\r\n            // Link: Actor -> Mechanism\r\n            links.push({\r\n                source: actorIdx,\r\n                target: mechanismIdx,\r\n                value: 1,\r\n                type: item.type\r\n            });\r\n\r\n            // Link: Mechanism -> Impact\r\n            links.push({\r\n                source: mechanismIdx,\r\n                target: impactIdx,\r\n                value: 1,\r\n                type: item.type\r\n            });\r\n        });\r\n\r\n        // Aggregate identical links\r\n        const uniqueLinksMap = new Map<string, { source: number; target: number; value: number; type: string }>();\r\n        links.forEach(link => {\r\n            const key = `${link.source}-${link.target}`;\r\n            if (uniqueLinksMap.has(key)) {\r\n                uniqueLinksMap.get(key)!.value += 1;\r\n            } else {\r\n                // @ts-ignore\r\n                uniqueLinksMap.set(key, { ...link });\r\n            }\r\n        });\r\n\r\n        return {\r\n            nodes,\r\n            links: Array.from(uniqueLinksMap.values())\r\n        };\r\n    }, [data]);\r\n\r\n    const containerRef = useRef<HTMLDivElement>(null);\r\n\r\n    const handleDownload = () => {\r\n        if (!containerRef.current) return;\r\n\r\n        const svgElement = containerRef.current.querySelector('svg');\r\n        if (!svgElement) {\r\n            console.error(\"SVG element not found\");\r\n            return;\r\n        }\r\n\r\n        // Get SVG data\r\n        const serializer = new XMLSerializer();\r\n        const svgString = serializer.serializeToString(svgElement);\r\n        const svgBlob = new Blob([svgString], { type: 'image/svg+xml;charset=utf-8' });\r\n        const url = URL.createObjectURL(svgBlob);\r\n\r\n        // Create image and draw to canvas\r\n        const img = new Image();\r\n        img.onload = () => {\r\n            const canvas = document.createElement('canvas');\r\n            // Use the actual SVG dimensions or the container dimensions\r\n            const width = svgElement.clientWidth || 800;\r\n            const height = svgElement.clientHeight || 500;\r\n\r\n            // Scale up for better resolution\r\n            const scale = 2;\r\n            canvas.width = width * scale;\r\n            canvas.height = height * scale;\r\n\r\n            const ctx = canvas.getContext('2d');\r\n            if (!ctx) return;\r\n\r\n            // Fill white background\r\n            ctx.fillStyle = '#ffffff';\r\n            ctx.fillRect(0, 0, canvas.width, canvas.height);\r\n\r\n            ctx.scale(scale, scale);\r\n            ctx.drawImage(img, 0, 0);\r\n\r\n            // Trigger download\r\n            const pngUrl = canvas.toDataURL('image/png');\r\n            const downloadLink = document.createElement('a');\r\n            downloadLink.href = pngUrl;\r\n            downloadLink.download = 'assemblage-sankey.png';\r\n            document.body.appendChild(downloadLink);\r\n            downloadLink.click();\r\n            document.body.removeChild(downloadLink);\r\n\r\n            URL.revokeObjectURL(url);\r\n        };\r\n        img.src = url;\r\n    };\r\n\r\n    if (data.length === 0) {\r\n        return (\r\n            <div className=\"flex items-center justify-center h-full text-slate-400 text-sm\">\r\n                No data available for visualization\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div style={{ width: '100%', height }} className=\"relative\" ref={containerRef}>\r\n            <div className=\"absolute top-0 right-0 z-10\">\r\n                <button\r\n                    onClick={handleDownload}\r\n                    className=\"bg-white/80 hover:bg-white border border-slate-200 text-slate-600 text-xs font-medium px-2 py-1 rounded shadow-sm backdrop-blur-sm transition-colors\"\r\n                    title=\"Download as PNG\"\r\n                >\r\n                    Download PNG\r\n                </button>\r\n            </div>\r\n\r\n            {/* Column Headers */}\r\n            <div className=\"flex justify-between px-4 mb-2 text-sm font-bold text-slate-700 uppercase tracking-wider border-b pb-2\">\r\n                <div className=\"w-1/3 text-left\">Actors</div>\r\n                <div className=\"w-1/3 text-center\">Mechanisms</div>\r\n                <div className=\"w-1/3 text-right pr-40\">Impacts</div>\r\n            </div>\r\n\r\n            <ResponsiveContainer>\r\n                <Sankey\r\n                    data={chartData}\r\n                    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n                    node={(props: any) => {\r\n                        const { x, y, width, height, index, payload, containerWidth } = props;\r\n                        const isOut = x + width + 6 > (containerWidth || 500) / 2;\r\n\r\n                        // Determine color based on node type or connection\r\n                        const fill = \"#3b82f6\";\r\n\r\n                        // Truncate text if it's too long\r\n                        const truncateText = (text: string, maxLength: number) => {\r\n                            if (text.length <= maxLength) return text;\r\n                            return text.slice(0, maxLength) + '...';\r\n                        };\r\n\r\n                        return (\r\n                            <Layer key={`CustomNode${index}`}>\r\n                                <Rectangle x={x} y={y} width={width} height={height} fill={fill} fillOpacity=\"1\" />\r\n                                <text\r\n                                    textAnchor={isOut ? 'end' : 'start'}\r\n                                    x={isOut ? x - 6 : x + width + 6}\r\n                                    y={y + height / 2}\r\n                                    fontSize=\"11\"\r\n                                    stroke=\"none\"\r\n                                    fill=\"#1e293b\"\r\n                                    dy=\"0.355em\"\r\n                                    fontWeight=\"500\"\r\n                                >\r\n                                    {truncateText(payload.name, 35)}\r\n                                </text>\r\n                                <title>{payload.name}</title>\r\n                            </Layer>\r\n                        );\r\n                    }}\r\n                    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n                    link={(props: any) => {\r\n                        const { sourceX, sourceY, targetX, targetY, linkWidth, payload } = props;\r\n                        // Color links based on the \"type\" of the impact\r\n                        const isConstraint = payload.type === \"Constraint\";\r\n                        const color = isConstraint ? \"#fca5a5\" : \"#86efac\"; // Red-300 for constraint, Green-300 for affordance\r\n                        const opacity = 0.6;\r\n\r\n                        return (\r\n                            <path\r\n                                d={`\r\n                                     M${sourceX},${sourceY + linkWidth / 2}\r\n                                     C${sourceX + 100},${sourceY + linkWidth / 2}\r\n                                     ${targetX - 100},${targetY + linkWidth / 2}\r\n                                     ${targetX},${targetY + linkWidth / 2}\r\n                                     L${targetX},${targetY - linkWidth / 2}\r\n                                     C${targetX - 100},${targetY - linkWidth / 2}\r\n                                     ${sourceX + 100},${sourceY - linkWidth / 2}\r\n                                     ${sourceX},${sourceY - linkWidth / 2}\r\n                                     Z\r\n                                 `}\r\n                                fill={color}\r\n                                fillOpacity={opacity}\r\n                                stroke={isConstraint ? \"#ef4444\" : \"#22c55e\"}\r\n                                strokeWidth={1}\r\n                                strokeOpacity={0.2}\r\n                            />\r\n                        );\r\n                    }}\r\n                    nodePadding={50}\r\n                    margin={{\r\n                        left: 20,\r\n                        right: 160,\r\n                        top: 20,\r\n                        bottom: 20,\r\n                    }}\r\n                >\r\n                    <Tooltip />\r\n                </Sankey>\r\n            </ResponsiveContainer>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\CulturalHoleCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\CulturalHoleMatrix.tsx","messages":[{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":110,"column":89,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[5900,6116],"text":"\r\n                                                            These discourse clusters don&apos;t \"speak to each other\"  they use different language and concepts.\r\n                                                        "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[5900,6116],"text":"\r\n                                                            These discourse clusters don&lsquo;t \"speak to each other\"  they use different language and concepts.\r\n                                                        "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[5900,6116],"text":"\r\n                                                            These discourse clusters don&#39;t \"speak to each other\"  they use different language and concepts.\r\n                                                        "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[5900,6116],"text":"\r\n                                                            These discourse clusters don&rsquo;t \"speak to each other\"  they use different language and concepts.\r\n                                                        "},"desc":"Replace with `&rsquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":110,"column":92,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[5900,6116],"text":"\r\n                                                            These discourse clusters don't &quot;speak to each other\"  they use different language and concepts.\r\n                                                        "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[5900,6116],"text":"\r\n                                                            These discourse clusters don't &ldquo;speak to each other\"  they use different language and concepts.\r\n                                                        "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[5900,6116],"text":"\r\n                                                            These discourse clusters don't &#34;speak to each other\"  they use different language and concepts.\r\n                                                        "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[5900,6116],"text":"\r\n                                                            These discourse clusters don't &rdquo;speak to each other\"  they use different language and concepts.\r\n                                                        "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":110,"column":112,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[5900,6116],"text":"\r\n                                                            These discourse clusters don't \"speak to each other&quot;  they use different language and concepts.\r\n                                                        "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[5900,6116],"text":"\r\n                                                            These discourse clusters don't \"speak to each other&ldquo;  they use different language and concepts.\r\n                                                        "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[5900,6116],"text":"\r\n                                                            These discourse clusters don't \"speak to each other&#34;  they use different language and concepts.\r\n                                                        "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[5900,6116],"text":"\r\n                                                            These discourse clusters don't \"speak to each other&rdquo;  they use different language and concepts.\r\n                                                        "},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport React from \"react\";\r\nimport { DiscourseCluster, CulturalHole, BridgingConcept } from \"@/types/cultural\";\r\nimport { Tooltip, TooltipContent, TooltipProvider, TooltipTrigger } from \"@/components/ui/tooltip\";\r\n\r\ninterface CulturalHoleMatrixProps {\r\n    clusters: DiscourseCluster[];\r\n    holes: CulturalHole[];\r\n    onConceptClick?: (concept: BridgingConcept) => void;\r\n}\r\n\r\nexport function CulturalHoleMatrix({ clusters, holes, onConceptClick }: CulturalHoleMatrixProps) {\r\n    if (clusters.length === 0) {\r\n        return (\r\n            <div className=\"flex items-center justify-center h-96 bg-slate-50 rounded-lg border-2 border-dashed border-slate-300\">\r\n                <p className=\"text-slate-500\">No cultural analysis data available</p>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    // Helper to get hole between two clusters\r\n    const getHole = (nameA: string, nameB: string) => {\r\n        return holes.find(h =>\r\n            (h.clusterA === nameA && h.clusterB === nameB) ||\r\n            (h.clusterA === nameB && h.clusterB === nameA)\r\n        );\r\n    };\r\n\r\n    // Helper to get color based on distance\r\n    const getCellColor = (distance: number) => {\r\n        if (distance < 0.2) return \"bg-slate-50\";\r\n        if (distance < 0.4) return \"bg-red-50\";\r\n        if (distance < 0.6) return \"bg-red-100\";\r\n        if (distance < 0.8) return \"bg-red-200\";\r\n        return \"bg-red-300\";\r\n    };\r\n\r\n    return (\r\n        <div className=\"overflow-x-auto\">\r\n            <div className=\"min-w-[600px] p-2\">\r\n                <div className=\"grid\" style={{\r\n                    gridTemplateColumns: `auto repeat(${clusters.length}, minmax(60px, 1fr))`\r\n                }}>\r\n                    {/* Header Row */}\r\n                    <div className=\"h-16\"></div>\r\n                    {clusters.map((cluster) => (\r\n                        <div key={cluster.id} className=\"relative h-16 border-b border-slate-200\">\r\n                            <div className=\"absolute bottom-2 left-1/2 -translate-x-1/2 w-full text-center transform -rotate-45 origin-bottom text-xs font-medium text-slate-700 px-1 whitespace-nowrap\">\r\n                                {cluster.name}\r\n                            </div>\r\n                        </div>\r\n                    ))}\r\n\r\n                    {/* Matrix Rows */}\r\n                    {clusters.map((rowCluster, rowIndex) => (\r\n                        <React.Fragment key={rowCluster.id}>\r\n                            {/* Row Header */}\r\n                            <div className=\"flex items-center justify-end pr-2 py-1 border-r border-slate-200\">\r\n                                <span className=\"text-xs font-medium text-slate-700 text-right truncate w-24\">\r\n                                    {rowCluster.name}\r\n                                </span>\r\n                            </div>\r\n\r\n                            {/* Cells */}\r\n                            {clusters.map((colCluster, colIndex) => {\r\n                                const isDiagonal = rowIndex === colIndex;\r\n                                const isLowerTriangle = colIndex < rowIndex;\r\n                                const hole = getHole(rowCluster.name, colCluster.name);\r\n\r\n                                if (isLowerTriangle) {\r\n                                    return (\r\n                                        <div key={`${rowCluster.id}-${colCluster.id}`} className=\"bg-slate-50/50 border border-white h-12\" />\r\n                                    );\r\n                                }\r\n\r\n                                if (isDiagonal) {\r\n                                    return (\r\n                                        <div key={`${rowCluster.id}-${colCluster.id}`} className=\"bg-slate-100 border border-white flex items-center justify-center h-12\">\r\n                                            <span className=\"text-xs font-bold text-slate-400\">\r\n                                                {rowCluster.size}\r\n                                            </span>\r\n                                        </div>\r\n                                    );\r\n                                }\r\n\r\n                                if (!hole) {\r\n                                    return (\r\n                                        <div key={`${rowCluster.id}-${colCluster.id}`} className=\"bg-slate-50 border border-white h-12\" />\r\n                                    );\r\n                                }\r\n\r\n                                return (\r\n                                    <TooltipProvider key={`${rowCluster.id}-${colCluster.id}`}>\r\n                                        <Tooltip>\r\n                                            <TooltipTrigger asChild>\r\n                                                <div\r\n                                                    className={`${getCellColor(hole.distance)} border border-white h-12 flex items-center justify-center cursor-help transition-colors hover:opacity-80`}\r\n                                                >\r\n                                                    <span className=\"text-xs font-medium text-red-900 opacity-50\">\r\n                                                        {(hole.distance * 100).toFixed(0)}%\r\n                                                    </span>\r\n                                                </div>\r\n                                            </TooltipTrigger>\r\n                                            <TooltipContent className=\"max-w-md bg-white border-slate-200 shadow-lg\">\r\n                                                <div className=\"space-y-3\">\r\n                                                    <div>\r\n                                                        <p className=\"font-bold text-sm text-amber-700\"> Cultural Gap Detected</p>\r\n                                                        <p className=\"text-xs text-slate-600 mt-1\">\r\n                                                            These discourse clusters don't \"speak to each other\"  they use different language and concepts.\r\n                                                        </p>\r\n                                                    </div>\r\n\r\n                                                    {/* Cluster Definitions */}\r\n                                                    <div className=\"text-xs space-y-2 bg-slate-50 p-2 rounded border border-slate-100\">\r\n                                                        <div>\r\n                                                            <span className=\"font-semibold text-indigo-700\">Cluster A:</span>{\" \"}\r\n                                                            <span className=\"text-slate-700\">\r\n                                                                {hole.clusterA}\r\n                                                            </span>\r\n                                                            {clusters.find(c => c.name === hole.clusterA)?.description && (\r\n                                                                <p className=\"text-slate-600 italic mt-0.5 pl-2\">\r\n                                                                    {clusters.find(c => c.name === hole.clusterA)?.description}\r\n                                                                </p>\r\n                                                            )}\r\n                                                        </div>\r\n                                                        <div>\r\n                                                            <span className=\"font-semibold text-indigo-700\">Cluster B:</span>{\" \"}\r\n                                                            <span className=\"text-slate-700\">\r\n                                                                {hole.clusterB}\r\n                                                            </span>\r\n                                                            {clusters.find(c => c.name === hole.clusterB)?.description && (\r\n                                                                <p className=\"text-slate-600 italic mt-0.5 pl-2\">\r\n                                                                    {clusters.find(c => c.name === hole.clusterB)?.description}\r\n                                                                </p>\r\n                                                            )}\r\n                                                        </div>\r\n                                                    </div>\r\n\r\n                                                    <div className=\"text-xs space-y-2 border-t border-slate-100 pt-2\">\r\n                                                        <p>\r\n                                                            <span className=\"font-semibold text-slate-700\">Gap Size:</span>{\" \"}\r\n                                                            <span className=\"text-slate-900\">{(hole.distance * 100).toFixed(0)}%</span>\r\n                                                            <span className=\"text-slate-500 ml-1\">\r\n                                                                ({hole.distance > 0.7 ? \"Very Large\" : hole.distance > 0.4 ? \"Moderate\" : \"Small\"})\r\n                                                            </span>\r\n                                                        </p>\r\n\r\n                                                        {/* Bridging Concepts with individual tooltips */}\r\n                                                        <div>\r\n                                                            <p className=\"font-semibold text-slate-700 mb-1\">Bridging Ideas (Click to Draft Policy):</p>\r\n                                                            <div className=\"flex flex-wrap gap-1\">\r\n                                                                {hole.bridgingConcepts.map((bc: BridgingConcept, idx: number) => (\r\n                                                                    <TooltipProvider key={idx}>\r\n                                                                        <Tooltip>\r\n                                                                            <TooltipTrigger asChild>\r\n                                                                                <button\r\n                                                                                    onClick={() => onConceptClick?.(bc)}\r\n                                                                                    className=\"px-2 py-0.5 bg-blue-50 text-blue-700 rounded border border-blue-100 cursor-pointer text-xs hover:bg-blue-100 hover:scale-105 transition-all\"\r\n                                                                                >\r\n                                                                                    {bc.concept}\r\n                                                                                </button>\r\n                                                                            </TooltipTrigger>\r\n                                                                            <TooltipContent className=\"max-w-xs bg-white\">\r\n                                                                                <p className=\"text-xs text-slate-700\">{bc.explanation}</p>\r\n                                                                                <p className=\"text-[10px] text-blue-500 mt-1 font-semibold\">Click to generate policy draft</p>\r\n                                                                            </TooltipContent>\r\n                                                                        </Tooltip>\r\n                                                                    </TooltipProvider>\r\n                                                                ))}\r\n                                                            </div>\r\n                                                        </div>\r\n\r\n                                                        <div className=\"bg-amber-50 p-2 rounded border border-amber-100 mt-2\">\r\n                                                            <p className=\"font-semibold text-amber-900 mb-1\"> Opportunity for Innovation:</p>\r\n                                                            <p className=\"text-slate-700\">{hole.opportunity}</p>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                </div>\r\n                                            </TooltipContent>\r\n                                        </Tooltip>\r\n                                    </TooltipProvider>\r\n                                );\r\n                            })}\r\n                        </React.Fragment>\r\n                    ))}\r\n                </div>\r\n\r\n                {/* Legend */}\r\n                <div className=\"mt-4 flex items-center justify-end gap-4 text-xs text-slate-600\">\r\n                    <div className=\"flex items-center gap-2\">\r\n                        <div className=\"w-4 h-4 bg-slate-100 border border-slate-200\"></div>\r\n                        <span>Cluster Size</span>\r\n                    </div>\r\n                    <div className=\"flex items-center gap-2\">\r\n                        <div className=\"flex\">\r\n                            <div className=\"w-4 h-4 bg-slate-50\"></div>\r\n                            <div className=\"w-4 h-4 bg-red-50\"></div>\r\n                            <div className=\"w-4 h-4 bg-red-100\"></div>\r\n                            <div className=\"w-4 h-4 bg-red-200\"></div>\r\n                            <div className=\"w-4 h-4 bg-red-300\"></div>\r\n                        </div>\r\n                        <span>Gap Distance (Low  High)</span>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\CulturalHoleNetwork.tsx","messages":[{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`drawNetwork` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\nC:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\CulturalHoleNetwork.tsx:28:13\n  26 |             canvas.height = height;\n  27 |             // Initial draw\n> 28 |             drawNetwork(canvas, width, height, 0);\n     |             ^^^^^^^^^^^ `drawNetwork` accessed before it is declared\n  29 |         });\n  30 |\n  31 |         resizeObserver.observe(container);\n\nC:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\CulturalHoleNetwork.tsx:62:5\n   60 |     }, [isLive, clusters, holes]);\n   61 |\n>  62 |     const drawNetwork = (canvas: HTMLCanvasElement, width: number, height: number, time: number) => {\n      |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n>  63 |         const ctx = canvas.getContext(\"2d\");\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n>  64 |         if (!ctx) return;\n      \n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 188 |         });\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 189 |     };\n      | ^^^^^^^ `drawNetwork` is declared here\n  190 |\n  191 |     if (clusters.length === 0) {\n  192 |         return (","line":28,"column":13,"nodeType":null,"endLine":28,"endColumn":24},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'drawNetwork'. Either include it or remove the dependency array.","line":37,"column":8,"nodeType":"ArrayExpression","endLine":37,"endColumn":25,"suggestions":[{"desc":"Update the dependencies array to be: [clusters, drawNetwork, holes]","fix":{"range":[1257,1274],"text":"[clusters, drawNetwork, holes]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'drawNetwork'. Either include it or remove the dependency array.","line":60,"column":8,"nodeType":"ArrayExpression","endLine":60,"endColumn":33,"suggestions":[{"desc":"Update the dependencies array to be: [isLive, clusters, holes, drawNetwork]","fix":{"range":[2018,2043],"text":"[isLive, clusters, holes, drawNetwork]"}}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useEffect, useRef } from \"react\";\r\nimport { DiscourseCluster, CulturalHole } from \"@/types/cultural\";\r\n\r\ninterface CulturalHoleNetworkProps {\r\n    clusters: DiscourseCluster[];\r\n    holes: CulturalHole[];\r\n    isLive?: boolean;\r\n}\r\n\r\nexport function CulturalHoleNetwork({ clusters, holes, isLive = false }: CulturalHoleNetworkProps) {\r\n    const containerRef = useRef<HTMLDivElement>(null);\r\n    const canvasRef = useRef<HTMLCanvasElement>(null);\r\n    const animationRef = useRef<number>();\r\n    const timeRef = useRef<number>(0);\r\n\r\n    useEffect(() => {\r\n        const container = containerRef.current;\r\n        const canvas = canvasRef.current;\r\n        if (!container || !canvas || clusters.length === 0) return;\r\n\r\n        const resizeObserver = new ResizeObserver((entries) => {\r\n            const { width, height } = entries[0].contentRect;\r\n            canvas.width = width;\r\n            canvas.height = height;\r\n            // Initial draw\r\n            drawNetwork(canvas, width, height, 0);\r\n        });\r\n\r\n        resizeObserver.observe(container);\r\n\r\n        return () => {\r\n            resizeObserver.disconnect();\r\n            if (animationRef.current) cancelAnimationFrame(animationRef.current);\r\n        };\r\n    }, [clusters, holes]);\r\n\r\n    // Animation Loop\r\n    useEffect(() => {\r\n        const canvas = canvasRef.current;\r\n        if (!canvas || !isLive) {\r\n            if (animationRef.current) cancelAnimationFrame(animationRef.current);\r\n            // Reset to static state\r\n            if (canvas) drawNetwork(canvas, canvas.width, canvas.height, 0);\r\n            return;\r\n        }\r\n\r\n        const animate = () => {\r\n            timeRef.current += 0.01;\r\n            drawNetwork(canvas, canvas.width, canvas.height, timeRef.current);\r\n            animationRef.current = requestAnimationFrame(animate);\r\n        };\r\n\r\n        animate();\r\n\r\n        return () => {\r\n            if (animationRef.current) cancelAnimationFrame(animationRef.current);\r\n        };\r\n    }, [isLive, clusters, holes]);\r\n\r\n    const drawNetwork = (canvas: HTMLCanvasElement, width: number, height: number, time: number) => {\r\n        const ctx = canvas.getContext(\"2d\");\r\n        if (!ctx) return;\r\n\r\n        // Clear canvas\r\n        ctx.clearRect(0, 0, width, height);\r\n\r\n        // Calculate positions for clusters (circular layout)\r\n        const centerX = width / 2;\r\n        const centerY = height / 2;\r\n        const radius = Math.min(width, height) * 0.3;\r\n\r\n        const positions = clusters.map((_, i) => {\r\n            const angle = (i / clusters.length) * 2 * Math.PI - Math.PI / 2;\r\n\r\n            // Add subtle movement if live\r\n            const driftX = isLive ? Math.sin(time + i) * 10 : 0;\r\n            const driftY = isLive ? Math.cos(time + i * 2) * 10 : 0;\r\n\r\n            // Add \"breathing\" radius\r\n            const breathingRadius = isLive ? radius + Math.sin(time * 0.5) * 5 : radius;\r\n\r\n            return {\r\n                x: centerX + breathingRadius * Math.cos(angle) + driftX,\r\n                y: centerY + breathingRadius * Math.sin(angle) + driftY,\r\n            };\r\n        });\r\n\r\n        // Draw connections (holes) first\r\n        holes.forEach((hole) => {\r\n            const indexA = clusters.findIndex((c) => c.id === hole.clusterA);\r\n            const indexB = clusters.findIndex((c) => c.id === hole.clusterB);\r\n\r\n            if (indexA === -1 || indexB === -1) return;\r\n\r\n            const posA = positions[indexA];\r\n            const posB = positions[indexB];\r\n\r\n            // Color based on gap size\r\n            const alpha = hole.distance;\r\n\r\n            // Draw glow effect\r\n            ctx.shadowBlur = isLive ? 15 + Math.sin(time * 2) * 5 : 10;\r\n            ctx.shadowColor = `rgba(239, 68, 68, ${alpha * 0.5})`;\r\n\r\n            ctx.strokeStyle = `rgba(239, 68, 68, ${alpha * 0.8})`; // Red with transparency\r\n            ctx.lineWidth = 3;\r\n            ctx.setLineDash([8, 6]); // Dashed line for gaps\r\n\r\n            // Animate dash offset\r\n            ctx.lineDashOffset = isLive ? -time * 10 : 0;\r\n\r\n            ctx.beginPath();\r\n            ctx.moveTo(posA.x, posA.y);\r\n            ctx.lineTo(posB.x, posB.y);\r\n            ctx.stroke();\r\n\r\n            ctx.setLineDash([]); // Reset dash\r\n            ctx.shadowBlur = 0; // Reset shadow\r\n        });\r\n\r\n        // Draw clusters as nodes\r\n        clusters.forEach((cluster, i) => {\r\n            const pos = positions[i];\r\n            const nodeRadius = 25 + cluster.size * 2;\r\n\r\n            // Draw node shadow\r\n            ctx.shadowBlur = isLive ? 20 + Math.sin(time * 3) * 5 : 15;\r\n            ctx.shadowColor = \"rgba(59, 130, 246, 0.4)\";\r\n            ctx.shadowOffsetY = 4;\r\n\r\n            // Draw node circle (Gradient)\r\n            const gradient = ctx.createRadialGradient(pos.x - nodeRadius / 3, pos.y - nodeRadius / 3, nodeRadius / 10, pos.x, pos.y, nodeRadius);\r\n            gradient.addColorStop(0, \"#60a5fa\"); // Light blue\r\n            gradient.addColorStop(1, \"#2563eb\"); // Blue\r\n\r\n            ctx.fillStyle = gradient;\r\n            ctx.beginPath();\r\n            ctx.arc(pos.x, pos.y, nodeRadius, 0, 2 * Math.PI);\r\n            ctx.fill();\r\n\r\n            // Reset shadow\r\n            ctx.shadowBlur = 0;\r\n            ctx.shadowOffsetY = 0;\r\n\r\n            // Draw border\r\n            ctx.strokeStyle = \"#ffffff\";\r\n            ctx.lineWidth = 3;\r\n            ctx.stroke();\r\n\r\n            // Draw label background (pill)\r\n            ctx.font = \"bold 13px Inter, sans-serif\";\r\n            const maxLength = 25;\r\n            const displayName = cluster.name.length > maxLength\r\n                ? cluster.name.substring(0, maxLength) + \"...\"\r\n                : cluster.name;\r\n\r\n            const textMetrics = ctx.measureText(displayName);\r\n            const textWidth = textMetrics.width;\r\n            const textHeight = 16;\r\n            const padding = 8;\r\n\r\n            const labelY = pos.y + nodeRadius + 15;\r\n\r\n            ctx.fillStyle = \"rgba(255, 255, 255, 0.9)\";\r\n            ctx.beginPath();\r\n            ctx.roundRect(pos.x - textWidth / 2 - padding, labelY, textWidth + padding * 2, textHeight + padding, 6);\r\n            ctx.fill();\r\n            ctx.strokeStyle = \"#e2e8f0\";\r\n            ctx.lineWidth = 1;\r\n            ctx.stroke();\r\n\r\n            // Draw label text\r\n            ctx.fillStyle = \"#1e293b\";\r\n            ctx.textAlign = \"center\";\r\n            ctx.textBaseline = \"top\";\r\n            ctx.fillText(displayName, pos.x, labelY + padding / 2);\r\n\r\n            // Draw theme count inside node\r\n            ctx.fillStyle = \"#ffffff\";\r\n            ctx.font = \"bold 16px Inter, sans-serif\";\r\n            ctx.textBaseline = \"middle\";\r\n            ctx.shadowColor = \"rgba(0,0,0,0.2)\";\r\n            ctx.shadowBlur = 2;\r\n            ctx.fillText(cluster.size.toString(), pos.x, pos.y);\r\n            ctx.shadowBlur = 0;\r\n        });\r\n    };\r\n\r\n    if (clusters.length === 0) {\r\n        return (\r\n            <div className=\"flex items-center justify-center h-96 bg-slate-50 rounded-lg border-2 border-dashed border-slate-300\">\r\n                <p className=\"text-slate-500\">No cultural analysis data available</p>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div ref={containerRef} className=\"relative w-full h-full min-h-[400px]\">\r\n            <canvas\r\n                ref={canvasRef}\r\n                className=\"w-full h-full rounded-lg bg-slate-50/50\"\r\n            />\r\n            <div className=\"absolute bottom-4 left-4 flex items-center gap-4 text-xs text-slate-600 bg-white/80 p-2 rounded-lg backdrop-blur-sm border border-slate-200 shadow-sm\">\r\n                <div className=\"flex items-center gap-2\">\r\n                    <div className=\"w-3 h-3 rounded-full bg-blue-500 border border-blue-600\"></div>\r\n                    <span>Cluster</span>\r\n                </div>\r\n                <div className=\"flex items-center gap-2\">\r\n                    <div className=\"w-6 h-0.5 border-t-2 border-dashed border-red-500\"></div>\r\n                    <span>Cultural Hole</span>\r\n                </div>\r\n                {isLive && (\r\n                    <div className=\"flex items-center gap-2 text-indigo-600 font-medium animate-pulse\">\r\n                        <div className=\"w-2 h-2 rounded-full bg-indigo-500\"></div>\r\n                        <span>Live Assemblage</span>\r\n                    </div>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\ResearchWorkflowGuide.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useEffect' is defined but never used.","line":3,"column":20,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":29},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ChevronRight' is defined but never used.","line":4,"column":23,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":35}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport { BookOpen, X, ChevronRight, Database, GitGraph, FileText, Share2 } from \"lucide-react\";\r\nimport Link from \"next/link\";\r\nimport { usePathname } from \"next/navigation\";\r\n\r\nexport function ResearchWorkflowGuide() {\r\n    const [isOpen, setIsOpen] = useState(false);\r\n    const pathname = usePathname();\r\n\r\n    // Auto-minimize on specific pages if needed, or keep persistent\r\n    // For now, we'll just let the user control it.\r\n\r\n    if (!isOpen) {\r\n        return (\r\n            <button\r\n                onClick={() => setIsOpen(true)}\r\n                className=\"fixed bottom-6 right-6 bg-blue-600 text-white p-3 rounded-full shadow-lg hover:bg-blue-700 transition-all z-50 flex items-center gap-2\"\r\n                title=\"Open Research Guide\"\r\n            >\r\n                <BookOpen size={20} />\r\n                <span className=\"font-medium text-sm pr-1\">CFP Guide</span>\r\n            </button>\r\n        );\r\n    }\r\n\r\n    const steps = [\r\n        {\r\n            id: 1,\r\n            title: \"Data Collection\",\r\n            icon: <Database size={16} />,\r\n            desc: \"Ingest documents and capture empirical traces.\",\r\n            link: \"/data\",\r\n            active: pathname === \"/data\" || pathname === \"/empirical\"\r\n        },\r\n        {\r\n            id: 2,\r\n            title: \"Micro Analysis\",\r\n            icon: <FileText size={16} />,\r\n            desc: \"Analyze resistance and reflect on positionality.\",\r\n            link: \"/resistance\",\r\n            active: pathname === \"/resistance\" || pathname === \"/reflexivity\"\r\n        },\r\n        {\r\n            id: 3,\r\n            title: \"Meso Analysis\",\r\n            icon: <GitGraph size={16} />,\r\n            desc: \"Map ecosystems and conceptual networks.\",\r\n            link: \"/ecosystem\",\r\n            active: pathname === \"/ecosystem\" || pathname === \"/ontology\"\r\n        },\r\n        {\r\n            id: 4,\r\n            title: \"Macro Analysis\",\r\n            icon: <Share2 size={16} />,\r\n            desc: \"Examine governance structures and cultural framing.\",\r\n            link: \"/governance\",\r\n            active: pathname === \"/governance\" || pathname === \"/cultural\" || pathname === \"/timeline\" || pathname === \"/comparison\"\r\n        },\r\n        {\r\n            id: 5,\r\n            title: \"Synthesis\",\r\n            icon: <BookOpen size={16} />,\r\n            desc: \"Generate reports and visualize the assemblage.\",\r\n            link: \"/synthesis\",\r\n            active: pathname === \"/synthesis\"\r\n        }\r\n    ];\r\n\r\n    return (\r\n        <div className=\"fixed bottom-6 right-6 w-80 bg-white rounded-xl shadow-2xl border border-slate-200 z-50 overflow-hidden flex flex-col animate-in slide-in-from-bottom-5 duration-300\">\r\n            <div className=\"bg-slate-900 text-white p-4 flex justify-between items-start\">\r\n                <div>\r\n                    <h3 className=\"font-bold text-sm flex items-center gap-2\">\r\n                        <BookOpen size={16} className=\"text-blue-400\" />\r\n                        Assemblage AI Guide\r\n                    </h3>\r\n                    <p className=\"text-xs text-slate-400 mt-1\">\r\n                        Critical Analysis Workflow\r\n                    </p>\r\n                </div>\r\n                <button\r\n                    onClick={() => setIsOpen(false)}\r\n                    className=\"text-slate-400 hover:text-white transition-colors\"\r\n                >\r\n                    <X size={16} />\r\n                </button>\r\n            </div>\r\n\r\n            <div className=\"p-4 space-y-4 max-h-[60vh] overflow-y-auto\">\r\n                <div className=\"space-y-3\">\r\n                    {steps.map((step) => (\r\n                        <Link\r\n                            key={step.id}\r\n                            href={step.link}\r\n                            className={`block group border rounded-lg p-3 transition-all ${step.active\r\n                                ? \"bg-blue-50 border-blue-200 ring-1 ring-blue-200\"\r\n                                : \"bg-white border-slate-100 hover:border-blue-200 hover:shadow-sm\"\r\n                                }`}\r\n                        >\r\n                            <div className=\"flex items-center justify-between mb-1\">\r\n                                <div className={`flex items-center gap-2 font-semibold text-sm ${step.active ? \"text-blue-700\" : \"text-slate-700\"\r\n                                    }`}>\r\n                                    <span className={`p-1 rounded ${step.active ? \"bg-blue-100\" : \"bg-slate-100 group-hover:bg-blue-50\"\r\n                                        }`}>\r\n                                        {step.icon}\r\n                                    </span>\r\n                                    {step.title}\r\n                                </div>\r\n                                {step.active && <div className=\"w-2 h-2 rounded-full bg-blue-500\"></div>}\r\n                            </div>\r\n                            <p className=\"text-xs text-slate-500 leading-relaxed pl-8\">\r\n                                {step.desc}\r\n                            </p>\r\n                        </Link>\r\n                    ))}\r\n                </div>\r\n\r\n                <div className=\"bg-slate-50 p-3 rounded-lg border border-slate-100\">\r\n                    <h4 className=\"text-xs font-semibold text-slate-700 mb-2\">Current Goal:</h4>\r\n                    <p className=\"text-xs text-slate-600 leading-relaxed\">\r\n                        Begin by uploading your primary policy documents in the <strong>Data Collection</strong> tab to initialize the assemblage analysis.\r\n                    </p>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\Sidebar.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\Sidebar.tsx:31:9\n  29 |     // Close mobile menu when path changes\n  30 |     useEffect(() => {\n> 31 |         setIsMobileOpen(false);\n     |         ^^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  32 |     }, [pathname]);\n  33 |\n  34 |     // Handle hydration mismatch","line":31,"column":9,"nodeType":null,"endLine":31,"endColumn":24},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\Sidebar.tsx:36:9\n  34 |     // Handle hydration mismatch\n  35 |     useEffect(() => {\n> 36 |         setIsMounted(true);\n     |         ^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  37 |     }, []);\n  38 |\n  39 |     const navGroups = [","line":36,"column":9,"nodeType":null,"endLine":36,"endColumn":21},{"ruleId":"react-hooks/static-components","severity":2,"message":"Error: Cannot create components during render\n\nComponents created during render will reset their state each time they are created. Declare components outside of render.\n\nC:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\Sidebar.tsx:219:18\n  217 |             {/* Desktop Sidebar */}\n  218 |             <div className=\"hidden md:flex w-64 border-r border-slate-200 bg-white flex-col h-full flex-shrink-0\">\n> 219 |                 <SidebarContent />\n      |                  ^^^^^^^^^^^^^^ This component is created during render\n  220 |             </div>\n  221 |\n  222 |             {/* Mobile Header */}\n\nC:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\Sidebar.tsx:156:28\n  154 |     ];\n  155 |\n> 156 |     const SidebarContent = () => (\n      |                            ^^^^^^^\n> 157 |         <div className=\"flex flex-col h-full bg-white\">\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 158 |             <div className=\"p-6 border-b border-slate-100\">\n      \n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 212 |         </div>\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 213 |     );\n      | ^^^^^^ The component is created during render here\n  214 |\n  215 |     return (\n  216 |         <>","line":219,"column":18,"nodeType":null,"endLine":219,"endColumn":32},{"ruleId":"react-hooks/static-components","severity":2,"message":"Error: Cannot create components during render\n\nComponents created during render will reset their state each time they are created. Declare components outside of render.\n\nC:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\Sidebar.tsx:259:30\n  257 |                         </div>\n  258 |                         <div className=\"flex-1 overflow-hidden\">\n> 259 |                             <SidebarContent />\n      |                              ^^^^^^^^^^^^^^ This component is created during render\n  260 |                         </div>\n  261 |                     </div>\n  262 |                 </div>\n\nC:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\Sidebar.tsx:156:28\n  154 |     ];\n  155 |\n> 156 |     const SidebarContent = () => (\n      |                            ^^^^^^^\n> 157 |         <div className=\"flex flex-col h-full bg-white\">\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 158 |             <div className=\"p-6 border-b border-slate-100\">\n      \n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 212 |         </div>\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 213 |     );\n      | ^^^^^^ The component is created during render here\n  214 |\n  215 |     return (\n  216 |         <>","line":259,"column":30,"nodeType":null,"endLine":259,"endColumn":44}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport Link from \"next/link\";\r\nimport { usePathname } from \"next/navigation\";\r\nimport {\r\n    LayoutDashboard,\r\n    Database,\r\n    BookOpen,\r\n    Scale,\r\n    Users,\r\n    Scan,\r\n    Network,\r\n    Lightbulb,\r\n    ArrowLeftRight,\r\n    Clock,\r\n    Menu,\r\n    X\r\n} from \"lucide-react\";\r\nimport { cn } from \"@/lib/utils\";\r\nimport { Tooltip, TooltipContent, TooltipProvider, TooltipTrigger } from \"@/components/ui/tooltip\";\r\nimport { UserButton } from \"@clerk/nextjs\";\r\n\r\nexport function Sidebar() {\r\n    const pathname = usePathname();\r\n    const [isMobileOpen, setIsMobileOpen] = useState(false);\r\n    const [isMounted, setIsMounted] = useState(false);\r\n\r\n    // Close mobile menu when path changes\r\n    useEffect(() => {\r\n        setIsMobileOpen(false);\r\n    }, [pathname]);\r\n\r\n    // Handle hydration mismatch\r\n    useEffect(() => {\r\n        setIsMounted(true);\r\n    }, []);\r\n\r\n    const navGroups = [\r\n        {\r\n            title: \"Overview\",\r\n            items: [\r\n                {\r\n                    name: \"Dashboard\",\r\n                    href: \"/\",\r\n                    icon: LayoutDashboard,\r\n                    description: \"High-level view of the algorithmic assemblage and research progress.\"\r\n                }\r\n            ]\r\n        },\r\n        {\r\n            title: \"Data Collection\",\r\n            items: [\r\n                {\r\n                    name: \"Documents\",\r\n                    href: \"/data\",\r\n                    icon: Database,\r\n                    description: \"Archive of primary policy texts (PDFs) and source materials.\"\r\n                },\r\n                {\r\n                    name: \"Empirical Data\",\r\n                    href: \"/empirical\",\r\n                    icon: Users,\r\n                    description: \"Collect and organize empirical traces from web sources.\"\r\n                }\r\n            ]\r\n        },\r\n        {\r\n            title: \"Agency & Resistance\",\r\n            items: [\r\n                {\r\n                    name: \"Resistance\",\r\n                    href: \"/resistance\",\r\n                    icon: Users,\r\n                    description: \"Analyze micro-resistance strategies and counter-conduct.\"\r\n                },\r\n                {\r\n                    name: \"Critical Reflection\",\r\n                    href: \"/reflexivity\",\r\n                    icon: Scan,\r\n                    description: \"Examine how your own perspective and context shape the analysis.\"\r\n                },\r\n            ]\r\n        },\r\n        {\r\n            title: \"Assemblage Mapping\",\r\n            items: [\r\n                {\r\n                    name: \"Ecosystem Analysis\",\r\n                    href: \"/ecosystem\",\r\n                    icon: Users,\r\n                    description: \"Map actors, detect cultural holes, and visualize social networks.\"\r\n                },\r\n                {\r\n                    name: \"Cross-Case Analysis\",\r\n                    href: \"/synthesis\",\r\n                    icon: Network,\r\n                    description: \"Cross-case analysis and AI-powered framework comparison.\"\r\n                },\r\n            ]\r\n        },\r\n        {\r\n            title: \"Structural Governance\",\r\n            items: [\r\n                {\r\n                    name: \"Comparison\",\r\n                    href: \"/comparison\",\r\n                    icon: ArrowLeftRight,\r\n                    description: \"Side-by-side comparison of governance frameworks.\"\r\n                },\r\n                {\r\n                    name: \"Governance\",\r\n                    href: \"/governance\",\r\n                    icon: Scale,\r\n                    description: \"Analyze resource orchestration and institutional logics.\"\r\n                },\r\n                {\r\n                    name: \"Cultural Framing\",\r\n                    href: \"/cultural\",\r\n                    icon: Lightbulb,\r\n                    description: \"Examine cultural framing and epistemic authority.\"\r\n                },\r\n                {\r\n                    name: \"Concept Network\",\r\n                    href: \"/ontology\",\r\n                    icon: BookOpen,\r\n                    description: \"Visual map of key concepts and their relationships.\"\r\n                },\r\n                {\r\n                    name: \"Temporal Dynamics\",\r\n                    href: \"/timeline\",\r\n                    icon: Clock,\r\n                    description: \"Track the evolution of discourse and policy over time.\"\r\n                },\r\n            ]\r\n        },\r\n        {\r\n            title: \"Educational Resources\",\r\n            items: [\r\n                {\r\n                    name: \"Critical Glossary\",\r\n                    href: \"/glossary\",\r\n                    icon: BookOpen,\r\n                    description: \"Definitions of key theoretical concepts and terms.\"\r\n                },\r\n                {\r\n                    name: \"Literature Review\",\r\n                    href: \"/literature\",\r\n                    icon: BookOpen,\r\n                    description: \"Theoretical framework and key scholarship.\"\r\n                }\r\n            ]\r\n        }\r\n    ];\r\n\r\n    const SidebarContent = () => (\r\n        <div className=\"flex flex-col h-full bg-white\">\r\n            <div className=\"p-6 border-b border-slate-100\">\r\n                <Link href=\"/\" className=\"flex items-center gap-2\">\r\n                    <div className=\"w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center\">\r\n                        <LayoutDashboard className=\"text-white w-5 h-5\" />\r\n                    </div>\r\n                    <span className=\"font-bold text-lg text-slate-900 tracking-tight\">\r\n                        Assemblage<span className=\"text-blue-600\">-AI</span>\r\n                    </span>\r\n                </Link>\r\n            </div>\r\n\r\n            <div className=\"flex-1 overflow-y-auto py-6 px-4 space-y-8\">\r\n                {navGroups.map((group, groupIndex) => (\r\n                    <div key={groupIndex}>\r\n                        <h3 className=\"text-xs font-semibold text-slate-400 uppercase tracking-wider mb-3 px-2\">\r\n                            {group.title}\r\n                        </h3>\r\n                        <div className=\"space-y-1\">\r\n                            {group.items.map((item) => {\r\n                                const isActive = pathname === item.href;\r\n                                return (\r\n                                    <TooltipProvider key={item.href} delayDuration={0}>\r\n                                        <Tooltip>\r\n                                            <TooltipTrigger asChild>\r\n                                                <Link\r\n                                                    href={item.href}\r\n                                                    className={cn(\r\n                                                        \"flex items-center gap-3 px-3 py-2 rounded-md text-sm font-medium transition-colors\",\r\n                                                        isActive\r\n                                                            ? \"bg-blue-50 text-blue-700\"\r\n                                                            : \"text-slate-600 hover:bg-slate-50 hover:text-slate-900\"\r\n                                                    )}\r\n                                                >\r\n                                                    <item.icon size={18} />\r\n                                                    {item.name}\r\n                                                </Link>\r\n                                            </TooltipTrigger>\r\n                                            <TooltipContent side=\"right\" className=\"max-w-xs bg-slate-900 text-white border-slate-800 hidden lg:block\">\r\n                                                <p>{item.description}</p>\r\n                                            </TooltipContent>\r\n                                        </Tooltip>\r\n                                    </TooltipProvider>\r\n                                );\r\n                            })}\r\n                        </div>\r\n                    </div>\r\n                ))}\r\n            </div>\r\n\r\n            <div className=\"p-4 border-t border-slate-100 bg-slate-50\">\r\n                <div className=\"flex items-center gap-3 justify-center\">\r\n                    {isMounted && <UserButton showName />}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n\r\n    return (\r\n        <>\r\n            {/* Desktop Sidebar */}\r\n            <div className=\"hidden md:flex w-64 border-r border-slate-200 bg-white flex-col h-full flex-shrink-0\">\r\n                <SidebarContent />\r\n            </div>\r\n\r\n            {/* Mobile Header */}\r\n            <div className=\"md:hidden flex items-center justify-between p-4 bg-white border-b border-slate-200 fixed top-0 left-0 right-0 z-30\">\r\n                <Link href=\"/\" className=\"flex items-center gap-2\">\r\n                    <div className=\"w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center\">\r\n                        <LayoutDashboard className=\"text-white w-5 h-5\" />\r\n                    </div>\r\n                    <span className=\"font-bold text-lg text-slate-900 tracking-tight\">\r\n                        Assemblage<span className=\"text-blue-600\">-AI</span>\r\n                    </span>\r\n                </Link>\r\n                <button\r\n                    onClick={() => setIsMobileOpen(true)}\r\n                    className=\"p-2 text-slate-600 hover:bg-slate-100 rounded-md\"\r\n                >\r\n                    <Menu className=\"w-6 h-6\" />\r\n                </button>\r\n            </div>\r\n\r\n            {/* Mobile Drawer Overlay */}\r\n            {isMobileOpen && (\r\n                <div className=\"fixed inset-0 z-50 md:hidden\">\r\n                    {/* Backdrop */}\r\n                    <div\r\n                        className=\"absolute inset-0 bg-black/50 backdrop-blur-sm\"\r\n                        onClick={() => setIsMobileOpen(false)}\r\n                    />\r\n                    {/* Drawer */}\r\n                    <div className=\"absolute top-0 left-0 bottom-0 w-80 bg-white shadow-xl flex flex-col animate-in slide-in-from-left duration-200\">\r\n                        <div className=\"flex justify-end p-4 border-b border-slate-100\">\r\n                            <button\r\n                                onClick={() => setIsMobileOpen(false)}\r\n                                className=\"p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-md\"\r\n                            >\r\n                                <X className=\"w-6 h-6\" />\r\n                            </button>\r\n                        </div>\r\n                        <div className=\"flex-1 overflow-hidden\">\r\n                            <SidebarContent />\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\ecosystem\\ActorList.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\ecosystem\\ConfigurationDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\ecosystem\\CulturalHolesAnalysis.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":63,"column":62,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":63,"endColumn":65,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3367,3370],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3367,3370],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":86,"column":81,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":86,"endColumn":84,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5243,5246],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5243,5246],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":147,"column":59,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[9505,9549],"text":"Click &quot;Analyze Holes\" to detect disconnects."},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[9505,9549],"text":"Click &ldquo;Analyze Holes\" to detect disconnects."},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[9505,9549],"text":"Click &#34;Analyze Holes\" to detect disconnects."},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[9505,9549],"text":"Click &rdquo;Analyze Holes\" to detect disconnects."},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":147,"column":73,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[9505,9549],"text":"Click \"Analyze Holes&quot; to detect disconnects."},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[9505,9549],"text":"Click \"Analyze Holes&ldquo; to detect disconnects."},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[9505,9549],"text":"Click \"Analyze Holes&#34; to detect disconnects."},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[9505,9549],"text":"Click \"Analyze Holes&rdquo; to detect disconnects."},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CulturalHoleChart' is defined but never used.","line":155,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":155,"endColumn":27}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Zap, Loader2, Users } from 'lucide-react';\r\nimport { Bar, BarChart, XAxis, YAxis, Tooltip, ResponsiveContainer, Cell } from 'recharts';\r\nimport { CulturalHolesAnalysisResult, CulturalHole } from '@/types/ecosystem';\r\n\r\ninterface CulturalHolesAnalysisProps {\r\n    culturalHoles: CulturalHolesAnalysisResult | null;\r\n    isAnalyzingHoles: boolean;\r\n    onAnalyze: () => void;\r\n}\r\n\r\nexport function CulturalHolesAnalysis({ culturalHoles, isAnalyzingHoles, onAnalyze }: CulturalHolesAnalysisProps) {\r\n    return (\r\n        <Card className=\"min-h-[300px] flex flex-col\">\r\n            <CardHeader>\r\n                <div className=\"flex flex-col md:flex-row items-start md:items-center justify-between gap-4 md:gap-0\">\r\n                    <div className=\"flex items-center gap-2\">\r\n                        <Zap className=\"h-5 w-5 text-amber-600\" />\r\n                        <CardTitle>Cultural Holes & Disconnects</CardTitle>\r\n                    </div>\r\n                    <Button size=\"sm\" variant=\"outline\" onClick={onAnalyze} disabled={isAnalyzingHoles}>\r\n                        {isAnalyzingHoles ? (\r\n                            <>\r\n                                <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\r\n                                Analyzing...\r\n                            </>\r\n                        ) : (\r\n                            \"Analyze Holes\"\r\n                        )}\r\n                    </Button>\r\n                </div>\r\n                <CardDescription>\r\n                    Identifying semantic distance and missing links between actor communities.\r\n                </CardDescription>\r\n            </CardHeader>\r\n            <CardContent className=\"flex-1 bg-slate-50/50 p-6 border-t\">\r\n                {culturalHoles ? (\r\n                    <div className=\"space-y-6\">\r\n                        <div className=\"flex items-center justify-between\">\r\n                            <h4 className=\"font-semibold text-sm text-slate-700\">Connectivity Score</h4>\r\n                            <Badge variant={culturalHoles.overall_connectivity_score > 0.7 ? \"default\" : \"destructive\"}>\r\n                                {(culturalHoles.overall_connectivity_score * 100).toFixed(0)}%\r\n                            </Badge>\r\n                        </div>\r\n\r\n                        {/* Analysis Summary */}\r\n                        {culturalHoles.summary && (\r\n                            <div className=\"bg-indigo-50 p-4 rounded-md border border-indigo-100 text-sm text-slate-700\">\r\n                                <div className=\"flex items-center gap-2 mb-2\">\r\n                                    <Zap className=\"h-4 w-4 text-indigo-600\" />\r\n                                    <span className=\"font-semibold text-indigo-900\">Analysis Summary</span>\r\n                                </div>\r\n                                <p>{culturalHoles.summary}</p>\r\n                            </div>\r\n                        )}\r\n\r\n                        <ConceptCloud holes={culturalHoles.holes} />\r\n\r\n                        <div className=\"space-y-4\">\r\n                            {culturalHoles.holes?.map((hole: any, i: number) => (\r\n                                <div key={i} className=\"bg-white p-4 rounded-md border border-amber-200 shadow-sm\">\r\n                                    <div className=\"flex items-center justify-between mb-2\">\r\n                                        <div className=\"flex items-center gap-2\">\r\n                                            <Badge variant=\"outline\" className=\"text-xs font-normal text-slate-500\">Gap</Badge>\r\n                                            <span className=\"font-bold text-amber-700 text-sm\">\r\n                                                {hole.clusterA} <span className=\"text-slate-400 mx-1\"></span> {hole.clusterB}\r\n                                            </span>\r\n                                        </div>\r\n                                        <Badge variant=\"secondary\" className=\"text-xs\">\r\n                                            Dist: {(hole.distance * 100).toFixed(0)}%\r\n                                        </Badge>\r\n                                    </div>\r\n\r\n                                    <div className=\"mb-3\">\r\n                                        <p className=\"text-xs font-semibold text-slate-700 mb-1\">Opportunity:</p>\r\n                                        <p className=\"text-xs text-slate-600\">{hole.opportunity}</p>\r\n                                    </div>\r\n\r\n                                    {hole.bridgingConcepts && hole.bridgingConcepts.length > 0 && (\r\n                                        <div className=\"bg-slate-50 p-2 rounded border border-slate-100\">\r\n                                            <p className=\"text-[10px] uppercase tracking-wider text-slate-400 font-bold mb-2\">Bridging Concepts</p>\r\n                                            <div className=\"space-y-2\">\r\n                                                {hole.bridgingConcepts.map((bc: any, idx: number) => (\r\n                                                    <div key={idx} className=\"flex flex-col gap-1\">\r\n                                                        <span className=\"text-xs font-bold text-indigo-600\">{bc.concept}</span>\r\n                                                        <span className=\"text-xs text-slate-500\">{bc.description}</span>\r\n                                                    </div>\r\n                                                ))}\r\n                                            </div>\r\n                                        </div>\r\n                                    )}\r\n                                </div>\r\n                            ))}\r\n                        </div>\r\n\r\n                        {/* Silences (Ghost Nodes) Section */}\r\n                        {culturalHoles.silences && culturalHoles.silences.length > 0 && (\r\n                            <div className=\"space-y-4 pt-4 border-t border-slate-200\">\r\n                                <div className=\"flex items-center gap-2\">\r\n                                    <Users className=\"h-4 w-4 text-slate-500\" />\r\n                                    <h4 className=\"font-semibold text-sm text-slate-700\">Detected Silences (Ghost Nodes)</h4>\r\n                                </div>\r\n                                <p className=\"text-xs text-slate-500\">\r\n                                    Stakeholders or concepts from the global ontology that are absent in the current discourse.\r\n                                </p>\r\n                                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3\">\r\n                                    {culturalHoles.silences.map((silence, i) => (\r\n                                        <div key={i} className=\"bg-slate-50 p-3 rounded border border-slate-200 opacity-70 hover:opacity-100 transition-opacity\">\r\n                                            <div className=\"flex items-center justify-between mb-1\">\r\n                                                <span className=\"font-medium text-sm text-slate-700\">{silence.name}</span>\r\n                                                <Badge variant=\"outline\" className=\"text-[10px] bg-white\">{silence.category}</Badge>\r\n                                            </div>\r\n                                            <div className=\"flex flex-wrap gap-1\">\r\n                                                {silence.keywords.slice(0, 3).map(k => (\r\n                                                    <span key={k} className=\"text-[10px] text-slate-400 bg-white px-1 rounded border border-slate-100\">\r\n                                                        #{k}\r\n                                                    </span>\r\n                                                ))}\r\n                                            </div>\r\n                                        </div>\r\n                                    ))}\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n\r\n                        {culturalHoles.recommendations?.length > 0 && (\r\n                            <div className=\"pt-4 border-t border-slate-200\">\r\n                                <h4 className=\"font-semibold text-sm text-slate-700 mb-3\">Bridging Recommendations</h4>\r\n                                <ul className=\"space-y-2\">\r\n                                    {culturalHoles.recommendations.map((rec: { role: string; action: string }, i: number) => (\r\n                                        <li key={i} className=\"text-xs text-slate-600 flex gap-2\">\r\n                                            <span className=\"font-bold text-indigo-600\"> {rec.role}:</span>\r\n                                            {rec.action}\r\n                                        </li>\r\n                                    ))}\r\n                                </ul>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                ) : (\r\n                    <div className=\"text-center text-slate-400 py-8\">\r\n                        <Users className=\"h-12 w-12 mx-auto mb-2 opacity-20\" />\r\n                        <p>No analysis yet.</p>\r\n                        <p className=\"text-xs mt-1\">Click \"Analyze Holes\" to detect disconnects.</p>\r\n                    </div>\r\n                )}\r\n            </CardContent>\r\n        </Card>\r\n    );\r\n}\r\n\r\nfunction CulturalHoleChart({ hole }: { hole: CulturalHole }) {\r\n    if (!hole.scores) return null;\r\n\r\n    const data = Object.entries(hole.scores).map(([name, score]) => ({\r\n        name,\r\n        score: score as number\r\n    }));\r\n\r\n    return (\r\n        <div className=\"mt-4 h-[150px] w-full\">\r\n            <div className=\"flex items-center justify-between mb-2\">\r\n                <p className=\"text-[10px] text-slate-400 uppercase tracking-wider font-semibold\">Concept Affinity Gap</p>\r\n                <div className=\"flex gap-2 text-[9px] text-slate-500\">\r\n                    <div className=\"flex items-center gap-1\"><div className=\"w-2 h-2 rounded-full bg-[#3b82f6]\"></div>High Affinity</div>\r\n                    <div className=\"flex items-center gap-1\"><div className=\"w-2 h-2 rounded-full bg-[#f59e0b]\"></div>Low Affinity</div>\r\n                </div>\r\n            </div>\r\n            <ResponsiveContainer width=\"100%\" height=\"100%\">\r\n                <BarChart data={data} layout=\"vertical\" margin={{ top: 0, right: 30, left: 40, bottom: 0 }}>\r\n                    <XAxis type=\"number\" domain={[0, 10]} hide />\r\n                    <YAxis dataKey=\"name\" type=\"category\" width={80} tick={{ fontSize: 10 }} />\r\n                    <Tooltip\r\n                        cursor={{ fill: 'transparent' }}\r\n                        contentStyle={{ fontSize: '12px', borderRadius: '6px' }}\r\n                    />\r\n                    <Bar dataKey=\"score\" radius={[0, 4, 4, 0]} barSize={20}>\r\n                        {data.map((entry, index) => (\r\n                            <Cell key={`cell-${index}`} fill={entry.score < 5 ? '#f59e0b' : '#3b82f6'} />\r\n                        ))}\r\n                    </Bar>\r\n                </BarChart>\r\n            </ResponsiveContainer>\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction ConceptCloud({ holes }: { holes: CulturalHole[] }) {\r\n    if (!holes || holes.length === 0) return null;\r\n\r\n    return (\r\n        <div className=\"flex flex-wrap gap-2 mb-6 p-4 bg-slate-50 rounded-lg border border-slate-100\">\r\n            {holes.map((hole, i) => {\r\n                const size = hole.significance === 'High' ? 'text-lg' : hole.significance === 'Medium' ? 'text-sm' : 'text-xs';\r\n                const weight = hole.significance === 'High' ? 'font-bold' : 'font-medium';\r\n                const opacity = hole.significance === 'High' ? 'opacity-100' : 'opacity-70';\r\n\r\n                return (\r\n                    <span key={i} className={`${size} ${weight} ${opacity} text-indigo-600 bg-white px-2 py-1 rounded-full border border-indigo-100 shadow-sm`}>\r\n                        {hole.concept}\r\n                    </span>\r\n                );\r\n            })}\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\ecosystem\\EcosystemMap.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'j' is defined but never used.","line":283,"column":58,"nodeType":null,"messageId":"unusedVar","endLine":283,"endColumn":59}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useRef, useState } from 'react';\r\nimport { EcosystemActor, EcosystemConfiguration } from '@/types/ecosystem';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Network, MousePointer2, BoxSelect, Layers, Landmark, Users, Rocket, GraduationCap, Server, Database, Cpu, FileCode } from 'lucide-react';\r\n\r\ninterface EcosystemMapProps {\r\n    actors: EcosystemActor[];\r\n    configurations: EcosystemConfiguration[];\r\n    positions: Record<string, { x: number, y: number }>;\r\n    interactionMode: \"drag\" | \"select\";\r\n    setInteractionMode: (mode: \"drag\" | \"select\") => void;\r\n    selectedForGrouping: string[];\r\n    onToggleSelection: (actorId: string) => void;\r\n    onCreateConfiguration: () => void;\r\n    onActorDrag: (actorId: string, x: number, y: number) => void;\r\n    onConfigDrag: (configId: string, dx: number, dy: number) => void;\r\n}\r\n\r\nexport function EcosystemMap({\r\n    actors,\r\n    configurations,\r\n    positions,\r\n    interactionMode,\r\n    setInteractionMode,\r\n    selectedForGrouping,\r\n    onToggleSelection,\r\n    onCreateConfiguration,\r\n    onActorDrag,\r\n    onConfigDrag\r\n}: EcosystemMapProps) {\r\n    const [draggingId, setDraggingId] = useState<string | null>(null);\r\n    const [draggingConfigId, setDraggingConfigId] = useState<string | null>(null);\r\n    const dragStartRef = useRef<{ mouse: { x: number, y: number } } | null>(null);\r\n\r\n    const handleMouseDown = (e: React.MouseEvent, actorId: string) => {\r\n        e.stopPropagation();\r\n        e.preventDefault();\r\n\r\n        if (interactionMode === \"drag\") {\r\n            setDraggingId(actorId);\r\n        } else if (interactionMode === \"select\") {\r\n            onToggleSelection(actorId);\r\n        }\r\n    };\r\n\r\n    const handleConfigMouseDown = (e: React.MouseEvent, configId: string) => {\r\n        if (interactionMode !== \"drag\") return;\r\n        e.stopPropagation();\r\n        e.preventDefault();\r\n\r\n        const svg = (e.target as Element).closest('svg');\r\n        if (!svg) return;\r\n\r\n        const pt = svg.createSVGPoint();\r\n        pt.x = e.clientX;\r\n        pt.y = e.clientY;\r\n        const svgP = pt.matrixTransform(svg.getScreenCTM()?.inverse());\r\n\r\n        dragStartRef.current = { mouse: { x: svgP.x, y: svgP.y } };\r\n        setDraggingConfigId(configId);\r\n    };\r\n\r\n    const handleMouseMove = (e: React.MouseEvent<SVGSVGElement>) => {\r\n        if (interactionMode !== \"drag\") return;\r\n        if (!draggingId && !draggingConfigId) return;\r\n\r\n        const svg = e.currentTarget;\r\n        const pt = svg.createSVGPoint();\r\n        pt.x = e.clientX;\r\n        pt.y = e.clientY;\r\n        const svgP = pt.matrixTransform(svg.getScreenCTM()?.inverse());\r\n\r\n        if (draggingId) {\r\n            onActorDrag(draggingId, svgP.x, svgP.y);\r\n        } else if (draggingConfigId && dragStartRef.current) {\r\n            const dx = svgP.x - dragStartRef.current.mouse.x;\r\n            const dy = svgP.y - dragStartRef.current.mouse.y;\r\n\r\n            // Update start ref for next delta\r\n            dragStartRef.current = { mouse: { x: svgP.x, y: svgP.y } };\r\n\r\n            onConfigDrag(draggingConfigId, dx, dy);\r\n        }\r\n    };\r\n\r\n    const handleMouseUp = () => {\r\n        setDraggingId(null);\r\n        setDraggingConfigId(null);\r\n        dragStartRef.current = null;\r\n    };\r\n\r\n    // Convex Hull Algorithm\r\n    const getConvexHull = (points: { x: number, y: number }[]) => {\r\n        if (points.length < 3) return points;\r\n        points.sort((a, b) => a.x - b.x || a.y - b.y);\r\n\r\n        const cross = (o: { x: number, y: number }, a: { x: number, y: number }, b: { x: number, y: number }) => {\r\n            return (a.x - o.x) * (b.y - o.y) - (a.y - o.y) * (b.x - o.x);\r\n        };\r\n\r\n        const lower = [];\r\n        for (let i = 0; i < points.length; i++) {\r\n            while (lower.length >= 2 && cross(lower[lower.length - 2], lower[lower.length - 1], points[i]) <= 0) {\r\n                lower.pop();\r\n            }\r\n            lower.push(points[i]);\r\n        }\r\n\r\n        const upper = [];\r\n        for (let i = points.length - 1; i >= 0; i--) {\r\n            while (upper.length >= 2 && cross(upper[upper.length - 2], upper[upper.length - 1], points[i]) <= 0) {\r\n                upper.pop();\r\n            }\r\n            upper.push(points[i]);\r\n        }\r\n\r\n        upper.pop();\r\n        lower.pop();\r\n        return lower.concat(upper);\r\n    };\r\n\r\n    const renderConfigurationShapes = () => {\r\n        return configurations.map(config => {\r\n            const memberPoints = config.memberIds\r\n                .map(id => positions[id])\r\n                .filter(p => p !== undefined);\r\n\r\n            if (memberPoints.length < 2) return null;\r\n\r\n            let pathData = \"\";\r\n            let centroid = { x: 0, y: 0 };\r\n\r\n            if (memberPoints.length === 2) {\r\n                pathData = `M ${memberPoints[0].x} ${memberPoints[0].y} L ${memberPoints[1].x} ${memberPoints[1].y}`;\r\n                centroid = {\r\n                    x: (memberPoints[0].x + memberPoints[1].x) / 2,\r\n                    y: (memberPoints[0].y + memberPoints[1].y) / 2\r\n                };\r\n            } else {\r\n                const hull = getConvexHull(memberPoints);\r\n                pathData = `M ${hull.map(p => `${p.x},${p.y}`).join(\" L \")} Z`;\r\n                centroid = hull.reduce((acc, p) => ({ x: acc.x + p.x, y: acc.y + p.y }), { x: 0, y: 0 });\r\n                centroid.x /= hull.length;\r\n                centroid.y /= hull.length;\r\n            }\r\n\r\n            return (\r\n                <g\r\n                    key={config.id}\r\n                    onMouseDown={(e) => handleConfigMouseDown(e, config.id)}\r\n                    className={interactionMode === \"drag\" ? \"cursor-grab active:cursor-grabbing\" : \"\"}\r\n                    style={{ pointerEvents: 'all' }}\r\n                >\r\n                    <path\r\n                        d={pathData}\r\n                        fill={memberPoints.length > 2 ? config.color : \"none\"}\r\n                        stroke={config.color}\r\n                        strokeWidth={memberPoints.length > 2 ? \"40\" : \"60\"}\r\n                        strokeLinecap=\"round\"\r\n                        strokeLinejoin=\"round\"\r\n                        opacity=\"0.4\"\r\n                        className=\"transition-all duration-300\"\r\n                    />\r\n                    <text\r\n                        x={centroid.x}\r\n                        y={centroid.y}\r\n                        textAnchor=\"middle\"\r\n                        fill=\"#475569\"\r\n                        fontSize=\"12\"\r\n                        fontWeight=\"bold\"\r\n                        className=\"pointer-events-none select-none\"\r\n                    >\r\n                        {config.name}\r\n                    </text>\r\n                </g>\r\n            );\r\n        });\r\n    };\r\n\r\n    const getActorIcon = (type: string) => {\r\n        switch (type) {\r\n            case \"Policymaker\": return Landmark;\r\n            case \"Civil Society\": return Users;\r\n            case \"Startup\": return Rocket;\r\n            case \"Academic\": return GraduationCap;\r\n            case \"Infrastructure\": return Server;\r\n            case \"Algorithm\": return Cpu;\r\n            case \"Dataset\": return Database;\r\n            default: return FileCode;\r\n        }\r\n    };\r\n\r\n    const getLinkLabel = (sourceType: string, targetType: string) => {\r\n        if (sourceType === \"Policymaker\" && targetType === \"Civil Society\") return \"Consults\";\r\n        if (sourceType === \"Startup\" && targetType === \"Academic\") return \"Collaborates\";\r\n        if (sourceType === \"Policymaker\" && targetType === \"Startup\") return \"Regulates\";\r\n        if (sourceType === \"Civil Society\" && targetType === \"Academic\") return \"Studies\";\r\n        if (sourceType === \"Infrastructure\" && targetType === \"Startup\") return \"Supports\";\r\n        if (sourceType === \"Infrastructure\" && targetType === \"Policymaker\") return \"Informs\";\r\n        if (sourceType === \"Infrastructure\" && targetType === \"Academic\") return \"Provides Data\";\r\n\r\n        // Algorithm connections\r\n        if (sourceType === \"Startup\" && targetType === \"Algorithm\") return \"Develops\";\r\n        if (sourceType === \"Academic\" && targetType === \"Algorithm\") return \"Audits\";\r\n        if (sourceType === \"Algorithm\" && targetType === \"Dataset\") return \"Trained On\";\r\n        if (sourceType === \"Policymaker\" && targetType === \"Algorithm\") return \"Governs\";\r\n        if (sourceType === \"Infrastructure\" && targetType === \"Algorithm\") return \"Hosts\";\r\n        if (sourceType === \"Infrastructure\" && targetType === \"Dataset\") return \"Stores\";\r\n\r\n        return \"Relates To\";\r\n    };\r\n\r\n    return (\r\n        <Card className=\"min-h-[400px] flex flex-col\">\r\n            <CardHeader className=\"z-10 relative\">\r\n                <div className=\"flex items-center justify-between\">\r\n                    <div className=\"flex items-center gap-2\">\r\n                        <Network className=\"h-5 w-5 text-indigo-600\" />\r\n                        <CardTitle>Social Network Graph</CardTitle>\r\n                    </div>\r\n                    <div className=\"flex items-center gap-2\">\r\n                        <div className=\"flex bg-slate-100 p-1 rounded-lg\">\r\n                            <Button\r\n                                variant={interactionMode === \"drag\" ? \"secondary\" : \"ghost\"}\r\n                                size=\"sm\"\r\n                                className=\"h-7 px-2 text-xs\"\r\n                                onClick={() => setInteractionMode(\"drag\")}\r\n                            >\r\n                                <MousePointer2 className=\"h-3 w-3 mr-1\" />\r\n                                Drag\r\n                            </Button>\r\n                            <Button\r\n                                variant={interactionMode === \"select\" ? \"secondary\" : \"ghost\"}\r\n                                size=\"sm\"\r\n                                className=\"h-7 px-2 text-xs\"\r\n                                onClick={() => setInteractionMode(\"select\")}\r\n                            >\r\n                                <BoxSelect className=\"h-3 w-3 mr-1\" />\r\n                                Select\r\n                            </Button>\r\n                        </div>\r\n                        {interactionMode === \"select\" && selectedForGrouping.length > 0 && (\r\n                            <Button\r\n                                size=\"sm\"\r\n                                className=\"h-7 text-xs bg-indigo-600 hover:bg-indigo-700 text-white\"\r\n                                onClick={onCreateConfiguration}\r\n                            >\r\n                                <Layers className=\"h-3 w-3 mr-1\" />\r\n                                Group ({selectedForGrouping.length})\r\n                            </Button>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n                <CardDescription>\r\n                    Visualizing ties between actors. Switch to <strong>Select Mode</strong> and <strong>click nodes</strong> to group them.\r\n                </CardDescription>\r\n            </CardHeader>\r\n            <CardContent className=\"flex-1 bg-slate-50/50 p-6 border-t relative\">\r\n                <svg\r\n                    width=\"100%\"\r\n                    height=\"400\"\r\n                    className={`border rounded-lg bg-white transition-colors duration-300 ${interactionMode === \"drag\" ? \"cursor-move border-slate-200\" : \"cursor-crosshair border-indigo-400 ring-2 ring-indigo-100\"}`}\r\n                    onMouseMove={handleMouseMove}\r\n                    onMouseUp={handleMouseUp}\r\n                    onMouseLeave={handleMouseUp}\r\n                >\r\n                    <defs>\r\n                        <marker id=\"actor-arrow\" markerWidth=\"8\" markerHeight=\"8\" refX=\"20\" refY=\"4\" orient=\"auto\">\r\n                            <polygon points=\"0 0, 8 4, 0 8\" fill=\"#94a3b8\" />\r\n                        </marker>\r\n                        <filter id=\"actor-glow\" x=\"-50%\" y=\"-50%\" width=\"200%\" height=\"200%\">\r\n                            <feGaussianBlur stdDeviation=\"3\" result=\"blur\" />\r\n                            <feComposite in=\"SourceGraphic\" in2=\"blur\" operator=\"over\" />\r\n                        </filter>\r\n                    </defs>\r\n\r\n                    {/* Render Configuration Super-Nodes (Background) */}\r\n                    {renderConfigurationShapes()}\r\n\r\n                    {/* Generate connections based on actor types */}\r\n                    {actors.map((source, i) =>\r\n                        actors.slice(i + 1).map((target, j) => {\r\n                            const shouldConnect = (\r\n                                (source.type === \"Policymaker\" && target.type === \"Civil Society\") ||\r\n                                (source.type === \"Startup\" && target.type === \"Academic\") ||\r\n                                (source.type === \"Policymaker\" && target.type === \"Startup\") ||\r\n                                (source.type === \"Civil Society\" && target.type === \"Academic\") ||\r\n                                (source.type === \"Infrastructure\" && target.type === \"Startup\") ||\r\n                                (source.type === \"Infrastructure\" && target.type === \"Policymaker\") ||\r\n                                (source.type === \"Infrastructure\" && target.type === \"Academic\") ||\r\n                                // Algorithm connections\r\n                                (source.type === \"Startup\" && target.type === \"Algorithm\") ||\r\n                                (source.type === \"Academic\" && target.type === \"Algorithm\") ||\r\n                                (source.type === \"Algorithm\" && target.type === \"Dataset\") ||\r\n                                (source.type === \"Policymaker\" && target.type === \"Algorithm\") ||\r\n                                (source.type === \"Infrastructure\" && target.type === \"Algorithm\") ||\r\n                                (source.type === \"Infrastructure\" && target.type === \"Dataset\")\r\n                            );\r\n\r\n                            if (!shouldConnect) return null;\r\n\r\n                            const pos1 = positions[source.id];\r\n                            const pos2 = positions[target.id];\r\n\r\n                            if (!pos1 || !pos2) return null;\r\n\r\n                            const label = getLinkLabel(source.type, target.type);\r\n                            const midX = (pos1.x + pos2.x) / 2;\r\n                            const midY = (pos1.y + pos2.y) / 2;\r\n\r\n                            return (\r\n                                <g key={`${source.id}-${target.id}`}>\r\n                                    <line\r\n                                        x1={pos1.x}\r\n                                        y1={pos1.y}\r\n                                        x2={pos2.x}\r\n                                        y2={pos2.y}\r\n                                        stroke=\"#cbd5e1\"\r\n                                        strokeWidth=\"1\"\r\n                                        strokeDasharray=\"4\"\r\n                                    />\r\n                                    <rect\r\n                                        x={midX - (label.length * 3)}\r\n                                        y={midY - 8}\r\n                                        width={label.length * 6}\r\n                                        height=\"16\"\r\n                                        fill=\"white\"\r\n                                        opacity=\"0.8\"\r\n                                        rx=\"4\"\r\n                                    />\r\n                                    <text\r\n                                        x={midX}\r\n                                        y={midY + 3}\r\n                                        textAnchor=\"middle\"\r\n                                        fontSize=\"9\"\r\n                                        fill=\"#64748b\"\r\n                                        className=\"select-none pointer-events-none font-medium\"\r\n                                    >\r\n                                        {label}\r\n                                    </text>\r\n                                </g>\r\n                            );\r\n                        })\r\n                    )}\r\n\r\n                    {/* Render Actors */}\r\n                    {actors.map(actor => {\r\n                        const pos = positions[actor.id];\r\n                        if (!pos) return null;\r\n\r\n                        const isSelected = selectedForGrouping.includes(actor.id);\r\n                        const Icon = getActorIcon(actor.type);\r\n\r\n                        return (\r\n                            <g\r\n                                key={actor.id}\r\n                                transform={`translate(${pos.x},${pos.y})`}\r\n                                onMouseDown={(e) => handleMouseDown(e, actor.id)}\r\n                                className=\"cursor-pointer transition-all duration-200\"\r\n                                style={{\r\n                                    filter: isSelected ? \"url(#actor-glow)\" : \"none\"\r\n                                }}\r\n                            >\r\n                                <circle\r\n                                    r={isSelected ? 28 : 24}\r\n                                    fill={isSelected ? \"#4f46e5\" : \"white\"}\r\n                                    stroke={isSelected ? \"#4f46e5\" : \"#94a3b8\"}\r\n                                    strokeWidth=\"2\"\r\n                                    className=\"transition-all duration-300 shadow-sm\"\r\n                                />\r\n                                <foreignObject x=\"-12\" y=\"-12\" width=\"24\" height=\"24\" className=\"pointer-events-none\">\r\n                                    <div className={`flex items-center justify-center w-full h-full ${isSelected ? \"text-white\" : \"text-slate-600\"}`}>\r\n                                        <Icon size={16} />\r\n                                    </div>\r\n                                </foreignObject>\r\n                                <foreignObject x=\"-40\" y=\"28\" width=\"80\" height=\"40\">\r\n                                    <div className=\"text-center text-[10px] font-medium text-slate-700 leading-tight line-clamp-2 bg-white/80 px-1 rounded\">\r\n                                        {actor.name}\r\n                                    </div>\r\n                                </foreignObject>\r\n                            </g>\r\n                        );\r\n                    })}\r\n                </svg>\r\n            </CardContent>\r\n        </Card>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\governance\\GovernanceCompass.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Label' is defined but never used.","line":4,"column":107,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":112}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport React from 'react';\r\nimport { ScatterChart, Scatter, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, ReferenceLine, Label, Cell, LabelList } from 'recharts';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { DriftVector } from '@/lib/governance';\r\n\r\ninterface GovernanceCompassProps {\r\n    analysis: DriftVector | null;\r\n}\r\n\r\nexport function GovernanceCompass({ analysis }: GovernanceCompassProps) {\r\n    if (!analysis) {\r\n        return (\r\n            <Card className=\"h-[500px] flex items-center justify-center bg-slate-50 border-dashed\">\r\n                <p className=\"text-slate-400\">Run analysis to generate Governance Compass</p>\r\n            </Card>\r\n        );\r\n    }\r\n\r\n    const data = [\r\n        { x: analysis.rhetoric.x, y: analysis.rhetoric.y, name: 'Rhetoric', fill: '#3b82f6' }, // Blue\r\n        { x: analysis.reality.x, y: analysis.reality.y, name: 'Reality', fill: '#0f172a' },   // Black\r\n    ];\r\n\r\n    return (\r\n        <Card className=\"w-full\">\r\n            <CardHeader>\r\n                <CardTitle>Governance Drift Compass</CardTitle>\r\n                <CardDescription>\r\n                    Visualizing the gap between ethical rhetoric and technical reality.\r\n                    <br />\r\n                    <span className=\"text-xs text-slate-500\">\r\n                        Drift Magnitude: {analysis.magnitude.toFixed(2)} |\r\n                        X-Shift: {analysis.driftX.toFixed(2)} |\r\n                        Y-Shift: {analysis.driftY.toFixed(2)}\r\n                    </span>\r\n                </CardDescription>\r\n            </CardHeader>\r\n            <CardContent>\r\n                <div className=\"h-[500px] w-full relative\">\r\n                    {/* Background Quadrant Labels */}\r\n                    <div className=\"absolute top-4 right-4 text-xs font-bold text-emerald-600 bg-emerald-50 px-2 py-1 rounded opacity-80\">\r\n                        REGENERATIVE / PARTICIPATORY\r\n                    </div>\r\n                    <div className=\"absolute bottom-4 left-4 text-xs font-bold text-red-600 bg-red-50 px-2 py-1 rounded opacity-80\">\r\n                        EXTRACTIVE / ASYMMETRICAL\r\n                    </div>\r\n\r\n                    <ResponsiveContainer width=\"100%\" height=\"100%\">\r\n                        <ScatterChart margin={{ top: 20, right: 20, bottom: 40, left: 80 }}>\r\n                            <CartesianGrid strokeDasharray=\"3 3\" />\r\n                            <XAxis\r\n                                type=\"number\"\r\n                                dataKey=\"x\"\r\n                                name=\"Power\"\r\n                                domain={[-1.2, 1.2]}\r\n                                label={{ value: 'Power: Asymmetrical (-) vs Participatory (+)', position: 'bottom', offset: 0 }}\r\n                            />\r\n                            <YAxis\r\n                                type=\"number\"\r\n                                dataKey=\"y\"\r\n                                name=\"Value\"\r\n                                domain={[-1.2, 1.2]}\r\n                                label={{ value: 'Value: Extractive (-) vs Regenerative (+)', angle: -90, position: 'insideLeft', offset: 10, style: { textAnchor: 'middle' } }}\r\n                            />\r\n                            <ReferenceLine x={0} stroke=\"#64748b\" />\r\n                            <ReferenceLine y={0} stroke=\"#64748b\" />\r\n\r\n                            <Tooltip cursor={{ strokeDasharray: '3 3' }} />\r\n\r\n                            <Scatter name=\"Points\" data={data} fill=\"#8884d8\">\r\n                                {data.map((entry, index) => (\r\n                                    <Cell key={`cell-${index}`} fill={entry.fill} />\r\n                                ))}\r\n                                <LabelList dataKey=\"name\" position=\"top\" offset={10} style={{ fill: '#64748b', fontSize: '12px', fontWeight: 'bold' }} />\r\n                            </Scatter>\r\n                        </ScatterChart>\r\n                    </ResponsiveContainer>\r\n\r\n                    {/* SVG Overlay for the Arrow (Drift Vector) */}\r\n                    {/* Note: Precise overlay requires mapping coordinates to pixels, which is hard with ResponsiveContainer. \r\n                        For this MVP, we rely on the scatter points. A more advanced version would use a custom SVG layer. */}\r\n                </div>\r\n            </CardContent>\r\n        </Card>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\ontology\\ComparisonView.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\ontology\\ConceptDetailsModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\ontology\\ConceptList.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\ontology\\MapGallery.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\ontology\\OntologyMap.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\policy\\AddDocumentDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\policy\\AddUrlDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\policy\\AnalysisResults.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\policy\\DocumentCard.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AnalysisResult' is defined but never used.","line":1,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":32}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Source, AnalysisResult } from \"@/types\";\r\nimport { AnalysisMode } from \"@/services/analysis\";\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { FileText, Globe, Loader2, Sparkles, Trash, Globe2, Scale, Pencil } from \"lucide-react\";\r\nimport { AnalysisResults } from \"./AnalysisResults\";\r\nimport { LegitimacyAnalysisView } from \"./LegitimacyAnalysisView\";\r\n\r\ninterface DocumentCardProps {\r\n    source: Source;\r\n    isAnalyzing: boolean;\r\n    isSearching: boolean;\r\n    onAnalyze: (id: string, mode: AnalysisMode) => void;\r\n    onDelete: (id: string) => void;\r\n    onEdit: (source: Source) => void;\r\n    onFindTraces: (source: Source) => void;\r\n    onView: (source: Source) => void;\r\n    onUpdateSource?: (id: string, updates: Partial<Source>) => void;\r\n}\r\n\r\nexport function DocumentCard({\r\n    source,\r\n    isAnalyzing,\r\n    isSearching,\r\n    onAnalyze,\r\n    onDelete,\r\n    onEdit,\r\n    onFindTraces,\r\n    onView,\r\n    onUpdateSource\r\n}: DocumentCardProps) {\r\n    return (\r\n        <Card className=\"hover:shadow-md transition-shadow\">\r\n            <CardHeader className=\"flex flex-col md:flex-row items-start justify-between space-y-4 md:space-y-0 pb-2\">\r\n                <div className=\"space-y-1 flex-1 min-w-0 pr-0 md:pr-4 w-full\">\r\n                    <CardTitle className=\"text-base font-semibold break-words\">{source.title}</CardTitle>\r\n                    <CardDescription className=\"break-words\">{source.description}</CardDescription>\r\n                </div>\r\n                <div className=\"flex items-center gap-2 shrink-0 w-full md:w-auto justify-end md:justify-start\">\r\n                    <div\r\n                        className={`rounded-full p-2 ${source.colorClass} cursor-pointer hover:opacity-80 transition-opacity`}\r\n                        onClick={() => onView(source)}\r\n                        title=\"Click to view extracted text\"\r\n                    >\r\n                        <FileText className={`h-4 w-4 ${source.iconClass}`} />\r\n                    </div>\r\n                    <Button\r\n                        variant=\"ghost\"\r\n                        size=\"sm\"\r\n                        onClick={() => onFindTraces(source)}\r\n                        disabled={isSearching || !source.extractedText}\r\n                        className=\"h-8 w-8 p-0 hover:bg-blue-100 hover:text-blue-600 disabled:opacity-30\"\r\n                        title={source.extractedText ? \"Find empirical traces using Google Search\" : \"Upload a PDF or add text first to enable trace search\"}\r\n                    >\r\n                        {isSearching ? (\r\n                            <Loader2 className=\"h-4 w-4 animate-spin\" />\r\n                        ) : (\r\n                            <Globe className=\"h-4 w-4\" />\r\n                        )}\r\n                    </Button>\r\n                    <Button\r\n                        variant=\"ghost\"\r\n                        size=\"sm\"\r\n                        onClick={() => onDelete(source.id)}\r\n                        className=\"h-8 w-8 p-0 hover:bg-red-100 hover:text-red-600\"\r\n                    >\r\n                        <Trash className=\"h-4 w-4\" />\r\n                    </Button>\r\n                </div>\r\n            </CardHeader>\r\n            <CardContent>\r\n                <div className=\"mt-4 flex items-center space-x-2\">\r\n                    <Badge variant=\"secondary\" className=\"bg-green-100 text-green-700 hover:bg-green-100\">\r\n                        {source.status}\r\n                    </Badge>\r\n                    <span className=\"text-xs text-slate-500\">\r\n                        {source.type} {source.pageCount ? ` ${source.pageCount} pages` : ''}\r\n                    </span>\r\n                </div>\r\n                <div className=\"mt-4 flex flex-wrap gap-2 text-xs text-slate-500\">\r\n                    <div>Added: {source.addedDate}</div>\r\n                    {source.publicationDate && (\r\n                        <>\r\n                            <div></div>\r\n                            <div>Published: {source.publicationDate}</div>\r\n                        </>\r\n                    )}\r\n                    {source.version && (\r\n                        <>\r\n                            <div></div>\r\n                            <div>v{source.version}</div>\r\n                        </>\r\n                    )}\r\n                    {source.jurisdiction && (\r\n                        <>\r\n                            <div></div>\r\n                            <Badge variant=\"outline\" className=\"text-[10px] h-4 px-1\">\r\n                                {source.jurisdiction}\r\n                            </Badge>\r\n                        </>\r\n                    )}\r\n                </div>\r\n                <div className=\"mt-4 flex gap-2\">\r\n                    <Button\r\n                        variant=\"outline\"\r\n                        size=\"sm\"\r\n                        onClick={() => onEdit(source)}\r\n                        className=\"hover:bg-blue-50 hover:text-blue-600\"\r\n                    >\r\n                        <Pencil className=\"h-4 w-4 mr-2\" />\r\n                        Edit\r\n                    </Button>\r\n                </div>\r\n                {source.extractedText && (\r\n                    <div className=\"mt-4 space-y-2\">\r\n                        <Button\r\n                            onClick={() => onAnalyze(source.id, 'dsf')}\r\n                            disabled={isAnalyzing}\r\n                            className=\"w-full bg-purple-600 text-white hover:bg-purple-700\"\r\n                            size=\"sm\"\r\n                        >\r\n                            {isAnalyzing ? (\r\n                                <>\r\n                                    <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\r\n                                    Analyzing...\r\n                                </>\r\n                            ) : (\r\n                                <>\r\n                                    <Sparkles className=\"mr-2 h-4 w-4\" />\r\n                                    {source.analysis ? 'Re-analyze with AI' : 'Analyze with AI'}\r\n                                </>\r\n                            )}\r\n                        </Button>\r\n                        <div className=\"grid grid-cols-3 gap-2\">\r\n                            <Button\r\n                                onClick={() => onAnalyze(source.id, 'cultural_framing')}\r\n                                disabled={isAnalyzing}\r\n                                variant=\"outline\"\r\n                                size=\"sm\"\r\n                                className=\"text-xs border-purple-200 hover:bg-purple-50\"\r\n                                title=\"Analyze cultural framing for CFP\"\r\n                            >\r\n                                <Globe2 className=\"mr-1 h-3 w-3\" />\r\n                                Cultural\r\n                            </Button>\r\n                            <Button\r\n                                onClick={() => onAnalyze(source.id, 'institutional_logics')}\r\n                                disabled={isAnalyzing}\r\n                                variant=\"outline\"\r\n                                size=\"sm\"\r\n                                className=\"text-xs border-purple-200 hover:bg-purple-50\"\r\n                                title=\"Analyze institutional logics for CFP\"\r\n                            >\r\n                                <Scale className=\"mr-1 h-3 w-3\" />\r\n                                Logics\r\n                            </Button>\r\n                            <Button\r\n                                onClick={() => onAnalyze(source.id, 'legitimacy')}\r\n                                disabled={isAnalyzing}\r\n                                variant=\"outline\"\r\n                                size=\"sm\"\r\n                                className=\"text-xs border-purple-200 hover:bg-purple-50\"\r\n                                title=\"Analyze legitimacy and justification\"\r\n                            >\r\n                                <Scale className=\"mr-1 h-3 w-3\" />\r\n                                Legitimacy\r\n                            </Button>\r\n                        </div>\r\n                    </div>\r\n                )}\r\n                {source.analysis && (\r\n                    <AnalysisResults\r\n                        analysis={source.analysis}\r\n                        sourceTitle={source.title}\r\n                        onUpdate={(updates) => onUpdateSource && onUpdateSource(source.id, {\r\n                            analysis: { ...source.analysis!, ...updates }\r\n                        })}\r\n                    />\r\n                )}\r\n                {source.legitimacy_analysis && (\r\n                    <div className=\"mt-6 pt-4 border-t border-slate-100\">\r\n                        <h3 className=\"text-sm font-semibold text-slate-900 mb-4\">Legitimacy & Justification Analysis</h3>\r\n                        <LegitimacyAnalysisView analysis={source.legitimacy_analysis} />\r\n                    </div>\r\n                )}\r\n            </CardContent>\r\n        </Card>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\policy\\DocumentToolbar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\policy\\EditSourceDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\policy\\GovernanceCompass.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Label' is defined but never used.","line":1,"column":105,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":110}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { ResponsiveContainer, ScatterChart, Scatter, XAxis, YAxis, ZAxis, Tooltip, Cell, ReferenceLine, Label } from 'recharts';\r\n\r\ninterface GovernanceCompassProps {\r\n    rhetoricScore: number; // 0-100 (Y-Axis)\r\n    realityScore: number; // 0-100 (X-Axis)\r\n    driftExplanation?: string;\r\n}\r\n\r\nexport function GovernanceCompass({ rhetoricScore, realityScore, driftExplanation }: GovernanceCompassProps) {\r\n    const data = [\r\n        { x: realityScore, y: rhetoricScore, name: 'Governance State' }\r\n    ];\r\n\r\n    // Calculate drift magnitude\r\n    const drift = Math.abs(rhetoricScore - realityScore);\r\n    const isHighDrift = drift > 30;\r\n\r\n    return (\r\n        <div className=\"p-4 rounded-xl bg-white border border-slate-200 shadow-sm\">\r\n            <div className=\"mb-4\">\r\n                <h4 className=\"text-sm font-bold text-slate-900 uppercase tracking-wide\">Governance Compass</h4>\r\n                <p className=\"text-xs text-slate-500\">Mapping Discursive Claims (Rhetoric) vs. Material Operations (Reality)</p>\r\n            </div>\r\n\r\n            <div className=\"h-[300px] w-full relative\">\r\n                <ResponsiveContainer width=\"100%\" height=\"100%\">\r\n                    <ScatterChart margin={{ top: 20, right: 20, bottom: 20, left: 20 }}>\r\n                        <XAxis\r\n                            type=\"number\"\r\n                            dataKey=\"x\"\r\n                            name=\"Reality (Enforcement)\"\r\n                            domain={[0, 100]}\r\n                            tick={{ fontSize: 10 }}\r\n                            label={{ value: 'Material Reality (Enforcement) ', position: 'bottom', offset: 0, fontSize: 10 }}\r\n                        />\r\n                        <YAxis\r\n                            type=\"number\"\r\n                            dataKey=\"y\"\r\n                            name=\"Rhetoric (Claims)\"\r\n                            domain={[0, 100]}\r\n                            tick={{ fontSize: 10 }}\r\n                            label={{ value: 'Discursive Rhetoric (Claims) ', angle: -90, position: 'left', offset: 0, fontSize: 10 }}\r\n                        />\r\n                        <ZAxis range={[100, 100]} />\r\n                        <Tooltip cursor={{ strokeDasharray: '3 3' }} />\r\n\r\n                        {/* Quadrant Lines */}\r\n                        <ReferenceLine x={50} stroke=\"#e2e8f0\" />\r\n                        <ReferenceLine y={50} stroke=\"#e2e8f0\" />\r\n\r\n                        {/* Quadrant Labels */}\r\n                        <ReferenceLine y={90} label={{ value: \"High Rhetoric\", position: 'insideTopRight', fontSize: 10, fill: '#94a3b8' }} stroke=\"none\" />\r\n                        <ReferenceLine x={90} label={{ value: \"High Reality\", position: 'insideTopRight', fontSize: 10, fill: '#94a3b8' }} stroke=\"none\" />\r\n\r\n                        {/* Drift Vector (Ideal Line) */}\r\n                        <ReferenceLine segment={[{ x: 0, y: 0 }, { x: 100, y: 100 }]} stroke=\"#cbd5e1\" strokeDasharray=\"3 3\" />\r\n\r\n                        <Scatter data={data} fill=\"#8884d8\">\r\n                            {data.map((entry, index) => (\r\n                                <Cell key={`cell-${index}`} fill={isHighDrift ? '#ef4444' : '#10b981'} />\r\n                            ))}\r\n                        </Scatter>\r\n                    </ScatterChart>\r\n                </ResponsiveContainer>\r\n\r\n                {/* Custom Annotation for the Point */}\r\n                <div\r\n                    className=\"absolute transform -translate-x-1/2 -translate-y-1/2 pointer-events-none\"\r\n                    style={{\r\n                        left: `${(realityScore / 100) * 80 + 10}%`, // Rough approximation for positioning\r\n                        bottom: `${(rhetoricScore / 100) * 80 + 10}%`\r\n                    }}\r\n                >\r\n                    <div className={`px-2 py-1 rounded text-[10px] font-bold text-white ${isHighDrift ? 'bg-red-500' : 'bg-emerald-500'} shadow-sm whitespace-nowrap`}>\r\n                        {isHighDrift ? 'Drift Detected' : 'Aligned'}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {isHighDrift && (\r\n                <div className=\"mt-4 p-3 rounded-lg bg-red-50 border border-red-100 text-xs text-red-800\">\r\n                    <strong>Governance Drift:</strong> {driftExplanation || \"Significant gap between ethical claims and enforcement mechanisms.\"}\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\policy\\LegitimacyAnalysisView.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardDescription' is defined but never used.","line":4,"column":29,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":44}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { LegitimacyAnalysis } from \"@/types\";\r\nimport { Radar, RadarChart, PolarGrid, PolarAngleAxis, PolarRadiusAxis, ResponsiveContainer, Tooltip } from 'recharts';\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Scale } from \"lucide-react\";\r\n\r\ninterface LegitimacyAnalysisViewProps {\r\n    analysis: LegitimacyAnalysis;\r\n}\r\n\r\nexport function LegitimacyAnalysisView({ analysis }: LegitimacyAnalysisViewProps) {\r\n    if (!analysis || !analysis.orders) return null;\r\n\r\n    const data = [\r\n        { subject: 'Market', A: analysis.orders.market, fullMark: 10 },\r\n        { subject: 'Industrial', A: analysis.orders.industrial, fullMark: 10 },\r\n        { subject: 'Civic', A: analysis.orders.civic, fullMark: 10 },\r\n        { subject: 'Domestic', A: analysis.orders.domestic, fullMark: 10 },\r\n        { subject: 'Inspired', A: analysis.orders.inspired, fullMark: 10 },\r\n        { subject: 'Fame', A: analysis.orders.fame, fullMark: 10 },\r\n    ];\r\n\r\n    return (\r\n        <div className=\"space-y-6\">\r\n            <div className=\"flex flex-col md:flex-row gap-6\">\r\n                {/* Radar Chart */}\r\n                <div className=\"w-full md:w-1/2 h-[300px]\">\r\n                    <ResponsiveContainer width=\"100%\" height=\"100%\">\r\n                        <RadarChart cx=\"50%\" cy=\"50%\" outerRadius=\"80%\" data={data}>\r\n                            <PolarGrid stroke=\"#e2e8f0\" />\r\n                            <PolarAngleAxis dataKey=\"subject\" tick={{ fill: '#64748b', fontSize: 12 }} />\r\n                            <PolarRadiusAxis angle={30} domain={[0, 10]} tick={false} axisLine={false} />\r\n                            <Radar\r\n                                name=\"Legitimacy\"\r\n                                dataKey=\"A\"\r\n                                stroke=\"#4f46e5\"\r\n                                strokeWidth={2}\r\n                                fill=\"#6366f1\"\r\n                                fillOpacity={0.4}\r\n                            />\r\n                            <Tooltip\r\n                                contentStyle={{ borderRadius: '8px', border: 'none', boxShadow: '0 4px 6px -1px rgb(0 0 0 / 0.1)' }}\r\n                            />\r\n                        </RadarChart>\r\n                    </ResponsiveContainer>\r\n                </div>\r\n\r\n                {/* Analysis Details */}\r\n                <div className=\"w-full md:w-1/2 space-y-4\">\r\n                    <div>\r\n                        <h4 className=\"text-sm font-semibold text-slate-500 uppercase tracking-wider mb-2\">Dominant Order</h4>\r\n                        <div className=\"flex items-center gap-2\">\r\n                            <Scale className=\"h-5 w-5 text-indigo-600\" />\r\n                            <span className=\"text-lg font-bold text-slate-900\">{analysis.dominant_order}</span>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div>\r\n                        <h4 className=\"text-sm font-semibold text-slate-500 uppercase tracking-wider mb-2\">Justification Logic</h4>\r\n                        <p className=\"text-sm text-slate-700 leading-relaxed bg-slate-50 p-3 rounded-md border border-slate-100\">\r\n                            {analysis.justification_logic}\r\n                        </p>\r\n                    </div>\r\n\r\n                    <div>\r\n                        <h4 className=\"text-sm font-semibold text-slate-500 uppercase tracking-wider mb-2\">Moral Vocabulary</h4>\r\n                        <div className=\"flex flex-wrap gap-2\">\r\n                            {analysis.moral_vocabulary?.map((term, i) => (\r\n                                <Badge key={i} variant=\"secondary\" className=\"bg-indigo-50 text-indigo-700 hover:bg-indigo-100\">\r\n                                    {term}\r\n                                </Badge>\r\n                            ))}\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Conflict Spot */}\r\n            {analysis.conflict_spot && (\r\n                <Card className=\"bg-amber-50 border-amber-200\">\r\n                    <CardHeader className=\"pb-2\">\r\n                        <CardTitle className=\"text-sm font-bold text-amber-800 flex items-center gap-2\">\r\n                             Conflict Spot\r\n                        </CardTitle>\r\n                    </CardHeader>\r\n                    <CardContent>\r\n                        <p className=\"text-sm text-amber-900\">\r\n                            {analysis.conflict_spot}\r\n                        </p>\r\n                    </CardContent>\r\n                </Card>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\policy\\ViewSourceDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\reflexivity\\LogEntry.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CheckCircle' is defined but never used.","line":4,"column":31,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":42},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":29,"column":43,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[1614,1615],"text":"&quot;"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[1614,1615],"text":"&ldquo;"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[1614,1615],"text":"&#34;"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[1614,1615],"text":"&rdquo;"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":29,"column":67,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[1638,1639],"text":"&quot;"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[1638,1639],"text":"&ldquo;"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[1638,1639],"text":"&#34;"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[1638,1639],"text":"&rdquo;"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":104,"column":33,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[6616,6651],"text":"\r\n                                &quot;"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[6616,6651],"text":"\r\n                                &ldquo;"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[6616,6651],"text":"\r\n                                &#34;"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[6616,6651],"text":"\r\n                                &rdquo;"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":104,"column":147,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[6764,6795],"text":"&quot;\r\n                            "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[6764,6795],"text":"&ldquo;\r\n                            "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[6764,6795],"text":"&#34;\r\n                            "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[6764,6795],"text":"&rdquo;\r\n                            "},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { MethodLog } from \"@/types/logs\";\r\nimport { Tooltip, TooltipContent, TooltipProvider, TooltipTrigger } from \"@/components/ui/tooltip\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Info, AlertTriangle, CheckCircle, BrainCircuit, Scale, User, Bot } from \"lucide-react\";\r\n\r\nconst formatEnum = (value: string) => {\r\n    return value.split('_').map(word => word.charAt(0) + word.slice(1).toLowerCase()).join(' ');\r\n};\r\n\r\nexport function LogEntry({ log }: { log: MethodLog }) {\r\n    const isConflictLog = !!log.details.discrepancy;\r\n    const isPositionalityLog = log.action === \"Positionality Calibration\";\r\n\r\n    return (\r\n        <div className={`border-l-2 pl-4 py-3 space-y-2 transition-all ${isConflictLog ? 'border-amber-400 bg-amber-50/30 rounded-r-lg pr-2' : 'border-slate-200'}`}>\r\n            <div className=\"flex items-center justify-between mb-1\">\r\n                <span className=\"text-xs font-semibold text-slate-500\">\r\n                    {new Date(log.timestamp).toLocaleString()}\r\n                </span>\r\n                <Badge variant={isConflictLog ? \"default\" : \"outline\"} className={`text-xs ${isConflictLog ? 'bg-amber-600 hover:bg-amber-700' : ''}`}>\r\n                    {log.action}\r\n                </Badge>\r\n            </div>\r\n\r\n            {/* Positionality Statement */}\r\n            {log.details.statement && (\r\n                <div className=\"bg-slate-50 p-3 rounded-md border border-slate-100 text-sm text-slate-700 italic relative\">\r\n                    <User className=\"h-3 w-3 absolute top-3 left-2 text-slate-400\" />\r\n                    <div className=\"pl-4\">\"{log.details.statement}\"</div>\r\n                    {isPositionalityLog && (\r\n                        <div className=\"mt-2 text-xs text-slate-500 flex gap-2\">\r\n                            <Badge variant=\"secondary\" className=\"text-[10px]\">Locus: {log.details.locus as string}</Badge>\r\n                            <Badge variant=\"secondary\" className=\"text-[10px]\">Lens: {log.details.discipline as string}</Badge>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            )}\r\n\r\n            {/* Rich Conflict Resolution Log */}\r\n            {log.details.discrepancy && (\r\n                <div className=\"mt-2 space-y-3\">\r\n                    <div className=\"bg-white p-3 rounded-md border border-slate-200 shadow-sm\">\r\n                        <div className=\"flex items-center gap-2 mb-2\">\r\n                            <Scale className=\"h-4 w-4 text-amber-600\" />\r\n                            <span className=\"font-semibold text-slate-800 text-xs uppercase tracking-wide\">Interpretive Discrepancy</span>\r\n                            <TooltipProvider>\r\n                                <Tooltip>\r\n                                    <TooltipTrigger>\r\n                                        <Info className=\"h-3 w-3 text-slate-400 cursor-help\" />\r\n                                    </TooltipTrigger>\r\n                                    <TooltipContent className=\"max-w-xs\">\r\n                                        <p>The AI detected a divergence between its analysis and your anchor. This log captures how you resolved it.</p>\r\n                                    </TooltipContent>\r\n                                </Tooltip>\r\n                            </TooltipProvider>\r\n                        </div>\r\n\r\n                        <div className=\"grid grid-cols-2 gap-4\">\r\n                            <div className=\"bg-slate-50 p-2 rounded border border-slate-100\">\r\n                                <div className=\"flex items-center gap-1 mb-1\">\r\n                                    <Bot className=\"h-3 w-3 text-indigo-500\" />\r\n                                    <span className=\"text-[10px] text-slate-500 uppercase font-bold\">AI Proposition</span>\r\n                                </div>\r\n                                <span className=\"font-medium text-indigo-700 text-sm block\">\r\n                                    {formatEnum(log.details.discrepancy.systemProposition.placement)}\r\n                                </span>\r\n                                <p className=\"text-[10px] text-slate-500 mt-1 leading-tight\">\r\n                                    {log.details.discrepancy.systemProposition.evidence}\r\n                                </p>\r\n                            </div>\r\n                            <div className=\"bg-slate-50 p-2 rounded border border-slate-100\">\r\n                                <div className=\"flex items-center gap-1 mb-1\">\r\n                                    <User className=\"h-3 w-3 text-emerald-500\" />\r\n                                    <span className=\"text-[10px] text-slate-500 uppercase font-bold\">Human Anchor</span>\r\n                                </div>\r\n                                <span className=\"font-medium text-emerald-700 text-sm block\">\r\n                                    {formatEnum(log.details.discrepancy.humanAnchor.placement)}\r\n                                </span>\r\n                                <p className=\"text-[10px] text-slate-500 mt-1 leading-tight\">\r\n                                    {log.details.discrepancy.humanAnchor.evidence}\r\n                                </p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"flex items-center justify-between bg-slate-100 p-2 rounded text-xs\">\r\n                        <span className=\"font-semibold text-slate-600\">Resolution:</span>\r\n                        <div className=\"flex items-center gap-2\">\r\n                            <span className={log.details.resolution?.action === 'MANUAL_OVERRIDE' ? 'text-red-600 font-bold' : 'text-emerald-600 font-bold'}>\r\n                                {formatEnum(log.details.resolution?.action || '')}\r\n                            </span>\r\n                            <span className=\"text-slate-500\"></span>\r\n                            <span className=\"text-slate-800 font-medium\">{formatEnum(log.details.resolution?.finalValue || '')}</span>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {log.details.justification && (\r\n                        <div className=\"bg-red-50 p-3 rounded-md border border-red-100 text-red-900 text-xs\">\r\n                            <div className=\"flex items-center gap-2 mb-1 text-red-700 font-semibold\">\r\n                                <AlertTriangle className=\"h-3 w-3\" />\r\n                                <span>Analyst Rationale</span>\r\n                            </div>\r\n                            <p className=\"italic pl-5\">\r\n                                \"{typeof log.details.justification === 'string' ? log.details.justification : log.details.justification.rationale}\"\r\n                            </p>\r\n                        </div>\r\n                    )}\r\n\r\n                    {log.details.reflexivity && (\r\n                        <div className=\"bg-purple-50 p-3 rounded-md border border-purple-100 text-purple-900 text-xs\">\r\n                            <div className=\"flex items-center gap-2 mb-1 text-purple-700 font-semibold\">\r\n                                <BrainCircuit className=\"h-3 w-3\" />\r\n                                <span>System Reflexivity</span>\r\n                                <TooltipProvider>\r\n                                    <Tooltip>\r\n                                        <TooltipTrigger>\r\n                                            <Info className=\"h-3 w-3 text-purple-400 cursor-help\" />\r\n                                        </TooltipTrigger>\r\n                                        <TooltipContent className=\"max-w-xs\">\r\n                                            <p>How the system is updating its internal model based on this interaction.</p>\r\n                                        </TooltipContent>\r\n                                    </Tooltip>\r\n                                </TooltipProvider>\r\n                            </div>\r\n                            <p className=\"pl-5\">\r\n                                {log.details.reflexivity.feedbackLoop}\r\n                            </p>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            )}\r\n\r\n            {/* Standard Validation Details (Legacy) */}\r\n            {!log.details.discrepancy && log.details.agreement && (\r\n                <div className=\"text-xs space-y-1 pl-2\">\r\n                    <div className=\"flex items-center gap-2\">\r\n                        <span className=\"font-semibold text-slate-600\">Agreement:</span>\r\n                        <span className={log.details.agreement === 'yes' ? 'text-emerald-600 font-bold' : 'text-red-600 font-bold'}>\r\n                            {log.details.agreement.toUpperCase()}\r\n                        </span>\r\n                    </div>\r\n                    {log.details.initial_impression && (\r\n                        <p className=\"text-slate-600\"><span className=\"font-semibold\">Initial Impression:</span> {log.details.initial_impression}</p>\r\n                    )}\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\reflexivity\\MultiLensAnalysis.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\reflexivity\\PositionalityDialog.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AlertTriangle' is defined but never used.","line":8,"column":47,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":60},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":78,"column":70,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[3213,3373],"text":"\r\n                        Assemblage-AI uses your inputs to adjust its &quot;Decolonial Prompts\" and flag potential cultural misunderstandings.\r\n                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[3213,3373],"text":"\r\n                        Assemblage-AI uses your inputs to adjust its &ldquo;Decolonial Prompts\" and flag potential cultural misunderstandings.\r\n                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[3213,3373],"text":"\r\n                        Assemblage-AI uses your inputs to adjust its &#34;Decolonial Prompts\" and flag potential cultural misunderstandings.\r\n                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[3213,3373],"text":"\r\n                        Assemblage-AI uses your inputs to adjust its &rdquo;Decolonial Prompts\" and flag potential cultural misunderstandings.\r\n                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":78,"column":89,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[3213,3373],"text":"\r\n                        Assemblage-AI uses your inputs to adjust its \"Decolonial Prompts&quot; and flag potential cultural misunderstandings.\r\n                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[3213,3373],"text":"\r\n                        Assemblage-AI uses your inputs to adjust its \"Decolonial Prompts&ldquo; and flag potential cultural misunderstandings.\r\n                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[3213,3373],"text":"\r\n                        Assemblage-AI uses your inputs to adjust its \"Decolonial Prompts&#34; and flag potential cultural misunderstandings.\r\n                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[3213,3373],"text":"\r\n                        Assemblage-AI uses your inputs to adjust its \"Decolonial Prompts&rdquo; and flag potential cultural misunderstandings.\r\n                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":156,"column":44,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[8359,8465],"text":"\r\n                                    Enable &quot;Counter-Narrative\" Prompts\r\n                                "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[8359,8465],"text":"\r\n                                    Enable &ldquo;Counter-Narrative\" Prompts\r\n                                "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[8359,8465],"text":"\r\n                                    Enable &#34;Counter-Narrative\" Prompts\r\n                                "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[8359,8465],"text":"\r\n                                    Enable &rdquo;Counter-Narrative\" Prompts\r\n                                "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":156,"column":62,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[8359,8465],"text":"\r\n                                    Enable \"Counter-Narrative&quot; Prompts\r\n                                "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[8359,8465],"text":"\r\n                                    Enable \"Counter-Narrative&ldquo; Prompts\r\n                                "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[8359,8465],"text":"\r\n                                    Enable \"Counter-Narrative&#34; Prompts\r\n                                "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[8359,8465],"text":"\r\n                                    Enable \"Counter-Narrative&rdquo; Prompts\r\n                                "},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from \"react\";\r\nimport { Dialog, DialogContent, DialogDescription, DialogFooter, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Textarea } from \"@/components/ui/textarea\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\r\nimport { Checkbox } from \"@/components/ui/checkbox\";\r\nimport { Loader2, Settings2, Globe, BookOpen, AlertTriangle } from \"lucide-react\";\r\nimport { PositionalityData } from \"@/types\";\r\n\r\ninterface PositionalityDialogProps {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n    onConfirm: (data: PositionalityData) => void;\r\n}\r\n\r\nexport function PositionalityDialog({ isOpen, onClose, onConfirm }: PositionalityDialogProps) {\r\n    const [locus, setLocus] = useState(\"\");\r\n    const [discipline, setDiscipline] = useState(\"\");\r\n    const [reflexiveGap, setReflexiveGap] = useState(\"\");\r\n    const [enableCounterNarrative, setEnableCounterNarrative] = useState(false);\r\n    const [isSaving, setIsSaving] = useState(false);\r\n\r\n    const handleConfirm = async () => {\r\n        if (!locus || !discipline || !reflexiveGap) return;\r\n\r\n        setIsSaving(true);\r\n        const data: PositionalityData = {\r\n            locus,\r\n            discipline,\r\n            reflexiveGap,\r\n            enableCounterNarrative\r\n        };\r\n\r\n        try {\r\n            // Save to logs\r\n            const headers: HeadersInit = { 'Content-Type': 'application/json' };\r\n            if (process.env.NEXT_PUBLIC_ENABLE_DEMO_MODE === 'true' && process.env.NEXT_PUBLIC_DEMO_USER_ID) {\r\n                headers['x-demo-user-id'] = process.env.NEXT_PUBLIC_DEMO_USER_ID;\r\n            }\r\n\r\n            await fetch('/api/logs', {\r\n                method: 'POST',\r\n                headers: headers,\r\n                body: JSON.stringify({\r\n                    action: \"Positionality Calibration\",\r\n                    details: {\r\n                        ...data,\r\n                        context: \"Pre-Analysis Calibration\"\r\n                    }\r\n                })\r\n            });\r\n\r\n            onConfirm(data);\r\n            // Reset for next time\r\n            setLocus(\"\");\r\n            setDiscipline(\"\");\r\n            setReflexiveGap(\"\");\r\n            setEnableCounterNarrative(false);\r\n        } catch (error) {\r\n            console.error(\"Failed to save positionality statement\", error);\r\n            onConfirm(data);\r\n        } finally {\r\n            setIsSaving(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <Dialog open={isOpen} onOpenChange={(open) => !open && onClose()}>\r\n            <DialogContent className=\"sm:max-w-[600px] max-h-[90vh] overflow-y-auto\">\r\n                <DialogHeader>\r\n                    <div className=\"flex items-center gap-2 text-indigo-600 mb-2\">\r\n                        <Settings2 className=\"h-5 w-5\" />\r\n                        <span className=\"text-xs font-bold uppercase tracking-wider\">System Calibration</span>\r\n                    </div>\r\n                    <DialogTitle className=\"text-xl\">Calibrate Interpretive Lenses</DialogTitle>\r\n                    <DialogDescription>\r\n                        Assemblage-AI uses your inputs to adjust its \"Decolonial Prompts\" and flag potential cultural misunderstandings.\r\n                    </DialogDescription>\r\n                </DialogHeader>\r\n\r\n                <div className=\"space-y-6 py-4\">\r\n                    {/* Part 1: Locus of Enunciation */}\r\n                    <div className=\"space-y-4 p-4 bg-slate-50 rounded-lg border border-slate-200\">\r\n                        <h5 className=\"text-sm font-bold text-slate-900 uppercase flex items-center gap-2\">\r\n                            <Globe className=\"h-4 w-4 text-slate-500\" />\r\n                            Part 1: Locus of Enunciation\r\n                        </h5>\r\n                        <div className=\"grid grid-cols-2 gap-4\">\r\n                            <div className=\"space-y-2\">\r\n                                <Label className=\"text-xs\">Geographic Locus</Label>\r\n                                <Select value={locus} onValueChange={setLocus}>\r\n                                    <SelectTrigger>\r\n                                        <SelectValue placeholder=\"Select Region\" />\r\n                                    </SelectTrigger>\r\n                                    <SelectContent>\r\n                                        <SelectItem value=\"Global North\">Global North</SelectItem>\r\n                                        <SelectItem value=\"Global South\">Global South</SelectItem>\r\n                                        <SelectItem value=\"Indigenous\">Indigenous / First Nations</SelectItem>\r\n                                        <SelectItem value=\"Diasporic\">Diasporic</SelectItem>\r\n                                    </SelectContent>\r\n                                </Select>\r\n                            </div>\r\n                            <div className=\"space-y-2\">\r\n                                <Label className=\"text-xs\">Disciplinary Lens</Label>\r\n                                <Select value={discipline} onValueChange={setDiscipline}>\r\n                                    <SelectTrigger>\r\n                                        <SelectValue placeholder=\"Select Discipline\" />\r\n                                    </SelectTrigger>\r\n                                    <SelectContent>\r\n                                        <SelectItem value=\"Legal\">Legal / Regulatory</SelectItem>\r\n                                        <SelectItem value=\"Technical\">Technical / Engineering</SelectItem>\r\n                                        <SelectItem value=\"Sociological\">Sociological / STS</SelectItem>\r\n                                        <SelectItem value=\"Activist\">Activist / Civil Society</SelectItem>\r\n                                    </SelectContent>\r\n                                </Select>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Part 2: Epistemic Distance */}\r\n                    <div className=\"space-y-4\">\r\n                        <h5 className=\"text-sm font-bold text-slate-900 uppercase flex items-center gap-2\">\r\n                            <BookOpen className=\"h-4 w-4 text-slate-500\" />\r\n                            Part 2: Epistemic Distance\r\n                        </h5>\r\n                        <div className=\"space-y-2\">\r\n                            <Label className=\"text-xs\">Reflexive Gap Prediction</Label>\r\n                            <p className=\"text-xs text-slate-500 mb-2\">\r\n                                Given your Locus ({locus || \"...\"}) and the Target Document, what specific concepts might you misinterpret?\r\n                            </p>\r\n                            <Textarea\r\n                                placeholder=\"e.g., 'I might default to individual privacy definitions instead of communal data rights.'\"\r\n                                value={reflexiveGap}\r\n                                onChange={(e) => setReflexiveGap(e.target.value)}\r\n                                className=\"min-h-[80px]\"\r\n                            />\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Part 3: Active Calibration */}\r\n                    <div className=\"space-y-4 p-4 bg-indigo-50 rounded-lg border border-indigo-100\">\r\n                        <h5 className=\"text-sm font-bold text-indigo-900 uppercase flex items-center gap-2\">\r\n                            <Settings2 className=\"h-4 w-4\" />\r\n                            Part 3: Active Calibration\r\n                        </h5>\r\n                        <div className=\"flex items-start gap-3\">\r\n                            <Checkbox\r\n                                id=\"counter-narrative\"\r\n                                checked={enableCounterNarrative}\r\n                                onCheckedChange={(checked: boolean | \"indeterminate\") => setEnableCounterNarrative(checked === true)}\r\n                                className=\"mt-1\"\r\n                            />\r\n                            <div className=\"space-y-1\">\r\n                                <Label htmlFor=\"counter-narrative\" className=\"font-semibold text-indigo-900 cursor-pointer\">\r\n                                    Enable \"Counter-Narrative\" Prompts\r\n                                </Label>\r\n                                <p className=\"text-xs text-indigo-700 leading-relaxed\">\r\n                                    Force the AI to re-summarize key findings from the perspective of marginalized actors identified in the text.\r\n                                </p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                <DialogFooter>\r\n                    <Button variant=\"outline\" onClick={onClose}>Cancel</Button>\r\n                    <Button\r\n                        onClick={handleConfirm}\r\n                        disabled={!locus || !discipline || !reflexiveGap || isSaving}\r\n                        className=\"bg-indigo-600 hover:bg-indigo-700 text-white\"\r\n                    >\r\n                        {isSaving ? <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" /> : null}\r\n                        Save & Calibrate Engine\r\n                    </Button>\r\n                </DialogFooter>\r\n            </DialogContent>\r\n        </Dialog>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\ui\\alert-dialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\ui\\badge.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\ui\\button.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\ui\\card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\ui\\checkbox.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\ui\\dialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\ui\\input.tsx","messages":[{"ruleId":"@typescript-eslint/no-empty-object-type","severity":2,"message":"An interface declaring no members is equivalent to its supertype.","line":5,"column":18,"nodeType":"Identifier","messageId":"noEmptyInterfaceWithSuper","endLine":5,"endColumn":28,"suggestions":[{"messageId":"replaceEmptyInterfaceWithSuper","fix":{"range":[77,158],"text":"type InputProps = React.InputHTMLAttributes<HTMLInputElement>"},"desc":"Replace empty interface with a type alias."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nexport interface InputProps\r\n    extends React.InputHTMLAttributes<HTMLInputElement> { }\r\n\r\nconst Input = React.forwardRef<HTMLInputElement, InputProps>(\r\n    ({ className, type, ...props }, ref) => {\r\n        return (\r\n            <input\r\n                type={type}\r\n                className={cn(\r\n                    \"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\r\n                    className\r\n                )}\r\n                ref={ref}\r\n                {...props}\r\n            />\r\n        )\r\n    }\r\n)\r\nInput.displayName = \"Input\"\r\n\r\nexport { Input }\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\ui\\label.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\ui\\select.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\ui\\tabs.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\ui\\textarea.tsx","messages":[{"ruleId":"@typescript-eslint/no-empty-object-type","severity":2,"message":"An interface declaring no members is equivalent to its supertype.","line":5,"column":18,"nodeType":"Identifier","messageId":"noEmptyInterfaceWithSuper","endLine":5,"endColumn":31,"suggestions":[{"messageId":"replaceEmptyInterfaceWithSuper","fix":{"range":[77,167],"text":"type TextareaProps = React.TextareaHTMLAttributes<HTMLTextAreaElement>"},"desc":"Replace empty interface with a type alias."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nexport interface TextareaProps\r\n    extends React.TextareaHTMLAttributes<HTMLTextAreaElement> { }\r\n\r\nconst Textarea = React.forwardRef<HTMLTextAreaElement, TextareaProps>(\r\n    ({ className, ...props }, ref) => {\r\n        return (\r\n            <textarea\r\n                className={cn(\r\n                    \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\r\n                    className\r\n                )}\r\n                ref={ref}\r\n                {...props}\r\n            />\r\n        )\r\n    }\r\n)\r\nTextarea.displayName = \"Textarea\"\r\n\r\nexport { Textarea }\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\ui\\tooltip.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\hooks\\useServerStorage.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\hooks\\useSources.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":73,"column":26,"nodeType":null,"messageId":"unusedVar","endLine":73,"endColumn":27}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport { Source } from '@/types';\r\n\r\nexport function useSources() {\r\n    const [sources, setSources] = useState<Source[]>([]);\r\n    const [isLoading, setIsLoading] = useState(true);\r\n    const [error, setError] = useState<string | null>(null);\r\n\r\n    useEffect(() => {\r\n        fetchSources();\r\n    }, []);\r\n\r\n    const fetchSources = async () => {\r\n        try {\r\n            const headers: HeadersInit = {};\r\n            if (process.env.NEXT_PUBLIC_ENABLE_DEMO_MODE === 'true' && process.env.NEXT_PUBLIC_DEMO_USER_ID) {\r\n                headers['x-demo-user-id'] = process.env.NEXT_PUBLIC_DEMO_USER_ID;\r\n            }\r\n\r\n            const response = await fetch('/api/sources', {\r\n                cache: 'no-store',\r\n                headers\r\n            });\r\n            if (!response.ok) throw new Error('Failed to fetch sources');\r\n            const data = await response.json();\r\n            setSources(data);\r\n        } catch (err) {\r\n            setError(err instanceof Error ? err.message : 'An error occurred');\r\n        } finally {\r\n            setIsLoading(false);\r\n        }\r\n    };\r\n\r\n    const addSource = async (source: Source) => {\r\n        try {\r\n            const headers: HeadersInit = { 'Content-Type': 'application/json' };\r\n            if (process.env.NEXT_PUBLIC_ENABLE_DEMO_MODE === 'true' && process.env.NEXT_PUBLIC_DEMO_USER_ID) {\r\n                headers['x-demo-user-id'] = process.env.NEXT_PUBLIC_DEMO_USER_ID;\r\n            }\r\n\r\n            const response = await fetch('/api/sources', {\r\n                method: 'POST',\r\n                headers: headers,\r\n                body: JSON.stringify(source),\r\n            });\r\n            if (!response.ok) throw new Error('Failed to add source');\r\n            const newSource = await response.json();\r\n            setSources(prev => [...prev, newSource]);\r\n            return newSource;\r\n        } catch (err) {\r\n            setError(err instanceof Error ? err.message : 'Failed to add source');\r\n            throw err;\r\n        }\r\n    };\r\n\r\n    const updateSource = async (id: string, updates: Partial<Source>) => {\r\n        try {\r\n            const headers: HeadersInit = { 'Content-Type': 'application/json' };\r\n            if (process.env.NEXT_PUBLIC_ENABLE_DEMO_MODE === 'true' && process.env.NEXT_PUBLIC_DEMO_USER_ID) {\r\n                headers['x-demo-user-id'] = process.env.NEXT_PUBLIC_DEMO_USER_ID;\r\n            }\r\n\r\n            const response = await fetch(`/api/sources/${id}`, {\r\n                method: 'PUT',\r\n                headers: headers,\r\n                body: JSON.stringify(updates),\r\n            });\r\n            if (!response.ok) {\r\n                const text = await response.text();\r\n                try {\r\n                    const errorData = JSON.parse(text);\r\n                    throw new Error(errorData.error || 'Failed to update source');\r\n                } catch (e) {\r\n                    // If JSON parse fails, throw the raw text (or a summary of it)\r\n                    console.error('Non-JSON error response:', text);\r\n                    throw new Error(`Server error (${response.status}): ${text.substring(0, 100)}`);\r\n                }\r\n            }\r\n            const updatedSource = await response.json();\r\n            setSources(prev => prev.map(s => s.id === id ? updatedSource : s));\r\n            return updatedSource;\r\n        } catch (err) {\r\n            setError(err instanceof Error ? err.message : 'Failed to update source');\r\n            throw err;\r\n        }\r\n    };\r\n\r\n    const deleteSource = async (id: string) => {\r\n        try {\r\n            const headers: HeadersInit = {};\r\n            if (process.env.NEXT_PUBLIC_ENABLE_DEMO_MODE === 'true' && process.env.NEXT_PUBLIC_DEMO_USER_ID) {\r\n                headers['x-demo-user-id'] = process.env.NEXT_PUBLIC_DEMO_USER_ID;\r\n            }\r\n\r\n            const response = await fetch(`/api/sources/${id}`, {\r\n                method: 'DELETE',\r\n                headers: headers\r\n            });\r\n            if (!response.ok) throw new Error('Failed to delete source');\r\n            setSources(prev => prev.filter(s => s.id !== id));\r\n        } catch (err) {\r\n            setError(err instanceof Error ? err.message : 'Failed to delete source');\r\n            throw err;\r\n        }\r\n    };\r\n\r\n    return {\r\n        sources,\r\n        isLoading,\r\n        error,\r\n        addSource,\r\n        updateSource,\r\n        deleteSource,\r\n        refresh: fetchSources\r\n    };\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\lib\\analysis-prompts.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\lib\\analysis-utils.ts","messages":[],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":2,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":2,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[110,113],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[110,113],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":2,"column":60,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":2,"endColumn":63,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[116,119],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[116,119],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":3,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":3,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[143,146],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[143,146],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":8,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":8,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[414,417],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[414,417],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\lib\\credits.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\lib\\governance.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'count' is assigned a value but never used.","line":37,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":37,"endColumn":14}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"export interface CompassPoint {\r\n    x: number; // Asymmetrical (-1) vs Participatory (+1)\r\n    y: number; // Extractive (-1) vs Regenerative (+1)\r\n    label: string;\r\n}\r\n\r\nexport interface DriftVector {\r\n    rhetoric: CompassPoint;\r\n    reality: CompassPoint;\r\n    driftX: number;\r\n    driftY: number;\r\n    magnitude: number;\r\n}\r\n\r\n// Keywords for scoring (simplified for this implementation)\r\n// Keywords for scoring (expanded for better matching)\r\nconst REGENERATIVE_KEYWORDS = [\r\n    'capacity building', 'community ownership', 'local adaptation', 'public good', 'sustainability', 'empowerment',\r\n    'humanity', 'benefit', 'safety', 'beneficial', 'robust', 'reliable', 'fairness', 'justice', 'equity', 'access', 'open source', 'public', 'thriving', 'ecosystem'\r\n];\r\nconst EXTRACTIVE_KEYWORDS = [\r\n    'data mining', 'user acquisition', 'behavioral surplus', 'monetization', 'lock-in', 'surveillance',\r\n    'proprietary', 'closed', 'profit', 'commercial', 'usage policies', 'restrictions', 'license', 'fee', 'paid', 'exclusive', 'competitive', 'capture', 'market share', 'dominance'\r\n];\r\nconst PARTICIPATORY_KEYWORDS = [\r\n    'co-design', 'veto power', 'citizen jury', 'public consultation', 'multi-stakeholder', 'consensus',\r\n    'oversight', 'accountability', 'transparency', 'explainability', 'audit', 'feedback', 'redress', 'appeal', 'collaboration', 'partnership', 'agency', 'choice', 'democratic'\r\n];\r\nconst ASYMMETRICAL_KEYWORDS = [\r\n    'unilateral', 'compliance requirement', 'terms of service', 'mandatory', 'enforcement', 'top-down',\r\n    'centralized', 'control', 'authority', 'restricted', 'prohibited', 'disallowed', 'monitoring', 'rules', 'opaque', 'black box', 'limited access'\r\n];\r\n\r\nfunction calculateScore(text: string, positiveKeywords: string[], negativeKeywords: string[]): number {\r\n    const lowerText = text.toLowerCase();\r\n    let score = 0;\r\n    let count = 0;\r\n\r\n    positiveKeywords.forEach(keyword => {\r\n        if (lowerText.includes(keyword)) {\r\n            score += 1;\r\n            count++;\r\n        }\r\n    });\r\n\r\n    negativeKeywords.forEach(keyword => {\r\n        if (lowerText.includes(keyword)) {\r\n            score -= 1;\r\n            count++;\r\n        }\r\n    });\r\n\r\n    // Normalize to -1 to 1 range, avoiding division by zero\r\n    // We use a sigmoid-like squash or simple clamping. Here, simple clamping with a scaling factor.\r\n    // Assuming 5 keywords is a \"strong\" signal.\r\n    return Math.max(-1, Math.min(1, score * 0.2));\r\n}\r\n\r\nexport function calculateCompassScore(text: string, label: string): CompassPoint {\r\n    const y = calculateScore(text, REGENERATIVE_KEYWORDS, EXTRACTIVE_KEYWORDS);\r\n    const x = calculateScore(text, PARTICIPATORY_KEYWORDS, ASYMMETRICAL_KEYWORDS);\r\n    return { x, y, label };\r\n}\r\n\r\nexport function calculateDrift(policyText: string, techText: string): DriftVector {\r\n    const rhetoric = calculateCompassScore(policyText, \"Rhetoric\");\r\n    const reality = calculateCompassScore(techText, \"Reality\");\r\n\r\n    const driftX = reality.x - rhetoric.x;\r\n    const driftY = reality.y - rhetoric.y;\r\n    const magnitude = Math.sqrt(driftX * driftX + driftY * driftY);\r\n\r\n    return {\r\n        rhetoric,\r\n        reality,\r\n        driftX,\r\n        driftY,\r\n        magnitude\r\n    };\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\lib\\ontology-utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\lib\\ontology.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\lib\\ratelimit.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\lib\\redis.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\lib\\store.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\lib\\utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\middleware.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\services\\analysis.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AnalyzeRequest' is defined but never used.","line":5,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":25}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { AnalysisResult, Source, PositionalityData } from \"@/types\";\r\n\r\nexport type AnalysisMode = 'dsf' | 'cultural_framing' | 'institutional_logics' | 'resistance' | 'ecosystem' | 'ontology' | 'comparison' | 'generate_resistance' | 'cultural_holes' | 'legitimacy' | 'comparative_synthesis' | 'assemblage_extraction' | 'resistance_synthesis';\r\n\r\ninterface AnalyzeRequest {\r\n    text: string;\r\n    sourceType: string;\r\n    analysisMode?: AnalysisMode;\r\n    sourceA?: { title: string; text: string };\r\n    sourceB?: { title: string; text: string };\r\n    documents?: Source[]; // For comparative synthesis\r\n}\r\n\r\ninterface AnalyzeResponse {\r\n    success: boolean;\r\n    analysis: AnalysisResult;\r\n    error?: string;\r\n    details?: string;\r\n}\r\n\r\nexport const analyzeDocument = async (\r\n    text: string,\r\n    mode: AnalysisMode = 'dsf',\r\n    sourceType: string = 'Policy Document',\r\n    force: boolean = false,\r\n    documentId?: string,\r\n    title?: string,\r\n    positionality?: PositionalityData\r\n): Promise<AnalysisResult> => {\r\n    try {\r\n        const headers: HeadersInit = { 'Content-Type': 'application/json' };\r\n        if (process.env.NEXT_PUBLIC_ENABLE_DEMO_MODE === 'true' && process.env.NEXT_PUBLIC_DEMO_USER_ID) {\r\n            headers['x-demo-user-id'] = process.env.NEXT_PUBLIC_DEMO_USER_ID;\r\n        }\r\n        console.log('analyzeDocument headers:', headers);\r\n\r\n        const response = await fetch('/api/analyze', {\r\n            method: 'POST',\r\n            headers: headers,\r\n            body: JSON.stringify({\r\n                text,\r\n                sourceType,\r\n                analysisMode: mode,\r\n                force,\r\n                documentId,\r\n                title,\r\n                positionality\r\n            })\r\n        });\r\n\r\n        const result: AnalyzeResponse = await response.json();\r\n\r\n        if (!result.success) {\r\n            throw new Error(result.details || result.error || 'Analysis failed');\r\n        }\r\n\r\n        return result.analysis;\r\n    } catch (error) {\r\n        console.error(`Analysis error (${mode}):`, error);\r\n        throw error;\r\n    }\r\n};\r\n\r\nexport const synthesizeComparison = async (documents: Source[]): Promise<AnalysisResult> => {\r\n    try {\r\n        const headers: HeadersInit = { 'Content-Type': 'application/json' };\r\n        if (process.env.NEXT_PUBLIC_ENABLE_DEMO_MODE === 'true' && process.env.NEXT_PUBLIC_DEMO_USER_ID) {\r\n            headers['x-demo-user-id'] = process.env.NEXT_PUBLIC_DEMO_USER_ID;\r\n        }\r\n\r\n        const response = await fetch('/api/analyze', {\r\n            method: 'POST',\r\n            headers: headers,\r\n            body: JSON.stringify({\r\n                analysisMode: 'comparative_synthesis',\r\n                documents\r\n            })\r\n        });\r\n\r\n        const result: AnalyzeResponse = await response.json();\r\n\r\n        if (!result.success) {\r\n            throw new Error(result.details || result.error || 'Synthesis failed');\r\n        }\r\n\r\n        return result.analysis;\r\n    } catch (error) {\r\n        console.error('Comparative synthesis error:', error);\r\n        throw error;\r\n    }\r\n};\r\n\r\nexport const generateSearchTerms = async (insight: string): Promise<string[]> => {\r\n    try {\r\n        const headers: HeadersInit = { 'Content-Type': 'application/json' };\r\n        if (process.env.NEXT_PUBLIC_ENABLE_DEMO_MODE === 'true' && process.env.NEXT_PUBLIC_DEMO_USER_ID) {\r\n            headers['x-demo-user-id'] = process.env.NEXT_PUBLIC_DEMO_USER_ID;\r\n        }\r\n\r\n        const response = await fetch('/api/generate-search-terms', {\r\n            method: 'POST',\r\n            headers: headers,\r\n            body: JSON.stringify({ insight })\r\n        });\r\n\r\n        const result = await response.json();\r\n        return result.searchTerms || [];\r\n    } catch (error) {\r\n        console.error('Search terms generation error:', error);\r\n        return [];\r\n    }\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\services\\image.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\types\\cultural.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\types\\ecosystem.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\types\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\types\\logs.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\types\\ontology.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\utils\\generateSynthesisPDF.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\utils\\pdfExtractor.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":34,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":34,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1176,1179],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1176,1179],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"export interface PDFExtractionResult {\r\n    text: string;\r\n    pageCount: number;\r\n    metadata?: Record<string, unknown>;\r\n}\r\n\r\nexport async function extractTextFromPDF(file: File): Promise<PDFExtractionResult> {\r\n    try {\r\n        // Dynamic import to avoid SSR issues with DOMMatrix\r\n        const pdfjsLib = await import('pdfjs-dist');\r\n\r\n        // Configure worker\r\n        pdfjsLib.GlobalWorkerOptions.workerSrc = new URL(\r\n            'pdfjs-dist/build/pdf.worker.min.mjs',\r\n            import.meta.url\r\n        ).toString();\r\n\r\n        // Read file as array buffer\r\n        const arrayBuffer = await file.arrayBuffer();\r\n\r\n        // Load PDF document\r\n        const loadingTask = pdfjsLib.getDocument({ data: arrayBuffer });\r\n        const pdf = await loadingTask.promise;\r\n\r\n        const pageCount = pdf.numPages;\r\n        let fullText = '';\r\n\r\n        // Extract text from each page\r\n        for (let pageNum = 1; pageNum <= pageCount; pageNum++) {\r\n            const page = await pdf.getPage(pageNum);\r\n            const textContent = await page.getTextContent();\r\n\r\n            const pageText = textContent.items\r\n                .map((item: { str: string } | any) => 'str' in item ? item.str : '')\r\n                .join(' ');\r\n\r\n            fullText += `\\n\\n--- Page ${pageNum} ---\\n\\n${pageText}`;\r\n        }\r\n\r\n        // Get metadata\r\n        const metadata = await pdf.getMetadata();\r\n\r\n        return {\r\n            text: fullText.trim(),\r\n            pageCount,\r\n            metadata: metadata.info as Record<string, unknown>\r\n        };\r\n    } catch (error) {\r\n        console.error('PDF extraction error:', error);\r\n        throw new Error('Failed to extract text from PDF');\r\n    }\r\n}\r\n\r\nexport function segmentText(text: string, chunkSize: number = 2000): string[] {\r\n    const segments: string[] = [];\r\n    const words = text.split(/\\s+/);\r\n\r\n    let currentSegment: string[] = [];\r\n    let currentLength = 0;\r\n\r\n    for (const word of words) {\r\n        if (currentLength + word.length > chunkSize && currentSegment.length > 0) {\r\n            segments.push(currentSegment.join(' '));\r\n            currentSegment = [word];\r\n            currentLength = word.length;\r\n        } else {\r\n            currentSegment.push(word);\r\n            currentLength += word.length + 1;\r\n        }\r\n    }\r\n\r\n    if (currentSegment.length > 0) {\r\n        segments.push(currentSegment.join(' '));\r\n    }\r\n\r\n    return segments;\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\test-credits.js","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'getCredits' is assigned a value but never used.","line":2,"column":42,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":52},{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":2,"column":69,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":2,"endColumn":97},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'redis' is assigned a value but never used.","line":3,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":14},{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":3,"column":19,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":3,"endColumn":45}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nconst { initializeCredits, checkCredits, getCredits, addCredits } = require('./src/lib/credits');\r\nconst { redis } = require('./src/lib/redis');\r\n\r\nasync function testCredits() {\r\n    const testUserId = 'test_user_' + Date.now();\r\n    console.log(`Testing with User ID: ${testUserId}`);\r\n\r\n    // 1. Initialize\r\n    console.log('--- Test 1: Initialization ---');\r\n    const initialBalance = await initializeCredits(testUserId);\r\n    console.log(`Initial Balance: ${initialBalance} (Expected: 100)`);\r\n    if (initialBalance !== 100) throw new Error('Initialization failed');\r\n\r\n    // 2. Check & Deduct\r\n    console.log('\\n--- Test 2: Deduction ---');\r\n    const result = await checkCredits(testUserId, 10, true);\r\n    console.log(`Deduction Success: ${result.success}`);\r\n    console.log(`Remaining Balance: ${result.remaining} (Expected: 90)`);\r\n    if (result.remaining !== 90) throw new Error('Deduction failed');\r\n\r\n    // 3. Insufficient Funds\r\n    console.log('\\n--- Test 3: Insufficient Funds ---');\r\n    // Try to deduct 100 (balance is 90)\r\n    const failResult = await checkCredits(testUserId, 100, true);\r\n    console.log(`Should Fail: ${!failResult.success}`);\r\n    console.log(`Error Message: ${failResult.error}`);\r\n    if (failResult.success) throw new Error('Insufficient funds check failed');\r\n\r\n    // 4. Add Credits\r\n    console.log('\\n--- Test 4: Add Credits ---');\r\n    const newBalance = await addCredits(testUserId, 50);\r\n    console.log(`New Balance after adding 50: ${newBalance} (Expected: 140)`);\r\n    if (newBalance !== 140) throw new Error('Adding credits failed');\r\n\r\n    console.log('\\n All Credit Tests Passed');\r\n    process.exit(0);\r\n}\r\n\r\ntestCredits().catch(err => {\r\n    console.error(' Test Failed:', err);\r\n    process.exit(1);\r\n});\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\test-google-search.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\test-redis.js","messages":[],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":2,"column":15,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":2,"endColumn":33,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]