[{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\admin\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\api\\admin\\ratelimit\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\api\\analyze\\route.ts","messages":[],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":537,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":537,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[21948,21951],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[21948,21951],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":568,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":568,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[23379,23382],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[23379,23382],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\api\\cultural-analysis\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\api\\ecosystem\\clear-cache\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\api\\ecosystem\\simulate\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\api\\fetch-url\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\api\\generate-image\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\api\\generate-search-terms\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\api\\governance\\compass\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\api\\logs\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\api\\search-traces\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\api\\search\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\api\\sources\\[id]\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\api\\sources\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\api\\storage\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\comparison\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\cultural\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\data\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\data\\page_temp.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\demo\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\ecosystem\\page.tsx","messages":[],"suppressedMessages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'actors'. Either include it or remove the dependency array.","line":64,"column":8,"nodeType":"ArrayExpression","endLine":64,"endColumn":56,"suggestions":[{"desc":"Update the dependencies array to be: [actors, actors.length]","fix":{"range":[3169,3217],"text":"[actors, actors.length]"}}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a complex expression in the dependency array. Extract it to a separate variable so it can be statically checked.","line":64,"column":24,"nodeType":"CallExpression","endLine":64,"endColumn":55,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\empirical\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\glossary\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\governance\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\literature\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Quote' is defined but never used.","line":6,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ExternalLink' is defined but never used.","line":6,"column":17,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":29},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'BookMarked' is defined but never used.","line":6,"column":54,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":64},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Search' is defined but never used.","line":6,"column":66,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":72},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ScrollText' is defined but never used.","line":6,"column":74,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":84}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\r\nimport { Quote, ExternalLink, Scale, Network, Globe, BookMarked, Search, ScrollText, Users, Lightbulb, ShieldCheck } from \"lucide-react\";\r\n\r\nexport default function LiteraturePage() {\r\n    return (\r\n        <div className=\"space-y-8 max-w-7xl mx-auto\">\r\n            <div className=\"flex flex-col gap-2\">\r\n                <h1 className=\"text-3xl font-bold text-slate-900\">Theoretical Framework & Literature Review</h1>\r\n                <p className=\"text-slate-600 max-w-3xl\">\r\n                    This module maps the theoretical underpinnings of the &quot;Decolonial Situatedness in Global AI Governance&quot; project.\r\n                    It grounds the application&apos;s methodology in key scholarship across Decolonial Studies, STS, and Critical Legal Theory.\r\n                </p>\r\n            </div>\r\n\r\n            <Tabs defaultValue=\"assemblage\" className=\"w-full\">\r\n                <TabsList className=\"grid w-full grid-cols-6 bg-slate-100 p-1 rounded-lg\">\r\n                    <TabsTrigger value=\"assemblage\" className=\"data-[state=active]:bg-white data-[state=active]:shadow-sm\">\r\n                        <Network size={16} className=\"mr-2\" /> Assemblage Theory\r\n                    </TabsTrigger>\r\n                    <TabsTrigger value=\"decolonial\" className=\"data-[state=active]:bg-white data-[state=active]:shadow-sm\">\r\n                        <Globe size={16} className=\"mr-2\" /> Decoloniality\r\n                    </TabsTrigger>\r\n                    <TabsTrigger value=\"resistance\" className=\"data-[state=active]:bg-white data-[state=active]:shadow-sm\">\r\n                        <Users size={16} className=\"mr-2\" /> Resistance\r\n                    </TabsTrigger>\r\n                    <TabsTrigger value=\"legal\" className=\"data-[state=active]:bg-white data-[state=active]:shadow-sm\">\r\n                        <Scale size={16} className=\"mr-2\" /> Critical Legal\r\n                    </TabsTrigger>\r\n                    <TabsTrigger value=\"reflexivity\" className=\"data-[state=active]:bg-white data-[state=active]:shadow-sm\">\r\n                        <Lightbulb size={16} className=\"mr-2\" /> Reflexivity\r\n                    </TabsTrigger>\r\n                    <TabsTrigger value=\"legitimacy\" className=\"data-[state=active]:bg-white data-[state=active]:shadow-sm\">\r\n                        <ShieldCheck size={16} className=\"mr-2\" /> Legitimacy\r\n                    </TabsTrigger>\r\n                </TabsList>\r\n\r\n                <div className=\"mt-6 space-y-6\">\r\n                    {/* Assemblage Theory Content */}\r\n                    <TabsContent value=\"assemblage\" className=\"space-y-6\">\r\n                        <Card>\r\n                            <CardHeader>\r\n                                <CardTitle className=\"flex items-center gap-2\">\r\n                                    <Network className=\"text-blue-600\" />\r\n                                    Algorithmic Assemblages\r\n                                </CardTitle>\r\n                                <CardDescription>\r\n                                    Understanding AI governance not as static laws, but as dynamic, socio-technical flows.\r\n                                </CardDescription>\r\n                            </CardHeader>\r\n                            <CardContent className=\"space-y-4\">\r\n                                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                                    <div className=\"space-y-3\">\r\n                                        <h3 className=\"font-semibold text-slate-900\">Key Concepts</h3>\r\n                                        <ul className=\"list-disc list-inside text-sm text-slate-600 space-y-2\">\r\n                                            <li><strong>Assemblage (Agencement):</strong> A heterogeneous composition of human and non-human actors (Deleuze & Guattari).</li>\r\n                                            <li><strong>Translation:</strong> The process by which actors modify and displace goals (Latour/Callon).</li>\r\n                                            <li><strong>Performativity:</strong> How algorithms enact the realities they purport to describe (MacKenzie).</li>\r\n                                        </ul>\r\n                                    </div>\r\n                                    <div className=\"space-y-3\">\r\n                                        <h3 className=\"font-semibold text-slate-900\">Key Scholars</h3>\r\n                                        <div className=\"flex flex-wrap gap-2\">\r\n                                            <Badge variant=\"outline\">Deleuze & Guattari</Badge>\r\n                                            <Badge variant=\"outline\">Bruno Latour</Badge>\r\n                                            <Badge variant=\"outline\">Louise Amoore</Badge>\r\n                                            <Badge variant=\"outline\">N. Katherine Hayles</Badge>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"bg-slate-50 p-4 rounded-lg border border-slate-100 mt-4\">\r\n                                    <h4 className=\"text-sm font-semibold text-slate-800 mb-2\">Application in Project:</h4>\r\n                                    <p className=\"text-sm text-slate-600\">\r\n                                        Used in the <strong>Synthesis Module</strong> to map the flow from Actors &rarr; Mechanisms &rarr; Impacts, visualizing how the EU AI Act and PL 2338 function as &quot;assemblages&quot; of power rather than just text.\r\n                                    </p>\r\n                                </div>\r\n                            </CardContent>\r\n                        </Card>\r\n                    </TabsContent>\r\n\r\n                    {/* Decoloniality Content */}\r\n                    <TabsContent value=\"decolonial\" className=\"space-y-6\">\r\n                        <Card>\r\n                            <CardHeader>\r\n                                <CardTitle className=\"flex items-center gap-2\">\r\n                                    <Globe className=\"text-emerald-600\" />\r\n                                    Decolonial Situatedness\r\n                                </CardTitle>\r\n                                <CardDescription>\r\n                                    Analyzing how &quot;universal&quot; AI governance reinforces Global North epistemologies.\r\n                                </CardDescription>\r\n                            </CardHeader>\r\n                            <CardContent className=\"space-y-4\">\r\n                                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                                    <div className=\"space-y-3\">\r\n                                        <h3 className=\"font-semibold text-slate-900\">Key Concepts</h3>\r\n                                        <ul className=\"list-disc list-inside text-sm text-slate-600 space-y-2\">\r\n                                            <li><strong>Coloniality of Power:</strong> The continuity of colonial forms of domination after the end of colonial administrations (Quijano).</li>\r\n                                            <li><strong>Border Thinking:</strong> Thinking from the exteriority of the modern/colonial world system (Mignolo).</li>\r\n                                            <li><strong>Data Colonialism:</strong> The extraction of data from the Global South for value capture in the North (Couldry & Mejias).</li>\r\n                                        </ul>\r\n                                    </div>\r\n                                    <div className=\"space-y-3\">\r\n                                        <h3 className=\"font-semibold text-slate-900\">Key Scholars</h3>\r\n                                        <div className=\"flex flex-wrap gap-2\">\r\n                                            <Badge variant=\"outline\">Aníbal Quijano</Badge>\r\n                                            <Badge variant=\"outline\">Walter Mignolo</Badge>\r\n                                            <Badge variant=\"outline\">Sylvia Wynter</Badge>\r\n                                            <Badge variant=\"outline\">Paola Ricaurte</Badge>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"bg-emerald-50 p-4 rounded-lg border border-emerald-100 mt-4\">\r\n                                    <h4 className=\"text-sm font-semibold text-emerald-900 mb-2\">Application in Project:</h4>\r\n                                    <p className=\"text-sm text-emerald-800\">\r\n                                        Informs the <strong>Ontology Module</strong> and <strong>Cultural Analysis</strong>, questioning the &quot;universal&quot; applicability of the EU&apos;s &quot;Risk-Based Approach&quot; when transplanted to the Brazilian context.\r\n                                    </p>\r\n                                </div>\r\n                            </CardContent>\r\n                        </Card>\r\n                    </TabsContent>\r\n\r\n                    {/* Resistance Content */}\r\n                    <TabsContent value=\"resistance\" className=\"space-y-6\">\r\n                        <Card>\r\n                            <CardHeader>\r\n                                <CardTitle className=\"flex items-center gap-2\">\r\n                                    <Users className=\"text-amber-600\" />\r\n                                    Micro-Resistance & Friction\r\n                                </CardTitle>\r\n                                <CardDescription>\r\n                                    Identifying how local actors adapt, resist, or subvert algorithmic governance.\r\n                                </CardDescription>\r\n                            </CardHeader>\r\n                            <CardContent className=\"space-y-4\">\r\n                                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                                    <div className=\"space-y-3\">\r\n                                        <h3 className=\"font-semibold text-slate-900\">Key Concepts</h3>\r\n                                        <ul className=\"list-disc list-inside text-sm text-slate-600 space-y-2\">\r\n                                            <li><strong>Weapons of the Weak:</strong> Everyday forms of peasant resistance (Scott).</li>\r\n                                            <li><strong>Friction:</strong> The awkward, unequal, unstable, and creative qualities of interconnection (Tsing).</li>\r\n                                            <li><strong>Glitch Feminism:</strong> Using the error/glitch as a site of resistance (Russell).</li>\r\n                                        </ul>\r\n                                    </div>\r\n                                    <div className=\"space-y-3\">\r\n                                        <h3 className=\"font-semibold text-slate-900\">Key Scholars</h3>\r\n                                        <div className=\"flex flex-wrap gap-2\">\r\n                                            <Badge variant=\"outline\">James C. Scott</Badge>\r\n                                            <Badge variant=\"outline\">Anna Lowenhaupt Tsing</Badge>\r\n                                            <Badge variant=\"outline\">Legacy Russell</Badge>\r\n                                            <Badge variant=\"outline\">Saidiya Hartman</Badge>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"bg-amber-50 p-4 rounded-lg border border-amber-100 mt-4\">\r\n                                    <h4 className=\"text-sm font-semibold text-amber-900 mb-2\">Application in Project:</h4>\r\n                                    <p className=\"text-sm text-amber-800\">\r\n                                        Central to the <strong>Resistance Module</strong>, where we map &quot;Friction Points&quot; and &quot;Subversion Strategies&quot; in the implementation of AI laws.\r\n                                    </p>\r\n                                </div>\r\n                            </CardContent>\r\n                        </Card>\r\n                    </TabsContent>\r\n\r\n                    {/* Critical Legal Content */}\r\n                    <TabsContent value=\"legal\" className=\"space-y-6\">\r\n                        <Card>\r\n                            <CardHeader>\r\n                                <CardTitle className=\"flex items-center gap-2\">\r\n                                    <Scale className=\"text-indigo-600\" />\r\n                                    Critical Legal Theory & TWAIL\r\n                                </CardTitle>\r\n                                <CardDescription>\r\n                                    Examining international law as a site of struggle and hierarchy.\r\n                                </CardDescription>\r\n                            </CardHeader>\r\n                            <CardContent className=\"space-y-4\">\r\n                                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                                    <div className=\"space-y-3\">\r\n                                        <h3 className=\"font-semibold text-slate-900\">Key Concepts</h3>\r\n                                        <ul className=\"list-disc list-inside text-sm text-slate-600 space-y-2\">\r\n                                            <li><strong>Legal Transplants:</strong> The movement of laws across borders and their mutation (Watson/Frankenberg).</li>\r\n                                            <li><strong>TWAIL:</strong> Third World Approaches to International Law, critiquing the colonial origins of international norms.</li>\r\n                                            <li><strong>Brussels Effect:</strong> The EU&apos;s unilateral power to regulate global markets (Bradford) - <em>critiqued here</em>.</li>\r\n                                        </ul>\r\n                                    </div>\r\n                                    <div className=\"space-y-3\">\r\n                                        <h3 className=\"font-semibold text-slate-900\">Key Scholars</h3>\r\n                                        <div className=\"flex flex-wrap gap-2\">\r\n                                            <Badge variant=\"outline\">Antony Anghie</Badge>\r\n                                            <Badge variant=\"outline\">B.S. Chimni</Badge>\r\n                                            <Badge variant=\"outline\">Anu Bradford</Badge>\r\n                                            <Badge variant=\"outline\">Günter Frankenberg</Badge>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"bg-indigo-50 p-4 rounded-lg border border-indigo-100 mt-4\">\r\n                                    <h4 className=\"text-sm font-semibold text-indigo-900 mb-2\">Application in Project:</h4>\r\n                                    <p className=\"text-sm text-indigo-800\">\r\n                                        Used in the <strong>Data Module</strong> and <strong>Comparison</strong> to analyze the &quot;Brussels Effect&quot; not as a neutral diffusion of standards, but as a form of &quot;Legal Imperialism.&quot;\r\n                                    </p>\r\n                                </div>\r\n                            </CardContent>\r\n                        </Card>\r\n                    </TabsContent>\r\n\r\n                    {/* Reflexivity Content */}\r\n                    <TabsContent value=\"reflexivity\" className=\"space-y-6\">\r\n                        <Card>\r\n                            <CardHeader>\r\n                                <CardTitle className=\"flex items-center gap-2\">\r\n                                    <Lightbulb className=\"text-purple-600\" />\r\n                                    Feminist Standpoint & Reflexivity\r\n                                </CardTitle>\r\n                                <CardDescription>\r\n                                    Acknowledging the researcher&apos;s position within the assemblage.\r\n                                </CardDescription>\r\n                            </CardHeader>\r\n                            <CardContent className=\"space-y-4\">\r\n                                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                                    <div className=\"space-y-3\">\r\n                                        <h3 className=\"font-semibold text-slate-900\">Key Concepts</h3>\r\n                                        <ul className=\"list-disc list-inside text-sm text-slate-600 space-y-2\">\r\n                                            <li><strong>Situated Knowledges:</strong> The view from a body, always complex, contradictory, structuring, and structured (Haraway).</li>\r\n                                            <li><strong>Strong Objectivity:</strong> Starting research from the lives of marginalized groups to produce less partial accounts (Harding).</li>\r\n                                        </ul>\r\n                                    </div>\r\n                                    <div className=\"space-y-3\">\r\n                                        <h3 className=\"font-semibold text-slate-900\">Key Scholars</h3>\r\n                                        <div className=\"flex flex-wrap gap-2\">\r\n                                            <Badge variant=\"outline\">Donna Haraway</Badge>\r\n                                            <Badge variant=\"outline\">Sandra Harding</Badge>\r\n                                            <Badge variant=\"outline\">Patricia Hill Collins</Badge>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"bg-purple-50 p-4 rounded-lg border border-purple-100 mt-4\">\r\n                                    <h4 className=\"text-sm font-semibold text-purple-900 mb-2\">Application in Project:</h4>\r\n                                    <p className=\"text-sm text-purple-800\">\r\n                                        Operationalized in the <strong>Reflexivity Module</strong> via the &quot;Methodological Log&quot; and &quot;Positionality Statement,&quot; ensuring the researcher does not claim a &quot;God Trick&quot; view from nowhere.\r\n                                    </p>\r\n                                </div>\r\n                            </CardContent>\r\n                        </Card>\r\n                    </TabsContent>\r\n\r\n                    {/* Legitimacy Content */}\r\n                    <TabsContent value=\"legitimacy\" className=\"space-y-6\">\r\n                        <Card>\r\n                            <CardHeader>\r\n                                <CardTitle className=\"flex items-center gap-2\">\r\n                                    <ShieldCheck className=\"text-rose-600\" />\r\n                                    Sociology of Critique & Orders of Worth\r\n                                </CardTitle>\r\n                                <CardDescription>\r\n                                    Analyzing how actors justify their actions and claims to legitimacy.\r\n                                </CardDescription>\r\n                            </CardHeader>\r\n                            <CardContent className=\"space-y-4\">\r\n                                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                                    <div className=\"space-y-3\">\r\n                                        <h3 className=\"font-semibold text-slate-900\">Key Concepts</h3>\r\n                                        <ul className=\"list-disc list-inside text-sm text-slate-600 space-y-2\">\r\n                                            <li><strong>Orders of Worth (Cités):</strong> Distinct worlds of justification (Market, Industrial, Civic, Domestic, Inspired, Fame).</li>\r\n                                            <li><strong>Tests of Worth:</strong> Moments where legitimacy is challenged and must be proven through evidence.</li>\r\n                                            <li><strong>Compromise:</strong> Fragile agreements formed between conflicting orders of worth.</li>\r\n                                        </ul>\r\n                                    </div>\r\n                                    <div className=\"space-y-3\">\r\n                                        <h3 className=\"font-semibold text-slate-900\">Key Scholars</h3>\r\n                                        <div className=\"flex flex-wrap gap-2\">\r\n                                            <Badge variant=\"outline\">Luc Boltanski</Badge>\r\n                                            <Badge variant=\"outline\">Laurent Thévenot</Badge>\r\n                                            <Badge variant=\"outline\">Eve Chiapello</Badge>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"bg-rose-50 p-4 rounded-lg border border-rose-100 mt-4\">\r\n                                    <h4 className=\"text-sm font-semibold text-rose-900 mb-2\">Application in Project:</h4>\r\n                                    <p className=\"text-sm text-rose-800\">\r\n                                        Used in the <strong>Legitimacy Module</strong> to analyze the &quot;moral vocabulary&quot; of AI policy documents, identifying which &quot;Orders of Worth&quot; (e.g., Industrial efficiency vs. Civic solidarity) are dominant.\r\n                                    </p>\r\n                                </div>\r\n                            </CardContent>\r\n                        </Card>\r\n                    </TabsContent>\r\n                </div>\r\n            </Tabs>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\login\\[[...login]]\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\ontology\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Globe' is defined but never used.","line":22,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":22,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Brain' is defined but never used.","line":22,"column":17,"nodeType":null,"messageId":"unusedVar","endLine":22,"endColumn":22},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Share2' is defined but never used.","line":22,"column":24,"nodeType":null,"messageId":"unusedVar","endLine":22,"endColumn":30},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Database' is defined but never used.","line":22,"column":32,"nodeType":null,"messageId":"unusedVar","endLine":22,"endColumn":40},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Scale' is defined but never used.","line":22,"column":42,"nodeType":null,"messageId":"unusedVar","endLine":22,"endColumn":47}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState } from \"react\";\r\nimport { useServerStorage } from \"@/hooks/useServerStorage\";\r\nimport { useSources } from \"@/hooks/useSources\";\r\nimport { Card, CardContent } from \"@/components/ui/card\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Network, ArrowRightLeft, Sparkles, Loader2 } from \"lucide-react\";\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\r\nimport { OntologyData, OntologyNode, ComparisonResult } from \"@/types/ontology\";\r\nimport { getColorForCategory } from \"@/lib/ontology-utils\";\r\n\r\n// Components\r\nimport { OntologyMap } from \"@/components/ontology/OntologyMap\";\r\nimport { ConceptList } from \"@/components/ontology/ConceptList\";\r\nimport { MapGallery } from \"@/components/ontology/MapGallery\";\r\nimport { ConceptDetailsModal } from \"@/components/ontology/ConceptDetailsModal\";\r\nimport { ComparisonView } from \"@/components/ontology/ComparisonView\";\r\n\r\n// Static Data (Fallback) - Kept for initial state visualization\r\nimport { Globe, Brain, Share2, Database, Scale } from \"lucide-react\";\r\n\r\nconst STATIC_CONCEPTS = [\r\n    {\r\n        id: \"0\",\r\n        label: \"Coloniality of Power\",\r\n        description: \"The living legacy of colonialism in contemporary power structures, defining who has the authority to classify and organize the world.\",\r\n        quote: \"The coloniality of power is not just a historical event, but a continuous process of ordering the world.\",\r\n        category: \"Core\",\r\n        color: \"#fca5a5\",\r\n        x: 250, y: 50\r\n    },\r\n    {\r\n        id: \"1\",\r\n        label: \"Algorithmic Rationality\",\r\n        description: \"The logic by which algorithms order, sort, and prioritize information, often embedding specific cultural and epistemological values.\",\r\n        quote: \"Algorithms are not neutral tools; they are crystallized forms of rationality.\",\r\n        category: \"Mechanism\",\r\n        color: \"#d8b4fe\",\r\n        x: 450, y: 150\r\n    },\r\n    {\r\n        id: \"2\",\r\n        label: \"Global South State\",\r\n        description: \"The political entity situated in the periphery of the world-system, navigating the imposition of external AI norms while asserting sovereignty.\",\r\n        quote: \"The state in the Global South is not merely a regulator but a site of contestation.\",\r\n        category: \"Actor\",\r\n        color: \"#93c5fd\",\r\n        x: 50, y: 150\r\n    },\r\n    {\r\n        id: \"3\",\r\n        label: \"Data Extractivism\",\r\n        description: \"The process of extracting data from human life and turning it into a resource for capital accumulation.\",\r\n        quote: \"Data is the new oil, but the extraction process leaves behind social pollution.\",\r\n        category: \"Mechanism\",\r\n        color: \"#d8b4fe\",\r\n        x: 400, y: 300\r\n    },\r\n    {\r\n        id: \"4\",\r\n        label: \"Fundamental Rights\",\r\n        description: \"The set of ethical and legal principles protected by frameworks like the EU AI Act, often framed as universal but historically situated.\",\r\n        quote: \"Rights are the language through which power is negotiated and contested.\",\r\n        category: \"Value\",\r\n        color: \"#86efac\",\r\n        x: 100, y: 300\r\n    },\r\n    {\r\n        id: \"5\",\r\n        label: \"Sociotechnical Assemblage\",\r\n        description: \"Complex arrangements of humans, machines, norms, and resources that constitute AI systems as loosely coupled, emergently structured entities.\",\r\n        quote: \"AI is not a thing, but an assemblage of social and technical relations that orchestrate value.\",\r\n        category: \"Core\",\r\n        color: \"#fca5a5\",\r\n        x: 250, y: 200\r\n    },\r\n] as OntologyNode[];\r\n\r\nconst STATIC_NETWORK_LINKS = [\r\n    { source: \"0\", target: \"1\", relation: \"informs\" },\r\n    { source: \"0\", target: \"2\", relation: \"constrains\" },\r\n    { source: \"0\", target: \"5\", relation: \"shapes\" },\r\n    { source: \"1\", target: \"3\", relation: \"enables\" },\r\n    { source: \"1\", target: \"5\", relation: \"structures\" },\r\n    { source: \"2\", target: \"4\", relation: \"protects\" },\r\n    { source: \"2\", target: \"5\", relation: \"regulates\" },\r\n    { source: \"3\", target: \"5\", relation: \"feeds\" },\r\n    { source: \"4\", target: \"5\", relation: \"embedded in\" },\r\n];\r\n\r\nexport default function OntologyPage() {\r\n    const { sources } = useSources();\r\n    const [selectedSourceId, setSelectedSourceId] = useServerStorage<string>(\"ontology_selected_source_id\", \"\");\r\n    const [isAnalyzing, setIsAnalyzing] = useState(false);\r\n    const [ontologyMaps, setOntologyMaps] = useServerStorage<Record<string, OntologyData>>(\"ontology_maps\", {});\r\n\r\n    // Comparison State\r\n    const [isComparing, setIsComparing] = useState(false);\r\n    const [selectedForComparison, setSelectedForComparison] = useState<string[]>([]);\r\n    const [comparisonResult, setComparisonResult] = useState<ComparisonResult | null>(null);\r\n    const [isComparingLoading, setIsComparingLoading] = useState(false);\r\n\r\n    // Interactivity State\r\n    const [selectedNodeId, setSelectedNodeId] = useServerStorage<string | null>(\"ontology_selected_node_id\", null);\r\n    const [selectedCategory, setSelectedCategory] = useState<string | null>(null);\r\n\r\n    // Filter sources that have text available for analysis\r\n    const analyzedSources = sources.filter(s => s.extractedText);\r\n\r\n    // Get the currently active map based on selectedSourceId\r\n    const currentOntologyData = (selectedSourceId && ontologyMaps && ontologyMaps[selectedSourceId])\r\n        ? ontologyMaps[selectedSourceId]\r\n        : null;\r\n\r\n    const handleGenerateOntology = async () => {\r\n        const source = analyzedSources.find(s => s.id === selectedSourceId);\r\n        if (!source || !source.extractedText) return;\r\n\r\n        setIsAnalyzing(true);\r\n        try {\r\n            const headers: HeadersInit = { 'Content-Type': 'application/json' };\r\n            if (process.env.NEXT_PUBLIC_ENABLE_DEMO_MODE === 'true' && process.env.NEXT_PUBLIC_DEMO_USER_ID) {\r\n                headers['x-demo-user-id'] = process.env.NEXT_PUBLIC_DEMO_USER_ID;\r\n            }\r\n\r\n            const response = await fetch('/api/analyze', {\r\n                method: 'POST',\r\n                headers: headers,\r\n                body: JSON.stringify({\r\n                    text: source.extractedText.substring(0, 3000), // Limit text length\r\n                    analysisMode: 'ontology',\r\n                    force: true // Force refresh to bypass cache\r\n                })\r\n            });\r\n\r\n            const data = await response.json();\r\n            if (data.success && data.analysis) {\r\n                // Process nodes to add coordinates and colors\r\n                const processedNodes = data.analysis.nodes.map((node: OntologyNode, index: number) => ({\r\n                    ...node,\r\n                    x: 300 + 200 * Math.cos(2 * Math.PI * index / data.analysis.nodes.length),\r\n                    y: 200 + 150 * Math.sin(2 * Math.PI * index / data.analysis.nodes.length),\r\n                    color: getColorForCategory(node.category)\r\n                }));\r\n\r\n                const newMap: OntologyData = {\r\n                    summary: data.analysis.summary,\r\n                    nodes: processedNodes,\r\n                    links: data.analysis.links\r\n                };\r\n\r\n                // Update the maps record\r\n                setOntologyMaps({\r\n                    ...ontologyMaps,\r\n                    [selectedSourceId]: newMap\r\n                });\r\n            } else {\r\n                alert(\"Analysis failed: \" + (data.error || \"Unknown error\"));\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Ontology generation error:\", error);\r\n            alert(\"Failed to generate ontology.\");\r\n        } finally {\r\n            setIsAnalyzing(false);\r\n        }\r\n    };\r\n\r\n    const handleCompareOntologies = async () => {\r\n        if (selectedForComparison.length !== 2) return;\r\n\r\n        const sourceAId = selectedForComparison[0];\r\n        const sourceBId = selectedForComparison[1];\r\n        const sourceA = sources.find(s => s.id === sourceAId);\r\n        const sourceB = sources.find(s => s.id === sourceBId);\r\n        const mapA = ontologyMaps?.[sourceAId];\r\n        const mapB = ontologyMaps?.[sourceBId];\r\n\r\n        if (!sourceA || !sourceB || !mapA || !mapB) return;\r\n\r\n        setIsComparingLoading(true);\r\n        setComparisonResult(null);\r\n\r\n        try {\r\n            const headers: HeadersInit = { 'Content-Type': 'application/json' };\r\n            if (process.env.NEXT_PUBLIC_ENABLE_DEMO_MODE === 'true' && process.env.NEXT_PUBLIC_DEMO_USER_ID) {\r\n                headers['x-demo-user-id'] = process.env.NEXT_PUBLIC_DEMO_USER_ID;\r\n            }\r\n\r\n            const response = await fetch('/api/analyze', {\r\n                method: 'POST',\r\n                headers: headers,\r\n                body: JSON.stringify({\r\n                    analysisMode: 'ontology_comparison',\r\n                    sourceA: { title: sourceA.title, data: mapA },\r\n                    sourceB: { title: sourceB.title, data: mapB },\r\n                    force: true\r\n                })\r\n            });\r\n\r\n            const data = await response.json();\r\n            if (data.success && data.analysis) {\r\n                setComparisonResult(data.analysis);\r\n            } else {\r\n                alert(\"Comparison failed: \" + (data.error || \"Unknown error\"));\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Comparison error:\", error);\r\n            alert(\"Failed to compare ontologies.\");\r\n        } finally {\r\n            setIsComparingLoading(false);\r\n        }\r\n    };\r\n\r\n    const toggleComparisonSelection = (sourceId: string) => {\r\n        if (selectedForComparison.includes(sourceId)) {\r\n            setSelectedForComparison(prev => prev.filter(id => id !== sourceId));\r\n        } else {\r\n            if (selectedForComparison.length < 2) {\r\n                setSelectedForComparison(prev => [...prev, sourceId]);\r\n            }\r\n        }\r\n    };\r\n\r\n    const handleNodeDrag = (nodeId: string, x: number, y: number) => {\r\n        if (selectedSourceId && currentOntologyData) {\r\n            const updatedNodes = currentOntologyData.nodes.map(node =>\r\n                node.id === nodeId ? { ...node, x, y } : node\r\n            );\r\n\r\n            setOntologyMaps({\r\n                ...ontologyMaps,\r\n                [selectedSourceId]: {\r\n                    ...currentOntologyData,\r\n                    nodes: updatedNodes\r\n                }\r\n            });\r\n        }\r\n    };\r\n\r\n    // Filtering Logic\r\n    const displayNodes = currentOntologyData\r\n        ? currentOntologyData.nodes.filter(n => !selectedCategory || n.category === selectedCategory)\r\n        : STATIC_CONCEPTS;\r\n\r\n    const displayLinks = currentOntologyData\r\n        ? currentOntologyData.links.filter(l => {\r\n            const sourceNode = currentOntologyData.nodes.find(n => n.id === l.source);\r\n            const targetNode = currentOntologyData.nodes.find(n => n.id === l.target);\r\n            if (selectedCategory) {\r\n                return sourceNode?.category === selectedCategory && targetNode?.category === selectedCategory;\r\n            }\r\n            return true;\r\n        })\r\n        : STATIC_NETWORK_LINKS;\r\n\r\n    const selectedNode = currentOntologyData\r\n        ? currentOntologyData.nodes.find(n => n.id === selectedNodeId)\r\n        : STATIC_CONCEPTS.find(n => n.id === selectedNodeId);\r\n\r\n    return (\r\n        <div className=\"space-y-8\">\r\n            <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-4\">\r\n                <div>\r\n                    <h2 className=\"text-3xl font-bold text-slate-900 flex items-center gap-2\">\r\n                        <Network className=\"h-8 w-8 text-indigo-600\" />\r\n                        Concept Network\r\n                    </h2>\r\n                    <div className=\"text-slate-500 mt-2 flex flex-wrap items-center gap-2 text-sm\">\r\n                        Visualizing the assemblage:\r\n                        <Badge variant=\"secondary\" className=\"bg-red-100 text-red-700 hover:bg-red-200 border-red-200 cursor-default\">Core</Badge>\r\n                        <Badge variant=\"secondary\" className=\"bg-purple-100 text-purple-700 hover:bg-purple-200 border-purple-200 cursor-default\">Mechanism</Badge>\r\n                        <Badge variant=\"secondary\" className=\"bg-blue-100 text-blue-700 hover:bg-blue-200 border-blue-200 cursor-default\">Actor</Badge>\r\n                        <Badge variant=\"secondary\" className=\"bg-green-100 text-green-700 hover:bg-green-200 border-green-200 cursor-default\">Value</Badge>\r\n                    </div>\r\n                </div>\r\n                <div className=\"flex items-center gap-3\">\r\n                    <Button\r\n                        variant={isComparing ? \"secondary\" : \"outline\"}\r\n                        onClick={() => {\r\n                            setIsComparing(!isComparing);\r\n                            setComparisonResult(null);\r\n                            setSelectedForComparison([]);\r\n                        }}\r\n                        className=\"gap-2\"\r\n                    >\r\n                        <ArrowRightLeft className=\"h-4 w-4\" />\r\n                        {isComparing ? \"Exit Comparison\" : \"Compare Maps\"}\r\n                    </Button>\r\n\r\n                    {!isComparing && (\r\n                        <>\r\n                            <Select value={selectedSourceId} onValueChange={setSelectedSourceId}>\r\n                                <SelectTrigger className=\"w-[280px]\">\r\n                                    <SelectValue placeholder=\"Select a source to analyze\" />\r\n                                </SelectTrigger>\r\n                                <SelectContent>\r\n                                    {analyzedSources.map((source) => (\r\n                                        <SelectItem key={source.id} value={source.id}>\r\n                                            {source.title}\r\n                                        </SelectItem>\r\n                                    ))}\r\n                                </SelectContent>\r\n                            </Select>\r\n                            <Button\r\n                                onClick={handleGenerateOntology}\r\n                                disabled={!selectedSourceId || isAnalyzing}\r\n                                className=\"bg-indigo-600 hover:bg-indigo-700 text-white\"\r\n                            >\r\n                                {isAnalyzing ? (\r\n                                    <>\r\n                                        <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\r\n                                        Analyzing...\r\n                                    </>\r\n                                ) : (\r\n                                    <>\r\n                                        <Sparkles className=\"mr-2 h-4 w-4\" />\r\n                                        Generate Map\r\n                                    </>\r\n                                )}\r\n                            </Button>\r\n                        </>\r\n                    )}\r\n                </div>\r\n            </div>\r\n\r\n            {/* Comparison Result View */}\r\n            {isComparing && comparisonResult && (\r\n                <ComparisonView result={comparisonResult} />\r\n            )}\r\n\r\n            {/* Main Visualization */}\r\n            {!isComparing && (\r\n                <>\r\n                    {currentOntologyData?.summary && (\r\n                        <Card className=\"bg-slate-50 border-indigo-100\">\r\n                            <CardContent className=\"pt-6\">\r\n                                <p className=\"text-slate-700 leading-relaxed\">\r\n                                    <span className=\"font-semibold text-indigo-700\">Analysis Summary: </span>\r\n                                    {currentOntologyData.summary}\r\n                                </p>\r\n                            </CardContent>\r\n                        </Card>\r\n                    )}\r\n\r\n                    <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\r\n                        <div className=\"lg:col-span-2 space-y-4\">\r\n                            <OntologyMap\r\n                                nodes={displayNodes}\r\n                                links={displayLinks}\r\n                                selectedCategory={selectedCategory}\r\n                                onSelectCategory={setSelectedCategory}\r\n                                selectedNodeId={selectedNodeId}\r\n                                onSelectNode={setSelectedNodeId}\r\n                                onNodeDrag={handleNodeDrag}\r\n                            />\r\n                        </div>\r\n\r\n                        <ConceptList\r\n                            nodes={displayNodes}\r\n                            selectedNodeId={selectedNodeId}\r\n                            onSelectNode={setSelectedNodeId}\r\n                        />\r\n                    </div>\r\n                </>\r\n            )}\r\n\r\n            <MapGallery\r\n                ontologyMaps={ontologyMaps}\r\n                sources={sources}\r\n                selectedSourceId={selectedSourceId}\r\n                onSelectSource={setSelectedSourceId}\r\n                isComparing={isComparing}\r\n                selectedForComparison={selectedForComparison}\r\n                onToggleComparisonSelection={toggleComparisonSelection}\r\n                onCompare={handleCompareOntologies}\r\n                isComparingLoading={isComparingLoading}\r\n            />\r\n\r\n            <ConceptDetailsModal\r\n                selectedNode={selectedNode || null}\r\n                isOpen={!!selectedNodeId}\r\n                onClose={() => setSelectedNodeId(null)}\r\n                isStatic={!currentOntologyData}\r\n            />\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Layers' is defined but never used.","line":23,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":23,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Library' is defined but never used.","line":31,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":31,"endColumn":10},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":468,"column":15,"nodeType":"JSXOpeningElement","endLine":472,"endColumn":17}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport Link from \"next/link\";\nimport { useUser } from \"@clerk/nextjs\";\nimport { Source } from \"@/types\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { useSources } from \"@/hooks/useSources\";\nimport {\n  Database,\n  BookOpen,\n  Scale,\n  Users,\n  Scan,\n  Network,\n  Lightbulb,\n  ArrowRight,\n  FileText,\n  Search,\n  Zap,\n  Activity,\n  Upload,\n  Layers,\n  Cpu,\n  GitGraph,\n  Shield,\n  Lock,\n  GraduationCap,\n  Building,\n  Play,\n  Library\n} from \"lucide-react\";\n\n// --- DASHBOARD DATA ---\nconst features = [\n  // Data Collection\n  {\n    name: \"Documents\",\n    href: \"/data\",\n    icon: Database,\n    description: \"Archive of primary policy texts (PDFs) and source materials\",\n    color: \"bg-blue-50 text-blue-700 border-blue-200\",\n    iconColor: \"text-blue-600\",\n  },\n  {\n    name: \"Empirical Data\",\n    href: \"/empirical\",\n    icon: Users,\n    description: \"Collect and organize empirical traces from web sources\",\n    color: \"bg-indigo-50 text-indigo-700 border-indigo-200\",\n    iconColor: \"text-indigo-600\",\n  },\n  // Micro Analysis\n  {\n    name: \"Resistance\",\n    href: \"/resistance\",\n    icon: Users,\n    description: \"Analyze micro-resistance strategies and counter-conduct\",\n    color: \"bg-red-50 text-red-700 border-red-200\",\n    iconColor: \"text-red-600\",\n  },\n  {\n    name: \"Critical Reflection\",\n    href: \"/reflexivity\",\n    icon: Scan,\n    description: \"Examine how your own perspective and context shape the analysis\",\n    color: \"bg-orange-50 text-orange-700 border-orange-200\",\n    iconColor: \"text-orange-600\",\n  },\n  // Meso Analysis\n  {\n    name: \"Ecosystem Analysis\",\n    href: \"/ecosystem\",\n    icon: Users,\n    description: \"Map actors, detect cultural holes, and visualize social networks\",\n    color: \"bg-emerald-50 text-emerald-700 border-emerald-200\",\n    iconColor: \"text-emerald-600\",\n  },\n  {\n    name: \"Cross-Case Analysis\",\n    href: \"/synthesis\",\n    icon: Network,\n    description: \"Cross-case analysis and AI-powered framework comparison\",\n    color: \"bg-teal-50 text-teal-700 border-teal-200\",\n    iconColor: \"text-teal-600\",\n  },\n  // Macro Analysis\n  {\n    name: \"Comparison\",\n    href: \"/comparison\",\n    icon: Scale,\n    description: \"Side-by-side comparison of governance frameworks\",\n    color: \"bg-cyan-50 text-cyan-700 border-cyan-200\",\n    iconColor: \"text-cyan-600\",\n  },\n  {\n    name: \"Governance\",\n    href: \"/governance\",\n    icon: Scale,\n    description: \"Analyze resource orchestration and institutional logics\",\n    color: \"bg-green-50 text-green-700 border-green-200\",\n    iconColor: \"text-green-600\",\n  },\n  {\n    name: \"Cultural Framing\",\n    href: \"/cultural\",\n    icon: Lightbulb,\n    description: \"Examine cultural framing and epistemic authority\",\n    color: \"bg-amber-50 text-amber-700 border-amber-200\",\n    iconColor: \"text-amber-600\",\n  },\n  {\n    name: \"Concept Network\",\n    href: \"/ontology\",\n    icon: BookOpen,\n    description: \"Visual map of key concepts and their relationships\",\n    color: \"bg-purple-50 text-purple-700 border-purple-200\",\n    iconColor: \"text-purple-600\",\n  },\n  {\n    name: \"Temporal Dynamics\",\n    href: \"/timeline\",\n    icon: Activity,\n    description: \"Track the evolution of governance concepts over time\",\n    color: \"bg-pink-50 text-pink-700 border-pink-200\",\n    iconColor: \"text-pink-600\",\n  },\n];\n\n// --- COMPONENTS ---\n\nfunction LandingPage() {\n  return (\n    <div className=\"flex flex-col min-h-screen bg-white\">\n      {/* Hero Section */}\n      <div className=\"relative isolate px-6 pt-14 lg:px-8 bg-slate-900 text-white overflow-hidden\">\n        {/* Background Image */}\n        <div\n          className=\"absolute inset-0 -z-20\"\n          style={{\n            backgroundImage: \"url('/landing-bg.png')\",\n            backgroundSize: \"cover\",\n            backgroundPosition: \"center\",\n            opacity: 0.4\n          }}\n        />\n        {/* Gradient Overlay */}\n        <div className=\"absolute inset-0 -z-10 bg-gradient-to-b from-slate-900/90 via-slate-900/80 to-slate-900 lg:from-slate-900/80 lg:via-slate-900/50\" />\n\n        <div className=\"absolute inset-x-0 -top-40 -z-10 transform-gpu overflow-hidden blur-3xl sm:-top-80\" aria-hidden=\"true\">\n          <div className=\"relative left-[calc(50%-11rem)] aspect-[1155/678] w-[36.125rem] -translate-x-1/2 rotate-[30deg] bg-gradient-to-tr from-[#ff80b5] to-[#9089fc] opacity-20 sm:left-[calc(50%-30rem)] sm:w-[72.1875rem]\" style={{ clipPath: 'polygon(74.1% 44.1%, 100% 61.6%, 97.5% 26.9%, 85.5% 0.1%, 80.7% 2%, 72.5% 32.5%, 60.2% 62.4%, 52.4% 68.1%, 47.5% 58.3%, 45.2% 34.5%, 27.5% 76.7%, 0.1% 64.9%, 17.9% 100%, 27.6% 76.8%, 76.1% 97.7%, 74.1% 44.1%)' }} />\n        </div>\n\n        {/* Abstract Data Grid Background */}\n        <div className=\"absolute inset-0 -z-10 bg-[linear-gradient(to_right,#80808012_1px,transparent_1px),linear-gradient(to_bottom,#80808012_1px,transparent_1px)] bg-[size:24px_24px]\"></div>\n\n        <div className=\"mx-auto max-w-2xl py-32 sm:py-48 lg:py-56 text-center\">\n          <div className=\"hidden sm:mb-8 sm:flex sm:justify-center\">\n            <div className=\"relative rounded-full px-3 py-1 text-sm leading-6 text-slate-300 ring-1 ring-white/10 hover:ring-white/20\">\n              Advanced Research Tool for Complex Systems\n            </div>\n          </div>\n          <h1 className=\"text-4xl font-bold tracking-tight text-white sm:text-6xl\">\n            Assemblage AI\n          </h1>\n          <p className=\"mt-6 text-lg leading-8 text-slate-200\">\n            <Link href=\"/glossary\" className=\"inline-flex items-center gap-2 px-4 py-1.5 rounded-full bg-white/5 border border-white/10 hover:bg-white/10 hover:border-blue-500/50 hover:scale-105 transition-all duration-300 group\">\n              <span className=\"text-slate-300 group-hover:text-white transition-colors\">What is</span>\n              <span className=\"text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-emerald-400 font-bold\">Assemblage AI</span>\n              <span className=\"text-slate-400 group-hover:text-blue-400 transition-colors\">?</span>\n            </Link>\n          </p>\n          <p className=\"mt-4 text-sm text-slate-300 max-w-2xl mx-auto leading-relaxed text-left\">\n            Assemblage-AI is a platform dedicated to analyzing and managing AI governance, policy frameworks, and structural dynamics. It offers tools for data collection, ecosystem mapping, and critical reflection to explore the complexities of AI systems. Key insights include the challenges of centralized governance, limited inclusivity, and the tension between civic values and market-driven innovation. With resources like critical glossaries and literature reviews, Assemblage-AI aims to foster responsible and equitable AI practices while addressing global regulatory and ethical challenges.\n          </p>\n          <div className=\"mt-10 flex items-center justify-center gap-x-6\">\n            <Link href=\"/demo\">\n              <Button size=\"lg\" className=\"bg-emerald-600 hover:bg-emerald-500 text-white border border-emerald-400/30 px-8 transition-all hover:scale-105 group shadow-lg shadow-emerald-900/20\">\n                <Activity className=\"mr-2 h-4 w-4 group-hover:animate-pulse\" />\n                Explore Analysis Output\n              </Button>\n            </Link>\n          </div>\n          <div className=\"mt-8 flex flex-col items-center justify-center gap-6\">\n            <Link href=\"/login\" className=\"text-sm font-semibold leading-6 text-white hover:text-blue-300\">\n              Log in to your account <span aria-hidden=\"true\">→</span>\n            </Link>\n            <Link href=\"/sign-up\">\n              <Button size=\"lg\" className=\"bg-blue-600 hover:bg-blue-500 text-white font-semibold px-8\">\n                Get Started\n              </Button>\n            </Link>\n          </div>\n\n          {/* CSS-Based Dashboard Preview */}\n          <div className=\"mt-16 flow-root sm:mt-24\">\n            <div className=\"-m-2 rounded-xl bg-gray-900/5 p-2 ring-1 ring-inset ring-gray-900/10 lg:-m-4 lg:rounded-2xl lg:p-4\">\n              <div className=\"relative rounded-xl bg-slate-900/80 shadow-2xl ring-1 ring-white/10 backdrop-blur-md overflow-hidden group\">\n                {/* \n                  VIDEO EFFECT INSTRUCTION:\n                  To use a real video instead of the mock UI, uncomment the following video tag and remove the \"Mock UI Body\" div below.\n                  Ensure you have a file named 'demo.mp4' in your public folder.\n                */}\n                {\n                  <video\n                    controls\n                    playsInline\n                    className=\"w-full h-full object-cover opacity-90\"\n                  >\n                    <source src=\"/Sequence 01.mp4#t=0.001\" type=\"video/mp4\" />\n                  </video>\n                }\n\n                {/* Scanline/CRT Effect Overlay */}\n                <div className=\"absolute inset-0 pointer-events-none z-50 bg-[linear-gradient(rgba(18,16,16,0)_50%,rgba(0,0,0,0.25)_50%),linear-gradient(90deg,rgba(255,0,0,0.06),rgba(0,255,0,0.02),rgba(0,0,255,0.06))] bg-[length:100%_4px,3px_100%] bg-repeat opacity-20\"></div>\n                <div className=\"absolute inset-0 pointer-events-none z-50 bg-gradient-to-b from-white/5 to-transparent opacity-10\"></div>\n\n\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Global Coverage Section */}\n      <div className=\"bg-white py-10 border-b border-slate-100\">\n        <div className=\"mx-auto max-w-7xl px-6 lg:px-8\">\n          <p className=\"text-center text-sm font-semibold leading-8 text-slate-500 uppercase tracking-widest\">\n            Comparative Analysis of Major AI Regimes\n          </p>\n          <div className=\"mx-auto mt-8 grid max-w-lg grid-cols-4 items-center gap-x-8 gap-y-10 sm:max-w-xl sm:gap-x-10 sm:grid-cols-4 lg:mx-0 lg:max-w-none lg:grid-cols-4\">\n            <div className=\"col-span-1 flex flex-col items-center justify-center gap-2 group cursor-default\">\n              <span className=\"text-4xl filter grayscale group-hover:grayscale-0 transition-all duration-300 transform group-hover:scale-110\">🇪🇺</span>\n              <span className=\"text-xs font-bold text-slate-400 group-hover:text-blue-600 transition-colors\">EU AI Act</span>\n            </div>\n            <div className=\"col-span-1 flex flex-col items-center justify-center gap-2 group cursor-default\">\n              <span className=\"text-4xl filter grayscale group-hover:grayscale-0 transition-all duration-300 transform group-hover:scale-110\">🇺🇸</span>\n              <span className=\"text-xs font-bold text-slate-400 group-hover:text-blue-600 transition-colors\">US Executive Order</span>\n            </div>\n            <div className=\"col-span-1 flex flex-col items-center justify-center gap-2 group cursor-default\">\n              <span className=\"text-4xl filter grayscale group-hover:grayscale-0 transition-all duration-300 transform group-hover:scale-110\">🇨🇳</span>\n              <span className=\"text-xs font-bold text-slate-400 group-hover:text-blue-600 transition-colors\">China Interim Measures</span>\n            </div>\n            <div className=\"col-span-1 flex flex-col items-center justify-center gap-2 group cursor-default\">\n              <span className=\"text-4xl filter grayscale group-hover:grayscale-0 transition-all duration-300 transform group-hover:scale-110\">🇧🇷</span>\n              <span className=\"text-xs font-bold text-slate-400 group-hover:text-blue-600 transition-colors\">Brazil PL 2338</span>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div className=\"bg-white py-12 border-b border-slate-100\">\n        <div className=\"mx-auto max-w-7xl px-6 lg:px-8\">\n          <p className=\"text-center text-sm font-semibold leading-8 text-slate-500 uppercase tracking-widest\">\n            Powered by industry-leading technology\n          </p>\n          <div className=\"mx-auto mt-8 grid max-w-lg grid-cols-3 items-center gap-x-8 gap-y-10 sm:max-w-xl sm:gap-x-10 lg:mx-0 lg:max-w-none lg:grid-cols-3\">\n            {/* Google Logo */}\n            <div className=\"col-span-1 flex justify-center\">\n              <div className=\"flex items-center gap-2 grayscale hover:grayscale-0 transition-all duration-300 opacity-60 hover:opacity-100\">\n                <svg className=\"h-8 w-8\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n                  <path d=\"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z\" fill=\"#4285F4\" />\n                  <path d=\"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z\" fill=\"#34A853\" />\n                  <path d=\"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z\" fill=\"#FBBC05\" />\n                  <path d=\"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z\" fill=\"#EA4335\" />\n                </svg>\n                <span className=\"text-xl font-bold text-slate-600\">Google</span>\n              </div>\n            </div>\n\n            {/* OpenAI Logo */}\n            <div className=\"col-span-1 flex justify-center\">\n              <div className=\"flex items-center gap-2 grayscale hover:grayscale-0 transition-all duration-300 opacity-60 hover:opacity-100\">\n                <svg className=\"h-8 w-8 text-black\" viewBox=\"0 0 24 24\" fill=\"currentColor\" xmlns=\"http://www.w3.org/2000/svg\">\n                  <path d=\"M22.2819 9.8211a5.9847 5.9847 0 0 0-.5157-4.9108 6.0462 6.0462 0 0 0-6.5098-2.9A6.0651 6.0651 0 0 0 4.9807 4.1818a5.9847 5.9847 0 0 0-3.9977 2.9 6.0462 6.0462 0 0 0 .7427 7.0966 5.98 5.98 0 0 0 .511 4.9107 6.0462 6.0462 0 0 0 6.5146 2.9001A5.9847 5.9847 0 0 0 13.2599 24a6.0557 6.0557 0 0 0 5.7718-4.2058 5.9894 5.9894 0 0 0 3.9977-2.9001 6.0557 6.0557 0 0 0-.7475-7.0729zm-9.022 12.6081a4.4755 4.4755 0 0 1-2.8764-1.0408l.1419-.0804 4.7783-2.7582a.7948.7948 0 0 0 .3927-.6813v-6.7369l2.02 1.1686a.071.071 0 0 1 .038.052v5.5826a4.504 4.504 0 0 1-4.4945 4.4944zm-9.6607-4.1254a4.4708 4.4708 0 0 1-.5346-3.0137l.142.0852 4.783 2.7582a.7712.7712 0 0 0 .7806 0l5.8428-3.3685v2.3324a.0804.0804 0 0 1-.0332.0615L9.74 19.9502a4.4992 4.4992 0 0 1-6.1408-1.6464zM2.3408 7.8956a4.485 4.485 0 0 1 2.3655-1.9728V11.6a.7664.7664 0 0 0 .3879.6765l5.8144 3.3543-2.0201 1.1685a.0757.0757 0 0 1-.071 0l-4.8303-2.7865A4.504 4.504 0 0 1 2.3408 7.872zm16.5963 3.8558L13.1038 8.364 15.1195 7.2a.0757.0757 0 0 1 .071 0l4.8303 2.7913a4.4944 4.4944 0 0 1-.6765 8.1042v-5.6772a.79.79 0 0 0-.407-.667zm2.0107-3.0231l-.142-.0852-4.7735-2.7818a.7759.7759 0 0 0-.7854 0L9.409 9.2297V6.8974a.0662.0662 0 0 1 .0284-.0615l4.8303-2.7866a4.4992 4.4992 0 0 1 6.6802 4.66zM8.3065 12.863l-2.02-1.1638a.0804.0804 0 0 1-.038-.0567V6.0742a4.4992 4.4992 0 0 1 7.3757-3.4537l-.142.0805L8.704 5.459a.7948.7948 0 0 0-.3927.6813zm1.09-1.1088l2.9251-1.6923 2.9251 1.6923v3.3846l-2.9251 1.6923-2.9251-1.6923z\" />\n                </svg>\n                <span className=\"text-xl font-bold text-slate-600\">OpenAI</span>\n              </div>\n            </div>\n\n            {/* Redis Logo */}\n            <div className=\"col-span-1 flex justify-center\">\n              <div className=\"flex items-center gap-2 grayscale hover:grayscale-0 transition-all duration-300 opacity-60 hover:opacity-100\">\n                <svg className=\"h-8 w-8 text-red-600\" viewBox=\"0 0 24 24\" fill=\"currentColor\" xmlns=\"http://www.w3.org/2000/svg\">\n                  <path d=\"M20.4 3.6H3.6C1.6 3.6 0 5.2 0 7.2v9.6c0 2 1.6 3.6 3.6 3.6h16.8c2 0 3.6-1.6 3.6-3.6V7.2c0-2-1.6-3.6-3.6-3.6zm-12 12H4.8v-2.4h3.6v2.4zm0-4.8H4.8V8.4h3.6v2.4zm4.8 4.8H9.6v-2.4h3.6v2.4zm0-4.8H9.6V8.4h3.6v2.4zm4.8 4.8h-3.6v-2.4h3.6v2.4zm0-4.8h-3.6V8.4h3.6v2.4zm4.8 4.8h-3.6v-2.4h3.6v2.4zm0-4.8h-3.6V8.4h3.6v2.4z\" />\n                </svg>\n                <span className=\"text-xl font-bold text-slate-600\">Redis</span>\n              </div>\n            </div>\n\n            {/* Gemini Logo */}\n            <div className=\"col-span-1 flex justify-center\">\n              <div className=\"flex items-center gap-2 grayscale hover:grayscale-0 transition-all duration-300 opacity-60 hover:opacity-100\">\n                <svg className=\"h-8 w-8\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n                  <path d=\"M12 2L14.5 9.5L22 12L14.5 14.5L12 22L9.5 14.5L2 12L9.5 9.5L12 2Z\" fill=\"url(#gemini-gradient)\" />\n                  <defs>\n                    <linearGradient id=\"gemini-gradient\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\">\n                      <stop offset=\"0%\" stopColor=\"#4E85F7\" />\n                      <stop offset=\"100%\" stopColor=\"#D6669D\" />\n                    </linearGradient>\n                  </defs>\n                </svg>\n                <span className=\"text-xl font-bold text-slate-600\">Gemini</span>\n              </div>\n            </div>\n\n            {/* Next.js Logo */}\n            <div className=\"col-span-1 flex justify-center\">\n              <div className=\"flex items-center gap-2 grayscale hover:grayscale-0 transition-all duration-300 opacity-60 hover:opacity-100\">\n                <svg className=\"h-8 w-8\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n                  <path d=\"M12 2L2 19.7778H22L12 2Z\" fill=\"black\" className=\"fill-slate-900\" />\n                </svg>\n                <span className=\"text-xl font-bold text-slate-600\">Next.js</span>\n              </div>\n            </div>\n\n            {/* Grok Logo */}\n            <div className=\"col-span-1 flex justify-center\">\n              <div className=\"flex items-center gap-2 grayscale hover:grayscale-0 transition-all duration-300 opacity-60 hover:opacity-100\">\n                <svg className=\"h-8 w-8\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n                  <rect width=\"24\" height=\"24\" rx=\"4\" className=\"fill-slate-900\" />\n                  <path d=\"M6 18L18 6M18 6H10M18 6V14\" stroke=\"white\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" />\n                </svg>\n                <span className=\"text-xl font-bold text-slate-600\">Grok</span>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Value Proposition */}\n      <div className=\"py-24 sm:py-32 bg-slate-50\">\n        <div className=\"mx-auto max-w-7xl px-6 lg:px-8\">\n          <div className=\"mx-auto max-w-2xl lg:text-center\">\n            <h2 className=\"text-base font-semibold leading-7 text-blue-600\">Methodology</h2>\n            <p className=\"mt-2 text-3xl font-bold tracking-tight text-slate-900 sm:text-4xl\">\n              From Archive to Insight\n            </p>\n            <p className=\"mt-6 text-lg leading-8 text-slate-600\">\n              A systematic approach to analyzing complex textual datasets through multiple theoretical lenses.\n            </p>\n\n            {/* Video Panel */}\n            <div className=\"mt-12 w-full max-w-4xl mx-auto\">\n              <div className=\"bg-slate-900 rounded-xl border border-slate-800 overflow-hidden shadow-2xl\">\n                <div className=\"p-4 border-b border-slate-800 bg-slate-900/50\">\n                  <h3 className=\"text-white font-semibold flex items-center gap-2\">\n                    <div className=\"p-1 bg-indigo-500/20 rounded\">\n                      <Play className=\"h-4 w-4 text-indigo-400\" />\n                    </div>\n                    Introduction To Assemblage-AI\n                  </h3>\n                  <p className=\"text-sm text-slate-400 mt-1\">\n                    A video exploration of the need for Assemblage-AI.\n                  </p>\n                </div>\n                <div className=\"aspect-video w-full bg-black relative\">\n                  <video\n                    controls\n                    className=\"w-full h-full object-contain\"\n                    poster=\"/landing-bg.png\"\n                  >\n                    <source src=\"/assemblagebr.mp4\" type=\"video/mp4\" />\n                    Your browser does not support the video tag.\n                  </video>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div className=\"mx-auto mt-16 max-w-2xl sm:mt-20 lg:mt-24 lg:max-w-none\">\n            <dl className=\"grid max-w-xl grid-cols-1 gap-x-8 gap-y-16 lg:max-w-none lg:grid-cols-3\">\n              <div className=\"flex flex-col\">\n                <dt className=\"flex items-center gap-x-3 text-base font-semibold leading-7 text-slate-900\">\n                  <div className=\"h-10 w-10 flex items-center justify-center rounded-lg bg-blue-600\">\n                    <Database className=\"h-6 w-6 text-white\" aria-hidden=\"true\" />\n                  </div>\n                  Data Ingestion\n                </dt>\n                <dd className=\"mt-4 flex flex-auto flex-col text-base leading-7 text-slate-600\">\n                  <p className=\"flex-auto\">\n                    Upload PDFs, scrape web traces, and organize your primary sources. The system automatically extracts text and prepares it for analysis.\n                  </p>\n                </dd>\n              </div>\n              <div className=\"flex flex-col\">\n                <dt className=\"flex items-center gap-x-3 text-base font-semibold leading-7 text-slate-900\">\n                  <div className=\"h-10 w-10 flex items-center justify-center rounded-lg bg-indigo-600\">\n                    <Cpu className=\"h-6 w-6 text-white\" aria-hidden=\"true\" />\n                  </div>\n                  AI-Powered Analysis\n                </dt>\n                <dd className=\"mt-4 flex flex-auto flex-col text-base leading-7 text-slate-600\">\n                  <p className=\"flex-auto\">\n                    Apply specific theoretical lenses (Resistance, Cultural Framing, Institutional Logics) using advanced LLMs to extract structured insights.\n                  </p>\n                </dd>\n              </div>\n              <div className=\"flex flex-col\">\n                <dt className=\"flex items-center gap-x-3 text-base font-semibold leading-7 text-slate-900\">\n                  <div className=\"h-10 w-10 flex items-center justify-center rounded-lg bg-teal-600\">\n                    <GitGraph className=\"h-6 w-6 text-white\" aria-hidden=\"true\" />\n                  </div>\n                  Network Synthesis\n                </dt>\n                <dd className=\"mt-4 flex flex-auto flex-col text-base leading-7 text-slate-600\">\n                  <p className=\"flex-auto\">\n                    Visualize relationships between actors, concepts, and documents. Detect cultural holes and generate comparative reports.\n                  </p>\n                </dd>\n              </div>\n            </dl>\n          </div>\n        </div>\n      </div>\n\n      {/* Audience Section */}\n      <div className=\"py-24 sm:py-32 bg-white border-t border-slate-100\">\n        <div className=\"mx-auto max-w-7xl px-6 lg:px-8\">\n          <div className=\"mx-auto max-w-2xl lg:text-center mb-16\">\n            <h2 className=\"text-base font-semibold leading-7 text-indigo-600\">Community</h2>\n            <p className=\"mt-2 text-3xl font-bold tracking-tight text-slate-900 sm:text-4xl\">\n              Who uses Assemblage-AI?\n            </p>\n          </div>\n          <div className=\"mx-auto grid max-w-2xl grid-cols-1 gap-8 lg:max-w-none lg:grid-cols-3\">\n            <div className=\"flex flex-col items-start p-6 bg-slate-50 rounded-2xl\">\n              <div className=\"p-3 bg-blue-100 rounded-xl mb-4\">\n                <GraduationCap className=\"h-6 w-6 text-blue-600\" />\n              </div>\n              <h3 className=\"text-lg font-semibold text-slate-900 mb-2\">Academic Researchers</h3>\n              <p className=\"text-slate-600 leading-relaxed\">\n                Scholars in STS, Information Systems, and Law studying AI policy, algorithmic governance, and sociotechnical imaginaries.\n              </p>\n            </div>\n            <div className=\"flex flex-col items-start p-6 bg-slate-50 rounded-2xl\">\n              <div className=\"p-3 bg-indigo-100 rounded-xl mb-4\">\n                <Building className=\"h-6 w-6 text-indigo-600\" />\n              </div>\n              <h3 className=\"text-lg font-semibold text-slate-900 mb-2\">Policy Teams</h3>\n              <p className=\"text-slate-600 leading-relaxed\">\n                Regulators and analysts comparing global AI frameworks, tracking compliance logic, and identifying regulatory gaps.\n              </p>\n            </div>\n            <div className=\"flex flex-col items-start p-6 bg-slate-50 rounded-2xl\">\n              <div className=\"p-3 bg-teal-100 rounded-xl mb-4\">\n                <Users className=\"h-6 w-6 text-teal-600\" />\n              </div>\n              <h3 className=\"text-lg font-semibold text-slate-900 mb-2\">Advocates & NGOs</h3>\n              <p className=\"text-slate-600 leading-relaxed\">\n                Civil society organizations examining power dynamics, data justice, and the social impact of algorithmic systems.\n              </p>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Trust & Ethics Section */}\n      <div className=\"py-24 sm:py-32 bg-slate-900 text-slate-300\">\n        <div className=\"mx-auto max-w-7xl px-6 lg:px-8\">\n          <div className=\"mx-auto max-w-2xl lg:mx-0 flex flex-col lg:flex-row items-center gap-12\">\n            <div className=\"lg:w-1/2\">\n              <h2 className=\"text-3xl font-bold tracking-tight text-white sm:text-4xl\">Trust, Ethics & Privacy</h2>\n              <p className=\"mt-6 text-lg leading-8\">\n                Built for critical research with a commitment to data sovereignty and transparency.\n              </p>\n            </div>\n            <div className=\"lg:w-1/2 relative\">\n              <div className=\"absolute inset-0 bg-blue-500/20 blur-3xl rounded-full\"></div>\n              <img\n                src=\"/trust-ethics.png\"\n                alt=\"Digital Trust and Privacy\"\n                className=\"relative rounded-2xl shadow-2xl border border-white/10 w-full max-w-md mx-auto hover:scale-105 transition-transform duration-500\"\n              />\n            </div>\n          </div>\n          <div className=\"mx-auto mt-16 grid max-w-2xl grid-cols-1 gap-8 lg:mx-0 lg:max-w-none lg:grid-cols-2\">\n            <div className=\"flex flex-col\">\n              <dt className=\"flex items-center gap-x-3 text-base font-semibold leading-7 text-white\">\n                <Lock className=\"h-5 w-5 text-blue-400\" aria-hidden=\"true\" />\n                Data Handling & Privacy\n              </dt>\n              <dd className=\"mt-4 flex flex-auto flex-col text-base leading-7\">\n                <p className=\"flex-auto\">\n                  Uploaded documents are stored securely and are <strong>never used to train public AI models</strong>. You retain full ownership of your data. Files can be permanently deleted from our servers at any time.\n                </p>\n              </dd>\n            </div>\n            <div className=\"flex flex-col\">\n              <dt className=\"flex items-center gap-x-3 text-base font-semibold leading-7 text-white\">\n                <Shield className=\"h-5 w-5 text-blue-400\" aria-hidden=\"true\" />\n                Research Context\n              </dt>\n              <dd className=\"mt-4 flex flex-auto flex-col text-base leading-7\">\n                <p className=\"flex-auto\">\n                  Developed as part of academic research on using AI for critical analysis. This open-source tool is designed to reveal power structures, not reinforce them.\n                </p>\n              </dd>\n            </div>\n          </div>\n\n          {/* Privacy Badges */}\n          <div className=\"mt-16 pt-10 border-t border-white/10 flex flex-wrap justify-center gap-8 opacity-80\">\n            <div className=\"flex items-center gap-2 px-4 py-2 bg-white/5 rounded-full border border-white/10\">\n              <Shield className=\"h-4 w-4 text-emerald-400\" />\n              <span className=\"text-sm font-medium text-slate-300\">GDPR Ready</span>\n            </div>\n            <div className=\"flex items-center gap-2 px-4 py-2 bg-white/5 rounded-full border border-white/10\">\n              <Lock className=\"h-4 w-4 text-blue-400\" />\n              <span className=\"text-sm font-medium text-slate-300\">End-to-End Encrypted</span>\n            </div>\n            <div className=\"flex items-center gap-2 px-4 py-2 bg-white/5 rounded-full border border-white/10\">\n              <Database className=\"h-4 w-4 text-purple-400\" />\n              <span className=\"text-sm font-medium text-slate-300\">No Model Training</span>\n            </div>\n            <div className=\"flex items-center gap-2 px-4 py-2 bg-white/5 rounded-full border border-white/10\">\n              <GitGraph className=\"h-4 w-4 text-orange-400\" />\n              <span className=\"text-sm font-medium text-slate-300\">Open Source</span>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Footer */}\n      <footer className=\"bg-slate-950 text-slate-400 py-12 border-t border-slate-900\">\n        <div className=\"mx-auto max-w-7xl px-6 lg:px-8 grid grid-cols-1 md:grid-cols-4 gap-8\">\n          <div className=\"col-span-1 md:col-span-2\">\n            <div className=\"flex items-center gap-2 mb-4\">\n              <div className=\"h-8 w-8 bg-gradient-to-br from-blue-500 to-emerald-500 rounded-lg\"></div>\n              <span className=\"text-xl font-bold text-white\">Assemblage-AI</span>\n            </div>\n            <p className=\"text-sm leading-relaxed max-w-xs\">\n              An open-source platform for critical AI governance research, bridging the gap between policy intent and algorithmic reality.\n            </p>\n          </div>\n          <div>\n            <h4 className=\"text-white font-semibold mb-4\">Platform</h4>\n            <ul className=\"space-y-2 text-sm\">\n              <li><Link href=\"/data\" className=\"hover:text-blue-400 transition-colors\">Data Collection</Link></li>\n              <li><Link href=\"/ecosystem\" className=\"hover:text-blue-400 transition-colors\">Ecosystem Map</Link></li>\n              <li><Link href=\"/synthesis\" className=\"hover:text-blue-400 transition-colors\">Analysis Tools</Link></li>\n              <li><Link href=\"/demo\" className=\"hover:text-blue-400 transition-colors\">Live Demo</Link></li>\n            </ul>\n          </div>\n          <div>\n            <h4 className=\"text-white font-semibold mb-4\">Resources</h4>\n            <ul className=\"space-y-2 text-sm\">\n              <li><Link href=\"#\" className=\"hover:text-blue-400 transition-colors\">Documentation</Link></li>\n              <li><Link href=\"#\" className=\"hover:text-blue-400 transition-colors\">GitHub Repository</Link></li>\n              <li><Link href=\"#\" className=\"hover:text-blue-400 transition-colors\">Privacy Policy</Link></li>\n              <li><Link href=\"#\" className=\"hover:text-blue-400 transition-colors\">Contact</Link></li>\n            </ul>\n          </div>\n        </div>\n        <div className=\"mx-auto max-w-7xl px-6 lg:px-8 mt-12 pt-8 border-t border-slate-900 text-xs text-center\">\n          &copy; {new Date().getFullYear()} Assemblage-AI Research Group. Open Source (MIT License).\n        </div>\n      </footer>\n    </div>\n  );\n}\n\n// ...\n\nfunction Dashboard({ sources }: { sources: Source[] }) {\n  const docCount = sources.filter(s => s.type !== 'Trace').length;\n  const traceCount = sources.filter(s => s.type === 'Trace').length;\n  const analyzedCount = sources.filter(s => s.analysis || s.cultural_framing || s.institutional_logics).length;\n\n  return (\n    <div className=\"space-y-8\">\n      {/* Dashboard Header */}\n      <div className=\"bg-white p-6 rounded-xl border border-slate-200 shadow-sm\">\n        <h2 className=\"text-2xl font-bold tracking-tight text-slate-900\">\n          Assemblage Dashboard\n        </h2>\n        <p className=\"text-slate-500 mt-1\">\n          Welcome back. Continue your critical analysis of complex narratives.\n        </p>\n      </div>\n\n      {/* Metric Cards */}\n      <div className=\"grid gap-4 md:grid-cols-3\">\n        <Card className=\"bg-gradient-to-br from-blue-50 to-white border-blue-100\">\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium text-blue-900\">\n              Documents\n            </CardTitle>\n            <div className=\"h-8 w-8 rounded-full bg-blue-100 flex items-center justify-center\">\n              <FileText className=\"h-4 w-4 text-blue-600\" />\n            </div>\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-3xl font-bold text-blue-900\">{docCount}</div>\n            <p className=\"text-xs text-blue-600 mt-1 font-medium\">\n              Primary policy texts\n            </p>\n          </CardContent>\n        </Card>\n        <Card className=\"bg-gradient-to-br from-indigo-50 to-white border-indigo-100\">\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium text-indigo-900\">\n              Empirical Traces\n            </CardTitle>\n            <div className=\"h-8 w-8 rounded-full bg-indigo-100 flex items-center justify-center\">\n              <Search className=\"h-4 w-4 text-indigo-600\" />\n            </div>\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-3xl font-bold text-indigo-900\">{traceCount}</div>\n            <p className=\"text-xs text-indigo-600 mt-1 font-medium\">\n              Collected from web sources\n            </p>\n          </CardContent>\n        </Card>\n        <Card className=\"bg-gradient-to-br from-emerald-50 to-white border-emerald-100\">\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium text-emerald-900\">\n              Analyzed Sources\n            </CardTitle>\n            <div className=\"h-8 w-8 rounded-full bg-emerald-100 flex items-center justify-center\">\n              <Activity className=\"h-4 w-4 text-emerald-600\" />\n            </div>\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-3xl font-bold text-emerald-900\">{analyzedCount}</div>\n            <p className=\"text-xs text-emerald-600 mt-1 font-medium\">\n              Processed with AI lenses\n            </p>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Quick Actions */}\n      <div>\n        <h3 className=\"text-lg font-semibold text-slate-900 mb-4\">Quick Actions</h3>\n        <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-4\">\n          <Link href=\"/data\">\n            <div className=\"group relative flex flex-col items-center justify-center p-6 bg-white border-2 border-dashed border-slate-200 rounded-xl hover:border-blue-500 hover:bg-blue-50/50 transition-all duration-200 cursor-pointer\">\n              <div className=\"h-12 w-12 rounded-full bg-blue-100 flex items-center justify-center mb-3 group-hover:scale-110 transition-transform duration-200\">\n                <Upload className=\"h-6 w-6 text-blue-600\" />\n              </div>\n              <span className=\"font-semibold text-slate-900 group-hover:text-blue-700\">Upload Document</span>\n              <span className=\"text-xs text-slate-500 mt-1\">Add new PDF policy text</span>\n            </div>\n          </Link>\n          <Link href=\"/empirical\">\n            <div className=\"group relative flex flex-col items-center justify-center p-6 bg-white border-2 border-dashed border-slate-200 rounded-xl hover:border-indigo-500 hover:bg-indigo-50/50 transition-all duration-200 cursor-pointer\">\n              <div className=\"h-12 w-12 rounded-full bg-indigo-100 flex items-center justify-center mb-3 group-hover:scale-110 transition-transform duration-200\">\n                <Search className=\"h-6 w-6 text-indigo-600\" />\n              </div>\n              <span className=\"font-semibold text-slate-900 group-hover:text-indigo-700\">Find Traces</span>\n              <span className=\"text-xs text-slate-500 mt-1\">Search web for evidence</span>\n            </div>\n          </Link>\n          <Link href=\"/comparison\">\n            <div className=\"group relative flex flex-col items-center justify-center p-6 bg-white border-2 border-dashed border-slate-200 rounded-xl hover:border-cyan-500 hover:bg-cyan-50/50 transition-all duration-200 cursor-pointer\">\n              <div className=\"h-12 w-12 rounded-full bg-cyan-100 flex items-center justify-center mb-3 group-hover:scale-110 transition-transform duration-200\">\n                <Scale className=\"h-6 w-6 text-cyan-600\" />\n              </div>\n              <span className=\"font-semibold text-slate-900 group-hover:text-cyan-700\">Compare Frameworks</span>\n              <span className=\"text-xs text-slate-500 mt-1\">Side-by-side analysis</span>\n            </div>\n          </Link>\n          <Link href=\"/synthesis\">\n            <div className=\"group relative flex flex-col items-center justify-center p-6 bg-white border-2 border-dashed border-slate-200 rounded-xl hover:border-teal-500 hover:bg-teal-50/50 transition-all duration-200 cursor-pointer\">\n              <div className=\"h-12 w-12 rounded-full bg-teal-100 flex items-center justify-center mb-3 group-hover:scale-110 transition-transform duration-200\">\n                <Zap className=\"h-6 w-6 text-teal-600\" />\n              </div>\n              <span className=\"font-semibold text-slate-900 group-hover:text-teal-700\">Generate Report</span>\n              <span className=\"text-xs text-slate-500 mt-1\">Create synthesis PDF</span>\n            </div>\n          </Link>\n        </div>\n      </div>\n\n      {/* Features Grid */}\n      <div>\n        <h3 className=\"text-xl font-semibold text-slate-900 mb-4\">Research Tools</h3>\n        <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-3\">\n          {features.map((feature) => {\n            const Icon = feature.icon;\n            return (\n              <Link key={feature.name} href={feature.href}>\n                <Card className={`${feature.color} border-2 hover:shadow-lg transition-all cursor-pointer group animate-in fade-in slide-in-from-bottom-8 duration-1000 fill-mode-both`}>\n                  <CardHeader>\n                    <div className=\"flex items-start justify-between\">\n                      <div className=\"flex items-center gap-3\">\n                        <div className=\"p-2 bg-white rounded-lg\">\n                          <Icon className={`h-5 w-5 ${feature.iconColor}`} />\n                        </div>\n                        <CardTitle className=\"text-base\">{feature.name}</CardTitle>\n                      </div>\n                    </div>\n                    <CardDescription className=\"text-sm mt-2\">\n                      {feature.description}\n                    </CardDescription>\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"flex items-center text-sm font-medium group-hover:translate-x-1 transition-transform\">\n                      Open tool\n                      <ArrowRight className=\"ml-2 h-4 w-4\" />\n                    </div>\n                  </CardContent>\n                </Card>\n              </Link>\n            );\n          })}\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default function Home() {\n  const { isLoaded, isSignedIn } = useUser();\n  const { sources } = useSources();\n\n  if (!isLoaded) {\n    return <div className=\"flex items-center justify-center h-screen\">Loading...</div>;\n  }\n\n  if (!isSignedIn) {\n    // Bypass login if demo mode is enabled\n    // if (process.env.NEXT_PUBLIC_ENABLE_DEMO_MODE === \"true\") {\n    //   return <Dashboard sources={sources} />;\n    // }\n    return <LandingPage />;\n  }\n\n  return <Dashboard sources={sources} />;\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\reflexivity\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Badge' is defined but never used.","line":9,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":9,"endColumn":15},{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`fetchLogs` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\nC:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\reflexivity\\page.tsx:27:9\n  25 |\n  26 |     useEffect(() => {\n> 27 |         fetchLogs();\n     |         ^^^^^^^^^ `fetchLogs` accessed before it is declared\n  28 |     }, []);\n  29 |\n  30 |     const fetchLogs = async () => {\n\nC:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\reflexivity\\page.tsx:30:5\n  28 |     }, []);\n  29 |\n> 30 |     const fetchLogs = async () => {\n     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 31 |         try {\n     | ^^^^^^^^^^^^^\n> 32 |             const headers: HeadersInit = { 'Content-Type': 'application/json' };\n     …\n     | ^^^^^^^^^^^^^\n> 44 |         }\n     | ^^^^^^^^^^^^^\n> 45 |     };\n     | ^^^^^^^ `fetchLogs` is declared here\n  46 |\n  47 |     const handleSave = () => {\n  48 |         setSaveStatus(\"saving\");","line":27,"column":9,"nodeType":null,"endLine":27,"endColumn":18},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":114,"column":25,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[5336,5546],"text":"\r\n                        &quot;To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical' but 'decolonial'.\" — Walter Mignolo\r\n                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[5336,5546],"text":"\r\n                        &ldquo;To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical' but 'decolonial'.\" — Walter Mignolo\r\n                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[5336,5546],"text":"\r\n                        &#34;To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical' but 'decolonial'.\" — Walter Mignolo\r\n                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[5336,5546],"text":"\r\n                        &rdquo;To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical' but 'decolonial'.\" — Walter Mignolo\r\n                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":114,"column":141,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[5336,5546],"text":"\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just &apos;critical' but 'decolonial'.\" — Walter Mignolo\r\n                    "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[5336,5546],"text":"\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just &lsquo;critical' but 'decolonial'.\" — Walter Mignolo\r\n                    "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[5336,5546],"text":"\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just &#39;critical' but 'decolonial'.\" — Walter Mignolo\r\n                    "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[5336,5546],"text":"\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just &rsquo;critical' but 'decolonial'.\" — Walter Mignolo\r\n                    "},"desc":"Replace with `&rsquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":114,"column":150,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[5336,5546],"text":"\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical&apos; but 'decolonial'.\" — Walter Mignolo\r\n                    "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[5336,5546],"text":"\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical&lsquo; but 'decolonial'.\" — Walter Mignolo\r\n                    "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[5336,5546],"text":"\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical&#39; but 'decolonial'.\" — Walter Mignolo\r\n                    "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[5336,5546],"text":"\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical&rsquo; but 'decolonial'.\" — Walter Mignolo\r\n                    "},"desc":"Replace with `&rsquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":114,"column":156,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[5336,5546],"text":"\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical' but &apos;decolonial'.\" — Walter Mignolo\r\n                    "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[5336,5546],"text":"\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical' but &lsquo;decolonial'.\" — Walter Mignolo\r\n                    "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[5336,5546],"text":"\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical' but &#39;decolonial'.\" — Walter Mignolo\r\n                    "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[5336,5546],"text":"\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical' but &rsquo;decolonial'.\" — Walter Mignolo\r\n                    "},"desc":"Replace with `&rsquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":114,"column":167,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[5336,5546],"text":"\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical' but 'decolonial&apos;.\" — Walter Mignolo\r\n                    "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[5336,5546],"text":"\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical' but 'decolonial&lsquo;.\" — Walter Mignolo\r\n                    "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[5336,5546],"text":"\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical' but 'decolonial&#39;.\" — Walter Mignolo\r\n                    "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[5336,5546],"text":"\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical' but 'decolonial&rsquo;.\" — Walter Mignolo\r\n                    "},"desc":"Replace with `&rsquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":114,"column":169,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[5336,5546],"text":"\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical' but 'decolonial'.&quot; — Walter Mignolo\r\n                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[5336,5546],"text":"\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical' but 'decolonial'.&ldquo; — Walter Mignolo\r\n                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[5336,5546],"text":"\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical' but 'decolonial'.&#34; — Walter Mignolo\r\n                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[5336,5546],"text":"\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical' but 'decolonial'.&rdquo; — Walter Mignolo\r\n                    "},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":7,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport { useServerStorage } from \"@/hooks/useServerStorage\";\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Textarea } from \"@/components/ui/textarea\";\r\nimport { BookOpen, Save, UserCircle, History } from \"lucide-react\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { LogEntry } from \"@/components/reflexivity/LogEntry\";\r\nimport { MethodLog } from \"@/types/logs\";\r\n\r\nconst GUIDING_QUESTIONS = [\r\n    \"How does my location in the Global North/South affect my reading of these texts?\",\r\n    \"What assumptions am I making about 'universal' AI ethics?\",\r\n    \"Whose voices are missing from the documents I am analyzing?\",\r\n    \"How does my own disciplinary background shape my interpretation of 'risk' and 'harm'?\",\r\n];\r\n\r\n\r\nexport default function ReflexivityPage() {\r\n    const [journalEntry, setJournalEntry] = useServerStorage(\"research-journal\", \"\");\r\n    const [saveStatus, setSaveStatus] = useState<\"saved\" | \"saving\" | null>(null);\r\n    const [logs, setLogs] = useState<MethodLog[]>([]);\r\n\r\n    useEffect(() => {\r\n        fetchLogs();\r\n    }, []);\r\n\r\n    const fetchLogs = async () => {\r\n        try {\r\n            const headers: HeadersInit = { 'Content-Type': 'application/json' };\r\n            if (process.env.NEXT_PUBLIC_ENABLE_DEMO_MODE === 'true' && process.env.NEXT_PUBLIC_DEMO_USER_ID) {\r\n                headers['x-demo-user-id'] = process.env.NEXT_PUBLIC_DEMO_USER_ID;\r\n            }\r\n\r\n            const res = await fetch('/api/logs', { headers });\r\n            if (res.ok) {\r\n                const data = await res.json();\r\n                setLogs(data);\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Failed to fetch logs\", error);\r\n        }\r\n    };\r\n\r\n    const handleSave = () => {\r\n        setSaveStatus(\"saving\");\r\n        // The data is already saved via useLocalStorage, just show feedback\r\n        setTimeout(() => {\r\n            setSaveStatus(\"saved\");\r\n            setTimeout(() => setSaveStatus(null), 2000);\r\n        }, 300);\r\n    };\r\n\r\n    return (\r\n        <div className=\"space-y-8\">\r\n            <div>\r\n                <h2 className=\"text-3xl font-bold tracking-tight text-slate-900\">Critical Reflection</h2>\r\n                <p className=\"text-slate-500\">Documenting epistemic location and engaging with positionality.</p>\r\n            </div>\r\n\r\n\r\n            <div className=\"grid gap-6 md:grid-cols-2\">\r\n                <div className=\"space-y-6\">\r\n                    <Card>\r\n                        <CardHeader>\r\n                            <div className=\"flex items-center space-x-2\">\r\n                                <UserCircle className=\"h-5 w-5 text-slate-600\" />\r\n                                <CardTitle className=\"text-lg\">Guiding Questions</CardTitle>\r\n                            </div>\r\n                            <CardDescription>\r\n                                Prompts to consider during your analysis.\r\n                            </CardDescription>\r\n                        </CardHeader>\r\n                        <CardContent>\r\n                            <ul className=\"space-y-4\">\r\n                                {GUIDING_QUESTIONS.map((question, index) => (\r\n                                    <li key={index} className=\"flex items-start space-x-3 text-sm text-slate-700\">\r\n                                        <span className=\"flex h-6 w-6 shrink-0 items-center justify-center rounded-full bg-slate-100 text-xs font-medium text-slate-600\">\r\n                                            {index + 1}\r\n                                        </span>\r\n                                        <span className=\"pt-0.5\">{question}</span>\r\n                                    </li>\r\n                                ))}\r\n                            </ul>\r\n                        </CardContent>\r\n                    </Card>\r\n\r\n                    <Card>\r\n                        <CardHeader>\r\n                            <div className=\"flex items-center space-x-2\">\r\n                                <History className=\"h-5 w-5 text-slate-600\" />\r\n                                <CardTitle className=\"text-lg\">Methodological Log</CardTitle>\r\n                            </div>\r\n                            <CardDescription>\r\n                                Automated log of analysis actions and lenses applied.\r\n                            </CardDescription>\r\n                        </CardHeader>\r\n                        <CardContent>\r\n                            <div className=\"space-y-4 max-h-[400px] overflow-y-auto pr-2\">\r\n                                {logs.length === 0 ? (\r\n                                    <p className=\"text-sm text-slate-500 italic\">No actions logged yet.</p>\r\n                                ) : (\r\n                                    logs.map((log) => (\r\n                                        <LogEntry key={log.id} log={log} />\r\n                                    ))\r\n                                )}\r\n                            </div>\r\n                        </CardContent>\r\n                    </Card>\r\n\r\n                    <div className=\"bg-slate-50 p-4 rounded-lg border border-slate-200 text-sm text-slate-600 italic\">\r\n                        \"To think from the border is to think from the exteriority of modernity... it is a way of thinking that is not just 'critical' but 'decolonial'.\" — Walter Mignolo\r\n                    </div>\r\n                </div>\r\n\r\n                <Card className=\"flex flex-col h-full\">\r\n                    <CardHeader>\r\n                        <div className=\"flex items-center space-x-2\">\r\n                            <BookOpen className=\"h-5 w-5 text-slate-600\" />\r\n                            <CardTitle className=\"text-lg\">Research Journal</CardTitle>\r\n                        </div>\r\n                        <CardDescription>\r\n                            Record your thoughts, biases, and shifts in perspective.\r\n                        </CardDescription>\r\n                    </CardHeader>\r\n                    <CardContent className=\"flex-1 flex flex-col space-y-4\">\r\n                        <Textarea\r\n                            placeholder=\"Start writing your reflections here...\"\r\n                            className=\"flex-1 min-h-[300px] resize-none p-4 leading-relaxed text-slate-900\"\r\n                            value={journalEntry}\r\n                            onChange={(e) => setJournalEntry(e.target.value)}\r\n                        />\r\n                        <div className=\"flex justify-end\">\r\n                            <Button\r\n                                onClick={handleSave}\r\n                                className=\"bg-slate-900 text-white hover:bg-slate-800\"\r\n                                disabled={saveStatus === \"saving\"}\r\n                            >\r\n                                <Save className=\"mr-2 h-4 w-4\" />\r\n                                {saveStatus === \"saving\" ? \"Saving...\" : saveStatus === \"saved\" ? \"Saved!\" : \"Save Entry\"}\r\n                            </Button>\r\n                        </div>\r\n                    </CardContent>\r\n                </Card>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\resistance\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Input' is defined but never used.","line":11,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":11,"endColumn":15},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":163,"column":60,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":163,"endColumn":63,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7464,7467],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7464,7467],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":341,"column":83,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":341,"endColumn":86,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[17398,17401],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[17398,17401],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":375,"column":77,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[19394,19559],"text":"\r\n                                    No traces found. Go to Data page to add &quot;Empirical Trace\" sources or use \"Search for Traces\".\r\n                                "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[19394,19559],"text":"\r\n                                    No traces found. Go to Data page to add &ldquo;Empirical Trace\" sources or use \"Search for Traces\".\r\n                                "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[19394,19559],"text":"\r\n                                    No traces found. Go to Data page to add &#34;Empirical Trace\" sources or use \"Search for Traces\".\r\n                                "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[19394,19559],"text":"\r\n                                    No traces found. Go to Data page to add &rdquo;Empirical Trace\" sources or use \"Search for Traces\".\r\n                                "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":375,"column":93,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[19394,19559],"text":"\r\n                                    No traces found. Go to Data page to add \"Empirical Trace&quot; sources or use \"Search for Traces\".\r\n                                "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[19394,19559],"text":"\r\n                                    No traces found. Go to Data page to add \"Empirical Trace&ldquo; sources or use \"Search for Traces\".\r\n                                "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[19394,19559],"text":"\r\n                                    No traces found. Go to Data page to add \"Empirical Trace&#34; sources or use \"Search for Traces\".\r\n                                "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[19394,19559],"text":"\r\n                                    No traces found. Go to Data page to add \"Empirical Trace&rdquo; sources or use \"Search for Traces\".\r\n                                "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":375,"column":110,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[19394,19559],"text":"\r\n                                    No traces found. Go to Data page to add \"Empirical Trace\" sources or use &quot;Search for Traces\".\r\n                                "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[19394,19559],"text":"\r\n                                    No traces found. Go to Data page to add \"Empirical Trace\" sources or use &ldquo;Search for Traces\".\r\n                                "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[19394,19559],"text":"\r\n                                    No traces found. Go to Data page to add \"Empirical Trace\" sources or use &#34;Search for Traces\".\r\n                                "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[19394,19559],"text":"\r\n                                    No traces found. Go to Data page to add \"Empirical Trace\" sources or use &rdquo;Search for Traces\".\r\n                                "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":375,"column":128,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[19394,19559],"text":"\r\n                                    No traces found. Go to Data page to add \"Empirical Trace\" sources or use \"Search for Traces&quot;.\r\n                                "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[19394,19559],"text":"\r\n                                    No traces found. Go to Data page to add \"Empirical Trace\" sources or use \"Search for Traces&ldquo;.\r\n                                "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[19394,19559],"text":"\r\n                                    No traces found. Go to Data page to add \"Empirical Trace\" sources or use \"Search for Traces&#34;.\r\n                                "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[19394,19559],"text":"\r\n                                    No traces found. Go to Data page to add \"Empirical Trace\" sources or use \"Search for Traces&rdquo;.\r\n                                "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":455,"column":53,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[24941,24996],"text":"\r\n                                                    &quot;"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[24941,24996],"text":"\r\n                                                    &ldquo;"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[24941,24996],"text":"\r\n                                                    &#34;"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[24941,24996],"text":"\r\n                                                    &rdquo;"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":455,"column":86,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[25028,25079],"text":"&quot;\r\n                                                "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[25028,25079],"text":"&ldquo;\r\n                                                "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[25028,25079],"text":"&#34;\r\n                                                "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[25028,25079],"text":"&rdquo;\r\n                                                "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":468,"column":55,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[25827,25898],"text":"Select &quot;Analyze Trace\" to identify resistance strategies using the LLM."},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[25827,25898],"text":"Select &ldquo;Analyze Trace\" to identify resistance strategies using the LLM."},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[25827,25898],"text":"Select &#34;Analyze Trace\" to identify resistance strategies using the LLM."},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[25827,25898],"text":"Select &rdquo;Analyze Trace\" to identify resistance strategies using the LLM."},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":468,"column":69,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[25827,25898],"text":"Select \"Analyze Trace&quot; to identify resistance strategies using the LLM."},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[25827,25898],"text":"Select \"Analyze Trace&ldquo; to identify resistance strategies using the LLM."},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[25827,25898],"text":"Select \"Analyze Trace&#34; to identify resistance strategies using the LLM."},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[25827,25898],"text":"Select \"Analyze Trace&rdquo; to identify resistance strategies using the LLM."},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":10,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState } from \"react\";\r\nimport { toast } from \"sonner\";\r\nimport { useServerStorage } from \"@/hooks/useServerStorage\";\r\nimport { useSources } from \"@/hooks/useSources\";\r\nimport { Source } from \"@/types\";\r\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Zap, EyeOff, Activity, Wrench, Users, Play, Loader2, Quote, Search, Trash } from \"lucide-react\";\r\nimport {\r\n    Dialog,\r\n    DialogContent,\r\n    DialogDescription,\r\n    DialogFooter,\r\n    DialogHeader,\r\n    DialogTitle,\r\n    DialogTrigger,\r\n} from \"@/components/ui/dialog\";\r\n\r\nconst STRATEGY_DEFINITIONS = [\r\n    { title: \"Gambiarra\", icon: Wrench, color: \"text-orange-600\", bg: \"bg-orange-100\" },\r\n    { title: \"Obfuscation\", icon: EyeOff, color: \"text-slate-600\", bg: \"bg-slate-100\" },\r\n    { title: \"Solidarity\", icon: Users, color: \"text-green-600\", bg: \"bg-green-100\" },\r\n    { title: \"Refusal\", icon: Zap, color: \"text-red-600\", bg: \"bg-red-100\" },\r\n];\r\n\r\nexport default function ResistancePage() {\r\n    const { sources, addSource, updateSource, deleteSource, isLoading } = useSources();\r\n    const [selectedTraceId, setSelectedTraceId] = useServerStorage<string | null>(\"resistance_selected_trace_id\", null);\r\n    const [isAnalyzing, setIsAnalyzing] = useState(false);\r\n\r\n    // Filter for sources that are explicitly marked as 'Trace' or have text content\r\n    const traces = sources.filter(s => s.type === 'Trace' || (s.type === 'Text' && s.extractedText));\r\n\r\n    const handleAnalyzeTrace = async (trace: Source) => {\r\n        if (!trace.extractedText) return;\r\n\r\n        setIsAnalyzing(true);\r\n        try {\r\n            const headers: HeadersInit = { 'Content-Type': 'application/json' };\r\n            if (process.env.NEXT_PUBLIC_ENABLE_DEMO_MODE === 'true' && process.env.NEXT_PUBLIC_DEMO_USER_ID) {\r\n                headers['x-demo-user-id'] = process.env.NEXT_PUBLIC_DEMO_USER_ID;\r\n            }\r\n\r\n            const response = await fetch('/api/analyze', {\r\n                method: 'POST',\r\n                headers: headers,\r\n                body: JSON.stringify({\r\n                    text: trace.extractedText.substring(0, 3000),\r\n                    sourceType: 'Empirical Trace',\r\n                    analysisMode: 'resistance'\r\n                })\r\n            });\r\n\r\n            const result = await response.json();\r\n            if (result.success) {\r\n                await updateSource(trace.id, { resistance_analysis: result.analysis });\r\n                toast.success(\"Trace analyzed successfully!\");\r\n            } else {\r\n                if (response.status === 429 || result.error === \"Quota Exceeded\") {\r\n                    toast.error(\"Quota Exceeded\", {\r\n                        description: \"You have reached your lifetime API limit. Please contact admin.\",\r\n                        duration: 5000,\r\n                    });\r\n                } else {\r\n                    toast.error(\"Analysis failed\", { description: result.error });\r\n                }\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Analysis failed\", error);\r\n            toast.error(\"Failed to analyze trace.\");\r\n        } finally {\r\n            setIsAnalyzing(false);\r\n        }\r\n    };\r\n\r\n    const selectedTrace = traces.find(t => t.id === selectedTraceId);\r\n    const currentAnalysis = selectedTrace?.resistance_analysis;\r\n\r\n    const [isSearching, setIsSearching] = useState(false);\r\n    const [isSearchDialogOpen, setIsSearchDialogOpen] = useState(false);\r\n    const [searchSource, setSearchSource] = useState<Source | null>(null);\r\n    const [customQuery, setCustomQuery] = useServerStorage<string>(\"resistance_custom_query\", \"\");\r\n    const [selectedPlatforms, setSelectedPlatforms] = useServerStorage<string[]>(\"resistance_selected_platforms\", [\"reddit\", \"hackernews\", \"forums\"]);\r\n\r\n    const handleSearchTraces = async () => {\r\n        // Need either a policy source or custom query\r\n        if (!searchSource?.extractedText && !customQuery.trim()) {\r\n            alert(\"Please select a policy or enter a custom search query.\");\r\n            return;\r\n        }\r\n\r\n        setIsSearching(true);\r\n        try {\r\n            const headers: HeadersInit = { 'Content-Type': 'application/json' };\r\n            if (process.env.NEXT_PUBLIC_ENABLE_DEMO_MODE === 'true' && process.env.NEXT_PUBLIC_DEMO_USER_ID) {\r\n                headers['x-demo-user-id'] = process.env.NEXT_PUBLIC_DEMO_USER_ID;\r\n            }\r\n\r\n            const response = await fetch('/api/search-traces', {\r\n                method: 'POST',\r\n                headers: headers,\r\n                body: JSON.stringify({\r\n                    policyText: searchSource?.extractedText?.substring(0, 3000),\r\n                    customQuery: customQuery.trim() || undefined,\r\n                    platforms: selectedPlatforms\r\n                })\r\n            });\r\n\r\n            const result = await response.json();\r\n            if (result.success && Array.isArray(result.traces)) {\r\n                const newTraces = result.traces.map((trace: { title: string; description: string; query: string; content: string; sourceUrl: string }) => ({\r\n                    id: Math.random().toString(36).substr(2, 9),\r\n                    title: `[Web] ${trace.title}`,\r\n                    description: `${trace.description} • Query: \"${trace.query}\"`,\r\n                    type: \"Trace\",\r\n                    extractedText: `${trace.content}\\n\\nSource: ${trace.sourceUrl}`,\r\n                    addedDate: new Date().toLocaleDateString(\"en-US\", { month: \"short\", day: \"numeric\", year: \"numeric\" }),\r\n                    status: \"Active Case\",\r\n                    colorClass: \"bg-blue-100\",\r\n                    iconClass: \"text-blue-600\"\r\n                }));\r\n\r\n                // Add each new trace to the store\r\n                for (const trace of newTraces) {\r\n                    await addSource(trace);\r\n                }\r\n\r\n                toast.success(`Found ${newTraces.length} resistance traces from the web!`);\r\n                setCustomQuery(\"\"); // Reset query\r\n            } else {\r\n                if (response.status === 429 || result.error === \"Quota Exceeded\") {\r\n                    toast.error(\"Quota Exceeded\", {\r\n                        description: \"You have reached your lifetime API limit. Please contact admin.\",\r\n                        duration: 5000,\r\n                    });\r\n                } else {\r\n                    toast.error(\"Search failed\", { description: result.error || \"Unknown error\" });\r\n                }\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Search error:\", error);\r\n            toast.error(\"Failed to search for traces\", { description: \"Make sure your Google Search API is configured.\" });\r\n        } finally {\r\n            setIsSearching(false);\r\n            setIsSearchDialogOpen(false);\r\n        }\r\n    };\r\n\r\n    const handleDeleteTrace = async (traceId: string) => {\r\n        if (confirm(`Are you sure you want to delete this trace?`)) {\r\n            await deleteSource(traceId);\r\n            if (selectedTraceId === traceId) {\r\n                setSelectedTraceId(null);\r\n            }\r\n        }\r\n    };\r\n\r\n    const [isSynthesizing, setIsSynthesizing] = useState(false);\r\n    const [synthesisResult, setSynthesisResult] = useState<any>(null);\r\n\r\n    const handleSynthesizeFindings = async () => {\r\n        const analyzedTraces = traces.filter(t => t.resistance_analysis);\r\n        if (analyzedTraces.length < 2) {\r\n            toast.error(\"Not enough data\", { description: \"Please analyze at least 2 traces before synthesizing.\" });\r\n            return;\r\n        }\r\n\r\n        setIsSynthesizing(true);\r\n        try {\r\n            const headers: HeadersInit = { 'Content-Type': 'application/json' };\r\n            if (process.env.NEXT_PUBLIC_ENABLE_DEMO_MODE === 'true' && process.env.NEXT_PUBLIC_DEMO_USER_ID) {\r\n                headers['x-demo-user-id'] = process.env.NEXT_PUBLIC_DEMO_USER_ID;\r\n            }\r\n\r\n            const response = await fetch('/api/analyze', {\r\n                method: 'POST',\r\n                headers: headers,\r\n                body: JSON.stringify({\r\n                    analysisMode: 'resistance_synthesis',\r\n                    documents: analyzedTraces.map(t => ({\r\n                        title: t.title,\r\n                        content: t.extractedText,\r\n                        analysis: t.resistance_analysis\r\n                    }))\r\n                })\r\n            });\r\n\r\n            const result = await response.json();\r\n            if (result.success) {\r\n                setSynthesisResult(result.analysis);\r\n                toast.success(\"Synthesis complete!\");\r\n            } else {\r\n                toast.error(\"Synthesis failed\", { description: result.error });\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Synthesis error:\", error);\r\n            toast.error(\"Failed to synthesize findings.\");\r\n        } finally {\r\n            setIsSynthesizing(false);\r\n        }\r\n    };\r\n\r\n    if (isLoading) {\r\n        return (\r\n            <div className=\"flex items-center justify-center h-64\">\r\n                <Loader2 className=\"h-8 w-8 animate-spin text-slate-400\" />\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"space-y-8\">\r\n            <div className=\"flex items-center justify-between\">\r\n                <div>\r\n                    <h2 className=\"text-3xl font-bold tracking-tight text-slate-900\">Micro-Resistance Grounding</h2>\r\n                    <p className=\"text-slate-500\">Analyze empirical traces (forum posts, comments) to identify real-world resistance strategies.</p>\r\n                </div>\r\n                <div className=\"flex gap-2\">\r\n                    <Button\r\n                        variant=\"outline\"\r\n                        onClick={handleSynthesizeFindings}\r\n                        disabled={isSynthesizing || traces.filter(t => t.resistance_analysis).length < 2}\r\n                        className=\"border-purple-200 hover:bg-purple-50 text-purple-700\"\r\n                    >\r\n                        {isSynthesizing ? <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" /> : <Activity className=\"mr-2 h-4 w-4\" />}\r\n                        Synthesize Findings\r\n                    </Button>\r\n                    <Dialog open={isSearchDialogOpen} onOpenChange={setIsSearchDialogOpen}>\r\n                        <DialogTrigger asChild>\r\n                            <Button className=\"bg-blue-600 text-white hover:bg-blue-700\">\r\n                                <Search className=\"mr-2 h-4 w-4\" /> Search for Traces\r\n                            </Button>\r\n                        </DialogTrigger>\r\n                        <DialogContent className=\"sm:max-w-[600px]\">\r\n                            <DialogHeader>\r\n                                <DialogTitle>Search Web for Resistance Traces</DialogTitle>\r\n                                <DialogDescription>\r\n                                    Find real forum posts, Reddit threads, and discussions about resistance to AI policies.\r\n                                </DialogDescription>\r\n                            </DialogHeader>\r\n                            <div className=\"space-y-4 py-4\">\r\n                                <div>\r\n                                    <label className=\"text-sm font-medium text-slate-700 mb-2 block\">\r\n                                        Auto-extract from Policy (Optional)\r\n                                    </label>\r\n                                    <select\r\n                                        className=\"w-full p-2 border rounded-md text-sm\"\r\n                                        onChange={(e) => {\r\n                                            const source = sources.find(s => s.id === e.target.value);\r\n                                            setSearchSource(source || null);\r\n                                        }}\r\n                                    >\r\n                                        <option value=\"\">Select Policy...</option>\r\n                                        {sources.filter(s => s.type === 'PDF').map(s => (\r\n                                            <option key={s.id} value={s.id}>{s.title}</option>\r\n                                        ))}\r\n                                    </select>\r\n                                    <p className=\"text-xs text-slate-500 mt-1\">AI will extract key terms to search for</p>\r\n                                </div>\r\n\r\n                                <div className=\"relative\">\r\n                                    <div className=\"absolute inset-0 flex items-center\">\r\n                                        <span className=\"w-full border-t\" />\r\n                                    </div>\r\n                                    <div className=\"relative flex justify-center text-xs uppercase\">\r\n                                        <span className=\"bg-white px-2 text-slate-500\">Or</span>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"grid grid-cols-2 gap-2\">\r\n                                    {[\r\n                                        { id: 'reddit', label: 'Reddit' },\r\n                                        { id: 'hackernews', label: 'Hacker News' },\r\n                                        { id: 'forums', label: 'Forums' },\r\n                                        { id: 'twitter', label: 'Twitter/X' },\r\n                                        { id: 'technews', label: 'Tech News' },\r\n                                        { id: 'mastodon', label: 'Mastodon' }\r\n                                    ].map(platform => (\r\n                                        <label key={platform.id} className=\"flex items-center gap-2 cursor-pointer\">\r\n                                            <input\r\n                                                type=\"checkbox\"\r\n                                                checked={selectedPlatforms.includes(platform.id)}\r\n                                                onChange={(e) => {\r\n                                                    if (e.target.checked) {\r\n                                                        setSelectedPlatforms([...selectedPlatforms, platform.id]);\r\n                                                    } else {\r\n                                                        setSelectedPlatforms(selectedPlatforms.filter(p => p !== platform.id));\r\n                                                    }\r\n                                                }}\r\n                                                className=\"rounded\"\r\n                                            />\r\n                                            <span className=\"text-sm\">{platform.label}</span>\r\n                                        </label>\r\n                                    ))}\r\n                                </div>\r\n                            </div>\r\n\r\n                            <DialogFooter>\r\n                                <Button\r\n                                    onClick={handleSearchTraces}\r\n                                    disabled={(!searchSource && !customQuery.trim()) || isSearching}\r\n                                    className=\"bg-blue-600 hover:bg-blue-700\"\r\n                                >\r\n                                    {isSearching ? (\r\n                                        <>\r\n                                            <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\r\n                                            Searching Web...\r\n                                        </>\r\n                                    ) : (\r\n                                        <>\r\n                                            <Search className=\"mr-2 h-4 w-4\" />\r\n                                            Search\r\n                                        </>\r\n                                    )}\r\n                                </Button>\r\n                            </DialogFooter>\r\n                        </DialogContent>\r\n                    </Dialog>\r\n                </div>\r\n            </div>\r\n\r\n            {synthesisResult && (\r\n                <Card className=\"bg-purple-50 border-purple-200\">\r\n                    <CardHeader>\r\n                        <CardTitle className=\"text-purple-900 flex items-center\">\r\n                            <Activity className=\"mr-2 h-5 w-5\" /> Synthesis of Findings\r\n                        </CardTitle>\r\n                    </CardHeader>\r\n                    <CardContent className=\"space-y-4\">\r\n                        <div>\r\n                            <h4 className=\"font-semibold text-purple-900 mb-1\">Executive Summary</h4>\r\n                            <p className=\"text-purple-800 text-sm leading-relaxed\">{synthesisResult.executive_summary}</p>\r\n                        </div>\r\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                            <div>\r\n                                <h4 className=\"font-semibold text-purple-900 mb-2\">Dominant Strategies</h4>\r\n                                <ul className=\"space-y-2\">\r\n                                    {synthesisResult.dominant_strategies?.map((s: any, i: number) => (\r\n                                        <li key={i} className=\"text-sm bg-white p-2 rounded border border-purple-100\">\r\n                                            <span className=\"font-bold text-purple-700\">{s.strategy}</span> ({s.frequency}): {s.description}\r\n                                        </li>\r\n                                    ))}\r\n                                </ul>\r\n                            </div>\r\n                            <div>\r\n                                <h4 className=\"font-semibold text-purple-900 mb-2\">Emerging Themes</h4>\r\n                                <ul className=\"list-disc list-inside text-sm text-purple-800 space-y-1\">\r\n                                    {synthesisResult.emerging_themes?.map((t: string, i: number) => (\r\n                                        <li key={i}>{t}</li>\r\n                                    ))}\r\n                                </ul>\r\n                            </div>\r\n                        </div>\r\n                        <div>\r\n                            <h4 className=\"font-semibold text-purple-900 mb-1\">Policy Implications</h4>\r\n                            <p className=\"text-purple-800 text-sm\">{synthesisResult.implications_for_policy}</p>\r\n                        </div>\r\n                    </CardContent>\r\n                </Card>\r\n            )}\r\n\r\n            <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\r\n                {/* Left Column: Trace Selector */}\r\n                <div className=\"space-y-4\">\r\n                    <h3 className=\"font-semibold text-slate-900 flex items-center\">\r\n                        <Activity className=\"mr-2 h-4 w-4\" /> Available Traces\r\n                    </h3>\r\n                    <div className=\"space-y-2\">\r\n                        {traces.length === 0 && (\r\n                            <Card className=\"bg-slate-50 border-dashed\">\r\n                                <CardContent className=\"p-4 text-center text-sm text-slate-500\">\r\n                                    No traces found. Go to Data page to add \"Empirical Trace\" sources or use \"Search for Traces\".\r\n                                </CardContent>\r\n                            </Card>\r\n                        )}\r\n                        {traces.map(trace => (\r\n                            <Card\r\n                                key={trace.id}\r\n                                className={`transition-all hover:border-purple-400 ${selectedTraceId === trace.id ? 'border-purple-600 ring-1 ring-purple-600' : ''}`}\r\n                            >\r\n                                <CardContent className=\"p-4\">\r\n                                    <div className=\"flex items-start justify-between gap-2\">\r\n                                        <div\r\n                                            className=\"flex-1 min-w-0 pr-2 cursor-pointer\"\r\n                                            onClick={() => setSelectedTraceId(trace.id)}\r\n                                        >\r\n                                            <div className=\"font-medium text-slate-900 break-words\">{trace.title}</div>\r\n                                            <div className=\"text-xs text-slate-500 mt-1 break-words\">{trace.description}</div>\r\n                                            {trace.resistance_analysis && (\r\n                                                <Badge variant=\"secondary\" className=\"mt-2 bg-green-100 text-green-700\">\r\n                                                    Analyzed\r\n                                                </Badge>\r\n                                            )}\r\n                                        </div>\r\n                                        <Button\r\n                                            variant=\"ghost\"\r\n                                            size=\"sm\"\r\n                                            className=\"shrink-0 h-8 w-8 p-0 hover:bg-red-100 hover:text-red-600\"\r\n                                            onClick={(e) => {\r\n                                                e.stopPropagation();\r\n                                                handleDeleteTrace(trace.id);\r\n                                            }}\r\n                                        >\r\n                                            <Trash className=\"h-4 w-4\" />\r\n                                        </Button>\r\n                                    </div>\r\n                                </CardContent>\r\n                            </Card>\r\n                        ))}\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Middle Column: Analysis Area */}\r\n                <div className=\"lg:col-span-2 space-y-6\">\r\n                    {selectedTrace ? (\r\n                        <div className=\"space-y-6\">\r\n                            <Card>\r\n                                <CardHeader>\r\n                                    <CardTitle className=\"flex justify-between items-center\">\r\n                                        <span>Analysis: {selectedTrace.title}</span>\r\n                                        {!currentAnalysis && (\r\n                                            <Button\r\n                                                onClick={() => handleAnalyzeTrace(selectedTrace)}\r\n                                                disabled={isAnalyzing}\r\n                                                className=\"bg-purple-600 hover:bg-purple-700\"\r\n                                            >\r\n                                                {isAnalyzing ? <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" /> : <Play className=\"mr-2 h-4 w-4\" />}\r\n                                                Analyze Trace\r\n                                            </Button>\r\n                                        )}\r\n                                    </CardTitle>\r\n                                </CardHeader>\r\n                                <CardContent>\r\n                                    {currentAnalysis ? (\r\n                                        <div className=\"space-y-6\">\r\n                                            <div className=\"flex items-center space-x-4\">\r\n                                                <div className=\"p-3 bg-purple-100 rounded-full\">\r\n                                                    <Zap className=\"h-6 w-6 text-purple-600\" />\r\n                                                </div>\r\n                                                <div>\r\n                                                    <div className=\"text-sm text-slate-500 uppercase tracking-wider font-bold\">Strategy Detected</div>\r\n                                                    <div className=\"text-2xl font-bold text-slate-900\">{currentAnalysis.strategy_detected}</div>\r\n                                                </div>\r\n                                                <Badge className={currentAnalysis.confidence === 'High' ? 'bg-green-100 text-green-800' : 'bg-yellow-100 text-yellow-800'}>\r\n                                                    {currentAnalysis.confidence} Confidence\r\n                                                </Badge>\r\n                                            </div>\r\n\r\n                                            <div className=\"bg-slate-50 p-4 rounded-lg border border-slate-200 relative\">\r\n                                                <Quote className=\"absolute top-2 left-2 h-8 w-8 text-slate-200 -z-0\" />\r\n                                                <p className=\"text-slate-700 italic relative z-10 pl-6\">\r\n                                                    \"{currentAnalysis.evidence_quote}\"\r\n                                                </p>\r\n                                            </div>\r\n\r\n                                            <div>\r\n                                                <h4 className=\"font-semibold text-slate-900 mb-2\">Interpretation</h4>\r\n                                                <p className=\"text-slate-600 leading-relaxed\">\r\n                                                    {currentAnalysis.interpretation}\r\n                                                </p>\r\n                                            </div>\r\n                                        </div>\r\n                                    ) : (\r\n                                        <div className=\"text-center py-12 text-slate-500\">\r\n                                            <p>Select \"Analyze Trace\" to identify resistance strategies using the LLM.</p>\r\n                                        </div>\r\n                                    )}\r\n                                </CardContent>\r\n                            </Card>\r\n\r\n                            {/* Reference Definitions */}\r\n                            <div className=\"grid grid-cols-2 gap-4\">\r\n                                {STRATEGY_DEFINITIONS.map(def => (\r\n                                    <div key={def.title} className=\"flex items-center space-x-3 p-3 bg-white rounded-lg border border-slate-100 shadow-sm\">\r\n                                        <div className={`p-2 rounded-full ${def.bg}`}>\r\n                                            <def.icon className={`h-4 w-4 ${def.color}`} />\r\n                                        </div>\r\n                                        <span className=\"font-medium text-slate-700\">{def.title}</span>\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n                    ) : (\r\n                        <div className=\"flex flex-col items-center justify-center h-64 bg-slate-50 rounded-lg border-2 border-dashed border-slate-200\">\r\n                            <Activity className=\"h-10 w-10 text-slate-300 mb-4\" />\r\n                            <p className=\"text-slate-500\">Select a trace from the left to begin analysis</p>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </div>\r\n        </div >\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\sign-up\\[[...sign-up]]\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\synthesis\\page.tsx","messages":[{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":485,"column":103,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[30044,30199],"text":" To see AI-generated synthesis results, use the &quot;AI-Powered Framework Comparison\" tool above to compare two policy documents.\r\n                            "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[30044,30199],"text":" To see AI-generated synthesis results, use the &ldquo;AI-Powered Framework Comparison\" tool above to compare two policy documents.\r\n                            "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[30044,30199],"text":" To see AI-generated synthesis results, use the &#34;AI-Powered Framework Comparison\" tool above to compare two policy documents.\r\n                            "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[30044,30199],"text":" To see AI-generated synthesis results, use the &rdquo;AI-Powered Framework Comparison\" tool above to compare two policy documents.\r\n                            "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":485,"column":135,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[30044,30199],"text":" To see AI-generated synthesis results, use the \"AI-Powered Framework Comparison&quot; tool above to compare two policy documents.\r\n                            "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[30044,30199],"text":" To see AI-generated synthesis results, use the \"AI-Powered Framework Comparison&ldquo; tool above to compare two policy documents.\r\n                            "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[30044,30199],"text":" To see AI-generated synthesis results, use the \"AI-Powered Framework Comparison&#34; tool above to compare two policy documents.\r\n                            "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[30044,30199],"text":" To see AI-generated synthesis results, use the \"AI-Powered Framework Comparison&rdquo; tool above to compare two policy documents.\r\n                            "},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState } from \"react\";\r\nimport { useSources } from \"@/hooks/useSources\";\r\nimport { useServerStorage } from \"@/hooks/useServerStorage\";\r\nimport { Source } from \"@/types\";\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { GitMerge, GitPullRequest, AlertCircle, FileDown, CheckCircle2, Sparkles, Brain, Network, Loader2, RefreshCw } from \"lucide-react\";\r\nimport { generateSynthesisPDF } from \"@/utils/generateSynthesisPDF\";\r\nimport { AssemblageSankey } from \"@/components/AssemblageSankey\";\r\nimport { Radar, RadarChart, PolarGrid, PolarAngleAxis, PolarRadiusAxis, ResponsiveContainer, Legend, Tooltip, BarChart, Bar, XAxis, YAxis, CartesianGrid } from \"recharts\";\r\nimport { Info } from \"lucide-react\";\r\n\r\ninterface ComparisonResult {\r\n    risk: { convergence: string; divergence: string; coloniality: string; resistance: string; convergence_score?: number; coloniality_score?: number };\r\n    governance: { convergence: string; divergence: string; coloniality: string; resistance: string; convergence_score?: number; coloniality_score?: number };\r\n    rights: { convergence: string; divergence: string; coloniality: string; resistance: string; convergence_score?: number; coloniality_score?: number };\r\n    scope: { convergence: string; divergence: string; coloniality: string; resistance: string; convergence_score?: number; coloniality_score?: number };\r\n}\r\n\r\nimport { EcosystemImpact } from \"@/types\";\r\n\r\nconst SYNTHESIS_FINDINGS = [\r\n    {\r\n        key: \"risk\",\r\n        dimension: \"Risk Classification\",\r\n        convergence: \"Comparison of risk definitions and tiered obligations across frameworks.\",\r\n        divergence: \"Analysis of how risk categories are adapted to local social and political contexts.\",\r\n        coloniality: \"Examination of whether risk models reflect Global North assumptions or local realities.\",\r\n        resistance: \"Identification of mechanisms that allow for local adaptation of risk frameworks.\",\r\n        icon: AlertCircle,\r\n    },\r\n    {\r\n        key: \"governance\",\r\n        dimension: \"Governance Structure\",\r\n        convergence: \"Comparison of institutional designs (e.g., centralized vs. networked authorities).\",\r\n        divergence: \"Analysis of enforcement powers and coordination mechanisms.\",\r\n        coloniality: \"Assessment of whether governance models assume state capacities that may not exist.\",\r\n        resistance: \"Highlighting of innovative governance structures that leverage local expertise.\",\r\n        icon: GitMerge,\r\n    },\r\n    {\r\n        key: \"rights\",\r\n        dimension: \"Rights Framework\",\r\n        convergence: \"Comparison of individual rights (e.g., explanation, redress) and collective protections.\",\r\n        divergence: \"Analysis of the balance between procedural compliance and substantive rights.\",\r\n        coloniality: \"Examination of whether rights frameworks obscure underlying power asymmetries.\",\r\n        resistance: \"Identification of rights-based approaches that empower affected communities.\",\r\n        icon: CheckCircle2,\r\n    },\r\n    {\r\n        key: \"scope\",\r\n        dimension: \"Territorial Scope\",\r\n        convergence: \"Comparison of jurisdictional reach and extraterritorial application.\",\r\n        divergence: \"Analysis of data sovereignty claims and market power dynamics.\",\r\n        coloniality: \"Assessment of the 'Brussels Effect' and the imposition of external legal norms.\",\r\n        resistance: \"Highlighting of assertions of epistemic and legal autonomy.\",\r\n        icon: GitPullRequest,\r\n    },\r\n];\r\n\r\nexport default function SynthesisPage() {\r\n    const { sources, isLoading } = useSources();\r\n    const [isExporting, setIsExporting] = useState(false);\r\n\r\n    // Comparison State\r\n    const [sourceA, setSourceA] = useState<Source | null>(null);\r\n    const [sourceB, setSourceB] = useState<Source | null>(null);\r\n    const [isComparing, setIsComparing] = useState(false);\r\n    const [comparisonResult, setComparisonResult] = useServerStorage<ComparisonResult | null>(\"synthesis_comparison_result\", null);\r\n\r\n    // Ecosystem State\r\n    const [ecosystemSource, setEcosystemSource] = useState<Source | null>(null);\r\n    const [isMapping, setIsMapping] = useState(false);\r\n    const [ecosystemImpacts, setEcosystemImpacts] = useState<EcosystemImpact[]>([]);\r\n    const [interconnectionFilter, setInterconnectionFilter] = useState<\"All\" | \"Material\" | \"Discursive\" | \"Hybrid\">(\"All\");\r\n    const [viewMode, setViewMode] = useState<\"list\" | \"graph\">(\"list\");\r\n    const [chartView, setChartView] = useState<\"radar\" | \"bar\">(\"radar\");\r\n    const [showGuide, setShowGuide] = useState(true);\r\n\r\n    // Filter sources that have text available for analysis\r\n    const analyzedSources = sources.filter(s => s.analysis || s.extractedText);\r\n\r\n    const handleExport = () => {\r\n        if (!comparisonResult) {\r\n            alert(\"Please run a comparison first to generate a report.\");\r\n            return;\r\n        }\r\n\r\n        setIsExporting(true);\r\n        try {\r\n            // Transform comparisonResult into the format expected by generateSynthesisPDF\r\n            const findings = Object.entries(comparisonResult).map(([key, value]) => {\r\n                const typedValue = value as ComparisonResult[\"risk\"]; // All keys have same structure\r\n                const findingDef = SYNTHESIS_FINDINGS.find(f => f.key === key);\r\n                return {\r\n                    dimension: findingDef?.dimension || key,\r\n                    convergence: typedValue.convergence,\r\n                    divergence: typedValue.divergence,\r\n                    coloniality: typedValue.coloniality,\r\n                    resistance: typedValue.resistance\r\n                };\r\n            });\r\n\r\n            generateSynthesisPDF(findings);\r\n        } catch (error) {\r\n            console.error(\"Error generating PDF:\", error);\r\n            alert(\"Failed to generate PDF. Please try again.\");\r\n        } finally {\r\n            setTimeout(() => setIsExporting(false), 1000);\r\n        }\r\n    };\r\n\r\n    const handleCompare = async (forceRefresh = false) => {\r\n        if (!sourceA || !sourceB) return;\r\n\r\n        setIsComparing(true);\r\n        // setComparisonResult(null); // Keep previous result while loading so button stays visible\r\n\r\n        try {\r\n            const headers: HeadersInit = { 'Content-Type': 'application/json' };\r\n            if (process.env.NEXT_PUBLIC_ENABLE_DEMO_MODE === 'true' && process.env.NEXT_PUBLIC_DEMO_USER_ID) {\r\n                headers['x-demo-user-id'] = process.env.NEXT_PUBLIC_DEMO_USER_ID;\r\n            }\r\n\r\n            const response = await fetch('/api/analyze', {\r\n                method: 'POST',\r\n                headers: headers,\r\n                body: JSON.stringify({\r\n                    analysisMode: 'comparison',\r\n                    sourceA: { title: sourceA.title, text: sourceA.extractedText?.substring(0, 50000) || '' },\r\n                    sourceB: { title: sourceB.title, text: sourceB.extractedText?.substring(0, 50000) || '' },\r\n                    force: forceRefresh\r\n                })\r\n            });\r\n\r\n            const data = await response.json();\r\n            if (data.success && data.analysis) {\r\n                setComparisonResult(data.analysis);\r\n            } else {\r\n                alert(\"Comparison failed: \" + (data.error || \"Unknown error\"));\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Comparison error:\", error);\r\n            alert(\"Failed to generate comparison.\");\r\n        } finally {\r\n            setIsComparing(false);\r\n        }\r\n    };\r\n\r\n    const handleEcosystemMap = async () => {\r\n        if (!ecosystemSource) return;\r\n\r\n        setIsMapping(true);\r\n        try {\r\n            const headers: HeadersInit = { 'Content-Type': 'application/json' };\r\n            if (process.env.NEXT_PUBLIC_ENABLE_DEMO_MODE === 'true' && process.env.NEXT_PUBLIC_DEMO_USER_ID) {\r\n                headers['x-demo-user-id'] = process.env.NEXT_PUBLIC_DEMO_USER_ID;\r\n            }\r\n\r\n            const response = await fetch('/api/analyze', {\r\n                method: 'POST',\r\n                headers: headers,\r\n                body: JSON.stringify({\r\n                    text: ecosystemSource.extractedText?.substring(0, 30000) || '',\r\n                    sourceType: 'Policy Document',\r\n                    analysisMode: 'ecosystem'\r\n                })\r\n            });\r\n\r\n            const data = await response.json();\r\n            if (data.success && Array.isArray(data.analysis)) {\r\n                setEcosystemImpacts(data.analysis);\r\n            } else {\r\n                alert(\"Mapping failed: \" + (data.error || \"Unknown error\"));\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Mapping error:\", error);\r\n            alert(\"Failed to generate ecosystem map.\");\r\n        } finally {\r\n            setIsMapping(false);\r\n        }\r\n    };\r\n\r\n    if (isLoading) {\r\n        return (\r\n            <div className=\"flex items-center justify-center h-64\">\r\n                <Loader2 className=\"h-8 w-8 animate-spin text-slate-400\" />\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"space-y-8\">\r\n            <div className=\"flex items-center justify-between\">\r\n                <div>\r\n                    <h2 className=\"text-3xl font-bold tracking-tight text-slate-900\">Cross-Case Analysis</h2>\r\n                    <p className=\"text-slate-500\">Comparative analysis of AI governance frameworks using the Decolonial Situatedness Framework.</p>\r\n                </div>\r\n                <Button\r\n                    onClick={handleExport}\r\n                    className=\"bg-slate-900 text-white hover:bg-slate-800\"\r\n                    disabled={isExporting}\r\n                >\r\n                    <FileDown className=\"mr-2 h-4 w-4\" />\r\n                    {isExporting ? \"Generating PDF...\" : \"Export Report\"}\r\n                </Button>\r\n            </div>\r\n\r\n            <Card className=\"bg-gradient-to-br from-slate-50 to-blue-50 border-slate-200\">\r\n                <CardHeader>\r\n                    <CardTitle>Executive Summary</CardTitle>\r\n                    <CardDescription>Key insights from the comparative analysis</CardDescription>\r\n                </CardHeader>\r\n                <CardContent className=\"space-y-3 text-sm text-slate-700 leading-relaxed\">\r\n                    <p>\r\n                        This synthesis compares AI governance frameworks to identify patterns of convergence, divergence, and coloniality. By applying the Decolonial Situatedness Framework, we analyze how different jurisdictions approach risk, governance, rights, and territorial scope.\r\n                    </p>\r\n                    <p>\r\n                        <strong>Convergence:</strong> Identification of shared regulatory mechanisms, definitions, and risk classifications across frameworks.\r\n                    </p>\r\n                    <p>\r\n                        <strong>Divergence:</strong> Analysis of distinct approaches to enforcement, rights protections, and institutional design that reflect local contexts.\r\n                    </p>\r\n                    <p>\r\n                        <strong>Colonial Patterns:</strong> Examination of potential legal transplants, extraterritorial effects, and the imposition of Global North epistemologies.\r\n                    </p>\r\n                    <p>\r\n                        <strong>Decolonial Potential:</strong> Highlighting opportunities for epistemic autonomy, local adaptation, and resistance to hegemonic norms.\r\n                    </p>\r\n                </CardContent>\r\n            </Card>\r\n\r\n            {/* AI-Powered Comparison */}\r\n            {analyzedSources.length >= 2 && (\r\n                <Card className=\"border-purple-200\">\r\n                    <CardHeader>\r\n                        <div className=\"flex items-center gap-2\">\r\n                            <Brain className=\"h-5 w-5 text-purple-600\" />\r\n                            <CardTitle>AI-Powered Framework Comparison</CardTitle>\r\n                        </div>\r\n                        <CardDescription>\r\n                            Compare two policy documents to identify convergence, divergence, and colonial patterns\r\n                        </CardDescription>\r\n                    </CardHeader>\r\n                    <CardContent className=\"space-y-4\">\r\n                        <div className=\"grid grid-cols-2 gap-4\">\r\n                            <div className=\"space-y-2\">\r\n                                <label className=\"text-sm font-medium text-slate-700\">Source A</label>\r\n                                <select\r\n                                    className=\"w-full p-2 border rounded-md text-sm\"\r\n                                    onChange={(e) => {\r\n                                        const source = analyzedSources.find(s => s.id === e.target.value);\r\n                                        setSourceA(source || null);\r\n                                    }}\r\n                                >\r\n                                    <option value=\"\">Select first document...</option>\r\n                                    {analyzedSources.map(s => (\r\n                                        <option key={s.id} value={s.id}>{s.title}</option>\r\n                                    ))}\r\n                                </select>\r\n                            </div>\r\n                            <div className=\"space-y-2\">\r\n                                <label className=\"text-sm font-medium text-slate-700\">Source B</label>\r\n                                <select\r\n                                    className=\"w-full p-2 border rounded-md text-sm\"\r\n                                    onChange={(e) => {\r\n                                        const source = analyzedSources.find(s => s.id === e.target.value);\r\n                                        setSourceB(source || null);\r\n                                    }}\r\n                                >\r\n                                    <option value=\"\">Select second document...</option>\r\n                                    {analyzedSources.map(s => (\r\n                                        <option key={s.id} value={s.id}>{s.title}</option>\r\n                                    ))}\r\n                                </select>\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"flex gap-2\">\r\n                            <Button\r\n                                onClick={() => handleCompare(false)}\r\n                                disabled={!sourceA || !sourceB || isComparing}\r\n                                className=\"w-full bg-slate-900 hover:bg-slate-800\"\r\n                            >\r\n                                {isComparing ? (\r\n                                    <>\r\n                                        <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\r\n                                        Analyzing...\r\n                                    </>\r\n                                ) : (\r\n                                    <>\r\n                                        <Sparkles className=\"mr-2 h-4 w-4\" />\r\n                                        Compare Frameworks\r\n                                    </>\r\n                                )}\r\n                            </Button>\r\n                            {comparisonResult && (\r\n                                <Button\r\n                                    onClick={() => handleCompare(true)}\r\n                                    disabled={isComparing}\r\n                                    variant=\"outline\"\r\n                                    title=\"Force Regenerate (Bypass Cache)\"\r\n                                >\r\n                                    <RefreshCw className={`mr-2 h-4 w-4 ${isComparing ? 'animate-spin' : ''}`} />\r\n                                    Regenerate\r\n                                </Button>\r\n                            )}\r\n                        </div>\r\n\r\n                        {comparisonResult && (\r\n                            <div className=\"mt-8 space-y-6 pt-4 border-t\">\r\n                                <div className=\"h-[450px] w-full\">\r\n                                    <h4 className=\"font-semibold text-slate-900 mb-2 text-center\">Shape of Divergence</h4>\r\n                                    <p className=\"text-xs text-center text-slate-500 mb-4\">\r\n                                        Comparing: <span className=\"font-medium text-slate-700\">{sourceA?.title}</span> vs <span className=\"font-medium text-slate-700\">{sourceB?.title}</span>\r\n                                    </p>\r\n\r\n                                    <div className=\"flex justify-center mb-4 space-x-2\">\r\n                                        <button\r\n                                            onClick={() => setChartView(\"radar\")}\r\n                                            className={`px-3 py-1 text-xs font-medium rounded-md transition-colors ${chartView === \"radar\"\r\n                                                ? \"bg-slate-900 text-white\"\r\n                                                : \"bg-slate-100 text-slate-600 hover:bg-slate-200\"\r\n                                                }`}\r\n                                        >\r\n                                            Radar View\r\n                                        </button>\r\n                                        <button\r\n                                            onClick={() => setChartView(\"bar\")}\r\n                                            className={`px-3 py-1 text-xs font-medium rounded-md transition-colors ${chartView === \"bar\"\r\n                                                ? \"bg-slate-900 text-white\"\r\n                                                : \"bg-slate-100 text-slate-600 hover:bg-slate-200\"\r\n                                                }`}\r\n                                        >\r\n                                            Bar View\r\n                                        </button>\r\n                                    </div>\r\n\r\n                                    {\r\n                                        showGuide && (\r\n                                            <div className=\"mb-6 mx-auto max-w-2xl bg-blue-50 border border-blue-100 rounded-lg p-3 relative\">\r\n                                                <button\r\n                                                    onClick={() => setShowGuide(false)}\r\n                                                    className=\"absolute top-2 right-2 text-blue-400 hover:text-blue-600\"\r\n                                                >\r\n                                                    ×\r\n                                                </button>\r\n                                                <div className=\"flex gap-3\">\r\n                                                    <Info className=\"h-5 w-5 text-blue-600 shrink-0\" />\r\n                                                    <div className=\"text-xs text-blue-900 space-y-1\">\r\n                                                        <p className=\"font-semibold\">How to read this chart:</p>\r\n                                                        <p><span className=\"font-bold text-blue-700\">Convergence (Blue):</span> How similar the frameworks are. High score = Very similar rules/definitions.</p>\r\n                                                        <p><span className=\"font-bold text-red-700\">Coloniality (Red):</span> Power imbalance. High score = One framework is imposing values on the other.</p>\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n                                        )\r\n                                    }\r\n\r\n                                    <ResponsiveContainer width=\"100%\" height={300}>\r\n                                        {chartView === \"radar\" ? (\r\n                                            <RadarChart cx=\"50%\" cy=\"50%\" outerRadius=\"80%\" data={[\r\n                                                { subject: 'Risk', A: comparisonResult.risk.convergence_score || 0, B: comparisonResult.risk.coloniality_score || 0, fullMark: 10 },\r\n                                                { subject: 'Governance', A: comparisonResult.governance.convergence_score || 0, B: comparisonResult.governance.coloniality_score || 0, fullMark: 10 },\r\n                                                { subject: 'Rights', A: comparisonResult.rights.convergence_score || 0, B: comparisonResult.rights.coloniality_score || 0, fullMark: 10 },\r\n                                                { subject: 'Scope', A: comparisonResult.scope.convergence_score || 0, B: comparisonResult.scope.coloniality_score || 0, fullMark: 10 },\r\n                                            ]}>\r\n                                                <PolarGrid />\r\n                                                <PolarAngleAxis dataKey=\"subject\" />\r\n                                                <PolarRadiusAxis angle={30} domain={[0, 10]} />\r\n                                                <Tooltip />\r\n                                                <Radar name=\"Convergence (Similarity)\" dataKey=\"A\" stroke=\"#2563eb\" fill=\"#2563eb\" fillOpacity={0.5} />\r\n                                                <Radar name=\"Coloniality (Power Imbalance)\" dataKey=\"B\" stroke=\"#dc2626\" fill=\"#dc2626\" fillOpacity={0.5} />\r\n                                                <Legend />\r\n                                            </RadarChart>\r\n                                        ) : (\r\n                                            <BarChart\r\n                                                data={[\r\n                                                    { subject: 'Risk', Convergence: comparisonResult.risk.convergence_score || 0, Coloniality: comparisonResult.risk.coloniality_score || 0 },\r\n                                                    { subject: 'Governance', Convergence: comparisonResult.governance.convergence_score || 0, Coloniality: comparisonResult.governance.coloniality_score || 0 },\r\n                                                    { subject: 'Rights', Convergence: comparisonResult.rights.convergence_score || 0, Coloniality: comparisonResult.rights.coloniality_score || 0 },\r\n                                                    { subject: 'Scope', Convergence: comparisonResult.scope.convergence_score || 0, Coloniality: comparisonResult.scope.coloniality_score || 0 },\r\n                                                ]}\r\n                                                margin={{ top: 20, right: 30, left: 20, bottom: 5 }}\r\n                                            >\r\n                                                <CartesianGrid strokeDasharray=\"3 3\" />\r\n                                                <XAxis dataKey=\"subject\" />\r\n                                                <YAxis domain={[0, 10]} />\r\n                                                <Tooltip />\r\n                                                <Legend />\r\n                                                <Bar dataKey=\"Convergence\" fill=\"#2563eb\" name=\"Convergence (Similarity)\" />\r\n                                                <Bar dataKey=\"Coloniality\" fill=\"#dc2626\" name=\"Coloniality (Power Imbalance)\" />\r\n                                            </BarChart>\r\n                                        )}\r\n                                    </ResponsiveContainer>\r\n                                    <p className=\"text-xs text-center text-slate-400 mt-4\">\r\n                                        Scale 0-10: Higher scores indicate stronger presence of the attribute.\r\n                                    </p>\r\n                                </div >\r\n\r\n                                <h4 className=\"font-semibold text-slate-900\">Detailed Findings</h4>\r\n                                {\r\n                                    Object.entries(comparisonResult).map(([key, value]) => {\r\n                                        const typedValue = value as ComparisonResult[\"risk\"];\r\n                                        return (\r\n                                            <div key={key} className=\"space-y-2\">\r\n                                                <p className=\"text-sm font-medium text-slate-700 capitalize\">{key}</p>\r\n                                                <div className=\"grid grid-cols-2 gap-2 text-xs\">\r\n                                                    <div className=\"p-2 bg-green-50 rounded border border-green-200\">\r\n                                                        <span className=\"font-semibold text-green-700\">Convergence:</span>\r\n                                                        <p className=\"text-slate-600 mt-1\">{typedValue.convergence}</p>\r\n                                                    </div>\r\n                                                    <div className=\"p-2 bg-blue-50 rounded border border-blue-200\">\r\n                                                        <span className=\"font-semibold text-blue-700\">Divergence:</span>\r\n                                                        <p className=\"text-slate-600 mt-1\">{typedValue.divergence}</p>\r\n                                                    </div>\r\n                                                    <div className=\"p-2 bg-red-50 rounded border border-red-200\">\r\n                                                        <span className=\"font-semibold text-red-700\">Coloniality:</span>\r\n                                                        <p className=\"text-slate-600 mt-1\">{typedValue.coloniality}</p>\r\n                                                    </div>\r\n                                                    <div className=\"p-2 bg-purple-50 rounded border border-purple-200\">\r\n                                                        <span className=\"font-semibold text-purple-700\">Resistance:</span>\r\n                                                        <p className=\"text-slate-600 mt-1\">{typedValue.resistance}</p>\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n                                        )\r\n                                    })\r\n                                }\r\n                            </div >\r\n                        )\r\n                        }\r\n                    </CardContent >\r\n                </Card >\r\n            )}\r\n\r\n            {/* Synthesis Matrix */}\r\n            <div>\r\n                <h3 className=\"text-xl font-semibold text-slate-900 mb-4\">Synthesis Framework</h3>\r\n\r\n                {comparisonResult ? (\r\n                    // Show AI-generated comparison results\r\n                    <div className=\"grid gap-4\">\r\n                        {Object.entries(comparisonResult).map(([key, value]) => {\r\n                            const typedValue = value as ComparisonResult[\"risk\"];\r\n                            const finding = SYNTHESIS_FINDINGS.find(f => f.key === key);\r\n                            const Icon = finding?.icon || AlertCircle;\r\n                            return (\r\n                                <Card key={key}>\r\n                                    <CardHeader>\r\n                                        <div className=\"flex items-center gap-2\">\r\n                                            <Icon className=\"h-5 w-5 text-slate-600\" />\r\n                                            <CardTitle>{finding?.dimension || key}</CardTitle>\r\n                                        </div>\r\n                                    </CardHeader>\r\n                                    <CardContent className=\"space-y-3\">\r\n                                        <div className=\"p-3 bg-green-50 rounded-lg border border-green-200\">\r\n                                            <p className=\"text-xs font-bold text-green-700 uppercase mb-1\">Convergence</p>\r\n                                            <p className=\"text-sm text-slate-700\">{typedValue.convergence}</p>\r\n                                        </div>\r\n                                        <div className=\"p-3 bg-blue-50 rounded-lg border border-blue-200\">\r\n                                            <p className=\"text-xs font-bold text-blue-700 uppercase mb-1\">Divergence</p>\r\n                                            <p className=\"text-sm text-slate-700\">{typedValue.divergence}</p>\r\n                                        </div>\r\n                                        <div className=\"p-3 bg-red-50 rounded-lg border border-red-200\">\r\n                                            <p className=\"text-xs font-bold text-red-700 uppercase mb-1\">Coloniality</p>\r\n                                            <p className=\"text-sm text-slate-700\">{typedValue.coloniality}</p>\r\n                                        </div>\r\n                                        <div className=\"p-3 bg-purple-50 rounded-lg border border-purple-200\">\r\n                                            <p className=\"text-xs font-bold text-purple-700 uppercase mb-1\">Resistance</p>\r\n                                            <p className=\"text-sm text-slate-700\">{typedValue.resistance}</p>\r\n                                        </div>\r\n                                    </CardContent>\r\n                                </Card>\r\n                            );\r\n                        })}\r\n                    </div>\r\n                ) : (\r\n                    // Show placeholder framework when no comparison is active\r\n                    <>\r\n                        <div className=\"mb-4 p-4 bg-blue-50 border border-blue-200 rounded-lg\">\r\n                            <p className=\"text-sm text-blue-900\">\r\n                                <strong>Note:</strong> To see AI-generated synthesis results, use the \"AI-Powered Framework Comparison\" tool above to compare two policy documents.\r\n                            </p>\r\n                        </div>\r\n                        <div className=\"grid gap-4\">\r\n                            {SYNTHESIS_FINDINGS.map((finding) => {\r\n                                const Icon = finding.icon;\r\n                                return (\r\n                                    <Card key={finding.key} className=\"opacity-60\">\r\n                                        <CardHeader>\r\n                                            <div className=\"flex items-center gap-2\">\r\n                                                <Icon className=\"h-5 w-5 text-slate-600\" />\r\n                                                <CardTitle>{finding.dimension}</CardTitle>\r\n                                            </div>\r\n                                        </CardHeader>\r\n                                        <CardContent className=\"space-y-3\">\r\n                                            <div className=\"p-3 bg-green-50 rounded-lg border border-green-200\">\r\n                                                <p className=\"text-xs font-bold text-green-700 uppercase mb-1\">Convergence</p>\r\n                                                <p className=\"text-sm text-slate-700\">{finding.convergence}</p>\r\n                                            </div>\r\n                                            <div className=\"p-3 bg-blue-50 rounded-lg border border-blue-200\">\r\n                                                <p className=\"text-xs font-bold text-blue-700 uppercase mb-1\">Divergence</p>\r\n                                                <p className=\"text-sm text-slate-700\">{finding.divergence}</p>\r\n                                            </div>\r\n                                            <div className=\"p-3 bg-red-50 rounded-lg border border-red-200\">\r\n                                                <p className=\"text-xs font-bold text-red-700 uppercase mb-1\">Coloniality</p>\r\n                                                <p className=\"text-sm text-slate-700\">{finding.coloniality}</p>\r\n                                            </div>\r\n                                            <div className=\"p-3 bg-purple-50 rounded-lg border border-purple-200\">\r\n                                                <p className=\"text-xs font-bold text-purple-700 uppercase mb-1\">Resistance</p>\r\n                                                <p className=\"text-sm text-slate-700\">{finding.resistance}</p>\r\n                                            </div>\r\n                                        </CardContent>\r\n                                    </Card>\r\n                                );\r\n                            })}\r\n                        </div>\r\n                    </>\r\n                )}\r\n            </div>\r\n\r\n            {/* Ecosystem Impact Mapping */}\r\n            {\r\n                analyzedSources.length > 0 && (\r\n                    <Card className=\"border-teal-200\">\r\n                        <CardHeader>\r\n                            <div className=\"flex items-center gap-2\">\r\n                                <Network className=\"h-5 w-5 text-teal-600\" />\r\n                                <CardTitle>Ecosystem Impact Mapping</CardTitle>\r\n                            </div>\r\n                            <CardDescription>\r\n                                Map how policy mechanisms constrain or afford possibilities for ecosystem actors\r\n                            </CardDescription>\r\n                        </CardHeader>\r\n                        <CardContent className=\"space-y-4\">\r\n                            <div className=\"flex gap-4 items-end\">\r\n                                <div className=\"flex-1 space-y-2\">\r\n                                    <label className=\"text-sm font-medium text-slate-700\">Select Policy Document</label>\r\n                                    <select\r\n                                        className=\"w-full p-2 border rounded-md text-sm\"\r\n                                        onChange={(e) => {\r\n                                            const source = analyzedSources.find(s => s.id === e.target.value);\r\n                                            setEcosystemSource(source || null);\r\n                                        }}\r\n                                    >\r\n                                        <option value=\"\">Select document...</option>\r\n                                        {analyzedSources.map(s => (\r\n                                            <option key={s.id} value={s.id}>{s.title}</option>\r\n                                        ))}\r\n                                    </select>\r\n                                </div>\r\n                                <Button\r\n                                    className=\"bg-teal-600 text-white hover:bg-teal-700\"\r\n                                    onClick={handleEcosystemMap}\r\n                                    disabled={!ecosystemSource || isMapping}\r\n                                >\r\n                                    {isMapping ? (\r\n                                        <>\r\n                                            <Sparkles className=\"mr-2 h-4 w-4 animate-spin\" />\r\n                                            Mapping...\r\n                                        </>\r\n                                    ) : (\r\n                                        <>\r\n                                            <Network className=\"mr-2 h-4 w-4\" />\r\n                                            Generate Map\r\n                                        </>\r\n                                    )}\r\n                                </Button>\r\n                            </div>\r\n\r\n                            {ecosystemImpacts.length > 0 && (\r\n                                <div className=\"mt-4 space-y-3 pt-4 border-t\">\r\n                                    <div className=\"flex items-center justify-between\">\r\n                                        <h4 className=\"font-semibold text-slate-900\">Ecosystem Impacts</h4>\r\n                                        <div className=\"flex gap-2\">\r\n                                            <div className=\"flex bg-slate-100 rounded-lg p-1 mr-4\">\r\n                                                <button\r\n                                                    onClick={() => setViewMode(\"list\")}\r\n                                                    className={`px-3 py-1 text-xs font-medium rounded-md transition-colors ${viewMode === \"list\"\r\n                                                        ? \"bg-white text-slate-900 shadow-sm\"\r\n                                                        : \"text-slate-500 hover:text-slate-900\"\r\n                                                        }`}\r\n                                                >\r\n                                                    List View\r\n                                                </button>\r\n                                                <button\r\n                                                    onClick={() => setViewMode(\"graph\")}\r\n                                                    className={`px-3 py-1 text-xs font-medium rounded-md transition-colors ${viewMode === \"graph\"\r\n                                                        ? \"bg-white text-slate-900 shadow-sm\"\r\n                                                        : \"text-slate-500 hover:text-slate-900\"\r\n                                                        }`}\r\n                                                >\r\n                                                    Graph View\r\n                                                </button>\r\n                                            </div>\r\n\r\n                                            <Button\r\n                                                variant={interconnectionFilter === \"All\" ? \"default\" : \"outline\"}\r\n                                                size=\"sm\"\r\n                                                onClick={() => setInterconnectionFilter(\"All\")}\r\n                                            >\r\n                                                All\r\n                                            </Button>\r\n                                            <Button\r\n                                                variant={interconnectionFilter === \"Material\" ? \"default\" : \"outline\"}\r\n                                                size=\"sm\"\r\n                                                onClick={() => setInterconnectionFilter(\"Material\")}\r\n                                            >\r\n                                                Material\r\n                                            </Button>\r\n                                            <Button\r\n                                                variant={interconnectionFilter === \"Discursive\" ? \"default\" : \"outline\"}\r\n                                                size=\"sm\"\r\n                                                onClick={() => setInterconnectionFilter(\"Discursive\")}\r\n                                            >\r\n                                                Discursive\r\n                                            </Button>\r\n                                            <Button\r\n                                                variant={interconnectionFilter === \"Hybrid\" ? \"default\" : \"outline\"}\r\n                                                size=\"sm\"\r\n                                                onClick={() => setInterconnectionFilter(\"Hybrid\")}\r\n                                            >\r\n                                                Hybrid\r\n                                            </Button>\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    {viewMode === \"graph\" ? (\r\n                                        <div className=\"border rounded-lg p-4 bg-white min-h-[500px]\">\r\n                                            <AssemblageSankey\r\n                                                data={ecosystemImpacts.filter(impact =>\r\n                                                    interconnectionFilter === \"All\" ||\r\n                                                    impact.interconnection_type === interconnectionFilter\r\n                                                )}\r\n                                            />\r\n                                            <p className=\"text-center text-xs text-slate-500 mt-4\">\r\n                                                Visualizing the flow from <strong>Actors</strong> → <strong>Mechanisms</strong> → <strong>Impacts</strong>\r\n                                            </p>\r\n                                        </div>\r\n                                    ) : (\r\n                                        <div className=\"grid gap-3\">\r\n                                            {ecosystemImpacts\r\n                                                .filter(impact =>\r\n                                                    interconnectionFilter === \"All\" ||\r\n                                                    impact.interconnection_type === interconnectionFilter\r\n                                                )\r\n                                                .map((impact, i) => (\r\n                                                    <div key={i} className={`p-3 rounded-lg border ${impact.type === \"Constraint\"\r\n                                                        ? \"bg-red-50 border-red-200\"\r\n                                                        : \"bg-green-50 border-green-200\"\r\n                                                        }`}>\r\n                                                        <div className=\"flex items-start justify-between mb-2\">\r\n                                                            <span className={`text-xs font-bold uppercase ${impact.type === \"Constraint\" ? \"text-red-700\" : \"text-green-700\"\r\n                                                                }`}>\r\n                                                                {impact.type}\r\n                                                            </span>\r\n                                                            {impact.interconnection_type && (\r\n                                                                <Badge variant=\"outline\" className=\"text-xs\">\r\n                                                                    {impact.interconnection_type}\r\n                                                                </Badge>\r\n                                                            )}\r\n                                                        </div>\r\n                                                        <p className=\"text-sm font-semibold text-slate-900 mb-1\">{impact.actor}</p>\r\n                                                        <p className=\"text-xs text-slate-600 mb-1\">\r\n                                                            <span className=\"font-medium\">Mechanism:</span> {impact.mechanism}\r\n                                                        </p>\r\n                                                        <p className=\"text-xs text-slate-600\">\r\n                                                            <span className=\"font-medium\">Impact:</span> {impact.impact}\r\n                                                        </p>\r\n                                                    </div>\r\n                                                ))}\r\n                                        </div>\r\n                                    )}\r\n                                </div>\r\n                            )}\r\n                        </CardContent>\r\n                    </Card>\r\n                )\r\n            }\r\n\r\n\r\n        </div >\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\app\\timeline\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'FileText' is defined but never used.","line":6,"column":27,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":35},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'index' is defined but never used.","line":241,"column":57,"nodeType":null,"messageId":"unusedVar","endLine":241,"endColumn":62}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useSources } from \"@/hooks/useSources\";\r\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Calendar, Clock, FileText, TrendingUp } from \"lucide-react\";\r\nimport { Source } from \"@/types\";\r\n\r\nexport default function TimelinePage() {\r\n    const { sources, isLoading } = useSources();\r\n\r\n    // Filter sources with dates and sort them\r\n    const timelineEvents = sources\r\n        .filter(s => s.publicationDate)\r\n        .sort((a, b) => new Date(a.publicationDate!).getTime() - new Date(b.publicationDate!).getTime());\r\n\r\n    // Analytics: Publications by year\r\n    const publicationsByYear: Record<number, Source[]> = {};\r\n    timelineEvents.forEach(source => {\r\n        const year = new Date(source.publicationDate!).getFullYear();\r\n        if (!publicationsByYear[year]) publicationsByYear[year] = [];\r\n        publicationsByYear[year].push(source);\r\n    });\r\n\r\n    // Analytics: Publications by jurisdiction\r\n    const publicationsByJurisdiction: Record<string, Source[]> = {};\r\n    timelineEvents.forEach(source => {\r\n        const jurisdiction = source.jurisdiction || 'Other';\r\n        if (!publicationsByJurisdiction[jurisdiction]) publicationsByJurisdiction[jurisdiction] = [];\r\n        publicationsByJurisdiction[jurisdiction].push(source);\r\n    });\r\n\r\n    // Analytics: Active Discourse Metric\r\n    const now = new Date();\r\n    const oneYearAgo = new Date(now.getFullYear() - 1, now.getMonth(), now.getDate());\r\n    const twoYearsAgo = new Date(now.getFullYear() - 2, now.getMonth(), now.getDate());\r\n\r\n    const recentDocs = timelineEvents.filter(s => new Date(s.publicationDate!) >= oneYearAgo).length;\r\n    const previousDocs = timelineEvents.filter(s => {\r\n        const date = new Date(s.publicationDate!);\r\n        return date >= twoYearsAgo && date < oneYearAgo;\r\n    }).length;\r\n\r\n    const activityTrend = previousDocs === 0 ? 'High' :\r\n        recentDocs > previousDocs * 1.5 ? 'Growing' :\r\n            recentDocs < previousDocs * 0.5 ? 'Declining' : 'Stable';\r\n\r\n    // Analytics: Peak activity period\r\n    const peakYear = Object.entries(publicationsByYear)\r\n        .sort(([, a], [, b]) => b.length - a.length)[0];\r\n\r\n    // Analytics: Jurisdiction leadership\r\n    const jurisdictionLeader = Object.entries(publicationsByJurisdiction)\r\n        .sort(([, a], [, b]) => b.length - a.length)[0];\r\n\r\n    if (isLoading) {\r\n        return <div className=\"p-8 text-center\">Loading timeline...</div>;\r\n    }\r\n\r\n    return (\r\n        <div className=\"space-y-8\">\r\n            <div className=\"flex items-center justify-between\">\r\n                <div>\r\n                    <h1 className=\"text-3xl font-bold tracking-tight\">Temporal Dynamics</h1>\r\n                    <p className=\"text-muted-foreground mt-2\">\r\n                        Track the evolution of AI governance discourse and policy adoption over time.\r\n                    </p>\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"grid gap-6 md:grid-cols-3\">\r\n                <Card>\r\n                    <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n                        <CardTitle className=\"text-sm font-medium\">Total Timeline Events</CardTitle>\r\n                        <Calendar className=\"h-4 w-4 text-muted-foreground\" />\r\n                    </CardHeader>\r\n                    <CardContent>\r\n                        <div className=\"text-2xl font-bold\">{timelineEvents.length}</div>\r\n                        <p className=\"text-xs text-muted-foreground\">Documents with publication dates</p>\r\n                    </CardContent>\r\n                </Card>\r\n                <Card>\r\n                    <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n                        <CardTitle className=\"text-sm font-medium\">Date Range</CardTitle>\r\n                        <Clock className=\"h-4 w-4 text-muted-foreground\" />\r\n                    </CardHeader>\r\n                    <CardContent>\r\n                        <div className=\"text-2xl font-bold\">\r\n                            {timelineEvents.length > 0\r\n                                ? `${new Date(timelineEvents[0].publicationDate!).getFullYear()} - ${new Date(timelineEvents[timelineEvents.length - 1].publicationDate!).getFullYear()}`\r\n                                : \"N/A\"}\r\n                        </div>\r\n                        <p className=\"text-xs text-muted-foreground\">Earliest to latest document</p>\r\n                    </CardContent>\r\n                </Card>\r\n                <Card>\r\n                    <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n                        <CardTitle className=\"text-sm font-medium\">Active Discourse</CardTitle>\r\n                        <TrendingUp className=\"h-4 w-4 text-muted-foreground\" />\r\n                    </CardHeader>\r\n                    <CardContent>\r\n                        <div className=\"text-2xl font-bold\">{activityTrend}</div>\r\n                        <p className=\"text-xs text-muted-foreground\">\r\n                            {recentDocs} docs last year vs. {previousDocs} prior year\r\n                        </p>\r\n                    </CardContent>\r\n                </Card>\r\n            </div>\r\n\r\n            {/* New Analytics Cards */}\r\n            {timelineEvents.length > 0 && (\r\n                <div className=\"grid gap-6 md:grid-cols-2\">\r\n                    <Card>\r\n                        <CardHeader>\r\n                            <CardTitle className=\"text-base\">Peak Activity Period</CardTitle>\r\n                            <CardDescription>Year with most publications</CardDescription>\r\n                        </CardHeader>\r\n                        <CardContent>\r\n                            {peakYear && (\r\n                                <div>\r\n                                    <div className=\"text-3xl font-bold text-indigo-700 mb-2\">{peakYear[0]}</div>\r\n                                    <p className=\"text-sm text-slate-600\">\r\n                                        {peakYear[1].length} publication{peakYear[1].length !== 1 ? 's' : ''}\r\n                                    </p>\r\n                                    <div className=\"mt-3 flex flex-wrap gap-1\">\r\n                                        {Object.entries(\r\n                                            peakYear[1].reduce((acc: Record<string, number>, s: Source) => {\r\n                                                const j = s.jurisdiction || 'Other';\r\n                                                acc[j] = (acc[j] || 0) + 1;\r\n                                                return acc;\r\n                                            }, {})\r\n                                        ).map(([jurisdiction, count]) => (\r\n                                            <Badge key={jurisdiction} variant=\"outline\" className=\"text-xs\">\r\n                                                {jurisdiction}: {count}\r\n                                            </Badge>\r\n                                        ))}\r\n                                    </div>\r\n                                </div>\r\n                            )}\r\n                        </CardContent>\r\n                    </Card>\r\n\r\n                    <Card>\r\n                        <CardHeader>\r\n                            <CardTitle className=\"text-base\">Most Active Jurisdiction</CardTitle>\r\n                            <CardDescription>Publication leadership</CardDescription>\r\n                        </CardHeader>\r\n                        <CardContent>\r\n                            {jurisdictionLeader && (\r\n                                <div>\r\n                                    <div className=\"text-3xl font-bold text-indigo-700 mb-2\">{jurisdictionLeader[0]}</div>\r\n                                    <p className=\"text-sm text-slate-600\">\r\n                                        {jurisdictionLeader[1].length} publication{jurisdictionLeader[1].length !== 1 ? 's' : ''} total\r\n                                    </p>\r\n                                    <div className=\"mt-3 space-y-1\">\r\n                                        {jurisdictionLeader[1][0] && (\r\n                                            <p className=\"text-xs text-slate-500\">\r\n                                                First: {new Date(jurisdictionLeader[1][0].publicationDate!).getFullYear()}\r\n                                            </p>\r\n                                        )}\r\n                                        {jurisdictionLeader[1][jurisdictionLeader[1].length - 1] && (\r\n                                            <p className=\"text-xs text-slate-500\">\r\n                                                Latest: {new Date(jurisdictionLeader[1][jurisdictionLeader[1].length - 1].publicationDate!).getFullYear()}\r\n                                            </p>\r\n                                        )}\r\n                                    </div>\r\n                                </div>\r\n                            )}\r\n                        </CardContent>\r\n                    </Card>\r\n                </div>\r\n            )}\r\n\r\n            {/* Publication Frequency Chart */}\r\n            {timelineEvents.length > 0 && Object.keys(publicationsByYear).length > 0 && (\r\n                <Card>\r\n                    <CardHeader>\r\n                        <CardTitle>Publication Frequency Over Time</CardTitle>\r\n                        <CardDescription>Number of documents published each year</CardDescription>\r\n                    </CardHeader>\r\n                    <CardContent>\r\n                        <div className=\"space-y-4\">\r\n                            {Object.entries(publicationsByYear)\r\n                                .sort(([a], [b]) => Number(a) - Number(b))\r\n                                .map(([year, docs]) => {\r\n                                    const maxCount = Math.max(...Object.values(publicationsByYear).map(d => d.length));\r\n                                    const percentage = (docs.length / maxCount) * 100;\r\n\r\n                                    return (\r\n                                        <div key={year}>\r\n                                            <div className=\"flex items-center justify-between mb-1\">\r\n                                                <span className=\"text-sm font-medium\">{year}</span>\r\n                                                <span className=\"text-sm text-slate-600\">{docs.length} doc{docs.length !== 1 ? 's' : ''}</span>\r\n                                            </div>\r\n                                            <div className=\"w-full bg-slate-100 rounded-full h-6 relative overflow-hidden\">\r\n                                                <div\r\n                                                    className=\"bg-gradient-to-r from-indigo-500 to-indigo-600 h-6 rounded-full flex items-center px-2 transition-all\"\r\n                                                    style={{ width: `${Math.max(percentage, 5)}%` }}\r\n                                                >\r\n                                                    <div className=\"flex gap-1\">\r\n                                                        {Object.entries(\r\n                                                            docs.reduce((acc: Record<string, number>, s: Source) => {\r\n                                                                const j = s.jurisdiction || 'Other';\r\n                                                                acc[j] = (acc[j] || 0) + 1;\r\n                                                                return acc;\r\n                                                            }, {})\r\n                                                        ).map(([jurisdiction]) => (\r\n                                                            <div\r\n                                                                key={jurisdiction}\r\n                                                                className={`w-2 h-2 rounded-full ${jurisdiction === 'EU' ? 'bg-blue-300' :\r\n                                                                    jurisdiction === 'Brazil' ? 'bg-green-300' :\r\n                                                                        jurisdiction === 'US' ? 'bg-red-300' : 'bg-slate-300'\r\n                                                                    }`}\r\n                                                                title={jurisdiction}\r\n                                                            />\r\n                                                        ))}\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n                                    );\r\n                                })}\r\n                        </div>\r\n                    </CardContent>\r\n                </Card>\r\n            )}\r\n\r\n            {/* Timeline */}\r\n            <Card>\r\n                <CardHeader>\r\n                    <CardTitle>Policy Timeline</CardTitle>\r\n                    <CardDescription>Chronological evolution of AI governance documents</CardDescription>\r\n                </CardHeader>\r\n                <CardContent>\r\n                    <div className=\"relative border-l-2 border-slate-200 ml-4 md:ml-8 space-y-12 py-4\">\r\n                        {timelineEvents.length === 0 ? (\r\n                            <div className=\"pl-8 text-muted-foreground\">\r\n                                No documents with publication dates found. Edit your documents to add dates.\r\n                            </div>\r\n                        ) : (\r\n                            timelineEvents.map((source, index) => (\r\n                                <div key={source.id} className=\"relative pl-8 md:pl-12\">\r\n                                    {/* Timeline Dot */}\r\n                                    <div className={`absolute -left-[9px] top-0 h-4 w-4 rounded-full border-2 border-white ${source.jurisdiction === 'EU' ? 'bg-blue-500' :\r\n                                        source.jurisdiction === 'Brazil' ? 'bg-green-500' :\r\n                                            source.jurisdiction === 'US' ? 'bg-red-500' : 'bg-slate-500'\r\n                                        }`} />\r\n\r\n                                    {/* Date Label */}\r\n                                    <div className=\"mb-1 text-sm font-semibold text-slate-500\">\r\n                                        {new Date(source.publicationDate!).toLocaleDateString(\"en-US\", {\r\n                                            year: 'numeric',\r\n                                            month: 'long',\r\n                                            day: 'numeric'\r\n                                        })}\r\n                                    </div>\r\n\r\n                                    {/* Content Card */}\r\n                                    <Card className=\"w-full max-w-3xl hover:shadow-md transition-shadow\">\r\n                                        <CardHeader>\r\n                                            <div className=\"flex items-start justify-between\">\r\n                                                <div>\r\n                                                    <div className=\"flex items-center gap-2 mb-1\">\r\n                                                        <CardTitle className=\"text-lg text-indigo-700\">\r\n                                                            {source.title}\r\n                                                        </CardTitle>\r\n                                                        {source.version && (\r\n                                                            <Badge variant=\"outline\">v{source.version}</Badge>\r\n                                                        )}\r\n                                                        {source.jurisdiction && (\r\n                                                            <Badge className={\r\n                                                                source.jurisdiction === 'EU' ? 'bg-blue-100 text-blue-800 hover:bg-blue-100' :\r\n                                                                    source.jurisdiction === 'Brazil' ? 'bg-green-100 text-green-800 hover:bg-green-100' :\r\n                                                                        'bg-red-100 text-red-800 hover:bg-red-100'\r\n                                                            }>\r\n                                                                {source.jurisdiction}\r\n                                                            </Badge>\r\n                                                        )}\r\n                                                    </div>\r\n                                                    <CardDescription>{source.description}</CardDescription>\r\n                                                </div>\r\n                                                <div className=\"flex gap-2\">\r\n                                                    {/* Placeholder for future actions */}\r\n                                                </div>\r\n                                            </div>\r\n                                        </CardHeader>\r\n                                        <CardContent>\r\n                                            {source.extractedText && (\r\n                                                <p className=\"text-sm text-slate-600 line-clamp-3\">\r\n                                                    {source.extractedText.substring(0, 300)}...\r\n                                                </p>\r\n                                            )}\r\n                                            {source.analysis && (\r\n                                                <div className=\"mt-4 pt-4 border-t\">\r\n                                                    <h4 className=\"text-xs font-semibold uppercase text-slate-500 mb-2\">Key Insight</h4>\r\n                                                    <p className=\"text-sm\">{source.analysis.key_insight || \"No insight available.\"}</p>\r\n                                                </div>\r\n                                            )}\r\n                                        </CardContent>\r\n                                    </Card>\r\n                                </div>\r\n                            ))\r\n                        )}\r\n                    </div>\r\n                </CardContent>\r\n            </Card>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\AnalysisResults.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\AssemblageSankey.tsx","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Use \"@ts-expect-error\" instead of \"@ts-ignore\", as \"@ts-ignore\" will do nothing if the following line is error-free.","line":56,"column":17,"nodeType":"Line","messageId":"tsIgnoreInsteadOfExpectError","endLine":56,"endColumn":30,"suggestions":[{"messageId":"replaceTsIgnoreWithTsExpectError","fix":{"range":[1896,1909],"text":"// @ts-expect-error"},"desc":"Replace \"@ts-ignore\" with \"@ts-expect-error\"."}]}],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":152,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":152,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5464,5467],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5464,5467],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":185,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":185,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7231,7234],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7231,7234],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useMemo, useRef } from \"react\";\r\nimport { ResponsiveContainer, Sankey, Tooltip, Layer, Rectangle } from \"recharts\";\r\nimport { EcosystemImpact } from \"@/types\";\r\n\r\ninterface AssemblageSankeyProps {\r\n    data: EcosystemImpact[];\r\n    height?: number;\r\n}\r\n\r\nexport function AssemblageSankey({ data, height = 500 }: AssemblageSankeyProps) {\r\n    const chartData = useMemo(() => {\r\n        const nodes: { name: string }[] = [];\r\n        const links: { source: number; target: number; value: number; type?: string }[] = [];\r\n\r\n        const nodeMap = new Map<string, number>();\r\n\r\n        const getNodeIndex = (name: string) => {\r\n            if (!nodeMap.has(name)) {\r\n                nodeMap.set(name, nodes.length);\r\n                nodes.push({ name });\r\n            }\r\n            return nodeMap.get(name)!;\r\n        };\r\n\r\n        data.forEach(item => {\r\n            const actorIdx = getNodeIndex(item.actor);\r\n            const mechanismIdx = getNodeIndex(item.mechanism);\r\n            const impactIdx = getNodeIndex(item.impact);\r\n\r\n            // Link: Actor -> Mechanism\r\n            links.push({\r\n                source: actorIdx,\r\n                target: mechanismIdx,\r\n                value: 1,\r\n                type: item.type\r\n            });\r\n\r\n            // Link: Mechanism -> Impact\r\n            links.push({\r\n                source: mechanismIdx,\r\n                target: impactIdx,\r\n                value: 1,\r\n                type: item.type\r\n            });\r\n        });\r\n\r\n        // Aggregate identical links\r\n        const uniqueLinksMap = new Map<string, { source: number; target: number; value: number; type: string }>();\r\n        links.forEach(link => {\r\n            const key = `${link.source}-${link.target}`;\r\n            if (uniqueLinksMap.has(key)) {\r\n                uniqueLinksMap.get(key)!.value += 1;\r\n            } else {\r\n                // @ts-ignore\r\n                uniqueLinksMap.set(key, { ...link });\r\n            }\r\n        });\r\n\r\n        return {\r\n            nodes,\r\n            links: Array.from(uniqueLinksMap.values())\r\n        };\r\n    }, [data]);\r\n\r\n    const containerRef = useRef<HTMLDivElement>(null);\r\n\r\n    const handleDownload = () => {\r\n        if (!containerRef.current) return;\r\n\r\n        const svgElement = containerRef.current.querySelector('svg');\r\n        if (!svgElement) {\r\n            console.error(\"SVG element not found\");\r\n            return;\r\n        }\r\n\r\n        // Get SVG data\r\n        const serializer = new XMLSerializer();\r\n        const svgString = serializer.serializeToString(svgElement);\r\n        const svgBlob = new Blob([svgString], { type: 'image/svg+xml;charset=utf-8' });\r\n        const url = URL.createObjectURL(svgBlob);\r\n\r\n        // Create image and draw to canvas\r\n        const img = new Image();\r\n        img.onload = () => {\r\n            const canvas = document.createElement('canvas');\r\n            // Use the actual SVG dimensions or the container dimensions\r\n            const width = svgElement.clientWidth || 800;\r\n            const height = svgElement.clientHeight || 500;\r\n\r\n            // Scale up for better resolution\r\n            const scale = 2;\r\n            canvas.width = width * scale;\r\n            canvas.height = height * scale;\r\n\r\n            const ctx = canvas.getContext('2d');\r\n            if (!ctx) return;\r\n\r\n            // Fill white background\r\n            ctx.fillStyle = '#ffffff';\r\n            ctx.fillRect(0, 0, canvas.width, canvas.height);\r\n\r\n            ctx.scale(scale, scale);\r\n            ctx.drawImage(img, 0, 0);\r\n\r\n            // Trigger download\r\n            const pngUrl = canvas.toDataURL('image/png');\r\n            const downloadLink = document.createElement('a');\r\n            downloadLink.href = pngUrl;\r\n            downloadLink.download = 'assemblage-sankey.png';\r\n            document.body.appendChild(downloadLink);\r\n            downloadLink.click();\r\n            document.body.removeChild(downloadLink);\r\n\r\n            URL.revokeObjectURL(url);\r\n        };\r\n        img.src = url;\r\n    };\r\n\r\n    if (data.length === 0) {\r\n        return (\r\n            <div className=\"flex items-center justify-center h-full text-slate-400 text-sm\">\r\n                No data available for visualization\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div style={{ width: '100%', height }} className=\"relative\" ref={containerRef}>\r\n            <div className=\"absolute top-0 right-0 z-10\">\r\n                <button\r\n                    onClick={handleDownload}\r\n                    className=\"bg-white/80 hover:bg-white border border-slate-200 text-slate-600 text-xs font-medium px-2 py-1 rounded shadow-sm backdrop-blur-sm transition-colors\"\r\n                    title=\"Download as PNG\"\r\n                >\r\n                    Download PNG\r\n                </button>\r\n            </div>\r\n\r\n            {/* Column Headers */}\r\n            <div className=\"flex justify-between px-4 mb-2 text-sm font-bold text-slate-700 uppercase tracking-wider border-b pb-2\">\r\n                <div className=\"w-1/3 text-left\">Actors</div>\r\n                <div className=\"w-1/3 text-center\">Mechanisms</div>\r\n                <div className=\"w-1/3 text-right pr-40\">Impacts</div>\r\n            </div>\r\n\r\n            <ResponsiveContainer>\r\n                <Sankey\r\n                    data={chartData}\r\n                    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n                    node={(props: any) => {\r\n                        const { x, y, width, height, index, payload, containerWidth } = props;\r\n                        const isOut = x + width + 6 > (containerWidth || 500) / 2;\r\n\r\n                        // Determine color based on node type or connection\r\n                        const fill = \"#3b82f6\";\r\n\r\n                        // Truncate text if it's too long\r\n                        const truncateText = (text: string, maxLength: number) => {\r\n                            if (text.length <= maxLength) return text;\r\n                            return text.slice(0, maxLength) + '...';\r\n                        };\r\n\r\n                        return (\r\n                            <Layer key={`CustomNode${index}`}>\r\n                                <Rectangle x={x} y={y} width={width} height={height} fill={fill} fillOpacity=\"1\" />\r\n                                <text\r\n                                    textAnchor={isOut ? 'end' : 'start'}\r\n                                    x={isOut ? x - 6 : x + width + 6}\r\n                                    y={y + height / 2}\r\n                                    fontSize=\"11\"\r\n                                    stroke=\"none\"\r\n                                    fill=\"#1e293b\"\r\n                                    dy=\"0.355em\"\r\n                                    fontWeight=\"500\"\r\n                                >\r\n                                    {truncateText(payload.name, 35)}\r\n                                </text>\r\n                                <title>{payload.name}</title>\r\n                            </Layer>\r\n                        );\r\n                    }}\r\n                    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n                    link={(props: any) => {\r\n                        const { sourceX, sourceY, targetX, targetY, linkWidth, payload } = props;\r\n                        // Color links based on the \"type\" of the impact\r\n                        const isConstraint = payload.type === \"Constraint\";\r\n                        const color = isConstraint ? \"#fca5a5\" : \"#86efac\"; // Red-300 for constraint, Green-300 for affordance\r\n                        const opacity = 0.6;\r\n\r\n                        return (\r\n                            <path\r\n                                d={`\r\n                                     M${sourceX},${sourceY + linkWidth / 2}\r\n                                     C${sourceX + 100},${sourceY + linkWidth / 2}\r\n                                     ${targetX - 100},${targetY + linkWidth / 2}\r\n                                     ${targetX},${targetY + linkWidth / 2}\r\n                                     L${targetX},${targetY - linkWidth / 2}\r\n                                     C${targetX - 100},${targetY - linkWidth / 2}\r\n                                     ${sourceX + 100},${sourceY - linkWidth / 2}\r\n                                     ${sourceX},${sourceY - linkWidth / 2}\r\n                                     Z\r\n                                 `}\r\n                                fill={color}\r\n                                fillOpacity={opacity}\r\n                                stroke={isConstraint ? \"#ef4444\" : \"#22c55e\"}\r\n                                strokeWidth={1}\r\n                                strokeOpacity={0.2}\r\n                            />\r\n                        );\r\n                    }}\r\n                    nodePadding={50}\r\n                    margin={{\r\n                        left: 20,\r\n                        right: 160,\r\n                        top: 20,\r\n                        bottom: 20,\r\n                    }}\r\n                >\r\n                    <Tooltip />\r\n                </Sankey>\r\n            </ResponsiveContainer>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\CulturalHoleCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\CulturalHoleMatrix.tsx","messages":[{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":110,"column":89,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[5900,6116],"text":"\r\n                                                            These discourse clusters don&apos;t \"speak to each other\" — they use different language and concepts.\r\n                                                        "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[5900,6116],"text":"\r\n                                                            These discourse clusters don&lsquo;t \"speak to each other\" — they use different language and concepts.\r\n                                                        "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[5900,6116],"text":"\r\n                                                            These discourse clusters don&#39;t \"speak to each other\" — they use different language and concepts.\r\n                                                        "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[5900,6116],"text":"\r\n                                                            These discourse clusters don&rsquo;t \"speak to each other\" — they use different language and concepts.\r\n                                                        "},"desc":"Replace with `&rsquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":110,"column":92,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[5900,6116],"text":"\r\n                                                            These discourse clusters don't &quot;speak to each other\" — they use different language and concepts.\r\n                                                        "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[5900,6116],"text":"\r\n                                                            These discourse clusters don't &ldquo;speak to each other\" — they use different language and concepts.\r\n                                                        "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[5900,6116],"text":"\r\n                                                            These discourse clusters don't &#34;speak to each other\" — they use different language and concepts.\r\n                                                        "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[5900,6116],"text":"\r\n                                                            These discourse clusters don't &rdquo;speak to each other\" — they use different language and concepts.\r\n                                                        "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":110,"column":112,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[5900,6116],"text":"\r\n                                                            These discourse clusters don't \"speak to each other&quot; — they use different language and concepts.\r\n                                                        "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[5900,6116],"text":"\r\n                                                            These discourse clusters don't \"speak to each other&ldquo; — they use different language and concepts.\r\n                                                        "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[5900,6116],"text":"\r\n                                                            These discourse clusters don't \"speak to each other&#34; — they use different language and concepts.\r\n                                                        "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[5900,6116],"text":"\r\n                                                            These discourse clusters don't \"speak to each other&rdquo; — they use different language and concepts.\r\n                                                        "},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport React from \"react\";\r\nimport { DiscourseCluster, CulturalHole, BridgingConcept } from \"@/types/cultural\";\r\nimport { Tooltip, TooltipContent, TooltipProvider, TooltipTrigger } from \"@/components/ui/tooltip\";\r\n\r\ninterface CulturalHoleMatrixProps {\r\n    clusters: DiscourseCluster[];\r\n    holes: CulturalHole[];\r\n    onConceptClick?: (concept: BridgingConcept) => void;\r\n}\r\n\r\nexport function CulturalHoleMatrix({ clusters, holes, onConceptClick }: CulturalHoleMatrixProps) {\r\n    if (clusters.length === 0) {\r\n        return (\r\n            <div className=\"flex items-center justify-center h-96 bg-slate-50 rounded-lg border-2 border-dashed border-slate-300\">\r\n                <p className=\"text-slate-500\">No cultural analysis data available</p>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    // Helper to get hole between two clusters\r\n    const getHole = (nameA: string, nameB: string) => {\r\n        return holes.find(h =>\r\n            (h.clusterA === nameA && h.clusterB === nameB) ||\r\n            (h.clusterA === nameB && h.clusterB === nameA)\r\n        );\r\n    };\r\n\r\n    // Helper to get color based on distance\r\n    const getCellColor = (distance: number) => {\r\n        if (distance < 0.2) return \"bg-slate-50\";\r\n        if (distance < 0.4) return \"bg-red-50\";\r\n        if (distance < 0.6) return \"bg-red-100\";\r\n        if (distance < 0.8) return \"bg-red-200\";\r\n        return \"bg-red-300\";\r\n    };\r\n\r\n    return (\r\n        <div className=\"overflow-x-auto\">\r\n            <div className=\"min-w-[600px] p-2\">\r\n                <div className=\"grid\" style={{\r\n                    gridTemplateColumns: `auto repeat(${clusters.length}, minmax(60px, 1fr))`\r\n                }}>\r\n                    {/* Header Row */}\r\n                    <div className=\"h-16\"></div>\r\n                    {clusters.map((cluster) => (\r\n                        <div key={cluster.id} className=\"relative h-16 border-b border-slate-200\">\r\n                            <div className=\"absolute bottom-2 left-1/2 -translate-x-1/2 w-full text-center transform -rotate-45 origin-bottom text-xs font-medium text-slate-700 px-1 whitespace-nowrap\">\r\n                                {cluster.name}\r\n                            </div>\r\n                        </div>\r\n                    ))}\r\n\r\n                    {/* Matrix Rows */}\r\n                    {clusters.map((rowCluster, rowIndex) => (\r\n                        <React.Fragment key={rowCluster.id}>\r\n                            {/* Row Header */}\r\n                            <div className=\"flex items-center justify-end pr-2 py-1 border-r border-slate-200\">\r\n                                <span className=\"text-xs font-medium text-slate-700 text-right truncate w-24\">\r\n                                    {rowCluster.name}\r\n                                </span>\r\n                            </div>\r\n\r\n                            {/* Cells */}\r\n                            {clusters.map((colCluster, colIndex) => {\r\n                                const isDiagonal = rowIndex === colIndex;\r\n                                const isLowerTriangle = colIndex < rowIndex;\r\n                                const hole = getHole(rowCluster.name, colCluster.name);\r\n\r\n                                if (isLowerTriangle) {\r\n                                    return (\r\n                                        <div key={`${rowCluster.id}-${colCluster.id}`} className=\"bg-slate-50/50 border border-white h-12\" />\r\n                                    );\r\n                                }\r\n\r\n                                if (isDiagonal) {\r\n                                    return (\r\n                                        <div key={`${rowCluster.id}-${colCluster.id}`} className=\"bg-slate-100 border border-white flex items-center justify-center h-12\">\r\n                                            <span className=\"text-xs font-bold text-slate-400\">\r\n                                                {rowCluster.size}\r\n                                            </span>\r\n                                        </div>\r\n                                    );\r\n                                }\r\n\r\n                                if (!hole) {\r\n                                    return (\r\n                                        <div key={`${rowCluster.id}-${colCluster.id}`} className=\"bg-slate-50 border border-white h-12\" />\r\n                                    );\r\n                                }\r\n\r\n                                return (\r\n                                    <TooltipProvider key={`${rowCluster.id}-${colCluster.id}`}>\r\n                                        <Tooltip>\r\n                                            <TooltipTrigger asChild>\r\n                                                <div\r\n                                                    className={`${getCellColor(hole.distance)} border border-white h-12 flex items-center justify-center cursor-help transition-colors hover:opacity-80`}\r\n                                                >\r\n                                                    <span className=\"text-xs font-medium text-red-900 opacity-50\">\r\n                                                        {(hole.distance * 100).toFixed(0)}%\r\n                                                    </span>\r\n                                                </div>\r\n                                            </TooltipTrigger>\r\n                                            <TooltipContent className=\"max-w-md bg-white border-slate-200 shadow-lg\">\r\n                                                <div className=\"space-y-3\">\r\n                                                    <div>\r\n                                                        <p className=\"font-bold text-sm text-amber-700\">💡 Cultural Gap Detected</p>\r\n                                                        <p className=\"text-xs text-slate-600 mt-1\">\r\n                                                            These discourse clusters don't \"speak to each other\" — they use different language and concepts.\r\n                                                        </p>\r\n                                                    </div>\r\n\r\n                                                    {/* Cluster Definitions */}\r\n                                                    <div className=\"text-xs space-y-2 bg-slate-50 p-2 rounded border border-slate-100\">\r\n                                                        <div>\r\n                                                            <span className=\"font-semibold text-indigo-700\">Cluster A:</span>{\" \"}\r\n                                                            <span className=\"text-slate-700\">\r\n                                                                {hole.clusterA}\r\n                                                            </span>\r\n                                                            {clusters.find(c => c.name === hole.clusterA)?.description && (\r\n                                                                <p className=\"text-slate-600 italic mt-0.5 pl-2\">\r\n                                                                    {clusters.find(c => c.name === hole.clusterA)?.description}\r\n                                                                </p>\r\n                                                            )}\r\n                                                        </div>\r\n                                                        <div>\r\n                                                            <span className=\"font-semibold text-indigo-700\">Cluster B:</span>{\" \"}\r\n                                                            <span className=\"text-slate-700\">\r\n                                                                {hole.clusterB}\r\n                                                            </span>\r\n                                                            {clusters.find(c => c.name === hole.clusterB)?.description && (\r\n                                                                <p className=\"text-slate-600 italic mt-0.5 pl-2\">\r\n                                                                    {clusters.find(c => c.name === hole.clusterB)?.description}\r\n                                                                </p>\r\n                                                            )}\r\n                                                        </div>\r\n                                                    </div>\r\n\r\n                                                    <div className=\"text-xs space-y-2 border-t border-slate-100 pt-2\">\r\n                                                        <p>\r\n                                                            <span className=\"font-semibold text-slate-700\">Gap Size:</span>{\" \"}\r\n                                                            <span className=\"text-slate-900\">{(hole.distance * 100).toFixed(0)}%</span>\r\n                                                            <span className=\"text-slate-500 ml-1\">\r\n                                                                ({hole.distance > 0.7 ? \"Very Large\" : hole.distance > 0.4 ? \"Moderate\" : \"Small\"})\r\n                                                            </span>\r\n                                                        </p>\r\n\r\n                                                        {/* Bridging Concepts with individual tooltips */}\r\n                                                        <div>\r\n                                                            <p className=\"font-semibold text-slate-700 mb-1\">Bridging Ideas (Click to Draft Policy):</p>\r\n                                                            <div className=\"flex flex-wrap gap-1\">\r\n                                                                {hole.bridgingConcepts.map((bc: BridgingConcept, idx: number) => (\r\n                                                                    <TooltipProvider key={idx}>\r\n                                                                        <Tooltip>\r\n                                                                            <TooltipTrigger asChild>\r\n                                                                                <button\r\n                                                                                    onClick={() => onConceptClick?.(bc)}\r\n                                                                                    className=\"px-2 py-0.5 bg-blue-50 text-blue-700 rounded border border-blue-100 cursor-pointer text-xs hover:bg-blue-100 hover:scale-105 transition-all\"\r\n                                                                                >\r\n                                                                                    {bc.concept}\r\n                                                                                </button>\r\n                                                                            </TooltipTrigger>\r\n                                                                            <TooltipContent className=\"max-w-xs bg-white\">\r\n                                                                                <p className=\"text-xs text-slate-700\">{bc.explanation}</p>\r\n                                                                                <p className=\"text-[10px] text-blue-500 mt-1 font-semibold\">Click to generate policy draft</p>\r\n                                                                            </TooltipContent>\r\n                                                                        </Tooltip>\r\n                                                                    </TooltipProvider>\r\n                                                                ))}\r\n                                                            </div>\r\n                                                        </div>\r\n\r\n                                                        <div className=\"bg-amber-50 p-2 rounded border border-amber-100 mt-2\">\r\n                                                            <p className=\"font-semibold text-amber-900 mb-1\">🎯 Opportunity for Innovation:</p>\r\n                                                            <p className=\"text-slate-700\">{hole.opportunity}</p>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                </div>\r\n                                            </TooltipContent>\r\n                                        </Tooltip>\r\n                                    </TooltipProvider>\r\n                                );\r\n                            })}\r\n                        </React.Fragment>\r\n                    ))}\r\n                </div>\r\n\r\n                {/* Legend */}\r\n                <div className=\"mt-4 flex items-center justify-end gap-4 text-xs text-slate-600\">\r\n                    <div className=\"flex items-center gap-2\">\r\n                        <div className=\"w-4 h-4 bg-slate-100 border border-slate-200\"></div>\r\n                        <span>Cluster Size</span>\r\n                    </div>\r\n                    <div className=\"flex items-center gap-2\">\r\n                        <div className=\"flex\">\r\n                            <div className=\"w-4 h-4 bg-slate-50\"></div>\r\n                            <div className=\"w-4 h-4 bg-red-50\"></div>\r\n                            <div className=\"w-4 h-4 bg-red-100\"></div>\r\n                            <div className=\"w-4 h-4 bg-red-200\"></div>\r\n                            <div className=\"w-4 h-4 bg-red-300\"></div>\r\n                        </div>\r\n                        <span>Gap Distance (Low → High)</span>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\CulturalHoleNetwork.tsx","messages":[{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`drawNetwork` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\nC:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\CulturalHoleNetwork.tsx:28:13\n  26 |             canvas.height = height;\n  27 |             // Initial draw\n> 28 |             drawNetwork(canvas, width, height, 0);\n     |             ^^^^^^^^^^^ `drawNetwork` accessed before it is declared\n  29 |         });\n  30 |\n  31 |         resizeObserver.observe(container);\n\nC:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\CulturalHoleNetwork.tsx:62:5\n   60 |     }, [isLive, clusters, holes]);\n   61 |\n>  62 |     const drawNetwork = (canvas: HTMLCanvasElement, width: number, height: number, time: number) => {\n      |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n>  63 |         const ctx = canvas.getContext(\"2d\");\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n>  64 |         if (!ctx) return;\n      …\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 188 |         });\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 189 |     };\n      | ^^^^^^^ `drawNetwork` is declared here\n  190 |\n  191 |     if (clusters.length === 0) {\n  192 |         return (","line":28,"column":13,"nodeType":null,"endLine":28,"endColumn":24},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'drawNetwork'. Either include it or remove the dependency array.","line":37,"column":8,"nodeType":"ArrayExpression","endLine":37,"endColumn":25,"suggestions":[{"desc":"Update the dependencies array to be: [clusters, drawNetwork, holes]","fix":{"range":[1257,1274],"text":"[clusters, drawNetwork, holes]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'drawNetwork'. Either include it or remove the dependency array.","line":60,"column":8,"nodeType":"ArrayExpression","endLine":60,"endColumn":33,"suggestions":[{"desc":"Update the dependencies array to be: [isLive, clusters, holes, drawNetwork]","fix":{"range":[2018,2043],"text":"[isLive, clusters, holes, drawNetwork]"}}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useEffect, useRef } from \"react\";\r\nimport { DiscourseCluster, CulturalHole } from \"@/types/cultural\";\r\n\r\ninterface CulturalHoleNetworkProps {\r\n    clusters: DiscourseCluster[];\r\n    holes: CulturalHole[];\r\n    isLive?: boolean;\r\n}\r\n\r\nexport function CulturalHoleNetwork({ clusters, holes, isLive = false }: CulturalHoleNetworkProps) {\r\n    const containerRef = useRef<HTMLDivElement>(null);\r\n    const canvasRef = useRef<HTMLCanvasElement>(null);\r\n    const animationRef = useRef<number>();\r\n    const timeRef = useRef<number>(0);\r\n\r\n    useEffect(() => {\r\n        const container = containerRef.current;\r\n        const canvas = canvasRef.current;\r\n        if (!container || !canvas || clusters.length === 0) return;\r\n\r\n        const resizeObserver = new ResizeObserver((entries) => {\r\n            const { width, height } = entries[0].contentRect;\r\n            canvas.width = width;\r\n            canvas.height = height;\r\n            // Initial draw\r\n            drawNetwork(canvas, width, height, 0);\r\n        });\r\n\r\n        resizeObserver.observe(container);\r\n\r\n        return () => {\r\n            resizeObserver.disconnect();\r\n            if (animationRef.current) cancelAnimationFrame(animationRef.current);\r\n        };\r\n    }, [clusters, holes]);\r\n\r\n    // Animation Loop\r\n    useEffect(() => {\r\n        const canvas = canvasRef.current;\r\n        if (!canvas || !isLive) {\r\n            if (animationRef.current) cancelAnimationFrame(animationRef.current);\r\n            // Reset to static state\r\n            if (canvas) drawNetwork(canvas, canvas.width, canvas.height, 0);\r\n            return;\r\n        }\r\n\r\n        const animate = () => {\r\n            timeRef.current += 0.01;\r\n            drawNetwork(canvas, canvas.width, canvas.height, timeRef.current);\r\n            animationRef.current = requestAnimationFrame(animate);\r\n        };\r\n\r\n        animate();\r\n\r\n        return () => {\r\n            if (animationRef.current) cancelAnimationFrame(animationRef.current);\r\n        };\r\n    }, [isLive, clusters, holes]);\r\n\r\n    const drawNetwork = (canvas: HTMLCanvasElement, width: number, height: number, time: number) => {\r\n        const ctx = canvas.getContext(\"2d\");\r\n        if (!ctx) return;\r\n\r\n        // Clear canvas\r\n        ctx.clearRect(0, 0, width, height);\r\n\r\n        // Calculate positions for clusters (circular layout)\r\n        const centerX = width / 2;\r\n        const centerY = height / 2;\r\n        const radius = Math.min(width, height) * 0.3;\r\n\r\n        const positions = clusters.map((_, i) => {\r\n            const angle = (i / clusters.length) * 2 * Math.PI - Math.PI / 2;\r\n\r\n            // Add subtle movement if live\r\n            const driftX = isLive ? Math.sin(time + i) * 10 : 0;\r\n            const driftY = isLive ? Math.cos(time + i * 2) * 10 : 0;\r\n\r\n            // Add \"breathing\" radius\r\n            const breathingRadius = isLive ? radius + Math.sin(time * 0.5) * 5 : radius;\r\n\r\n            return {\r\n                x: centerX + breathingRadius * Math.cos(angle) + driftX,\r\n                y: centerY + breathingRadius * Math.sin(angle) + driftY,\r\n            };\r\n        });\r\n\r\n        // Draw connections (holes) first\r\n        holes.forEach((hole) => {\r\n            const indexA = clusters.findIndex((c) => c.id === hole.clusterA);\r\n            const indexB = clusters.findIndex((c) => c.id === hole.clusterB);\r\n\r\n            if (indexA === -1 || indexB === -1) return;\r\n\r\n            const posA = positions[indexA];\r\n            const posB = positions[indexB];\r\n\r\n            // Color based on gap size\r\n            const alpha = hole.distance;\r\n\r\n            // Draw glow effect\r\n            ctx.shadowBlur = isLive ? 15 + Math.sin(time * 2) * 5 : 10;\r\n            ctx.shadowColor = `rgba(239, 68, 68, ${alpha * 0.5})`;\r\n\r\n            ctx.strokeStyle = `rgba(239, 68, 68, ${alpha * 0.8})`; // Red with transparency\r\n            ctx.lineWidth = 3;\r\n            ctx.setLineDash([8, 6]); // Dashed line for gaps\r\n\r\n            // Animate dash offset\r\n            ctx.lineDashOffset = isLive ? -time * 10 : 0;\r\n\r\n            ctx.beginPath();\r\n            ctx.moveTo(posA.x, posA.y);\r\n            ctx.lineTo(posB.x, posB.y);\r\n            ctx.stroke();\r\n\r\n            ctx.setLineDash([]); // Reset dash\r\n            ctx.shadowBlur = 0; // Reset shadow\r\n        });\r\n\r\n        // Draw clusters as nodes\r\n        clusters.forEach((cluster, i) => {\r\n            const pos = positions[i];\r\n            const nodeRadius = 25 + cluster.size * 2;\r\n\r\n            // Draw node shadow\r\n            ctx.shadowBlur = isLive ? 20 + Math.sin(time * 3) * 5 : 15;\r\n            ctx.shadowColor = \"rgba(59, 130, 246, 0.4)\";\r\n            ctx.shadowOffsetY = 4;\r\n\r\n            // Draw node circle (Gradient)\r\n            const gradient = ctx.createRadialGradient(pos.x - nodeRadius / 3, pos.y - nodeRadius / 3, nodeRadius / 10, pos.x, pos.y, nodeRadius);\r\n            gradient.addColorStop(0, \"#60a5fa\"); // Light blue\r\n            gradient.addColorStop(1, \"#2563eb\"); // Blue\r\n\r\n            ctx.fillStyle = gradient;\r\n            ctx.beginPath();\r\n            ctx.arc(pos.x, pos.y, nodeRadius, 0, 2 * Math.PI);\r\n            ctx.fill();\r\n\r\n            // Reset shadow\r\n            ctx.shadowBlur = 0;\r\n            ctx.shadowOffsetY = 0;\r\n\r\n            // Draw border\r\n            ctx.strokeStyle = \"#ffffff\";\r\n            ctx.lineWidth = 3;\r\n            ctx.stroke();\r\n\r\n            // Draw label background (pill)\r\n            ctx.font = \"bold 13px Inter, sans-serif\";\r\n            const maxLength = 25;\r\n            const displayName = cluster.name.length > maxLength\r\n                ? cluster.name.substring(0, maxLength) + \"...\"\r\n                : cluster.name;\r\n\r\n            const textMetrics = ctx.measureText(displayName);\r\n            const textWidth = textMetrics.width;\r\n            const textHeight = 16;\r\n            const padding = 8;\r\n\r\n            const labelY = pos.y + nodeRadius + 15;\r\n\r\n            ctx.fillStyle = \"rgba(255, 255, 255, 0.9)\";\r\n            ctx.beginPath();\r\n            ctx.roundRect(pos.x - textWidth / 2 - padding, labelY, textWidth + padding * 2, textHeight + padding, 6);\r\n            ctx.fill();\r\n            ctx.strokeStyle = \"#e2e8f0\";\r\n            ctx.lineWidth = 1;\r\n            ctx.stroke();\r\n\r\n            // Draw label text\r\n            ctx.fillStyle = \"#1e293b\";\r\n            ctx.textAlign = \"center\";\r\n            ctx.textBaseline = \"top\";\r\n            ctx.fillText(displayName, pos.x, labelY + padding / 2);\r\n\r\n            // Draw theme count inside node\r\n            ctx.fillStyle = \"#ffffff\";\r\n            ctx.font = \"bold 16px Inter, sans-serif\";\r\n            ctx.textBaseline = \"middle\";\r\n            ctx.shadowColor = \"rgba(0,0,0,0.2)\";\r\n            ctx.shadowBlur = 2;\r\n            ctx.fillText(cluster.size.toString(), pos.x, pos.y);\r\n            ctx.shadowBlur = 0;\r\n        });\r\n    };\r\n\r\n    if (clusters.length === 0) {\r\n        return (\r\n            <div className=\"flex items-center justify-center h-96 bg-slate-50 rounded-lg border-2 border-dashed border-slate-300\">\r\n                <p className=\"text-slate-500\">No cultural analysis data available</p>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div ref={containerRef} className=\"relative w-full h-full min-h-[400px]\">\r\n            <canvas\r\n                ref={canvasRef}\r\n                className=\"w-full h-full rounded-lg bg-slate-50/50\"\r\n            />\r\n            <div className=\"absolute bottom-4 left-4 flex items-center gap-4 text-xs text-slate-600 bg-white/80 p-2 rounded-lg backdrop-blur-sm border border-slate-200 shadow-sm\">\r\n                <div className=\"flex items-center gap-2\">\r\n                    <div className=\"w-3 h-3 rounded-full bg-blue-500 border border-blue-600\"></div>\r\n                    <span>Cluster</span>\r\n                </div>\r\n                <div className=\"flex items-center gap-2\">\r\n                    <div className=\"w-6 h-0.5 border-t-2 border-dashed border-red-500\"></div>\r\n                    <span>Cultural Hole</span>\r\n                </div>\r\n                {isLive && (\r\n                    <div className=\"flex items-center gap-2 text-indigo-600 font-medium animate-pulse\">\r\n                        <div className=\"w-2 h-2 rounded-full bg-indigo-500\"></div>\r\n                        <span>Live Assemblage</span>\r\n                    </div>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\ResearchWorkflowGuide.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useEffect' is defined but never used.","line":3,"column":20,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":29},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ChevronRight' is defined but never used.","line":4,"column":23,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":35}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport { BookOpen, X, ChevronRight, Database, GitGraph, FileText, Share2 } from \"lucide-react\";\r\nimport Link from \"next/link\";\r\nimport { usePathname } from \"next/navigation\";\r\n\r\nexport function ResearchWorkflowGuide() {\r\n    const [isOpen, setIsOpen] = useState(false);\r\n    const pathname = usePathname();\r\n\r\n    // Auto-minimize on specific pages if needed, or keep persistent\r\n    // For now, we'll just let the user control it.\r\n\r\n    if (!isOpen) {\r\n        return (\r\n            <button\r\n                onClick={() => setIsOpen(true)}\r\n                className=\"fixed bottom-6 right-6 bg-blue-600 text-white p-3 rounded-full shadow-lg hover:bg-blue-700 transition-all z-50 flex items-center gap-2\"\r\n                title=\"Open Research Guide\"\r\n            >\r\n                <BookOpen size={20} />\r\n                <span className=\"font-medium text-sm pr-1\">CFP Guide</span>\r\n            </button>\r\n        );\r\n    }\r\n\r\n    const steps = [\r\n        {\r\n            id: 1,\r\n            title: \"Data Collection\",\r\n            icon: <Database size={16} />,\r\n            desc: \"Ingest documents and capture empirical traces.\",\r\n            link: \"/data\",\r\n            active: pathname === \"/data\" || pathname === \"/empirical\"\r\n        },\r\n        {\r\n            id: 2,\r\n            title: \"Micro Analysis\",\r\n            icon: <FileText size={16} />,\r\n            desc: \"Analyze resistance and reflect on positionality.\",\r\n            link: \"/resistance\",\r\n            active: pathname === \"/resistance\" || pathname === \"/reflexivity\"\r\n        },\r\n        {\r\n            id: 3,\r\n            title: \"Meso Analysis\",\r\n            icon: <GitGraph size={16} />,\r\n            desc: \"Map ecosystems and conceptual networks.\",\r\n            link: \"/ecosystem\",\r\n            active: pathname === \"/ecosystem\" || pathname === \"/ontology\"\r\n        },\r\n        {\r\n            id: 4,\r\n            title: \"Macro Analysis\",\r\n            icon: <Share2 size={16} />,\r\n            desc: \"Examine governance structures and cultural framing.\",\r\n            link: \"/governance\",\r\n            active: pathname === \"/governance\" || pathname === \"/cultural\" || pathname === \"/timeline\" || pathname === \"/comparison\"\r\n        },\r\n        {\r\n            id: 5,\r\n            title: \"Synthesis\",\r\n            icon: <BookOpen size={16} />,\r\n            desc: \"Generate reports and visualize the assemblage.\",\r\n            link: \"/synthesis\",\r\n            active: pathname === \"/synthesis\"\r\n        }\r\n    ];\r\n\r\n    return (\r\n        <div className=\"fixed bottom-6 right-6 w-80 bg-white rounded-xl shadow-2xl border border-slate-200 z-50 overflow-hidden flex flex-col animate-in slide-in-from-bottom-5 duration-300\">\r\n            <div className=\"bg-slate-900 text-white p-4 flex justify-between items-start\">\r\n                <div>\r\n                    <h3 className=\"font-bold text-sm flex items-center gap-2\">\r\n                        <BookOpen size={16} className=\"text-blue-400\" />\r\n                        Assemblage AI Guide\r\n                    </h3>\r\n                    <p className=\"text-xs text-slate-400 mt-1\">\r\n                        Critical Analysis Workflow\r\n                    </p>\r\n                </div>\r\n                <button\r\n                    onClick={() => setIsOpen(false)}\r\n                    className=\"text-slate-400 hover:text-white transition-colors\"\r\n                >\r\n                    <X size={16} />\r\n                </button>\r\n            </div>\r\n\r\n            <div className=\"p-4 space-y-4 max-h-[60vh] overflow-y-auto\">\r\n                <div className=\"space-y-3\">\r\n                    {steps.map((step) => (\r\n                        <Link\r\n                            key={step.id}\r\n                            href={step.link}\r\n                            className={`block group border rounded-lg p-3 transition-all ${step.active\r\n                                ? \"bg-blue-50 border-blue-200 ring-1 ring-blue-200\"\r\n                                : \"bg-white border-slate-100 hover:border-blue-200 hover:shadow-sm\"\r\n                                }`}\r\n                        >\r\n                            <div className=\"flex items-center justify-between mb-1\">\r\n                                <div className={`flex items-center gap-2 font-semibold text-sm ${step.active ? \"text-blue-700\" : \"text-slate-700\"\r\n                                    }`}>\r\n                                    <span className={`p-1 rounded ${step.active ? \"bg-blue-100\" : \"bg-slate-100 group-hover:bg-blue-50\"\r\n                                        }`}>\r\n                                        {step.icon}\r\n                                    </span>\r\n                                    {step.title}\r\n                                </div>\r\n                                {step.active && <div className=\"w-2 h-2 rounded-full bg-blue-500\"></div>}\r\n                            </div>\r\n                            <p className=\"text-xs text-slate-500 leading-relaxed pl-8\">\r\n                                {step.desc}\r\n                            </p>\r\n                        </Link>\r\n                    ))}\r\n                </div>\r\n\r\n                <div className=\"bg-slate-50 p-3 rounded-lg border border-slate-100\">\r\n                    <h4 className=\"text-xs font-semibold text-slate-700 mb-2\">Current Goal:</h4>\r\n                    <p className=\"text-xs text-slate-600 leading-relaxed\">\r\n                        Begin by uploading your primary policy documents in the <strong>Data Collection</strong> tab to initialize the assemblage analysis.\r\n                    </p>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\Sidebar.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\Sidebar.tsx:31:9\n  29 |     // Close mobile menu when path changes\n  30 |     useEffect(() => {\n> 31 |         setIsMobileOpen(false);\n     |         ^^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  32 |     }, [pathname]);\n  33 |\n  34 |     // Handle hydration mismatch","line":31,"column":9,"nodeType":null,"endLine":31,"endColumn":24},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\Sidebar.tsx:36:9\n  34 |     // Handle hydration mismatch\n  35 |     useEffect(() => {\n> 36 |         setIsMounted(true);\n     |         ^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  37 |     }, []);\n  38 |\n  39 |     const navGroups = [","line":36,"column":9,"nodeType":null,"endLine":36,"endColumn":21},{"ruleId":"react-hooks/static-components","severity":2,"message":"Error: Cannot create components during render\n\nComponents created during render will reset their state each time they are created. Declare components outside of render.\n\nC:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\Sidebar.tsx:219:18\n  217 |             {/* Desktop Sidebar */}\n  218 |             <div className=\"hidden md:flex w-64 border-r border-slate-200 bg-white flex-col h-full flex-shrink-0\">\n> 219 |                 <SidebarContent />\n      |                  ^^^^^^^^^^^^^^ This component is created during render\n  220 |             </div>\n  221 |\n  222 |             {/* Mobile Header */}\n\nC:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\Sidebar.tsx:156:28\n  154 |     ];\n  155 |\n> 156 |     const SidebarContent = () => (\n      |                            ^^^^^^^\n> 157 |         <div className=\"flex flex-col h-full bg-white\">\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 158 |             <div className=\"p-6 border-b border-slate-100\">\n      …\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 212 |         </div>\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 213 |     );\n      | ^^^^^^ The component is created during render here\n  214 |\n  215 |     return (\n  216 |         <>","line":219,"column":18,"nodeType":null,"endLine":219,"endColumn":32},{"ruleId":"react-hooks/static-components","severity":2,"message":"Error: Cannot create components during render\n\nComponents created during render will reset their state each time they are created. Declare components outside of render.\n\nC:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\Sidebar.tsx:259:30\n  257 |                         </div>\n  258 |                         <div className=\"flex-1 overflow-hidden\">\n> 259 |                             <SidebarContent />\n      |                              ^^^^^^^^^^^^^^ This component is created during render\n  260 |                         </div>\n  261 |                     </div>\n  262 |                 </div>\n\nC:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\Sidebar.tsx:156:28\n  154 |     ];\n  155 |\n> 156 |     const SidebarContent = () => (\n      |                            ^^^^^^^\n> 157 |         <div className=\"flex flex-col h-full bg-white\">\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 158 |             <div className=\"p-6 border-b border-slate-100\">\n      …\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 212 |         </div>\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 213 |     );\n      | ^^^^^^ The component is created during render here\n  214 |\n  215 |     return (\n  216 |         <>","line":259,"column":30,"nodeType":null,"endLine":259,"endColumn":44}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport Link from \"next/link\";\r\nimport { usePathname } from \"next/navigation\";\r\nimport {\r\n    LayoutDashboard,\r\n    Database,\r\n    BookOpen,\r\n    Scale,\r\n    Users,\r\n    Scan,\r\n    Network,\r\n    Lightbulb,\r\n    ArrowLeftRight,\r\n    Clock,\r\n    Menu,\r\n    X\r\n} from \"lucide-react\";\r\nimport { cn } from \"@/lib/utils\";\r\nimport { Tooltip, TooltipContent, TooltipProvider, TooltipTrigger } from \"@/components/ui/tooltip\";\r\nimport { UserButton } from \"@clerk/nextjs\";\r\n\r\nexport function Sidebar() {\r\n    const pathname = usePathname();\r\n    const [isMobileOpen, setIsMobileOpen] = useState(false);\r\n    const [isMounted, setIsMounted] = useState(false);\r\n\r\n    // Close mobile menu when path changes\r\n    useEffect(() => {\r\n        setIsMobileOpen(false);\r\n    }, [pathname]);\r\n\r\n    // Handle hydration mismatch\r\n    useEffect(() => {\r\n        setIsMounted(true);\r\n    }, []);\r\n\r\n    const navGroups = [\r\n        {\r\n            title: \"Overview\",\r\n            items: [\r\n                {\r\n                    name: \"Dashboard\",\r\n                    href: \"/\",\r\n                    icon: LayoutDashboard,\r\n                    description: \"High-level view of the algorithmic assemblage and research progress.\"\r\n                }\r\n            ]\r\n        },\r\n        {\r\n            title: \"Data Collection\",\r\n            items: [\r\n                {\r\n                    name: \"Documents\",\r\n                    href: \"/data\",\r\n                    icon: Database,\r\n                    description: \"Archive of primary policy texts (PDFs) and source materials.\"\r\n                },\r\n                {\r\n                    name: \"Empirical Data\",\r\n                    href: \"/empirical\",\r\n                    icon: Users,\r\n                    description: \"Collect and organize empirical traces from web sources.\"\r\n                }\r\n            ]\r\n        },\r\n        {\r\n            title: \"Agency & Resistance\",\r\n            items: [\r\n                {\r\n                    name: \"Resistance\",\r\n                    href: \"/resistance\",\r\n                    icon: Users,\r\n                    description: \"Analyze micro-resistance strategies and counter-conduct.\"\r\n                },\r\n                {\r\n                    name: \"Critical Reflection\",\r\n                    href: \"/reflexivity\",\r\n                    icon: Scan,\r\n                    description: \"Examine how your own perspective and context shape the analysis.\"\r\n                },\r\n            ]\r\n        },\r\n        {\r\n            title: \"Assemblage Mapping\",\r\n            items: [\r\n                {\r\n                    name: \"Ecosystem Analysis\",\r\n                    href: \"/ecosystem\",\r\n                    icon: Users,\r\n                    description: \"Map actors, detect cultural holes, and visualize social networks.\"\r\n                },\r\n                {\r\n                    name: \"Cross-Case Analysis\",\r\n                    href: \"/synthesis\",\r\n                    icon: Network,\r\n                    description: \"Cross-case analysis and AI-powered framework comparison.\"\r\n                },\r\n            ]\r\n        },\r\n        {\r\n            title: \"Structural Governance\",\r\n            items: [\r\n                {\r\n                    name: \"Comparison\",\r\n                    href: \"/comparison\",\r\n                    icon: ArrowLeftRight,\r\n                    description: \"Side-by-side comparison of governance frameworks.\"\r\n                },\r\n                {\r\n                    name: \"Governance\",\r\n                    href: \"/governance\",\r\n                    icon: Scale,\r\n                    description: \"Analyze resource orchestration and institutional logics.\"\r\n                },\r\n                {\r\n                    name: \"Cultural Framing\",\r\n                    href: \"/cultural\",\r\n                    icon: Lightbulb,\r\n                    description: \"Examine cultural framing and epistemic authority.\"\r\n                },\r\n                {\r\n                    name: \"Concept Network\",\r\n                    href: \"/ontology\",\r\n                    icon: BookOpen,\r\n                    description: \"Visual map of key concepts and their relationships.\"\r\n                },\r\n                {\r\n                    name: \"Temporal Dynamics\",\r\n                    href: \"/timeline\",\r\n                    icon: Clock,\r\n                    description: \"Track the evolution of discourse and policy over time.\"\r\n                },\r\n            ]\r\n        },\r\n        {\r\n            title: \"Educational Resources\",\r\n            items: [\r\n                {\r\n                    name: \"Critical Glossary\",\r\n                    href: \"/glossary\",\r\n                    icon: BookOpen,\r\n                    description: \"Definitions of key theoretical concepts and terms.\"\r\n                },\r\n                {\r\n                    name: \"Literature Review\",\r\n                    href: \"/literature\",\r\n                    icon: BookOpen,\r\n                    description: \"Theoretical framework and key scholarship.\"\r\n                }\r\n            ]\r\n        }\r\n    ];\r\n\r\n    const SidebarContent = () => (\r\n        <div className=\"flex flex-col h-full bg-white\">\r\n            <div className=\"p-6 border-b border-slate-100\">\r\n                <Link href=\"/\" className=\"flex items-center gap-2\">\r\n                    <div className=\"w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center\">\r\n                        <LayoutDashboard className=\"text-white w-5 h-5\" />\r\n                    </div>\r\n                    <span className=\"font-bold text-lg text-slate-900 tracking-tight\">\r\n                        Assemblage<span className=\"text-blue-600\">-AI</span>\r\n                    </span>\r\n                </Link>\r\n            </div>\r\n\r\n            <div className=\"flex-1 overflow-y-auto py-6 px-4 space-y-8\">\r\n                {navGroups.map((group, groupIndex) => (\r\n                    <div key={groupIndex}>\r\n                        <h3 className=\"text-xs font-semibold text-slate-400 uppercase tracking-wider mb-3 px-2\">\r\n                            {group.title}\r\n                        </h3>\r\n                        <div className=\"space-y-1\">\r\n                            {group.items.map((item) => {\r\n                                const isActive = pathname === item.href;\r\n                                return (\r\n                                    <TooltipProvider key={item.href} delayDuration={0}>\r\n                                        <Tooltip>\r\n                                            <TooltipTrigger asChild>\r\n                                                <Link\r\n                                                    href={item.href}\r\n                                                    className={cn(\r\n                                                        \"flex items-center gap-3 px-3 py-2 rounded-md text-sm font-medium transition-colors\",\r\n                                                        isActive\r\n                                                            ? \"bg-blue-50 text-blue-700\"\r\n                                                            : \"text-slate-600 hover:bg-slate-50 hover:text-slate-900\"\r\n                                                    )}\r\n                                                >\r\n                                                    <item.icon size={18} />\r\n                                                    {item.name}\r\n                                                </Link>\r\n                                            </TooltipTrigger>\r\n                                            <TooltipContent side=\"right\" className=\"max-w-xs bg-slate-900 text-white border-slate-800 hidden lg:block\">\r\n                                                <p>{item.description}</p>\r\n                                            </TooltipContent>\r\n                                        </Tooltip>\r\n                                    </TooltipProvider>\r\n                                );\r\n                            })}\r\n                        </div>\r\n                    </div>\r\n                ))}\r\n            </div>\r\n\r\n            <div className=\"p-4 border-t border-slate-100 bg-slate-50\">\r\n                <div className=\"flex items-center gap-3 justify-center\">\r\n                    {isMounted && <UserButton showName />}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n\r\n    return (\r\n        <>\r\n            {/* Desktop Sidebar */}\r\n            <div className=\"hidden md:flex w-64 border-r border-slate-200 bg-white flex-col h-full flex-shrink-0\">\r\n                <SidebarContent />\r\n            </div>\r\n\r\n            {/* Mobile Header */}\r\n            <div className=\"md:hidden flex items-center justify-between p-4 bg-white border-b border-slate-200 fixed top-0 left-0 right-0 z-30\">\r\n                <Link href=\"/\" className=\"flex items-center gap-2\">\r\n                    <div className=\"w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center\">\r\n                        <LayoutDashboard className=\"text-white w-5 h-5\" />\r\n                    </div>\r\n                    <span className=\"font-bold text-lg text-slate-900 tracking-tight\">\r\n                        Assemblage<span className=\"text-blue-600\">-AI</span>\r\n                    </span>\r\n                </Link>\r\n                <button\r\n                    onClick={() => setIsMobileOpen(true)}\r\n                    className=\"p-2 text-slate-600 hover:bg-slate-100 rounded-md\"\r\n                >\r\n                    <Menu className=\"w-6 h-6\" />\r\n                </button>\r\n            </div>\r\n\r\n            {/* Mobile Drawer Overlay */}\r\n            {isMobileOpen && (\r\n                <div className=\"fixed inset-0 z-50 md:hidden\">\r\n                    {/* Backdrop */}\r\n                    <div\r\n                        className=\"absolute inset-0 bg-black/50 backdrop-blur-sm\"\r\n                        onClick={() => setIsMobileOpen(false)}\r\n                    />\r\n                    {/* Drawer */}\r\n                    <div className=\"absolute top-0 left-0 bottom-0 w-80 bg-white shadow-xl flex flex-col animate-in slide-in-from-left duration-200\">\r\n                        <div className=\"flex justify-end p-4 border-b border-slate-100\">\r\n                            <button\r\n                                onClick={() => setIsMobileOpen(false)}\r\n                                className=\"p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-md\"\r\n                            >\r\n                                <X className=\"w-6 h-6\" />\r\n                            </button>\r\n                        </div>\r\n                        <div className=\"flex-1 overflow-hidden\">\r\n                            <SidebarContent />\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\ecosystem\\ActorList.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\ecosystem\\ConfigurationDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\ecosystem\\CulturalHolesAnalysis.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":63,"column":62,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":63,"endColumn":65,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3367,3370],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3367,3370],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":86,"column":81,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":86,"endColumn":84,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5243,5246],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5243,5246],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":147,"column":59,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[9505,9549],"text":"Click &quot;Analyze Holes\" to detect disconnects."},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[9505,9549],"text":"Click &ldquo;Analyze Holes\" to detect disconnects."},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[9505,9549],"text":"Click &#34;Analyze Holes\" to detect disconnects."},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[9505,9549],"text":"Click &rdquo;Analyze Holes\" to detect disconnects."},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":147,"column":73,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[9505,9549],"text":"Click \"Analyze Holes&quot; to detect disconnects."},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[9505,9549],"text":"Click \"Analyze Holes&ldquo; to detect disconnects."},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[9505,9549],"text":"Click \"Analyze Holes&#34; to detect disconnects."},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[9505,9549],"text":"Click \"Analyze Holes&rdquo; to detect disconnects."},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CulturalHoleChart' is defined but never used.","line":155,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":155,"endColumn":27}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Zap, Loader2, Users } from 'lucide-react';\r\nimport { Bar, BarChart, XAxis, YAxis, Tooltip, ResponsiveContainer, Cell } from 'recharts';\r\nimport { CulturalHolesAnalysisResult, CulturalHole } from '@/types/ecosystem';\r\n\r\ninterface CulturalHolesAnalysisProps {\r\n    culturalHoles: CulturalHolesAnalysisResult | null;\r\n    isAnalyzingHoles: boolean;\r\n    onAnalyze: () => void;\r\n}\r\n\r\nexport function CulturalHolesAnalysis({ culturalHoles, isAnalyzingHoles, onAnalyze }: CulturalHolesAnalysisProps) {\r\n    return (\r\n        <Card className=\"min-h-[300px] flex flex-col\">\r\n            <CardHeader>\r\n                <div className=\"flex flex-col md:flex-row items-start md:items-center justify-between gap-4 md:gap-0\">\r\n                    <div className=\"flex items-center gap-2\">\r\n                        <Zap className=\"h-5 w-5 text-amber-600\" />\r\n                        <CardTitle>Cultural Holes & Disconnects</CardTitle>\r\n                    </div>\r\n                    <Button size=\"sm\" variant=\"outline\" onClick={onAnalyze} disabled={isAnalyzingHoles}>\r\n                        {isAnalyzingHoles ? (\r\n                            <>\r\n                                <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\r\n                                Analyzing...\r\n                            </>\r\n                        ) : (\r\n                            \"Analyze Holes\"\r\n                        )}\r\n                    </Button>\r\n                </div>\r\n                <CardDescription>\r\n                    Identifying semantic distance and missing links between actor communities.\r\n                </CardDescription>\r\n            </CardHeader>\r\n            <CardContent className=\"flex-1 bg-slate-50/50 p-6 border-t\">\r\n                {culturalHoles ? (\r\n                    <div className=\"space-y-6\">\r\n                        <div className=\"flex items-center justify-between\">\r\n                            <h4 className=\"font-semibold text-sm text-slate-700\">Connectivity Score</h4>\r\n                            <Badge variant={culturalHoles.overall_connectivity_score > 0.7 ? \"default\" : \"destructive\"}>\r\n                                {(culturalHoles.overall_connectivity_score * 100).toFixed(0)}%\r\n                            </Badge>\r\n                        </div>\r\n\r\n                        {/* Analysis Summary */}\r\n                        {culturalHoles.summary && (\r\n                            <div className=\"bg-indigo-50 p-4 rounded-md border border-indigo-100 text-sm text-slate-700\">\r\n                                <div className=\"flex items-center gap-2 mb-2\">\r\n                                    <Zap className=\"h-4 w-4 text-indigo-600\" />\r\n                                    <span className=\"font-semibold text-indigo-900\">Analysis Summary</span>\r\n                                </div>\r\n                                <p>{culturalHoles.summary}</p>\r\n                            </div>\r\n                        )}\r\n\r\n                        <ConceptCloud holes={culturalHoles.holes} />\r\n\r\n                        <div className=\"space-y-4\">\r\n                            {culturalHoles.holes?.map((hole: any, i: number) => (\r\n                                <div key={i} className=\"bg-white p-4 rounded-md border border-amber-200 shadow-sm\">\r\n                                    <div className=\"flex items-center justify-between mb-2\">\r\n                                        <div className=\"flex items-center gap-2\">\r\n                                            <Badge variant=\"outline\" className=\"text-xs font-normal text-slate-500\">Gap</Badge>\r\n                                            <span className=\"font-bold text-amber-700 text-sm\">\r\n                                                {hole.clusterA} <span className=\"text-slate-400 mx-1\">↔</span> {hole.clusterB}\r\n                                            </span>\r\n                                        </div>\r\n                                        <Badge variant=\"secondary\" className=\"text-xs\">\r\n                                            Dist: {(hole.distance * 100).toFixed(0)}%\r\n                                        </Badge>\r\n                                    </div>\r\n\r\n                                    <div className=\"mb-3\">\r\n                                        <p className=\"text-xs font-semibold text-slate-700 mb-1\">Opportunity:</p>\r\n                                        <p className=\"text-xs text-slate-600\">{hole.opportunity}</p>\r\n                                    </div>\r\n\r\n                                    {hole.bridgingConcepts && hole.bridgingConcepts.length > 0 && (\r\n                                        <div className=\"bg-slate-50 p-2 rounded border border-slate-100\">\r\n                                            <p className=\"text-[10px] uppercase tracking-wider text-slate-400 font-bold mb-2\">Bridging Concepts</p>\r\n                                            <div className=\"space-y-2\">\r\n                                                {hole.bridgingConcepts.map((bc: any, idx: number) => (\r\n                                                    <div key={idx} className=\"flex flex-col gap-1\">\r\n                                                        <span className=\"text-xs font-bold text-indigo-600\">{bc.concept}</span>\r\n                                                        <span className=\"text-xs text-slate-500\">{bc.description}</span>\r\n                                                    </div>\r\n                                                ))}\r\n                                            </div>\r\n                                        </div>\r\n                                    )}\r\n                                </div>\r\n                            ))}\r\n                        </div>\r\n\r\n                        {/* Silences (Ghost Nodes) Section */}\r\n                        {culturalHoles.silences && culturalHoles.silences.length > 0 && (\r\n                            <div className=\"space-y-4 pt-4 border-t border-slate-200\">\r\n                                <div className=\"flex items-center gap-2\">\r\n                                    <Users className=\"h-4 w-4 text-slate-500\" />\r\n                                    <h4 className=\"font-semibold text-sm text-slate-700\">Detected Silences (Ghost Nodes)</h4>\r\n                                </div>\r\n                                <p className=\"text-xs text-slate-500\">\r\n                                    Stakeholders or concepts from the global ontology that are absent in the current discourse.\r\n                                </p>\r\n                                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3\">\r\n                                    {culturalHoles.silences.map((silence, i) => (\r\n                                        <div key={i} className=\"bg-slate-50 p-3 rounded border border-slate-200 opacity-70 hover:opacity-100 transition-opacity\">\r\n                                            <div className=\"flex items-center justify-between mb-1\">\r\n                                                <span className=\"font-medium text-sm text-slate-700\">{silence.name}</span>\r\n                                                <Badge variant=\"outline\" className=\"text-[10px] bg-white\">{silence.category}</Badge>\r\n                                            </div>\r\n                                            <div className=\"flex flex-wrap gap-1\">\r\n                                                {silence.keywords.slice(0, 3).map(k => (\r\n                                                    <span key={k} className=\"text-[10px] text-slate-400 bg-white px-1 rounded border border-slate-100\">\r\n                                                        #{k}\r\n                                                    </span>\r\n                                                ))}\r\n                                            </div>\r\n                                        </div>\r\n                                    ))}\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n\r\n                        {culturalHoles.recommendations?.length > 0 && (\r\n                            <div className=\"pt-4 border-t border-slate-200\">\r\n                                <h4 className=\"font-semibold text-sm text-slate-700 mb-3\">Bridging Recommendations</h4>\r\n                                <ul className=\"space-y-2\">\r\n                                    {culturalHoles.recommendations.map((rec: { role: string; action: string }, i: number) => (\r\n                                        <li key={i} className=\"text-xs text-slate-600 flex gap-2\">\r\n                                            <span className=\"font-bold text-indigo-600\">• {rec.role}:</span>\r\n                                            {rec.action}\r\n                                        </li>\r\n                                    ))}\r\n                                </ul>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                ) : (\r\n                    <div className=\"text-center text-slate-400 py-8\">\r\n                        <Users className=\"h-12 w-12 mx-auto mb-2 opacity-20\" />\r\n                        <p>No analysis yet.</p>\r\n                        <p className=\"text-xs mt-1\">Click \"Analyze Holes\" to detect disconnects.</p>\r\n                    </div>\r\n                )}\r\n            </CardContent>\r\n        </Card>\r\n    );\r\n}\r\n\r\nfunction CulturalHoleChart({ hole }: { hole: CulturalHole }) {\r\n    if (!hole.scores) return null;\r\n\r\n    const data = Object.entries(hole.scores).map(([name, score]) => ({\r\n        name,\r\n        score: score as number\r\n    }));\r\n\r\n    return (\r\n        <div className=\"mt-4 h-[150px] w-full\">\r\n            <div className=\"flex items-center justify-between mb-2\">\r\n                <p className=\"text-[10px] text-slate-400 uppercase tracking-wider font-semibold\">Concept Affinity Gap</p>\r\n                <div className=\"flex gap-2 text-[9px] text-slate-500\">\r\n                    <div className=\"flex items-center gap-1\"><div className=\"w-2 h-2 rounded-full bg-[#3b82f6]\"></div>High Affinity</div>\r\n                    <div className=\"flex items-center gap-1\"><div className=\"w-2 h-2 rounded-full bg-[#f59e0b]\"></div>Low Affinity</div>\r\n                </div>\r\n            </div>\r\n            <ResponsiveContainer width=\"100%\" height=\"100%\">\r\n                <BarChart data={data} layout=\"vertical\" margin={{ top: 0, right: 30, left: 40, bottom: 0 }}>\r\n                    <XAxis type=\"number\" domain={[0, 10]} hide />\r\n                    <YAxis dataKey=\"name\" type=\"category\" width={80} tick={{ fontSize: 10 }} />\r\n                    <Tooltip\r\n                        cursor={{ fill: 'transparent' }}\r\n                        contentStyle={{ fontSize: '12px', borderRadius: '6px' }}\r\n                    />\r\n                    <Bar dataKey=\"score\" radius={[0, 4, 4, 0]} barSize={20}>\r\n                        {data.map((entry, index) => (\r\n                            <Cell key={`cell-${index}`} fill={entry.score < 5 ? '#f59e0b' : '#3b82f6'} />\r\n                        ))}\r\n                    </Bar>\r\n                </BarChart>\r\n            </ResponsiveContainer>\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction ConceptCloud({ holes }: { holes: CulturalHole[] }) {\r\n    if (!holes || holes.length === 0) return null;\r\n\r\n    return (\r\n        <div className=\"flex flex-wrap gap-2 mb-6 p-4 bg-slate-50 rounded-lg border border-slate-100\">\r\n            {holes.map((hole, i) => {\r\n                const size = hole.significance === 'High' ? 'text-lg' : hole.significance === 'Medium' ? 'text-sm' : 'text-xs';\r\n                const weight = hole.significance === 'High' ? 'font-bold' : 'font-medium';\r\n                const opacity = hole.significance === 'High' ? 'opacity-100' : 'opacity-70';\r\n\r\n                return (\r\n                    <span key={i} className={`${size} ${weight} ${opacity} text-indigo-600 bg-white px-2 py-1 rounded-full border border-indigo-100 shadow-sm`}>\r\n                        {hole.concept}\r\n                    </span>\r\n                );\r\n            })}\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\ecosystem\\EcosystemMap.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'j' is defined but never used.","line":283,"column":58,"nodeType":null,"messageId":"unusedVar","endLine":283,"endColumn":59}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useRef, useState } from 'react';\r\nimport { EcosystemActor, EcosystemConfiguration } from '@/types/ecosystem';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Network, MousePointer2, BoxSelect, Layers, Landmark, Users, Rocket, GraduationCap, Server, Database, Cpu, FileCode } from 'lucide-react';\r\n\r\ninterface EcosystemMapProps {\r\n    actors: EcosystemActor[];\r\n    configurations: EcosystemConfiguration[];\r\n    positions: Record<string, { x: number, y: number }>;\r\n    interactionMode: \"drag\" | \"select\";\r\n    setInteractionMode: (mode: \"drag\" | \"select\") => void;\r\n    selectedForGrouping: string[];\r\n    onToggleSelection: (actorId: string) => void;\r\n    onCreateConfiguration: () => void;\r\n    onActorDrag: (actorId: string, x: number, y: number) => void;\r\n    onConfigDrag: (configId: string, dx: number, dy: number) => void;\r\n}\r\n\r\nexport function EcosystemMap({\r\n    actors,\r\n    configurations,\r\n    positions,\r\n    interactionMode,\r\n    setInteractionMode,\r\n    selectedForGrouping,\r\n    onToggleSelection,\r\n    onCreateConfiguration,\r\n    onActorDrag,\r\n    onConfigDrag\r\n}: EcosystemMapProps) {\r\n    const [draggingId, setDraggingId] = useState<string | null>(null);\r\n    const [draggingConfigId, setDraggingConfigId] = useState<string | null>(null);\r\n    const dragStartRef = useRef<{ mouse: { x: number, y: number } } | null>(null);\r\n\r\n    const handleMouseDown = (e: React.MouseEvent, actorId: string) => {\r\n        e.stopPropagation();\r\n        e.preventDefault();\r\n\r\n        if (interactionMode === \"drag\") {\r\n            setDraggingId(actorId);\r\n        } else if (interactionMode === \"select\") {\r\n            onToggleSelection(actorId);\r\n        }\r\n    };\r\n\r\n    const handleConfigMouseDown = (e: React.MouseEvent, configId: string) => {\r\n        if (interactionMode !== \"drag\") return;\r\n        e.stopPropagation();\r\n        e.preventDefault();\r\n\r\n        const svg = (e.target as Element).closest('svg');\r\n        if (!svg) return;\r\n\r\n        const pt = svg.createSVGPoint();\r\n        pt.x = e.clientX;\r\n        pt.y = e.clientY;\r\n        const svgP = pt.matrixTransform(svg.getScreenCTM()?.inverse());\r\n\r\n        dragStartRef.current = { mouse: { x: svgP.x, y: svgP.y } };\r\n        setDraggingConfigId(configId);\r\n    };\r\n\r\n    const handleMouseMove = (e: React.MouseEvent<SVGSVGElement>) => {\r\n        if (interactionMode !== \"drag\") return;\r\n        if (!draggingId && !draggingConfigId) return;\r\n\r\n        const svg = e.currentTarget;\r\n        const pt = svg.createSVGPoint();\r\n        pt.x = e.clientX;\r\n        pt.y = e.clientY;\r\n        const svgP = pt.matrixTransform(svg.getScreenCTM()?.inverse());\r\n\r\n        if (draggingId) {\r\n            onActorDrag(draggingId, svgP.x, svgP.y);\r\n        } else if (draggingConfigId && dragStartRef.current) {\r\n            const dx = svgP.x - dragStartRef.current.mouse.x;\r\n            const dy = svgP.y - dragStartRef.current.mouse.y;\r\n\r\n            // Update start ref for next delta\r\n            dragStartRef.current = { mouse: { x: svgP.x, y: svgP.y } };\r\n\r\n            onConfigDrag(draggingConfigId, dx, dy);\r\n        }\r\n    };\r\n\r\n    const handleMouseUp = () => {\r\n        setDraggingId(null);\r\n        setDraggingConfigId(null);\r\n        dragStartRef.current = null;\r\n    };\r\n\r\n    // Convex Hull Algorithm\r\n    const getConvexHull = (points: { x: number, y: number }[]) => {\r\n        if (points.length < 3) return points;\r\n        points.sort((a, b) => a.x - b.x || a.y - b.y);\r\n\r\n        const cross = (o: { x: number, y: number }, a: { x: number, y: number }, b: { x: number, y: number }) => {\r\n            return (a.x - o.x) * (b.y - o.y) - (a.y - o.y) * (b.x - o.x);\r\n        };\r\n\r\n        const lower = [];\r\n        for (let i = 0; i < points.length; i++) {\r\n            while (lower.length >= 2 && cross(lower[lower.length - 2], lower[lower.length - 1], points[i]) <= 0) {\r\n                lower.pop();\r\n            }\r\n            lower.push(points[i]);\r\n        }\r\n\r\n        const upper = [];\r\n        for (let i = points.length - 1; i >= 0; i--) {\r\n            while (upper.length >= 2 && cross(upper[upper.length - 2], upper[upper.length - 1], points[i]) <= 0) {\r\n                upper.pop();\r\n            }\r\n            upper.push(points[i]);\r\n        }\r\n\r\n        upper.pop();\r\n        lower.pop();\r\n        return lower.concat(upper);\r\n    };\r\n\r\n    const renderConfigurationShapes = () => {\r\n        return configurations.map(config => {\r\n            const memberPoints = config.memberIds\r\n                .map(id => positions[id])\r\n                .filter(p => p !== undefined);\r\n\r\n            if (memberPoints.length < 2) return null;\r\n\r\n            let pathData = \"\";\r\n            let centroid = { x: 0, y: 0 };\r\n\r\n            if (memberPoints.length === 2) {\r\n                pathData = `M ${memberPoints[0].x} ${memberPoints[0].y} L ${memberPoints[1].x} ${memberPoints[1].y}`;\r\n                centroid = {\r\n                    x: (memberPoints[0].x + memberPoints[1].x) / 2,\r\n                    y: (memberPoints[0].y + memberPoints[1].y) / 2\r\n                };\r\n            } else {\r\n                const hull = getConvexHull(memberPoints);\r\n                pathData = `M ${hull.map(p => `${p.x},${p.y}`).join(\" L \")} Z`;\r\n                centroid = hull.reduce((acc, p) => ({ x: acc.x + p.x, y: acc.y + p.y }), { x: 0, y: 0 });\r\n                centroid.x /= hull.length;\r\n                centroid.y /= hull.length;\r\n            }\r\n\r\n            return (\r\n                <g\r\n                    key={config.id}\r\n                    onMouseDown={(e) => handleConfigMouseDown(e, config.id)}\r\n                    className={interactionMode === \"drag\" ? \"cursor-grab active:cursor-grabbing\" : \"\"}\r\n                    style={{ pointerEvents: 'all' }}\r\n                >\r\n                    <path\r\n                        d={pathData}\r\n                        fill={memberPoints.length > 2 ? config.color : \"none\"}\r\n                        stroke={config.color}\r\n                        strokeWidth={memberPoints.length > 2 ? \"40\" : \"60\"}\r\n                        strokeLinecap=\"round\"\r\n                        strokeLinejoin=\"round\"\r\n                        opacity=\"0.4\"\r\n                        className=\"transition-all duration-300\"\r\n                    />\r\n                    <text\r\n                        x={centroid.x}\r\n                        y={centroid.y}\r\n                        textAnchor=\"middle\"\r\n                        fill=\"#475569\"\r\n                        fontSize=\"12\"\r\n                        fontWeight=\"bold\"\r\n                        className=\"pointer-events-none select-none\"\r\n                    >\r\n                        {config.name}\r\n                    </text>\r\n                </g>\r\n            );\r\n        });\r\n    };\r\n\r\n    const getActorIcon = (type: string) => {\r\n        switch (type) {\r\n            case \"Policymaker\": return Landmark;\r\n            case \"Civil Society\": return Users;\r\n            case \"Startup\": return Rocket;\r\n            case \"Academic\": return GraduationCap;\r\n            case \"Infrastructure\": return Server;\r\n            case \"Algorithm\": return Cpu;\r\n            case \"Dataset\": return Database;\r\n            default: return FileCode;\r\n        }\r\n    };\r\n\r\n    const getLinkLabel = (sourceType: string, targetType: string) => {\r\n        if (sourceType === \"Policymaker\" && targetType === \"Civil Society\") return \"Consults\";\r\n        if (sourceType === \"Startup\" && targetType === \"Academic\") return \"Collaborates\";\r\n        if (sourceType === \"Policymaker\" && targetType === \"Startup\") return \"Regulates\";\r\n        if (sourceType === \"Civil Society\" && targetType === \"Academic\") return \"Studies\";\r\n        if (sourceType === \"Infrastructure\" && targetType === \"Startup\") return \"Supports\";\r\n        if (sourceType === \"Infrastructure\" && targetType === \"Policymaker\") return \"Informs\";\r\n        if (sourceType === \"Infrastructure\" && targetType === \"Academic\") return \"Provides Data\";\r\n\r\n        // Algorithm connections\r\n        if (sourceType === \"Startup\" && targetType === \"Algorithm\") return \"Develops\";\r\n        if (sourceType === \"Academic\" && targetType === \"Algorithm\") return \"Audits\";\r\n        if (sourceType === \"Algorithm\" && targetType === \"Dataset\") return \"Trained On\";\r\n        if (sourceType === \"Policymaker\" && targetType === \"Algorithm\") return \"Governs\";\r\n        if (sourceType === \"Infrastructure\" && targetType === \"Algorithm\") return \"Hosts\";\r\n        if (sourceType === \"Infrastructure\" && targetType === \"Dataset\") return \"Stores\";\r\n\r\n        return \"Relates To\";\r\n    };\r\n\r\n    return (\r\n        <Card className=\"min-h-[400px] flex flex-col\">\r\n            <CardHeader className=\"z-10 relative\">\r\n                <div className=\"flex items-center justify-between\">\r\n                    <div className=\"flex items-center gap-2\">\r\n                        <Network className=\"h-5 w-5 text-indigo-600\" />\r\n                        <CardTitle>Social Network Graph</CardTitle>\r\n                    </div>\r\n                    <div className=\"flex items-center gap-2\">\r\n                        <div className=\"flex bg-slate-100 p-1 rounded-lg\">\r\n                            <Button\r\n                                variant={interactionMode === \"drag\" ? \"secondary\" : \"ghost\"}\r\n                                size=\"sm\"\r\n                                className=\"h-7 px-2 text-xs\"\r\n                                onClick={() => setInteractionMode(\"drag\")}\r\n                            >\r\n                                <MousePointer2 className=\"h-3 w-3 mr-1\" />\r\n                                Drag\r\n                            </Button>\r\n                            <Button\r\n                                variant={interactionMode === \"select\" ? \"secondary\" : \"ghost\"}\r\n                                size=\"sm\"\r\n                                className=\"h-7 px-2 text-xs\"\r\n                                onClick={() => setInteractionMode(\"select\")}\r\n                            >\r\n                                <BoxSelect className=\"h-3 w-3 mr-1\" />\r\n                                Select\r\n                            </Button>\r\n                        </div>\r\n                        {interactionMode === \"select\" && selectedForGrouping.length > 0 && (\r\n                            <Button\r\n                                size=\"sm\"\r\n                                className=\"h-7 text-xs bg-indigo-600 hover:bg-indigo-700 text-white\"\r\n                                onClick={onCreateConfiguration}\r\n                            >\r\n                                <Layers className=\"h-3 w-3 mr-1\" />\r\n                                Group ({selectedForGrouping.length})\r\n                            </Button>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n                <CardDescription>\r\n                    Visualizing ties between actors. Switch to <strong>Select Mode</strong> and <strong>click nodes</strong> to group them.\r\n                </CardDescription>\r\n            </CardHeader>\r\n            <CardContent className=\"flex-1 bg-slate-50/50 p-6 border-t relative\">\r\n                <svg\r\n                    width=\"100%\"\r\n                    height=\"400\"\r\n                    className={`border rounded-lg bg-white transition-colors duration-300 ${interactionMode === \"drag\" ? \"cursor-move border-slate-200\" : \"cursor-crosshair border-indigo-400 ring-2 ring-indigo-100\"}`}\r\n                    onMouseMove={handleMouseMove}\r\n                    onMouseUp={handleMouseUp}\r\n                    onMouseLeave={handleMouseUp}\r\n                >\r\n                    <defs>\r\n                        <marker id=\"actor-arrow\" markerWidth=\"8\" markerHeight=\"8\" refX=\"20\" refY=\"4\" orient=\"auto\">\r\n                            <polygon points=\"0 0, 8 4, 0 8\" fill=\"#94a3b8\" />\r\n                        </marker>\r\n                        <filter id=\"actor-glow\" x=\"-50%\" y=\"-50%\" width=\"200%\" height=\"200%\">\r\n                            <feGaussianBlur stdDeviation=\"3\" result=\"blur\" />\r\n                            <feComposite in=\"SourceGraphic\" in2=\"blur\" operator=\"over\" />\r\n                        </filter>\r\n                    </defs>\r\n\r\n                    {/* Render Configuration Super-Nodes (Background) */}\r\n                    {renderConfigurationShapes()}\r\n\r\n                    {/* Generate connections based on actor types */}\r\n                    {actors.map((source, i) =>\r\n                        actors.slice(i + 1).map((target, j) => {\r\n                            const shouldConnect = (\r\n                                (source.type === \"Policymaker\" && target.type === \"Civil Society\") ||\r\n                                (source.type === \"Startup\" && target.type === \"Academic\") ||\r\n                                (source.type === \"Policymaker\" && target.type === \"Startup\") ||\r\n                                (source.type === \"Civil Society\" && target.type === \"Academic\") ||\r\n                                (source.type === \"Infrastructure\" && target.type === \"Startup\") ||\r\n                                (source.type === \"Infrastructure\" && target.type === \"Policymaker\") ||\r\n                                (source.type === \"Infrastructure\" && target.type === \"Academic\") ||\r\n                                // Algorithm connections\r\n                                (source.type === \"Startup\" && target.type === \"Algorithm\") ||\r\n                                (source.type === \"Academic\" && target.type === \"Algorithm\") ||\r\n                                (source.type === \"Algorithm\" && target.type === \"Dataset\") ||\r\n                                (source.type === \"Policymaker\" && target.type === \"Algorithm\") ||\r\n                                (source.type === \"Infrastructure\" && target.type === \"Algorithm\") ||\r\n                                (source.type === \"Infrastructure\" && target.type === \"Dataset\")\r\n                            );\r\n\r\n                            if (!shouldConnect) return null;\r\n\r\n                            const pos1 = positions[source.id];\r\n                            const pos2 = positions[target.id];\r\n\r\n                            if (!pos1 || !pos2) return null;\r\n\r\n                            const label = getLinkLabel(source.type, target.type);\r\n                            const midX = (pos1.x + pos2.x) / 2;\r\n                            const midY = (pos1.y + pos2.y) / 2;\r\n\r\n                            return (\r\n                                <g key={`${source.id}-${target.id}`}>\r\n                                    <line\r\n                                        x1={pos1.x}\r\n                                        y1={pos1.y}\r\n                                        x2={pos2.x}\r\n                                        y2={pos2.y}\r\n                                        stroke=\"#cbd5e1\"\r\n                                        strokeWidth=\"1\"\r\n                                        strokeDasharray=\"4\"\r\n                                    />\r\n                                    <rect\r\n                                        x={midX - (label.length * 3)}\r\n                                        y={midY - 8}\r\n                                        width={label.length * 6}\r\n                                        height=\"16\"\r\n                                        fill=\"white\"\r\n                                        opacity=\"0.8\"\r\n                                        rx=\"4\"\r\n                                    />\r\n                                    <text\r\n                                        x={midX}\r\n                                        y={midY + 3}\r\n                                        textAnchor=\"middle\"\r\n                                        fontSize=\"9\"\r\n                                        fill=\"#64748b\"\r\n                                        className=\"select-none pointer-events-none font-medium\"\r\n                                    >\r\n                                        {label}\r\n                                    </text>\r\n                                </g>\r\n                            );\r\n                        })\r\n                    )}\r\n\r\n                    {/* Render Actors */}\r\n                    {actors.map(actor => {\r\n                        const pos = positions[actor.id];\r\n                        if (!pos) return null;\r\n\r\n                        const isSelected = selectedForGrouping.includes(actor.id);\r\n                        const Icon = getActorIcon(actor.type);\r\n\r\n                        return (\r\n                            <g\r\n                                key={actor.id}\r\n                                transform={`translate(${pos.x},${pos.y})`}\r\n                                onMouseDown={(e) => handleMouseDown(e, actor.id)}\r\n                                className=\"cursor-pointer transition-all duration-200\"\r\n                                style={{\r\n                                    filter: isSelected ? \"url(#actor-glow)\" : \"none\"\r\n                                }}\r\n                            >\r\n                                <circle\r\n                                    r={isSelected ? 28 : 24}\r\n                                    fill={isSelected ? \"#4f46e5\" : \"white\"}\r\n                                    stroke={isSelected ? \"#4f46e5\" : \"#94a3b8\"}\r\n                                    strokeWidth=\"2\"\r\n                                    className=\"transition-all duration-300 shadow-sm\"\r\n                                />\r\n                                <foreignObject x=\"-12\" y=\"-12\" width=\"24\" height=\"24\" className=\"pointer-events-none\">\r\n                                    <div className={`flex items-center justify-center w-full h-full ${isSelected ? \"text-white\" : \"text-slate-600\"}`}>\r\n                                        <Icon size={16} />\r\n                                    </div>\r\n                                </foreignObject>\r\n                                <foreignObject x=\"-40\" y=\"28\" width=\"80\" height=\"40\">\r\n                                    <div className=\"text-center text-[10px] font-medium text-slate-700 leading-tight line-clamp-2 bg-white/80 px-1 rounded\">\r\n                                        {actor.name}\r\n                                    </div>\r\n                                </foreignObject>\r\n                            </g>\r\n                        );\r\n                    })}\r\n                </svg>\r\n            </CardContent>\r\n        </Card>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\governance\\GovernanceCompass.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Label' is defined but never used.","line":4,"column":107,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":112}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport React from 'react';\r\nimport { ScatterChart, Scatter, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, ReferenceLine, Label, Cell, LabelList } from 'recharts';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { DriftVector } from '@/lib/governance';\r\n\r\ninterface GovernanceCompassProps {\r\n    analysis: DriftVector | null;\r\n}\r\n\r\nexport function GovernanceCompass({ analysis }: GovernanceCompassProps) {\r\n    if (!analysis) {\r\n        return (\r\n            <Card className=\"h-[500px] flex items-center justify-center bg-slate-50 border-dashed\">\r\n                <p className=\"text-slate-400\">Run analysis to generate Governance Compass</p>\r\n            </Card>\r\n        );\r\n    }\r\n\r\n    const data = [\r\n        { x: analysis.rhetoric.x, y: analysis.rhetoric.y, name: 'Rhetoric', fill: '#3b82f6' }, // Blue\r\n        { x: analysis.reality.x, y: analysis.reality.y, name: 'Reality', fill: '#0f172a' },   // Black\r\n    ];\r\n\r\n    return (\r\n        <Card className=\"w-full\">\r\n            <CardHeader>\r\n                <CardTitle>Governance Drift Compass</CardTitle>\r\n                <CardDescription>\r\n                    Visualizing the gap between ethical rhetoric and technical reality.\r\n                    <br />\r\n                    <span className=\"text-xs text-slate-500\">\r\n                        Drift Magnitude: {analysis.magnitude.toFixed(2)} |\r\n                        X-Shift: {analysis.driftX.toFixed(2)} |\r\n                        Y-Shift: {analysis.driftY.toFixed(2)}\r\n                    </span>\r\n                </CardDescription>\r\n            </CardHeader>\r\n            <CardContent>\r\n                <div className=\"h-[500px] w-full relative\">\r\n                    {/* Background Quadrant Labels */}\r\n                    <div className=\"absolute top-4 right-4 text-xs font-bold text-emerald-600 bg-emerald-50 px-2 py-1 rounded opacity-80\">\r\n                        REGENERATIVE / PARTICIPATORY\r\n                    </div>\r\n                    <div className=\"absolute bottom-4 left-4 text-xs font-bold text-red-600 bg-red-50 px-2 py-1 rounded opacity-80\">\r\n                        EXTRACTIVE / ASYMMETRICAL\r\n                    </div>\r\n\r\n                    <ResponsiveContainer width=\"100%\" height=\"100%\">\r\n                        <ScatterChart margin={{ top: 20, right: 20, bottom: 40, left: 80 }}>\r\n                            <CartesianGrid strokeDasharray=\"3 3\" />\r\n                            <XAxis\r\n                                type=\"number\"\r\n                                dataKey=\"x\"\r\n                                name=\"Power\"\r\n                                domain={[-1.2, 1.2]}\r\n                                label={{ value: 'Power: Asymmetrical (-) vs Participatory (+)', position: 'bottom', offset: 0 }}\r\n                            />\r\n                            <YAxis\r\n                                type=\"number\"\r\n                                dataKey=\"y\"\r\n                                name=\"Value\"\r\n                                domain={[-1.2, 1.2]}\r\n                                label={{ value: 'Value: Extractive (-) vs Regenerative (+)', angle: -90, position: 'insideLeft', offset: 10, style: { textAnchor: 'middle' } }}\r\n                            />\r\n                            <ReferenceLine x={0} stroke=\"#64748b\" />\r\n                            <ReferenceLine y={0} stroke=\"#64748b\" />\r\n\r\n                            <Tooltip cursor={{ strokeDasharray: '3 3' }} />\r\n\r\n                            <Scatter name=\"Points\" data={data} fill=\"#8884d8\">\r\n                                {data.map((entry, index) => (\r\n                                    <Cell key={`cell-${index}`} fill={entry.fill} />\r\n                                ))}\r\n                                <LabelList dataKey=\"name\" position=\"top\" offset={10} style={{ fill: '#64748b', fontSize: '12px', fontWeight: 'bold' }} />\r\n                            </Scatter>\r\n                        </ScatterChart>\r\n                    </ResponsiveContainer>\r\n\r\n                    {/* SVG Overlay for the Arrow (Drift Vector) */}\r\n                    {/* Note: Precise overlay requires mapping coordinates to pixels, which is hard with ResponsiveContainer. \r\n                        For this MVP, we rely on the scatter points. A more advanced version would use a custom SVG layer. */}\r\n                </div>\r\n            </CardContent>\r\n        </Card>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\ontology\\ComparisonView.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\ontology\\ConceptDetailsModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\ontology\\ConceptList.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\ontology\\MapGallery.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\ontology\\OntologyMap.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\policy\\AddDocumentDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\policy\\AddUrlDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\policy\\AnalysisResults.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\policy\\DocumentCard.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AnalysisResult' is defined but never used.","line":1,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":32}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Source, AnalysisResult } from \"@/types\";\r\nimport { AnalysisMode } from \"@/services/analysis\";\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { FileText, Globe, Loader2, Sparkles, Trash, Globe2, Scale, Pencil } from \"lucide-react\";\r\nimport { AnalysisResults } from \"./AnalysisResults\";\r\nimport { LegitimacyAnalysisView } from \"./LegitimacyAnalysisView\";\r\n\r\ninterface DocumentCardProps {\r\n    source: Source;\r\n    isAnalyzing: boolean;\r\n    isSearching: boolean;\r\n    onAnalyze: (id: string, mode: AnalysisMode) => void;\r\n    onDelete: (id: string) => void;\r\n    onEdit: (source: Source) => void;\r\n    onFindTraces: (source: Source) => void;\r\n    onView: (source: Source) => void;\r\n    onUpdateSource?: (id: string, updates: Partial<Source>) => void;\r\n}\r\n\r\nexport function DocumentCard({\r\n    source,\r\n    isAnalyzing,\r\n    isSearching,\r\n    onAnalyze,\r\n    onDelete,\r\n    onEdit,\r\n    onFindTraces,\r\n    onView,\r\n    onUpdateSource\r\n}: DocumentCardProps) {\r\n    return (\r\n        <Card className=\"hover:shadow-md transition-shadow\">\r\n            <CardHeader className=\"flex flex-col md:flex-row items-start justify-between space-y-4 md:space-y-0 pb-2\">\r\n                <div className=\"space-y-1 flex-1 min-w-0 pr-0 md:pr-4 w-full\">\r\n                    <CardTitle className=\"text-base font-semibold break-words\">{source.title}</CardTitle>\r\n                    <CardDescription className=\"break-words\">{source.description}</CardDescription>\r\n                </div>\r\n                <div className=\"flex items-center gap-2 shrink-0 w-full md:w-auto justify-end md:justify-start\">\r\n                    <div\r\n                        className={`rounded-full p-2 ${source.colorClass} cursor-pointer hover:opacity-80 transition-opacity`}\r\n                        onClick={() => onView(source)}\r\n                        title=\"Click to view extracted text\"\r\n                    >\r\n                        <FileText className={`h-4 w-4 ${source.iconClass}`} />\r\n                    </div>\r\n                    <Button\r\n                        variant=\"ghost\"\r\n                        size=\"sm\"\r\n                        onClick={() => onFindTraces(source)}\r\n                        disabled={isSearching || !source.extractedText}\r\n                        className=\"h-8 w-8 p-0 hover:bg-blue-100 hover:text-blue-600 disabled:opacity-30\"\r\n                        title={source.extractedText ? \"Find empirical traces using Google Search\" : \"Upload a PDF or add text first to enable trace search\"}\r\n                    >\r\n                        {isSearching ? (\r\n                            <Loader2 className=\"h-4 w-4 animate-spin\" />\r\n                        ) : (\r\n                            <Globe className=\"h-4 w-4\" />\r\n                        )}\r\n                    </Button>\r\n                    <Button\r\n                        variant=\"ghost\"\r\n                        size=\"sm\"\r\n                        onClick={() => onDelete(source.id)}\r\n                        className=\"h-8 w-8 p-0 hover:bg-red-100 hover:text-red-600\"\r\n                    >\r\n                        <Trash className=\"h-4 w-4\" />\r\n                    </Button>\r\n                </div>\r\n            </CardHeader>\r\n            <CardContent>\r\n                <div className=\"mt-4 flex items-center space-x-2\">\r\n                    <Badge variant=\"secondary\" className=\"bg-green-100 text-green-700 hover:bg-green-100\">\r\n                        {source.status}\r\n                    </Badge>\r\n                    <span className=\"text-xs text-slate-500\">\r\n                        {source.type} {source.pageCount ? `• ${source.pageCount} pages` : ''}\r\n                    </span>\r\n                </div>\r\n                <div className=\"mt-4 flex flex-wrap gap-2 text-xs text-slate-500\">\r\n                    <div>Added: {source.addedDate}</div>\r\n                    {source.publicationDate && (\r\n                        <>\r\n                            <div>•</div>\r\n                            <div>Published: {source.publicationDate}</div>\r\n                        </>\r\n                    )}\r\n                    {source.version && (\r\n                        <>\r\n                            <div>•</div>\r\n                            <div>v{source.version}</div>\r\n                        </>\r\n                    )}\r\n                    {source.jurisdiction && (\r\n                        <>\r\n                            <div>•</div>\r\n                            <Badge variant=\"outline\" className=\"text-[10px] h-4 px-1\">\r\n                                {source.jurisdiction}\r\n                            </Badge>\r\n                        </>\r\n                    )}\r\n                </div>\r\n                <div className=\"mt-4 flex gap-2\">\r\n                    <Button\r\n                        variant=\"outline\"\r\n                        size=\"sm\"\r\n                        onClick={() => onEdit(source)}\r\n                        className=\"hover:bg-blue-50 hover:text-blue-600\"\r\n                    >\r\n                        <Pencil className=\"h-4 w-4 mr-2\" />\r\n                        Edit\r\n                    </Button>\r\n                </div>\r\n                {source.extractedText && (\r\n                    <div className=\"mt-4 space-y-2\">\r\n                        <Button\r\n                            onClick={() => onAnalyze(source.id, 'dsf')}\r\n                            disabled={isAnalyzing}\r\n                            className=\"w-full bg-purple-600 text-white hover:bg-purple-700\"\r\n                            size=\"sm\"\r\n                        >\r\n                            {isAnalyzing ? (\r\n                                <>\r\n                                    <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\r\n                                    Analyzing...\r\n                                </>\r\n                            ) : (\r\n                                <>\r\n                                    <Sparkles className=\"mr-2 h-4 w-4\" />\r\n                                    {source.analysis ? 'Re-analyze with AI' : 'Analyze with AI'}\r\n                                </>\r\n                            )}\r\n                        </Button>\r\n                        <div className=\"grid grid-cols-3 gap-2\">\r\n                            <Button\r\n                                onClick={() => onAnalyze(source.id, 'cultural_framing')}\r\n                                disabled={isAnalyzing}\r\n                                variant=\"outline\"\r\n                                size=\"sm\"\r\n                                className=\"text-xs border-purple-200 hover:bg-purple-50\"\r\n                                title=\"Analyze cultural framing for CFP\"\r\n                            >\r\n                                <Globe2 className=\"mr-1 h-3 w-3\" />\r\n                                Cultural\r\n                            </Button>\r\n                            <Button\r\n                                onClick={() => onAnalyze(source.id, 'institutional_logics')}\r\n                                disabled={isAnalyzing}\r\n                                variant=\"outline\"\r\n                                size=\"sm\"\r\n                                className=\"text-xs border-purple-200 hover:bg-purple-50\"\r\n                                title=\"Analyze institutional logics for CFP\"\r\n                            >\r\n                                <Scale className=\"mr-1 h-3 w-3\" />\r\n                                Logics\r\n                            </Button>\r\n                            <Button\r\n                                onClick={() => onAnalyze(source.id, 'legitimacy')}\r\n                                disabled={isAnalyzing}\r\n                                variant=\"outline\"\r\n                                size=\"sm\"\r\n                                className=\"text-xs border-purple-200 hover:bg-purple-50\"\r\n                                title=\"Analyze legitimacy and justification\"\r\n                            >\r\n                                <Scale className=\"mr-1 h-3 w-3\" />\r\n                                Legitimacy\r\n                            </Button>\r\n                        </div>\r\n                    </div>\r\n                )}\r\n                {source.analysis && (\r\n                    <AnalysisResults\r\n                        analysis={source.analysis}\r\n                        sourceTitle={source.title}\r\n                        onUpdate={(updates) => onUpdateSource && onUpdateSource(source.id, {\r\n                            analysis: { ...source.analysis!, ...updates }\r\n                        })}\r\n                    />\r\n                )}\r\n                {source.legitimacy_analysis && (\r\n                    <div className=\"mt-6 pt-4 border-t border-slate-100\">\r\n                        <h3 className=\"text-sm font-semibold text-slate-900 mb-4\">Legitimacy & Justification Analysis</h3>\r\n                        <LegitimacyAnalysisView analysis={source.legitimacy_analysis} />\r\n                    </div>\r\n                )}\r\n            </CardContent>\r\n        </Card>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\policy\\DocumentToolbar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\policy\\EditSourceDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\policy\\GovernanceCompass.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Label' is defined but never used.","line":1,"column":105,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":110}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { ResponsiveContainer, ScatterChart, Scatter, XAxis, YAxis, ZAxis, Tooltip, Cell, ReferenceLine, Label } from 'recharts';\r\n\r\ninterface GovernanceCompassProps {\r\n    rhetoricScore: number; // 0-100 (Y-Axis)\r\n    realityScore: number; // 0-100 (X-Axis)\r\n    driftExplanation?: string;\r\n}\r\n\r\nexport function GovernanceCompass({ rhetoricScore, realityScore, driftExplanation }: GovernanceCompassProps) {\r\n    const data = [\r\n        { x: realityScore, y: rhetoricScore, name: 'Governance State' }\r\n    ];\r\n\r\n    // Calculate drift magnitude\r\n    const drift = Math.abs(rhetoricScore - realityScore);\r\n    const isHighDrift = drift > 30;\r\n\r\n    return (\r\n        <div className=\"p-4 rounded-xl bg-white border border-slate-200 shadow-sm\">\r\n            <div className=\"mb-4\">\r\n                <h4 className=\"text-sm font-bold text-slate-900 uppercase tracking-wide\">Governance Compass</h4>\r\n                <p className=\"text-xs text-slate-500\">Mapping Discursive Claims (Rhetoric) vs. Material Operations (Reality)</p>\r\n            </div>\r\n\r\n            <div className=\"h-[300px] w-full relative\">\r\n                <ResponsiveContainer width=\"100%\" height=\"100%\">\r\n                    <ScatterChart margin={{ top: 20, right: 20, bottom: 20, left: 20 }}>\r\n                        <XAxis\r\n                            type=\"number\"\r\n                            dataKey=\"x\"\r\n                            name=\"Reality (Enforcement)\"\r\n                            domain={[0, 100]}\r\n                            tick={{ fontSize: 10 }}\r\n                            label={{ value: 'Material Reality (Enforcement) →', position: 'bottom', offset: 0, fontSize: 10 }}\r\n                        />\r\n                        <YAxis\r\n                            type=\"number\"\r\n                            dataKey=\"y\"\r\n                            name=\"Rhetoric (Claims)\"\r\n                            domain={[0, 100]}\r\n                            tick={{ fontSize: 10 }}\r\n                            label={{ value: 'Discursive Rhetoric (Claims) →', angle: -90, position: 'left', offset: 0, fontSize: 10 }}\r\n                        />\r\n                        <ZAxis range={[100, 100]} />\r\n                        <Tooltip cursor={{ strokeDasharray: '3 3' }} />\r\n\r\n                        {/* Quadrant Lines */}\r\n                        <ReferenceLine x={50} stroke=\"#e2e8f0\" />\r\n                        <ReferenceLine y={50} stroke=\"#e2e8f0\" />\r\n\r\n                        {/* Quadrant Labels */}\r\n                        <ReferenceLine y={90} label={{ value: \"High Rhetoric\", position: 'insideTopRight', fontSize: 10, fill: '#94a3b8' }} stroke=\"none\" />\r\n                        <ReferenceLine x={90} label={{ value: \"High Reality\", position: 'insideTopRight', fontSize: 10, fill: '#94a3b8' }} stroke=\"none\" />\r\n\r\n                        {/* Drift Vector (Ideal Line) */}\r\n                        <ReferenceLine segment={[{ x: 0, y: 0 }, { x: 100, y: 100 }]} stroke=\"#cbd5e1\" strokeDasharray=\"3 3\" />\r\n\r\n                        <Scatter data={data} fill=\"#8884d8\">\r\n                            {data.map((entry, index) => (\r\n                                <Cell key={`cell-${index}`} fill={isHighDrift ? '#ef4444' : '#10b981'} />\r\n                            ))}\r\n                        </Scatter>\r\n                    </ScatterChart>\r\n                </ResponsiveContainer>\r\n\r\n                {/* Custom Annotation for the Point */}\r\n                <div\r\n                    className=\"absolute transform -translate-x-1/2 -translate-y-1/2 pointer-events-none\"\r\n                    style={{\r\n                        left: `${(realityScore / 100) * 80 + 10}%`, // Rough approximation for positioning\r\n                        bottom: `${(rhetoricScore / 100) * 80 + 10}%`\r\n                    }}\r\n                >\r\n                    <div className={`px-2 py-1 rounded text-[10px] font-bold text-white ${isHighDrift ? 'bg-red-500' : 'bg-emerald-500'} shadow-sm whitespace-nowrap`}>\r\n                        {isHighDrift ? 'Drift Detected' : 'Aligned'}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {isHighDrift && (\r\n                <div className=\"mt-4 p-3 rounded-lg bg-red-50 border border-red-100 text-xs text-red-800\">\r\n                    <strong>Governance Drift:</strong> {driftExplanation || \"Significant gap between ethical claims and enforcement mechanisms.\"}\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\policy\\LegitimacyAnalysisView.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardDescription' is defined but never used.","line":4,"column":29,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":44}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { LegitimacyAnalysis } from \"@/types\";\r\nimport { Radar, RadarChart, PolarGrid, PolarAngleAxis, PolarRadiusAxis, ResponsiveContainer, Tooltip } from 'recharts';\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Scale } from \"lucide-react\";\r\n\r\ninterface LegitimacyAnalysisViewProps {\r\n    analysis: LegitimacyAnalysis;\r\n}\r\n\r\nexport function LegitimacyAnalysisView({ analysis }: LegitimacyAnalysisViewProps) {\r\n    if (!analysis || !analysis.orders) return null;\r\n\r\n    const data = [\r\n        { subject: 'Market', A: analysis.orders.market, fullMark: 10 },\r\n        { subject: 'Industrial', A: analysis.orders.industrial, fullMark: 10 },\r\n        { subject: 'Civic', A: analysis.orders.civic, fullMark: 10 },\r\n        { subject: 'Domestic', A: analysis.orders.domestic, fullMark: 10 },\r\n        { subject: 'Inspired', A: analysis.orders.inspired, fullMark: 10 },\r\n        { subject: 'Fame', A: analysis.orders.fame, fullMark: 10 },\r\n    ];\r\n\r\n    return (\r\n        <div className=\"space-y-6\">\r\n            <div className=\"flex flex-col md:flex-row gap-6\">\r\n                {/* Radar Chart */}\r\n                <div className=\"w-full md:w-1/2 h-[300px]\">\r\n                    <ResponsiveContainer width=\"100%\" height=\"100%\">\r\n                        <RadarChart cx=\"50%\" cy=\"50%\" outerRadius=\"80%\" data={data}>\r\n                            <PolarGrid stroke=\"#e2e8f0\" />\r\n                            <PolarAngleAxis dataKey=\"subject\" tick={{ fill: '#64748b', fontSize: 12 }} />\r\n                            <PolarRadiusAxis angle={30} domain={[0, 10]} tick={false} axisLine={false} />\r\n                            <Radar\r\n                                name=\"Legitimacy\"\r\n                                dataKey=\"A\"\r\n                                stroke=\"#4f46e5\"\r\n                                strokeWidth={2}\r\n                                fill=\"#6366f1\"\r\n                                fillOpacity={0.4}\r\n                            />\r\n                            <Tooltip\r\n                                contentStyle={{ borderRadius: '8px', border: 'none', boxShadow: '0 4px 6px -1px rgb(0 0 0 / 0.1)' }}\r\n                            />\r\n                        </RadarChart>\r\n                    </ResponsiveContainer>\r\n                </div>\r\n\r\n                {/* Analysis Details */}\r\n                <div className=\"w-full md:w-1/2 space-y-4\">\r\n                    <div>\r\n                        <h4 className=\"text-sm font-semibold text-slate-500 uppercase tracking-wider mb-2\">Dominant Order</h4>\r\n                        <div className=\"flex items-center gap-2\">\r\n                            <Scale className=\"h-5 w-5 text-indigo-600\" />\r\n                            <span className=\"text-lg font-bold text-slate-900\">{analysis.dominant_order}</span>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div>\r\n                        <h4 className=\"text-sm font-semibold text-slate-500 uppercase tracking-wider mb-2\">Justification Logic</h4>\r\n                        <p className=\"text-sm text-slate-700 leading-relaxed bg-slate-50 p-3 rounded-md border border-slate-100\">\r\n                            {analysis.justification_logic}\r\n                        </p>\r\n                    </div>\r\n\r\n                    <div>\r\n                        <h4 className=\"text-sm font-semibold text-slate-500 uppercase tracking-wider mb-2\">Moral Vocabulary</h4>\r\n                        <div className=\"flex flex-wrap gap-2\">\r\n                            {analysis.moral_vocabulary?.map((term, i) => (\r\n                                <Badge key={i} variant=\"secondary\" className=\"bg-indigo-50 text-indigo-700 hover:bg-indigo-100\">\r\n                                    {term}\r\n                                </Badge>\r\n                            ))}\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Conflict Spot */}\r\n            {analysis.conflict_spot && (\r\n                <Card className=\"bg-amber-50 border-amber-200\">\r\n                    <CardHeader className=\"pb-2\">\r\n                        <CardTitle className=\"text-sm font-bold text-amber-800 flex items-center gap-2\">\r\n                            ⚠️ Conflict Spot\r\n                        </CardTitle>\r\n                    </CardHeader>\r\n                    <CardContent>\r\n                        <p className=\"text-sm text-amber-900\">\r\n                            {analysis.conflict_spot}\r\n                        </p>\r\n                    </CardContent>\r\n                </Card>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\policy\\ViewSourceDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\reflexivity\\LogEntry.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CheckCircle' is defined but never used.","line":4,"column":31,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":42},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":29,"column":43,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[1614,1615],"text":"&quot;"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[1614,1615],"text":"&ldquo;"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[1614,1615],"text":"&#34;"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[1614,1615],"text":"&rdquo;"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":29,"column":67,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[1638,1639],"text":"&quot;"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[1638,1639],"text":"&ldquo;"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[1638,1639],"text":"&#34;"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[1638,1639],"text":"&rdquo;"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":104,"column":33,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[6616,6651],"text":"\r\n                                &quot;"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[6616,6651],"text":"\r\n                                &ldquo;"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[6616,6651],"text":"\r\n                                &#34;"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[6616,6651],"text":"\r\n                                &rdquo;"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":104,"column":147,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[6764,6795],"text":"&quot;\r\n                            "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[6764,6795],"text":"&ldquo;\r\n                            "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[6764,6795],"text":"&#34;\r\n                            "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[6764,6795],"text":"&rdquo;\r\n                            "},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { MethodLog } from \"@/types/logs\";\r\nimport { Tooltip, TooltipContent, TooltipProvider, TooltipTrigger } from \"@/components/ui/tooltip\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Info, AlertTriangle, CheckCircle, BrainCircuit, Scale, User, Bot } from \"lucide-react\";\r\n\r\nconst formatEnum = (value: string) => {\r\n    return value.split('_').map(word => word.charAt(0) + word.slice(1).toLowerCase()).join(' ');\r\n};\r\n\r\nexport function LogEntry({ log }: { log: MethodLog }) {\r\n    const isConflictLog = !!log.details.discrepancy;\r\n    const isPositionalityLog = log.action === \"Positionality Calibration\";\r\n\r\n    return (\r\n        <div className={`border-l-2 pl-4 py-3 space-y-2 transition-all ${isConflictLog ? 'border-amber-400 bg-amber-50/30 rounded-r-lg pr-2' : 'border-slate-200'}`}>\r\n            <div className=\"flex items-center justify-between mb-1\">\r\n                <span className=\"text-xs font-semibold text-slate-500\">\r\n                    {new Date(log.timestamp).toLocaleString()}\r\n                </span>\r\n                <Badge variant={isConflictLog ? \"default\" : \"outline\"} className={`text-xs ${isConflictLog ? 'bg-amber-600 hover:bg-amber-700' : ''}`}>\r\n                    {log.action}\r\n                </Badge>\r\n            </div>\r\n\r\n            {/* Positionality Statement */}\r\n            {log.details.statement && (\r\n                <div className=\"bg-slate-50 p-3 rounded-md border border-slate-100 text-sm text-slate-700 italic relative\">\r\n                    <User className=\"h-3 w-3 absolute top-3 left-2 text-slate-400\" />\r\n                    <div className=\"pl-4\">\"{log.details.statement}\"</div>\r\n                    {isPositionalityLog && (\r\n                        <div className=\"mt-2 text-xs text-slate-500 flex gap-2\">\r\n                            <Badge variant=\"secondary\" className=\"text-[10px]\">Locus: {log.details.locus as string}</Badge>\r\n                            <Badge variant=\"secondary\" className=\"text-[10px]\">Lens: {log.details.discipline as string}</Badge>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            )}\r\n\r\n            {/* Rich Conflict Resolution Log */}\r\n            {log.details.discrepancy && (\r\n                <div className=\"mt-2 space-y-3\">\r\n                    <div className=\"bg-white p-3 rounded-md border border-slate-200 shadow-sm\">\r\n                        <div className=\"flex items-center gap-2 mb-2\">\r\n                            <Scale className=\"h-4 w-4 text-amber-600\" />\r\n                            <span className=\"font-semibold text-slate-800 text-xs uppercase tracking-wide\">Interpretive Discrepancy</span>\r\n                            <TooltipProvider>\r\n                                <Tooltip>\r\n                                    <TooltipTrigger>\r\n                                        <Info className=\"h-3 w-3 text-slate-400 cursor-help\" />\r\n                                    </TooltipTrigger>\r\n                                    <TooltipContent className=\"max-w-xs\">\r\n                                        <p>The AI detected a divergence between its analysis and your anchor. This log captures how you resolved it.</p>\r\n                                    </TooltipContent>\r\n                                </Tooltip>\r\n                            </TooltipProvider>\r\n                        </div>\r\n\r\n                        <div className=\"grid grid-cols-2 gap-4\">\r\n                            <div className=\"bg-slate-50 p-2 rounded border border-slate-100\">\r\n                                <div className=\"flex items-center gap-1 mb-1\">\r\n                                    <Bot className=\"h-3 w-3 text-indigo-500\" />\r\n                                    <span className=\"text-[10px] text-slate-500 uppercase font-bold\">AI Proposition</span>\r\n                                </div>\r\n                                <span className=\"font-medium text-indigo-700 text-sm block\">\r\n                                    {formatEnum(log.details.discrepancy.systemProposition.placement)}\r\n                                </span>\r\n                                <p className=\"text-[10px] text-slate-500 mt-1 leading-tight\">\r\n                                    {log.details.discrepancy.systemProposition.evidence}\r\n                                </p>\r\n                            </div>\r\n                            <div className=\"bg-slate-50 p-2 rounded border border-slate-100\">\r\n                                <div className=\"flex items-center gap-1 mb-1\">\r\n                                    <User className=\"h-3 w-3 text-emerald-500\" />\r\n                                    <span className=\"text-[10px] text-slate-500 uppercase font-bold\">Human Anchor</span>\r\n                                </div>\r\n                                <span className=\"font-medium text-emerald-700 text-sm block\">\r\n                                    {formatEnum(log.details.discrepancy.humanAnchor.placement)}\r\n                                </span>\r\n                                <p className=\"text-[10px] text-slate-500 mt-1 leading-tight\">\r\n                                    {log.details.discrepancy.humanAnchor.evidence}\r\n                                </p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"flex items-center justify-between bg-slate-100 p-2 rounded text-xs\">\r\n                        <span className=\"font-semibold text-slate-600\">Resolution:</span>\r\n                        <div className=\"flex items-center gap-2\">\r\n                            <span className={log.details.resolution?.action === 'MANUAL_OVERRIDE' ? 'text-red-600 font-bold' : 'text-emerald-600 font-bold'}>\r\n                                {formatEnum(log.details.resolution?.action || '')}\r\n                            </span>\r\n                            <span className=\"text-slate-500\">→</span>\r\n                            <span className=\"text-slate-800 font-medium\">{formatEnum(log.details.resolution?.finalValue || '')}</span>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {log.details.justification && (\r\n                        <div className=\"bg-red-50 p-3 rounded-md border border-red-100 text-red-900 text-xs\">\r\n                            <div className=\"flex items-center gap-2 mb-1 text-red-700 font-semibold\">\r\n                                <AlertTriangle className=\"h-3 w-3\" />\r\n                                <span>Analyst Rationale</span>\r\n                            </div>\r\n                            <p className=\"italic pl-5\">\r\n                                \"{typeof log.details.justification === 'string' ? log.details.justification : log.details.justification.rationale}\"\r\n                            </p>\r\n                        </div>\r\n                    )}\r\n\r\n                    {log.details.reflexivity && (\r\n                        <div className=\"bg-purple-50 p-3 rounded-md border border-purple-100 text-purple-900 text-xs\">\r\n                            <div className=\"flex items-center gap-2 mb-1 text-purple-700 font-semibold\">\r\n                                <BrainCircuit className=\"h-3 w-3\" />\r\n                                <span>System Reflexivity</span>\r\n                                <TooltipProvider>\r\n                                    <Tooltip>\r\n                                        <TooltipTrigger>\r\n                                            <Info className=\"h-3 w-3 text-purple-400 cursor-help\" />\r\n                                        </TooltipTrigger>\r\n                                        <TooltipContent className=\"max-w-xs\">\r\n                                            <p>How the system is updating its internal model based on this interaction.</p>\r\n                                        </TooltipContent>\r\n                                    </Tooltip>\r\n                                </TooltipProvider>\r\n                            </div>\r\n                            <p className=\"pl-5\">\r\n                                {log.details.reflexivity.feedbackLoop}\r\n                            </p>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            )}\r\n\r\n            {/* Standard Validation Details (Legacy) */}\r\n            {!log.details.discrepancy && log.details.agreement && (\r\n                <div className=\"text-xs space-y-1 pl-2\">\r\n                    <div className=\"flex items-center gap-2\">\r\n                        <span className=\"font-semibold text-slate-600\">Agreement:</span>\r\n                        <span className={log.details.agreement === 'yes' ? 'text-emerald-600 font-bold' : 'text-red-600 font-bold'}>\r\n                            {log.details.agreement.toUpperCase()}\r\n                        </span>\r\n                    </div>\r\n                    {log.details.initial_impression && (\r\n                        <p className=\"text-slate-600\"><span className=\"font-semibold\">Initial Impression:</span> {log.details.initial_impression}</p>\r\n                    )}\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\reflexivity\\MultiLensAnalysis.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\reflexivity\\PositionalityDialog.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AlertTriangle' is defined but never used.","line":8,"column":47,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":60},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":78,"column":70,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[3213,3373],"text":"\r\n                        Assemblage-AI uses your inputs to adjust its &quot;Decolonial Prompts\" and flag potential cultural misunderstandings.\r\n                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[3213,3373],"text":"\r\n                        Assemblage-AI uses your inputs to adjust its &ldquo;Decolonial Prompts\" and flag potential cultural misunderstandings.\r\n                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[3213,3373],"text":"\r\n                        Assemblage-AI uses your inputs to adjust its &#34;Decolonial Prompts\" and flag potential cultural misunderstandings.\r\n                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[3213,3373],"text":"\r\n                        Assemblage-AI uses your inputs to adjust its &rdquo;Decolonial Prompts\" and flag potential cultural misunderstandings.\r\n                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":78,"column":89,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[3213,3373],"text":"\r\n                        Assemblage-AI uses your inputs to adjust its \"Decolonial Prompts&quot; and flag potential cultural misunderstandings.\r\n                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[3213,3373],"text":"\r\n                        Assemblage-AI uses your inputs to adjust its \"Decolonial Prompts&ldquo; and flag potential cultural misunderstandings.\r\n                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[3213,3373],"text":"\r\n                        Assemblage-AI uses your inputs to adjust its \"Decolonial Prompts&#34; and flag potential cultural misunderstandings.\r\n                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[3213,3373],"text":"\r\n                        Assemblage-AI uses your inputs to adjust its \"Decolonial Prompts&rdquo; and flag potential cultural misunderstandings.\r\n                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":156,"column":44,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[8359,8465],"text":"\r\n                                    Enable &quot;Counter-Narrative\" Prompts\r\n                                "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[8359,8465],"text":"\r\n                                    Enable &ldquo;Counter-Narrative\" Prompts\r\n                                "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[8359,8465],"text":"\r\n                                    Enable &#34;Counter-Narrative\" Prompts\r\n                                "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[8359,8465],"text":"\r\n                                    Enable &rdquo;Counter-Narrative\" Prompts\r\n                                "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":156,"column":62,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[8359,8465],"text":"\r\n                                    Enable \"Counter-Narrative&quot; Prompts\r\n                                "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[8359,8465],"text":"\r\n                                    Enable \"Counter-Narrative&ldquo; Prompts\r\n                                "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[8359,8465],"text":"\r\n                                    Enable \"Counter-Narrative&#34; Prompts\r\n                                "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[8359,8465],"text":"\r\n                                    Enable \"Counter-Narrative&rdquo; Prompts\r\n                                "},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from \"react\";\r\nimport { Dialog, DialogContent, DialogDescription, DialogFooter, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Textarea } from \"@/components/ui/textarea\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\r\nimport { Checkbox } from \"@/components/ui/checkbox\";\r\nimport { Loader2, Settings2, Globe, BookOpen, AlertTriangle } from \"lucide-react\";\r\nimport { PositionalityData } from \"@/types\";\r\n\r\ninterface PositionalityDialogProps {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n    onConfirm: (data: PositionalityData) => void;\r\n}\r\n\r\nexport function PositionalityDialog({ isOpen, onClose, onConfirm }: PositionalityDialogProps) {\r\n    const [locus, setLocus] = useState(\"\");\r\n    const [discipline, setDiscipline] = useState(\"\");\r\n    const [reflexiveGap, setReflexiveGap] = useState(\"\");\r\n    const [enableCounterNarrative, setEnableCounterNarrative] = useState(false);\r\n    const [isSaving, setIsSaving] = useState(false);\r\n\r\n    const handleConfirm = async () => {\r\n        if (!locus || !discipline || !reflexiveGap) return;\r\n\r\n        setIsSaving(true);\r\n        const data: PositionalityData = {\r\n            locus,\r\n            discipline,\r\n            reflexiveGap,\r\n            enableCounterNarrative\r\n        };\r\n\r\n        try {\r\n            // Save to logs\r\n            const headers: HeadersInit = { 'Content-Type': 'application/json' };\r\n            if (process.env.NEXT_PUBLIC_ENABLE_DEMO_MODE === 'true' && process.env.NEXT_PUBLIC_DEMO_USER_ID) {\r\n                headers['x-demo-user-id'] = process.env.NEXT_PUBLIC_DEMO_USER_ID;\r\n            }\r\n\r\n            await fetch('/api/logs', {\r\n                method: 'POST',\r\n                headers: headers,\r\n                body: JSON.stringify({\r\n                    action: \"Positionality Calibration\",\r\n                    details: {\r\n                        ...data,\r\n                        context: \"Pre-Analysis Calibration\"\r\n                    }\r\n                })\r\n            });\r\n\r\n            onConfirm(data);\r\n            // Reset for next time\r\n            setLocus(\"\");\r\n            setDiscipline(\"\");\r\n            setReflexiveGap(\"\");\r\n            setEnableCounterNarrative(false);\r\n        } catch (error) {\r\n            console.error(\"Failed to save positionality statement\", error);\r\n            onConfirm(data);\r\n        } finally {\r\n            setIsSaving(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <Dialog open={isOpen} onOpenChange={(open) => !open && onClose()}>\r\n            <DialogContent className=\"sm:max-w-[600px] max-h-[90vh] overflow-y-auto\">\r\n                <DialogHeader>\r\n                    <div className=\"flex items-center gap-2 text-indigo-600 mb-2\">\r\n                        <Settings2 className=\"h-5 w-5\" />\r\n                        <span className=\"text-xs font-bold uppercase tracking-wider\">System Calibration</span>\r\n                    </div>\r\n                    <DialogTitle className=\"text-xl\">Calibrate Interpretive Lenses</DialogTitle>\r\n                    <DialogDescription>\r\n                        Assemblage-AI uses your inputs to adjust its \"Decolonial Prompts\" and flag potential cultural misunderstandings.\r\n                    </DialogDescription>\r\n                </DialogHeader>\r\n\r\n                <div className=\"space-y-6 py-4\">\r\n                    {/* Part 1: Locus of Enunciation */}\r\n                    <div className=\"space-y-4 p-4 bg-slate-50 rounded-lg border border-slate-200\">\r\n                        <h5 className=\"text-sm font-bold text-slate-900 uppercase flex items-center gap-2\">\r\n                            <Globe className=\"h-4 w-4 text-slate-500\" />\r\n                            Part 1: Locus of Enunciation\r\n                        </h5>\r\n                        <div className=\"grid grid-cols-2 gap-4\">\r\n                            <div className=\"space-y-2\">\r\n                                <Label className=\"text-xs\">Geographic Locus</Label>\r\n                                <Select value={locus} onValueChange={setLocus}>\r\n                                    <SelectTrigger>\r\n                                        <SelectValue placeholder=\"Select Region\" />\r\n                                    </SelectTrigger>\r\n                                    <SelectContent>\r\n                                        <SelectItem value=\"Global North\">Global North</SelectItem>\r\n                                        <SelectItem value=\"Global South\">Global South</SelectItem>\r\n                                        <SelectItem value=\"Indigenous\">Indigenous / First Nations</SelectItem>\r\n                                        <SelectItem value=\"Diasporic\">Diasporic</SelectItem>\r\n                                    </SelectContent>\r\n                                </Select>\r\n                            </div>\r\n                            <div className=\"space-y-2\">\r\n                                <Label className=\"text-xs\">Disciplinary Lens</Label>\r\n                                <Select value={discipline} onValueChange={setDiscipline}>\r\n                                    <SelectTrigger>\r\n                                        <SelectValue placeholder=\"Select Discipline\" />\r\n                                    </SelectTrigger>\r\n                                    <SelectContent>\r\n                                        <SelectItem value=\"Legal\">Legal / Regulatory</SelectItem>\r\n                                        <SelectItem value=\"Technical\">Technical / Engineering</SelectItem>\r\n                                        <SelectItem value=\"Sociological\">Sociological / STS</SelectItem>\r\n                                        <SelectItem value=\"Activist\">Activist / Civil Society</SelectItem>\r\n                                    </SelectContent>\r\n                                </Select>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Part 2: Epistemic Distance */}\r\n                    <div className=\"space-y-4\">\r\n                        <h5 className=\"text-sm font-bold text-slate-900 uppercase flex items-center gap-2\">\r\n                            <BookOpen className=\"h-4 w-4 text-slate-500\" />\r\n                            Part 2: Epistemic Distance\r\n                        </h5>\r\n                        <div className=\"space-y-2\">\r\n                            <Label className=\"text-xs\">Reflexive Gap Prediction</Label>\r\n                            <p className=\"text-xs text-slate-500 mb-2\">\r\n                                Given your Locus ({locus || \"...\"}) and the Target Document, what specific concepts might you misinterpret?\r\n                            </p>\r\n                            <Textarea\r\n                                placeholder=\"e.g., 'I might default to individual privacy definitions instead of communal data rights.'\"\r\n                                value={reflexiveGap}\r\n                                onChange={(e) => setReflexiveGap(e.target.value)}\r\n                                className=\"min-h-[80px]\"\r\n                            />\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Part 3: Active Calibration */}\r\n                    <div className=\"space-y-4 p-4 bg-indigo-50 rounded-lg border border-indigo-100\">\r\n                        <h5 className=\"text-sm font-bold text-indigo-900 uppercase flex items-center gap-2\">\r\n                            <Settings2 className=\"h-4 w-4\" />\r\n                            Part 3: Active Calibration\r\n                        </h5>\r\n                        <div className=\"flex items-start gap-3\">\r\n                            <Checkbox\r\n                                id=\"counter-narrative\"\r\n                                checked={enableCounterNarrative}\r\n                                onCheckedChange={(checked: boolean | \"indeterminate\") => setEnableCounterNarrative(checked === true)}\r\n                                className=\"mt-1\"\r\n                            />\r\n                            <div className=\"space-y-1\">\r\n                                <Label htmlFor=\"counter-narrative\" className=\"font-semibold text-indigo-900 cursor-pointer\">\r\n                                    Enable \"Counter-Narrative\" Prompts\r\n                                </Label>\r\n                                <p className=\"text-xs text-indigo-700 leading-relaxed\">\r\n                                    Force the AI to re-summarize key findings from the perspective of marginalized actors identified in the text.\r\n                                </p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                <DialogFooter>\r\n                    <Button variant=\"outline\" onClick={onClose}>Cancel</Button>\r\n                    <Button\r\n                        onClick={handleConfirm}\r\n                        disabled={!locus || !discipline || !reflexiveGap || isSaving}\r\n                        className=\"bg-indigo-600 hover:bg-indigo-700 text-white\"\r\n                    >\r\n                        {isSaving ? <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" /> : null}\r\n                        Save & Calibrate Engine\r\n                    </Button>\r\n                </DialogFooter>\r\n            </DialogContent>\r\n        </Dialog>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\ui\\alert-dialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\ui\\badge.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\ui\\button.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\ui\\card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\ui\\checkbox.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\ui\\dialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\ui\\input.tsx","messages":[{"ruleId":"@typescript-eslint/no-empty-object-type","severity":2,"message":"An interface declaring no members is equivalent to its supertype.","line":5,"column":18,"nodeType":"Identifier","messageId":"noEmptyInterfaceWithSuper","endLine":5,"endColumn":28,"suggestions":[{"messageId":"replaceEmptyInterfaceWithSuper","fix":{"range":[77,158],"text":"type InputProps = React.InputHTMLAttributes<HTMLInputElement>"},"desc":"Replace empty interface with a type alias."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nexport interface InputProps\r\n    extends React.InputHTMLAttributes<HTMLInputElement> { }\r\n\r\nconst Input = React.forwardRef<HTMLInputElement, InputProps>(\r\n    ({ className, type, ...props }, ref) => {\r\n        return (\r\n            <input\r\n                type={type}\r\n                className={cn(\r\n                    \"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\r\n                    className\r\n                )}\r\n                ref={ref}\r\n                {...props}\r\n            />\r\n        )\r\n    }\r\n)\r\nInput.displayName = \"Input\"\r\n\r\nexport { Input }\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\ui\\label.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\ui\\select.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\ui\\tabs.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\ui\\textarea.tsx","messages":[{"ruleId":"@typescript-eslint/no-empty-object-type","severity":2,"message":"An interface declaring no members is equivalent to its supertype.","line":5,"column":18,"nodeType":"Identifier","messageId":"noEmptyInterfaceWithSuper","endLine":5,"endColumn":31,"suggestions":[{"messageId":"replaceEmptyInterfaceWithSuper","fix":{"range":[77,167],"text":"type TextareaProps = React.TextareaHTMLAttributes<HTMLTextAreaElement>"},"desc":"Replace empty interface with a type alias."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nexport interface TextareaProps\r\n    extends React.TextareaHTMLAttributes<HTMLTextAreaElement> { }\r\n\r\nconst Textarea = React.forwardRef<HTMLTextAreaElement, TextareaProps>(\r\n    ({ className, ...props }, ref) => {\r\n        return (\r\n            <textarea\r\n                className={cn(\r\n                    \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\r\n                    className\r\n                )}\r\n                ref={ref}\r\n                {...props}\r\n            />\r\n        )\r\n    }\r\n)\r\nTextarea.displayName = \"Textarea\"\r\n\r\nexport { Textarea }\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\components\\ui\\tooltip.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\hooks\\useServerStorage.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\hooks\\useSources.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":73,"column":26,"nodeType":null,"messageId":"unusedVar","endLine":73,"endColumn":27}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport { Source } from '@/types';\r\n\r\nexport function useSources() {\r\n    const [sources, setSources] = useState<Source[]>([]);\r\n    const [isLoading, setIsLoading] = useState(true);\r\n    const [error, setError] = useState<string | null>(null);\r\n\r\n    useEffect(() => {\r\n        fetchSources();\r\n    }, []);\r\n\r\n    const fetchSources = async () => {\r\n        try {\r\n            const headers: HeadersInit = {};\r\n            if (process.env.NEXT_PUBLIC_ENABLE_DEMO_MODE === 'true' && process.env.NEXT_PUBLIC_DEMO_USER_ID) {\r\n                headers['x-demo-user-id'] = process.env.NEXT_PUBLIC_DEMO_USER_ID;\r\n            }\r\n\r\n            const response = await fetch('/api/sources', {\r\n                cache: 'no-store',\r\n                headers\r\n            });\r\n            if (!response.ok) throw new Error('Failed to fetch sources');\r\n            const data = await response.json();\r\n            setSources(data);\r\n        } catch (err) {\r\n            setError(err instanceof Error ? err.message : 'An error occurred');\r\n        } finally {\r\n            setIsLoading(false);\r\n        }\r\n    };\r\n\r\n    const addSource = async (source: Source) => {\r\n        try {\r\n            const headers: HeadersInit = { 'Content-Type': 'application/json' };\r\n            if (process.env.NEXT_PUBLIC_ENABLE_DEMO_MODE === 'true' && process.env.NEXT_PUBLIC_DEMO_USER_ID) {\r\n                headers['x-demo-user-id'] = process.env.NEXT_PUBLIC_DEMO_USER_ID;\r\n            }\r\n\r\n            const response = await fetch('/api/sources', {\r\n                method: 'POST',\r\n                headers: headers,\r\n                body: JSON.stringify(source),\r\n            });\r\n            if (!response.ok) throw new Error('Failed to add source');\r\n            const newSource = await response.json();\r\n            setSources(prev => [...prev, newSource]);\r\n            return newSource;\r\n        } catch (err) {\r\n            setError(err instanceof Error ? err.message : 'Failed to add source');\r\n            throw err;\r\n        }\r\n    };\r\n\r\n    const updateSource = async (id: string, updates: Partial<Source>) => {\r\n        try {\r\n            const headers: HeadersInit = { 'Content-Type': 'application/json' };\r\n            if (process.env.NEXT_PUBLIC_ENABLE_DEMO_MODE === 'true' && process.env.NEXT_PUBLIC_DEMO_USER_ID) {\r\n                headers['x-demo-user-id'] = process.env.NEXT_PUBLIC_DEMO_USER_ID;\r\n            }\r\n\r\n            const response = await fetch(`/api/sources/${id}`, {\r\n                method: 'PUT',\r\n                headers: headers,\r\n                body: JSON.stringify(updates),\r\n            });\r\n            if (!response.ok) {\r\n                const text = await response.text();\r\n                try {\r\n                    const errorData = JSON.parse(text);\r\n                    throw new Error(errorData.error || 'Failed to update source');\r\n                } catch (e) {\r\n                    // If JSON parse fails, throw the raw text (or a summary of it)\r\n                    console.error('Non-JSON error response:', text);\r\n                    throw new Error(`Server error (${response.status}): ${text.substring(0, 100)}`);\r\n                }\r\n            }\r\n            const updatedSource = await response.json();\r\n            setSources(prev => prev.map(s => s.id === id ? updatedSource : s));\r\n            return updatedSource;\r\n        } catch (err) {\r\n            setError(err instanceof Error ? err.message : 'Failed to update source');\r\n            throw err;\r\n        }\r\n    };\r\n\r\n    const deleteSource = async (id: string) => {\r\n        try {\r\n            const headers: HeadersInit = {};\r\n            if (process.env.NEXT_PUBLIC_ENABLE_DEMO_MODE === 'true' && process.env.NEXT_PUBLIC_DEMO_USER_ID) {\r\n                headers['x-demo-user-id'] = process.env.NEXT_PUBLIC_DEMO_USER_ID;\r\n            }\r\n\r\n            const response = await fetch(`/api/sources/${id}`, {\r\n                method: 'DELETE',\r\n                headers: headers\r\n            });\r\n            if (!response.ok) throw new Error('Failed to delete source');\r\n            setSources(prev => prev.filter(s => s.id !== id));\r\n        } catch (err) {\r\n            setError(err instanceof Error ? err.message : 'Failed to delete source');\r\n            throw err;\r\n        }\r\n    };\r\n\r\n    return {\r\n        sources,\r\n        isLoading,\r\n        error,\r\n        addSource,\r\n        updateSource,\r\n        deleteSource,\r\n        refresh: fetchSources\r\n    };\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\lib\\analysis-prompts.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\lib\\analysis-utils.ts","messages":[],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":2,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":2,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[110,113],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[110,113],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":2,"column":60,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":2,"endColumn":63,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[116,119],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[116,119],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":3,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":3,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[143,146],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[143,146],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":8,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":8,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[414,417],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[414,417],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\lib\\credits.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\lib\\governance.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'count' is assigned a value but never used.","line":37,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":37,"endColumn":14}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"export interface CompassPoint {\r\n    x: number; // Asymmetrical (-1) vs Participatory (+1)\r\n    y: number; // Extractive (-1) vs Regenerative (+1)\r\n    label: string;\r\n}\r\n\r\nexport interface DriftVector {\r\n    rhetoric: CompassPoint;\r\n    reality: CompassPoint;\r\n    driftX: number;\r\n    driftY: number;\r\n    magnitude: number;\r\n}\r\n\r\n// Keywords for scoring (simplified for this implementation)\r\n// Keywords for scoring (expanded for better matching)\r\nconst REGENERATIVE_KEYWORDS = [\r\n    'capacity building', 'community ownership', 'local adaptation', 'public good', 'sustainability', 'empowerment',\r\n    'humanity', 'benefit', 'safety', 'beneficial', 'robust', 'reliable', 'fairness', 'justice', 'equity', 'access', 'open source', 'public', 'thriving', 'ecosystem'\r\n];\r\nconst EXTRACTIVE_KEYWORDS = [\r\n    'data mining', 'user acquisition', 'behavioral surplus', 'monetization', 'lock-in', 'surveillance',\r\n    'proprietary', 'closed', 'profit', 'commercial', 'usage policies', 'restrictions', 'license', 'fee', 'paid', 'exclusive', 'competitive', 'capture', 'market share', 'dominance'\r\n];\r\nconst PARTICIPATORY_KEYWORDS = [\r\n    'co-design', 'veto power', 'citizen jury', 'public consultation', 'multi-stakeholder', 'consensus',\r\n    'oversight', 'accountability', 'transparency', 'explainability', 'audit', 'feedback', 'redress', 'appeal', 'collaboration', 'partnership', 'agency', 'choice', 'democratic'\r\n];\r\nconst ASYMMETRICAL_KEYWORDS = [\r\n    'unilateral', 'compliance requirement', 'terms of service', 'mandatory', 'enforcement', 'top-down',\r\n    'centralized', 'control', 'authority', 'restricted', 'prohibited', 'disallowed', 'monitoring', 'rules', 'opaque', 'black box', 'limited access'\r\n];\r\n\r\nfunction calculateScore(text: string, positiveKeywords: string[], negativeKeywords: string[]): number {\r\n    const lowerText = text.toLowerCase();\r\n    let score = 0;\r\n    let count = 0;\r\n\r\n    positiveKeywords.forEach(keyword => {\r\n        if (lowerText.includes(keyword)) {\r\n            score += 1;\r\n            count++;\r\n        }\r\n    });\r\n\r\n    negativeKeywords.forEach(keyword => {\r\n        if (lowerText.includes(keyword)) {\r\n            score -= 1;\r\n            count++;\r\n        }\r\n    });\r\n\r\n    // Normalize to -1 to 1 range, avoiding division by zero\r\n    // We use a sigmoid-like squash or simple clamping. Here, simple clamping with a scaling factor.\r\n    // Assuming 5 keywords is a \"strong\" signal.\r\n    return Math.max(-1, Math.min(1, score * 0.2));\r\n}\r\n\r\nexport function calculateCompassScore(text: string, label: string): CompassPoint {\r\n    const y = calculateScore(text, REGENERATIVE_KEYWORDS, EXTRACTIVE_KEYWORDS);\r\n    const x = calculateScore(text, PARTICIPATORY_KEYWORDS, ASYMMETRICAL_KEYWORDS);\r\n    return { x, y, label };\r\n}\r\n\r\nexport function calculateDrift(policyText: string, techText: string): DriftVector {\r\n    const rhetoric = calculateCompassScore(policyText, \"Rhetoric\");\r\n    const reality = calculateCompassScore(techText, \"Reality\");\r\n\r\n    const driftX = reality.x - rhetoric.x;\r\n    const driftY = reality.y - rhetoric.y;\r\n    const magnitude = Math.sqrt(driftX * driftX + driftY * driftY);\r\n\r\n    return {\r\n        rhetoric,\r\n        reality,\r\n        driftX,\r\n        driftY,\r\n        magnitude\r\n    };\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\lib\\ontology-utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\lib\\ontology.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\lib\\ratelimit.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\lib\\redis.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\lib\\store.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\lib\\utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\middleware.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\services\\analysis.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AnalyzeRequest' is defined but never used.","line":5,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":25}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { AnalysisResult, Source, PositionalityData } from \"@/types\";\r\n\r\nexport type AnalysisMode = 'dsf' | 'cultural_framing' | 'institutional_logics' | 'resistance' | 'ecosystem' | 'ontology' | 'comparison' | 'generate_resistance' | 'cultural_holes' | 'legitimacy' | 'comparative_synthesis' | 'assemblage_extraction' | 'resistance_synthesis';\r\n\r\ninterface AnalyzeRequest {\r\n    text: string;\r\n    sourceType: string;\r\n    analysisMode?: AnalysisMode;\r\n    sourceA?: { title: string; text: string };\r\n    sourceB?: { title: string; text: string };\r\n    documents?: Source[]; // For comparative synthesis\r\n}\r\n\r\ninterface AnalyzeResponse {\r\n    success: boolean;\r\n    analysis: AnalysisResult;\r\n    error?: string;\r\n    details?: string;\r\n}\r\n\r\nexport const analyzeDocument = async (\r\n    text: string,\r\n    mode: AnalysisMode = 'dsf',\r\n    sourceType: string = 'Policy Document',\r\n    force: boolean = false,\r\n    documentId?: string,\r\n    title?: string,\r\n    positionality?: PositionalityData\r\n): Promise<AnalysisResult> => {\r\n    try {\r\n        const headers: HeadersInit = { 'Content-Type': 'application/json' };\r\n        if (process.env.NEXT_PUBLIC_ENABLE_DEMO_MODE === 'true' && process.env.NEXT_PUBLIC_DEMO_USER_ID) {\r\n            headers['x-demo-user-id'] = process.env.NEXT_PUBLIC_DEMO_USER_ID;\r\n        }\r\n        console.log('analyzeDocument headers:', headers);\r\n\r\n        const response = await fetch('/api/analyze', {\r\n            method: 'POST',\r\n            headers: headers,\r\n            body: JSON.stringify({\r\n                text,\r\n                sourceType,\r\n                analysisMode: mode,\r\n                force,\r\n                documentId,\r\n                title,\r\n                positionality\r\n            })\r\n        });\r\n\r\n        const result: AnalyzeResponse = await response.json();\r\n\r\n        if (!result.success) {\r\n            throw new Error(result.details || result.error || 'Analysis failed');\r\n        }\r\n\r\n        return result.analysis;\r\n    } catch (error) {\r\n        console.error(`Analysis error (${mode}):`, error);\r\n        throw error;\r\n    }\r\n};\r\n\r\nexport const synthesizeComparison = async (documents: Source[]): Promise<AnalysisResult> => {\r\n    try {\r\n        const headers: HeadersInit = { 'Content-Type': 'application/json' };\r\n        if (process.env.NEXT_PUBLIC_ENABLE_DEMO_MODE === 'true' && process.env.NEXT_PUBLIC_DEMO_USER_ID) {\r\n            headers['x-demo-user-id'] = process.env.NEXT_PUBLIC_DEMO_USER_ID;\r\n        }\r\n\r\n        const response = await fetch('/api/analyze', {\r\n            method: 'POST',\r\n            headers: headers,\r\n            body: JSON.stringify({\r\n                analysisMode: 'comparative_synthesis',\r\n                documents\r\n            })\r\n        });\r\n\r\n        const result: AnalyzeResponse = await response.json();\r\n\r\n        if (!result.success) {\r\n            throw new Error(result.details || result.error || 'Synthesis failed');\r\n        }\r\n\r\n        return result.analysis;\r\n    } catch (error) {\r\n        console.error('Comparative synthesis error:', error);\r\n        throw error;\r\n    }\r\n};\r\n\r\nexport const generateSearchTerms = async (insight: string): Promise<string[]> => {\r\n    try {\r\n        const headers: HeadersInit = { 'Content-Type': 'application/json' };\r\n        if (process.env.NEXT_PUBLIC_ENABLE_DEMO_MODE === 'true' && process.env.NEXT_PUBLIC_DEMO_USER_ID) {\r\n            headers['x-demo-user-id'] = process.env.NEXT_PUBLIC_DEMO_USER_ID;\r\n        }\r\n\r\n        const response = await fetch('/api/generate-search-terms', {\r\n            method: 'POST',\r\n            headers: headers,\r\n            body: JSON.stringify({ insight })\r\n        });\r\n\r\n        const result = await response.json();\r\n        return result.searchTerms || [];\r\n    } catch (error) {\r\n        console.error('Search terms generation error:', error);\r\n        return [];\r\n    }\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\services\\image.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\types\\cultural.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\types\\ecosystem.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\types\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\types\\logs.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\types\\ontology.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\utils\\generateSynthesisPDF.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mount\\.gemini\\antigravity\\scratch\\src\\utils\\pdfExtractor.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":34,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":34,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1176,1179],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1176,1179],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"export interface PDFExtractionResult {\r\n    text: string;\r\n    pageCount: number;\r\n    metadata?: Record<string, unknown>;\r\n}\r\n\r\nexport async function extractTextFromPDF(file: File): Promise<PDFExtractionResult> {\r\n    try {\r\n        // Dynamic import to avoid SSR issues with DOMMatrix\r\n        const pdfjsLib = await import('pdfjs-dist');\r\n\r\n        // Configure worker\r\n        pdfjsLib.GlobalWorkerOptions.workerSrc = new URL(\r\n            'pdfjs-dist/build/pdf.worker.min.mjs',\r\n            import.meta.url\r\n        ).toString();\r\n\r\n        // Read file as array buffer\r\n        const arrayBuffer = await file.arrayBuffer();\r\n\r\n        // Load PDF document\r\n        const loadingTask = pdfjsLib.getDocument({ data: arrayBuffer });\r\n        const pdf = await loadingTask.promise;\r\n\r\n        const pageCount = pdf.numPages;\r\n        let fullText = '';\r\n\r\n        // Extract text from each page\r\n        for (let pageNum = 1; pageNum <= pageCount; pageNum++) {\r\n            const page = await pdf.getPage(pageNum);\r\n            const textContent = await page.getTextContent();\r\n\r\n            const pageText = textContent.items\r\n                .map((item: { str: string } | any) => 'str' in item ? item.str : '')\r\n                .join(' ');\r\n\r\n            fullText += `\\n\\n--- Page ${pageNum} ---\\n\\n${pageText}`;\r\n        }\r\n\r\n        // Get metadata\r\n        const metadata = await pdf.getMetadata();\r\n\r\n        return {\r\n            text: fullText.trim(),\r\n            pageCount,\r\n            metadata: metadata.info as Record<string, unknown>\r\n        };\r\n    } catch (error) {\r\n        console.error('PDF extraction error:', error);\r\n        throw new Error('Failed to extract text from PDF');\r\n    }\r\n}\r\n\r\nexport function segmentText(text: string, chunkSize: number = 2000): string[] {\r\n    const segments: string[] = [];\r\n    const words = text.split(/\\s+/);\r\n\r\n    let currentSegment: string[] = [];\r\n    let currentLength = 0;\r\n\r\n    for (const word of words) {\r\n        if (currentLength + word.length > chunkSize && currentSegment.length > 0) {\r\n            segments.push(currentSegment.join(' '));\r\n            currentSegment = [word];\r\n            currentLength = word.length;\r\n        } else {\r\n            currentSegment.push(word);\r\n            currentLength += word.length + 1;\r\n        }\r\n    }\r\n\r\n    if (currentSegment.length > 0) {\r\n        segments.push(currentSegment.join(' '));\r\n    }\r\n\r\n    return segments;\r\n}\r\n","usedDeprecatedRules":[]}]